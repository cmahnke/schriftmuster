/*! Bundled license information:

jquery/dist/jquery.js:
  (*!
   * jQuery JavaScript Library v3.7.1
   * https://jquery.com/
   *
   * Copyright OpenJS Foundation and other contributors
   * Released under the MIT license
   * https://jquery.org/license
   *
   * Date: 2023-08-28T13:37Z
   *)
*//*! Bundled license information:

tify/dist/tify.js:
  (*!
  TIFY v0.34.5
  (c) 2017-2025 Göttingen State and University Library (https://www.sub.uni-goettingen.de/)
  AGPL-3.0
  https://tify.rocks/
  *)
  (**
  * @vue/shared v3.5.18
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **)
  (*! #__NO_SIDE_EFFECTS__ *)
  (**
  * @vue/reactivity v3.5.18
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **)
  (**
  * @vue/runtime-core v3.5.18
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **)

tify/dist/tify.js:
  (**
  * @vue/runtime-dom v3.5.18
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **)
  (*! openseadragon 5.0.1 *)
  (*! Built on 2024-12-09 *)
  (*! Git commit: v5.0.1-0-480de92d *)
  (*! http://openseadragon.github.io *)
  (*! License: http://openseadragon.github.io/license/ *)
*/(()=>{var A,B,Nl,b,O,$e,xd,va,Cd,yn,Ed,sa,na,ae,Yi,$i,wi,ee,Eo,au,Io,M,Vn,Lu,At,Un,tt,Ee,Yu,Va,ar,l,Re,a,y,D1,Gn,Xn,K,dt,V1,Oe,Ce,$1,ss,Zn,ie,Ke,W1,Uh,Y1,Da,Z1,t4,ui,mi,Bt,Gr,s,pe,Me,x4,F,N4,Ss,Ms,Ga,I,u0,Js,eo,ua,O0,Gi,It,Ht,ai,J0,Oo,Co,Pt,Je,s2,a2,Bn,Qe,Ra,d2,u2,Ja,m2,Ue,zr,f2,gs,w2,it,x2,is,Y,es,Jn,De,Ur,nt,Hr,_s,ws,Pr,Rr,T2,z2,D2,P2,B2,V2,q2,Yn,yr,br,G2,Q2,t3,n3,i3,e3,l2,i2,mo,me,re,ri,mt,G0,uh,N0,ut,D0,Ro,z0,T0,F0,M0,C0,x0,Wo,Uo,Zo,O4,w4,v4,u4,ii,e4,Vt,Mn,Sn,fi,pi,gi,X1,ve,he,q1,K1,I1,H1,P1,S1,A1,uo,k1,E1,w1,_1,f1,h1,u1,l1,c1,a1,Bi,i1,Q,oo,Ui,On,s1,fe,wn,Zu,Xe,Zi,Qu,ke,ta,j,Qt,so,ia,Xu,Ku,Wu,xe,da,k,ha,jn,$u,Vu,Bu,Pu,Nu,Cu,X,wa,ne,xu,bu,Ta,za,hu,uu,du,lu,Qd,Ks,Us,Ua,Qa,Is,or,lr,_d,ur,yd,jd,bd,fd,cd,ad,Zl,Cr,ql,kr,Bl,Os,bs,Ml,se,ps,nn,xt,Qr,tn,Jr,U8,Mt,nl,et,$t,tl,Uc,Wc,Vc,lc,dc,Bc,hc,mc,Pc,Nc,Dc,Tc,jc,Sc,t2,Dt,Xt,Ec,kc,Ac,Mc,Fc,bc,zc,vc,gc,Lc,Rc,pc,ds,Ic,Te,$c,qt,Kt,Kc,qc,Yc,Gc,Xc,Qc,Zc,Jc,el,ht,Ft,sl,ol,il,al,rl,cl,Ve,dl,ul,hl,ml,fl,pl,gl,vl,bl,jl,yl,_l,wl,Ol,xl,Oc,El,kl,Sl,m,$r,Tl,Vr,Br,we,xs,Rl,sn,Hl,ce,an,$l,rn,yt,Gl,dd,ud,Hs,nr,Sd,Md,Fd,Td,zd,jt,Bs,le,Le,c,D,R,te,Ie,St,gn,Xs,vu,C,ju,t,_u,Ca,Ru,Hu,Z,bn,Tt,ca,Uu,_n,Gu,aa,Ji,Xi,Ju,e1,t1,n1,qi,o1,Fo,Ii,r1,Pi,Ri,d1,Li,Ni,m1,ao,ro,v1,b1,j1,y1,Ti,Fi,Mi,co,Cn,Ei,M1,F1,T1,z1,p4,si,b4,j4,y4,_4,ni,ti,C4,E4,k4,A4,S4,M4,D4,ei,L4,P4,H4,I4,Qo,V4,$4,W4,U4,K4,q4,Y4,G4,X4,Q4,Z4,rt,t0,n0,s0,c0,l0,d0,Tn,h0,m0,f0,p0,g0,Ko,b0,$o,Vo,E0,k0,A0,S0,K2,U2,W2,Ae,N,V,R2,N2,n,S,H,hs,F2,ac,Zt,ls,W,Ct,ic,os,Yr,Ye,_2,y2,b2,v2,Ze,g2,p2,Nr,tr,qs,Wn,In,ra,xc,Do,zo,qo,Z0,Oi,kn,ho,K0,U0,B0,H0,Ki,to,ma,Sa,Na,Xa,a0,i0,pr,o0,e0,J4,R4,Cs,z4,Zr,$a,us,oc,f4,l4,c4,He,r4,Fr,La,a4,s4,n4,Po,yo,Nt,U1,wr,at,fc,Vi,B1,R1,ns,Qn,Lr,gr,O1,p1,Ba,Iu,x,ka,Di,zi,Si,st,li,hm,zu,Tu,Fu,Mu,Su,ci,Au,ku,Eu,yu,Bo,gu,pu,fu,Ho,Ln,Mo,So,Ao,zn,su,nu,tu,Xo,di,eu,Zd,Yd,ji,Kd,Ud,Wd,Qi,Id,Pd,Rd,Ld,ea,kd,la,fa,ya,_a,Zs,Od,vd,xa,To,Qs,Ma,Fa,Gs,Pa,Ia,$s,hd,rd,Za,er,od,nd,rr,xr,Mr,Ir,ed,Kr,Xr,ec,fs,Ul,nc,Pl,Ll,sc,en,ms,Jt,Dl,rc,$,zl,_c,Fl,$8,Al,ll,Hc,Cc,Cl=Object.defineProperty,B8=Object.getOwnPropertyDescriptor,uc=Object.getOwnPropertyNames,H8=Object.prototype.hasOwnProperty,e=(e,t)=>function(){return e&&(t=(0,e[uc(e)[0]])(e=0)),t},P8=(e,t)=>function(){return t||(0,e[uc(e)[0]])((t={exports:{}}).exports,t),t.exports},L8=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of uc(t))!H8.call(e,o)&&o!==n&&Cl(e,o,{get:()=>t[o],enumerable:!(s=B8(t,o))||s.enumerable});return e},q8=e=>L8(Cl({},"__esModule",{value:!0}),e),D8=P8({"node_modules/jquery/dist/jquery.js"(e,t){(function(e,n){"use strict";typeof t=="object"&&typeof t.exports=="object"?t.exports=e.document?n(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(e)})(typeof window!="undefined"?window:e,function(e,t){"use strict";l=[],ke=Object.getPrototypeOf,h=l.slice,Ee=l.flat?function(e){return l.flat.call(e)}:function(e){return l.concat.apply([],e)},U=l.push,y=l.indexOf,W={},Oe=W.toString,M=W.hasOwnProperty,je=M.toString,Be=je.call(Object),a={},i=function(t){return typeof t=="function"&&typeof t.nodeType!="number"&&typeof t.item!="function"},E=function(t){return t!=null&&t===t.window},o=e.document,$e={type:!0,src:!0,nonce:!0,noModule:!0};function qe(e,t,n){n=n||o;var s,a,i=n.createElement("script");if(i.text=e,t)for(s in $e)a=t[s]||t.getAttribute&&t.getAttribute(s),a&&i.setAttribute(s,a);n.head.appendChild(i).parentNode.removeChild(i)}function H(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?W[Oe.call(e)]||"object":typeof e}var st="3.7.1",Xt=/HTML$/i,n=function(e,t){return new n.fn.init(e,t)};n.fn=n.prototype={jquery:st,constructor:n,length:0,toArray:function(){return h.call(this)},get:function(e){return e==null?h.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=n.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return n.each(this,e)},map:function(e){return this.pushStack(n.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(n.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(n.grep(this,function(e,t){return t%2}))},eq:function(e){var n=this.length,t=+e+(e<0?n:0);return this.pushStack(t>=0&&t<n?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:U,sort:l.sort,splice:l.splice},n.extend=n.fn.extend=function(){var t,o,a,r,c,l,e=arguments[0]||{},s=1,u=arguments.length,d=!1;for(typeof e=="boolean"&&(d=e,e=arguments[s]||{},s++),typeof e!="object"&&!i(e)&&(e={}),s===u&&(e=this,s--);s<u;s++)if((l=arguments[s])!=null)for(o in l){if(t=l[o],o==="__proto__"||e===t)continue;d&&t&&(n.isPlainObject(t)||(r=Array.isArray(t)))?(a=e[o],r&&!Array.isArray(a)?c=[]:!r&&!n.isPlainObject(a)?c={}:c=a,r=!1,e[o]=n.extend(d,c,t)):t!==0[0]&&(e[o]=t)}return e},n.extend({expando:"jQuery"+(st+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!!e&&Oe.call(e)==="[object Object]"&&(t=ke(e),!t||(n=M.call(t,"constructor")&&t.constructor,typeof n=="function"&&je.call(n)===Be))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){qe(e,{nonce:t&&t.nonce},n)},each:function(e,t){var s,n=0;if(we(e)){for(s=e.length;n<s;n++)if(t.call(e[n],n,e[n])===!1)break}else for(n in e)if(t.call(e[n],n,e[n])===!1)break;return e},text:function(e){var s,o="",i=0,t=e.nodeType;if(!t)for(;s=e[i++];)o+=n.text(s);return t===1||t===11?e.textContent:t===9?e.documentElement.textContent:t===3||t===4?e.nodeValue:o},makeArray:function(e,t){var s=t||[];return e!=null&&(we(Object(e))?n.merge(s,typeof e=="string"?[e]:e):U.call(s,e)),s},inArray:function(e,t,n){return t==null?-1:y.call(t,e,n)},isXMLDoc:function(e){var n=e&&e.namespaceURI,t=e&&(e.ownerDocument||e).documentElement;return!Xt.test(n||t&&t.nodeName||"HTML")},merge:function(e,t){for(var o=+t.length,n=0,s=e.length;n<o;n++)e[s++]=t[n];return e.length=s,e},grep:function(e,t,n){for(var o,i=[],s=0,a=e.length,r=!n;s<a;s++)o=!t(e[s],s),o!==r&&i.push(e[s]);return i},map:function(e,t,n){var o,a,s=0,i=[];if(we(e))for(a=e.length;s<a;s++)o=t(e[s],s,n),o!=null&&i.push(o);else for(s in e)o=t(e[s],s,n),o!=null&&i.push(o);return Ee(i)},guid:1,support:a}),typeof Symbol=="function"&&(n.fn[Symbol.iterator]=l[Symbol.iterator]),n.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){W["[object "+t+"]"]=t.toLowerCase()});function we(e){var t=!!e&&"length"in e&&e.length,n=H(e);return!i(e)&&!E(e)&&(n==="array"||t===0||typeof t=="number"&&t>0&&t-1 in e)}function c(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}jt=l.pop,Ot=l.sort,ct=l.splice,r=`[\\x20\\t\\r\\n\\f]`,P=new RegExp("^"+r+"+|((?:^|[^\\\\])(?:\\\\.)*)"+r+"+$","g"),n.contains=function(e,t){var n=t&&t.parentNode;return e===n||!!(n&&n.nodeType===1&&(e.contains?e.contains(n):e.compareDocumentPosition&&e.compareDocumentPosition(n)&16))},zt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function Lt(e,t){return t?e==="\0"?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}n.escapeSelector=function(e){return(e+"").replace(zt,Lt)},_=o,G=U,function(){var t,o,d,f,v,C,k,z,L,V,m=G,i=n.expando,p=0,ve=0,X=D(),Q=D(),Z=D(),N=D(),H=function(e,t){return e===t&&(L=!0),0},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",w="(?:\\\\[\\da-fA-F]{1,6}"+r+`?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+`,ee="\\["+r+"*("+w+")(?:"+r+"*([*^$|!~]?=)"+r+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+w+"))|)"+r+"*\\]",te=":("+w+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+ee+")*)|.*)\\)|)",ce=new RegExp(r+"+","g"),se=new RegExp("^"+r+"*,"+r+"*"),q=new RegExp("^"+r+"*([>+~]|"+r+")"+r+"*"),de=new RegExp(r+"|>"),ie=new RegExp(te),oe=new RegExp("^"+w+"$"),S={ID:new RegExp("^#("+w+")"),CLASS:new RegExp("^\\.("+w+")"),TAG:new RegExp("^("+w+"|[*])"),ATTR:new RegExp("^"+ee),PSEUDO:new RegExp("^"+te),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+r+"*(even|odd|(([+-]|)(\\d*)n|)"+r+"*(?:([+-]|)"+r+"*(\\d+)|))"+r+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+r+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+r+"*((?:-\\d)?\\d*)"+r+"*\\)|)(?=[^-]|$)","i")},ue=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,fe=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,W=/[+~]/,g=new RegExp("\\\\[\\da-fA-F]{1,6}"+r+`?|\\\\([^\\r\\n\\f])`,"g"),b=function(e,t){var n="0x"+e.slice(1)-65536;return t?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)},ae=function(){j()},be=F(function(e){return e.disabled===!0&&c(e,"fieldset")},{dir:"parentNode",next:"legend"});function pe(){try{return o.activeElement}catch{}}try{m.apply(l=h.call(_.childNodes),_.childNodes),l[_.childNodes.length].nodeType}catch{m={apply:function(e,t){G.apply(e,h.call(t))},call:function(e){G.apply(e,h.call(arguments,1))}}}function s(e,t,r,c){var l,u,h,v,b,y,_,p=t&&t.ownerDocument,g=t?t.nodeType:9;if(r=r||[],typeof e!="string"||!e||g!==1&&g!==9&&g!==11)return r;if(!c&&(j(t),t=t||o,f)){if(g!==11&&(y=fe.exec(e)))if(l=y[1]){if(g===9)if(u=t.getElementById(l)){if(u.id===l)return m.call(r,u),r}else return r;else if(p&&(u=p.getElementById(l))&&s.contains(t,u)&&u.id===l)return m.call(r,u),r}else if(y[2])return m.apply(r,t.getElementsByTagName(e)),r;else if((l=y[3])&&t.getElementsByClassName)return m.apply(r,t.getElementsByClassName(l)),r;if(!N[e+" "]&&(!d||!d.test(e))){if(_=e,p=t,g===1&&(de.test(e)||q.test(e))){for(p=W.test(e)&&U(t.parentNode)||t,(p!=t||!a.scope)&&((h=t.getAttribute("id"))?h=n.escapeSelector(h):t.setAttribute("id",h=i)),v=E(e),b=v.length;b--;)v[b]=(h?"#"+h:":scope")+" "+T(v[b]);_=v.join(",")}try{return m.apply(r,p.querySelectorAll(_)),r}catch{N(e,!0)}finally{h===i&&t.removeAttribute("id")}}}return Y(e.replace(P,"$1"),t,r,c)}function D(){var n=[];function e(s,o){return n.push(s+" ")>t.cacheLength&&delete e[n.shift()],e[s+" "]=o}return e}function u(e){return e[i]=!0,e}function x(e){var t=o.createElement("fieldset");try{return!!e(t)}catch{return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e){return function(t){return c(t,"input")&&t.type===e}}function re(e){return function(t){return(c(t,"input")||c(t,"button"))&&t.type===e}}function K(e){return function(t){return"form"in t?t.parentNode&&t.disabled===!1?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&be(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function O(e){return u(function(t){return t=+t,u(function(n,s){for(var o,i=e([],n.length,t),a=i.length;a--;)n[o=i[a]]&&(n[o]=!(s[o]=n[o]))})})}function U(e){return e&&typeof e.getElementsByTagName!="undefined"&&e}function j(e){var c,l=e?e.ownerDocument||e:_;return l==o||l.nodeType!==9||!l.documentElement?o:(o=l,v=o.documentElement,f=!n.isXMLDoc(o),V=v.matches||v.webkitMatchesSelector||v.msMatchesSelector,v.msMatchesSelector&&_!=o&&(c=o.defaultView)&&c.top!==c&&c.addEventListener("unload",ae),a.getById=x(function(e){return v.appendChild(e).id=n.expando,!o.getElementsByName||!o.getElementsByName(n.expando).length}),a.disconnectedMatch=x(function(e){return V.call(e,"*")}),a.scope=x(function(){return o.querySelectorAll(":scope")}),a.cssHas=x(function(){try{return o.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),a.getById?(t.filter.ID=function(e){var t=e.replace(g,b);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(typeof t.getElementById!="undefined"&&f){var n=t.getElementById(e);return n?[n]:[]}}):(t.filter.ID=function(e){var t=e.replace(g,b);return function(e){var n=typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id");return n&&n.value===t}},t.find.ID=function(e,t){if(typeof t.getElementById!="undefined"&&f){var n,o,i,s=t.getElementById(e);if(s){if(n=s.getAttributeNode("id"),n&&n.value===e)return[s];for(i=t.getElementsByName(e),o=0;s=i[o++];)if(n=s.getAttributeNode("id"),n&&n.value===e)return[s]}return[]}}),t.find.TAG=function(e,t){return typeof t.getElementsByTagName!="undefined"?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(typeof t.getElementsByClassName!="undefined"&&f)return t.getElementsByClassName(e)},d=[],x(function(e){var t;v.appendChild(e).innerHTML="<a id='"+i+"' href='' disabled='disabled'></a><select id='"+i+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+r+"*(?:value|"+J+")"),e.querySelectorAll("[id~="+i+"-]").length||d.push("~="),e.querySelectorAll("a#"+i+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),t=o.createElement("input"),t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),v.appendChild(e).disabled=!0,e.querySelectorAll(":disabled").length!==2&&d.push(":enabled",":disabled"),t=o.createElement("input"),t.setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||d.push("\\["+r+"*name"+r+"*="+r+`*(?:''|"")`)}),a.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),H=function(e,t){if(e===t)return L=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1,n&1||!a.sortDetached&&t.compareDocumentPosition(e)===n?e===o||e.ownerDocument==_&&s.contains(_,e)?-1:t===o||t.ownerDocument==_&&s.contains(_,t)?1:k?y.call(k,e)-y.call(k,t):0:n&4?-1:1)},o)}s.matches=function(e,t){return s(e,null,null,t)},s.matchesSelector=function(e,t){if(j(e),f&&!N[t+" "]&&(!d||!d.test(t)))try{var n=V.call(e,t);if(n||a.disconnectedMatch||e.document&&e.document.nodeType!==11)return n}catch{N(t,!0)}return s(t,o,null,[e]).length>0},s.contains=function(e,t){return(e.ownerDocument||e)!=o&&j(e),n.contains(e,t)},s.attr=function(e,n){(e.ownerDocument||e)!=o&&j(e);var s=t.attrHandle[n.toLowerCase()],i=s&&M.call(t.attrHandle,n.toLowerCase())?s(e,n,!f):0[0];return i!==0[0]?i:e.getAttribute(n)},s.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},n.uniqueSort=function(e){var s,o=[],t=0,n=0;if(L=!a.sortStable,k=!a.sortStable&&h.call(e,0),Ot.call(e,H),L){for(;s=e[n++];)s===e[n]&&(t=o.push(n));for(;t--;)ct.call(e,o[t],1)}return k=null,e},n.fn.uniqueSort=function(){return this.pushStack(n.uniqueSort(h.apply(this)))},t=n.expr={cacheLength:50,createPseudo:u,match:S,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(g,b),e[3]=(e[3]||e[4]||e[5]||"").replace(g,b),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||s.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&s.error(e[0]),e},PSEUDO:function(e){var n,t=!e[6]&&e[2];return S.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":t&&ie.test(t)&&(n=E(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(e[0]=e[0].slice(0,n),e[2]=t.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(g,b).toLowerCase();return e==="*"?function(){return!0}:function(e){return c(e,t)}},CLASS:function(e){var t=X[e+" "];return t||(t=new RegExp("(^|"+r+")"+e+"("+r+"|$)"))&&X(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!="undefined"&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(o){var i=s.attr(o,e);return i==null?t==="!=":!t||(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i.replace(ce," ")+" ").indexOf(n)>-1:t==="|="&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,s,o){var l=e.slice(0,3)!=="nth",r=e.slice(-4)!=="last",a=t==="of-type";return s===1&&o===0?function(e){return!!e.parentNode}:function(t,n,d){var u,m,f,g,b,j=l!==r?"nextSibling":"previousSibling",v=t.parentNode,_=a&&t.nodeName.toLowerCase(),y=!d&&!a,h=!1;if(v){if(l){for(;j;){for(u=t;u=u[j];)if(a?c(u,_):u.nodeType===1)return!1;b=j=e==="only"&&!b&&"nextSibling"}return!0}if(b=[r?v.firstChild:v.lastChild],r&&y){for(g=v[i]||(v[i]={}),f=g[e]||[],m=f[0]===p&&f[1],h=m&&f[2],u=m&&v.childNodes[m];u=++m&&u&&u[j]||(h=m=0)||b.pop();)if(u.nodeType===1&&++h&&u===t){g[e]=[p,m,h];break}}else if(y&&(g=t[i]||(t[i]={}),f=g[e]||[],m=f[0]===p&&f[1],h=m),h===!1)for(;u=++m&&u&&u[j]||(h=m=0)||b.pop();)if((a?c(u,_):u.nodeType===1)&&++h&&(y&&(g=u[i]||(u[i]={}),g[e]=[p,h]),u===t))break;return h-=o,h===s||h%s===0&&h/s>=0}}},PSEUDO:function(e,n){var a,o=t.pseudos[e]||t.setFilters[e.toLowerCase()]||s.error("unsupported pseudo: "+e);return o[i]?o(n):o.length>1?(a=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?u(function(e,t){for(var s,i=o(e,n),a=i.length;a--;)s=y.call(e,i[a]),e[s]=!(t[s]=i[a])}):function(e){return o(e,0,a)}):o}},pseudos:{not:u(function(e){var t=[],s=[],n=R(e.replace(P,"$1"));return n[i]?u(function(e,t,s,o){for(var a,r=n(e,null,o,[]),i=e.length;i--;)(a=r[i])&&(e[i]=!(t[i]=a))}):function(e,o,i){return t[0]=e,n(t,null,i,s),t[0]=null,!s.pop()}}),has:u(function(e){return function(t){return s(e,t).length>0}}),contains:u(function(e){return e=e.replace(g,b),function(t){return(t.textContent||n.text(t)).indexOf(e)>-1}}),lang:u(function(e){return oe.test(e||"")||s.error("unsupported lang: "+e),e=e.replace(g,b).toLowerCase(),function(t){var n;do if(n=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1)return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===v},focus:function(e){return e===pe()&&o.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:K(!1),disabled:K(!0),checked:function(e){return c(e,"input")&&!!e.checked||c(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return ue.test(e.nodeName)},button:function(e){return c(e,"input")&&e.type==="button"||c(e,"button")},text:function(e){var t;return c(e,"input")&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:O(function(){return[0]}),last:O(function(e,t){return[t-1]}),eq:O(function(e,t,n){return[n<0?n+t:n]}),even:O(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:O(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:O(function(e,t,n){n<0?s=n+t:n>t?s=t:s=n;for(var s;--s>=0;)e.push(s);return e}),gt:O(function(e,t,n){for(var s=n<0?n+t:n;++s<t;)e.push(s);return e})}},t.pseudos.nth=t.pseudos.eq;for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[C]=le(C);for(C in{submit:!0,reset:!0})t.pseudos[C]=re(C);function ne(){}ne.prototype=t.filters=t.pseudos,t.setFilters=new ne;function E(e,n){var o,i,a,r,c,l,d,u=Q[e+" "];if(u)return n?0:u.slice(0);for(o=e,l=[],d=t.preFilter;o;){(!a||(i=se.exec(o)))&&(i&&(o=o.slice(i[0].length)||o),l.push(c=[])),a=!1,(i=q.exec(o))&&(a=i.shift(),c.push({value:a,type:i[0].replace(P," ")}),o=o.slice(a.length));for(r in t.filter)(i=S[r].exec(o))&&(!d[r]||(i=d[r](i)))&&(a=i.shift(),c.push({value:a,type:r,matches:i}),o=o.slice(a.length));if(!a)break}return n?o.length:o?s.error(e):Q(e,l).slice(0)}function T(e){for(var t=0,s=e.length,n="";t<s;t++)n+=e[t].value;return n}function F(e,t,n){var s=t.dir,o=t.next,a=o||s,r=n&&a==="parentNode",l=ve++;return t.first?function(t,n,o){for(;t=t[s];)if(t.nodeType===1||r)return e(t,n,o);return!1}:function(t,n,d){var u,h,m=[p,l];if(d){for(;t=t[s];)if((t.nodeType===1||r)&&e(t,n,d))return!0}else for(;t=t[s];)if(t.nodeType===1||r)if(h=t[i]||(t[i]={}),o&&c(t,o))t=t[s]||t;else if((u=h[a])&&u[0]===p&&u[1]===l)return m[2]=u[2];else if(h[a]=m,m[2]=e(t,n,d))return!0;return!1}}function $(e){return e.length>1?function(t,n,s){for(var o=e.length;o--;)if(!e[o](t,n,s))return!1;return!0}:e[0]}function he(e,t,n){for(var o=0,i=t.length;o<i;o++)s(e,t[o],n);return n}function A(e,t,n,s,o){for(var a,r=[],i=0,c=e.length,l=t!=null;i<c;i++)(a=e[i])&&(!n||n(a,s,o))&&(r.push(a),l&&t.push(i));return r}function I(e,t,n,s,o,a){return s&&!s[i]&&(s=I(s)),o&&!o[i]&&(o=I(o,a)),u(function(i,a,r,c){var l,d,u,h,g=[],p=[],v=a.length,b=i||he(t||"*",r.nodeType?[r]:r,[]),f=e&&(i||!t)?A(b,g,e,r,c):b;if(n?(l=o||(i?e:v||s)?[]:a,n(f,l,r,c)):l=f,s)for(u=A(l,p),s(u,[],r,c),d=u.length;d--;)(h=u[d])&&(l[p[d]]=!(f[p[d]]=h));if(i){if(o||e){if(o){for(u=[],d=l.length;d--;)(h=l[d])&&u.push(f[d]=h);o(null,l=[],u,c)}for(d=l.length;d--;)(h=l[d])&&(u=o?y.call(i,h):g[d])>-1&&(i[u]=!(a[u]=h))}}else l=A(l===a?l.splice(v,l.length):l),o?o(null,a,l,c):m.apply(a,l)})}function B(e){for(var s,o,r,c=e.length,l=t.relative[e[0].type],d=l||t.relative[" "],n=l?1:0,u=F(function(e){return e===r},d,!0),h=F(function(e){return y.call(r,e)>-1},d,!0),a=[function(e,t,n){var s=!l&&(n||t!=z)||((r=t).nodeType?u(e,t,n):h(e,t,n));return r=null,s}];n<c;n++)if(o=t.relative[e[n].type])a=[F($(a),o)];else{if(o=t.filter[e[n].type].apply(null,e[n].matches),o[i]){for(s=++n;s<c;s++)if(t.relative[e[s].type])break;return I(n>1&&$(a),n>1&&T(e.slice(0,n-1).concat({value:e[n-2].type===" "?"*":""})).replace(P,"$1"),o,n<s&&B(e.slice(n,s)),s<c&&B(e=e.slice(s)),s<c&&T(e))}a.push(o)}return $(a)}function ge(e,s){var i=s.length>0,a=e.length>0,r=function(r,c,l,d,u){var h,b,_,y=0,g="0",w=r&&[],v=[],O=z,x=r||a&&t.find.TAG("*",u),C=p+=O==null?1:Math.random()||.1,E=x.length;for(u&&(z=c==o||c||u);g!==E&&(h=x[g])!=null;g++){if(a&&h){for(_=0,!c&&h.ownerDocument!=o&&(j(h),l=!f);b=e[_++];)if(b(h,c||o,l)){m.call(d,h);break}u&&(p=C)}i&&((h=!b&&h)&&y--,r&&w.push(h))}if(y+=g,i&&g!==y){for(_=0;b=s[_++];)b(w,v,c,l);if(r){if(y>0)for(;g--;)w[g]||v[g]||(v[g]=jt.call(d));v=A(v)}m.apply(d,v),u&&!r&&v.length>0&&y+s.length>1&&n.uniqueSort(d)}return u&&(p=C,z=O),w};return i?u(r):r}function R(e,t){var s,o=[],a=[],n=Z[e+" "];if(!n){for(t||(t=E(e)),s=t.length;s--;)n=B(t[s]),n[i]?o.push(n):a.push(n);n=Z(e,ge(a,o)),n.selector=e}return n}function Y(e,n,s,o){var i,a,r,d,u,l=typeof e=="function"&&e,c=!o&&E(e=l.selector||e);if(s=s||[],c.length===1){if(i=c[0]=c[0].slice(0),i.length>2&&(a=i[0]).type==="ID"&&n.nodeType===9&&f&&t.relative[i[1].type]){if(n=(t.find.ID(a.matches[0].replace(g,b),n)||[])[0],!n)return s;l&&(n=n.parentNode),e=e.slice(i.shift().value.length)}for(r=S.needsContext.test(e)?0:i.length;r--;){if(a=i[r],t.relative[d=a.type])break;if((u=t.find[d])&&(o=u(a.matches[0].replace(g,b),W.test(i[0].type)&&U(n.parentNode)||n))){if(i.splice(r,1),e=o.length&&T(i),!e)return m.apply(s,o),s;break}}}return(l||R(e,c))(o,n,!f,s,!n||W.test(e)&&U(n.parentNode)||n),s}a.sortStable=i.split("").sort(H).join("")===i,j(),a.sortDetached=x(function(e){return e.compareDocumentPosition(o.createElement("fieldset"))&1}),n.find=s,n.expr[":"]=n.expr.pseudos,n.unique=n.uniqueSort,s.compile=R,s.select=Y,s.setDocument=j,s.tokenize=E,s.escape=n.escapeSelector,s.getText=n.text,s.isXML=n.isXMLDoc,s.selectors=n.expr,s.support=n.support,s.uniqueSort=n.uniqueSort}(),C=function(e,t,s){for(var o=[],i=s!==0[0];(e=e[t])&&e.nodeType!==9;)if(e.nodeType===1){if(i&&n(e).is(s))break;o.push(e)}return o},ue=function(e,t){for(var n=[];e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n},ce=n.expr.match.needsContext,_e=/^<([a-z][^/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function me(e,t,s){return i(t)?n.grep(e,function(e,n){return!!t.call(e,n,e)!==s}):t.nodeType?n.grep(e,function(e){return e===t!==s}):typeof t!="string"?n.grep(e,function(e){return y.call(t,e)>-1!==s}):n.filter(t,e,s)}n.filter=function(e,t,s){var o=t[0];return s&&(e=":not("+e+")"),t.length===1&&o.nodeType===1?n.find.matchesSelector(o,e)?[o]:[]:n.find.matches(e,n.grep(t,function(e){return e.nodeType===1}))},n.fn.extend({find:function(e){var t,s,o=this.length,i=this;if(typeof e!="string")return this.pushStack(n(e).filter(function(){for(t=0;t<o;t++)if(n.contains(i[t],this))return!0}));s=this.pushStack([]);for(t=0;t<o;t++)n.find(e,i[t],s);return o>1?n.uniqueSort(s):s},filter:function(e){return this.pushStack(me(this,e||[],!1))},not:function(e){return this.pushStack(me(this,e||[],!0))},is:function(e){return!!me(this,typeof e=="string"&&ce.test(e)?n(e):e||[],!1).length}}),Mt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,At=n.fn.init=function(e,t,s){var a,r;if(!e)return this;if(s=s||Ft,typeof e=="string")if(e[0]==="<"&&e[e.length-1]===">"&&e.length>=3?a=[null,e,null]:a=Mt.exec(e),a&&(a[1]||!t)){if(a[1]){if(t=t instanceof n?t[0]:t,n.merge(this,n.parseHTML(a[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),_e.test(a[1])&&n.isPlainObject(t))for(a in t)i(this[a])?this[a](t[a]):this.attr(a,t[a]);return this}return r=o.getElementById(a[2]),r&&(this[0]=r,this.length=1),this}else return!t||t.jquery?(t||s).find(e):this.constructor(t).find(e);else if(e.nodeType)return this[0]=e,this.length=1,this;else if(i(e))return s.ready!==0[0]?s.ready(e):e(n);return n.makeArray(e,this)},At.prototype=n.fn,Ft=n(o),kt=/^(?:parents|prev(?:Until|All))/,Ne={children:!0,contents:!0,next:!0,prev:!0},n.fn.extend({has:function(e){var t=n(e,this),s=t.length;return this.filter(function(){for(var e=0;e<s;e++)if(n.contains(this,t[e]))return!0})},closest:function(e,t){var s,i=0,r=this.length,o=[],a=typeof e!="string"&&n(e);if(!ce.test(e))for(;i<r;i++)for(s=this[i];s&&s!==t;s=s.parentNode)if(s.nodeType<11&&(a?a.index(s)>-1:s.nodeType===1&&n.find.matchesSelector(s,e))){o.push(s);break}return this.pushStack(o.length>1?n.uniqueSort(o):o)},index:function(e){return e?typeof e=="string"?y.call(n(e),this[0]):y.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(n.uniqueSort(n.merge(this.get(),n(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function Et(e,t){for(;(e=e[t])&&e.nodeType!==1;);return e}n.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return C(e,"parentNode")},parentsUntil:function(e,t,n){return C(e,"parentNode",n)},next:function(e){return Et(e,"nextSibling")},prev:function(e){return Et(e,"previousSibling")},nextAll:function(e){return C(e,"nextSibling")},prevAll:function(e){return C(e,"previousSibling")},nextUntil:function(e,t,n){return C(e,"nextSibling",n)},prevUntil:function(e,t,n){return C(e,"previousSibling",n)},siblings:function(e){return ue((e.parentNode||{}).firstChild,e)},children:function(e){return ue(e.firstChild)},contents:function(e){return e.contentDocument!=null&&ke(e.contentDocument)?e.contentDocument:(c(e,"template")&&(e=e.content||e),n.merge([],e.childNodes))}},function(e,t){n.fn[e]=function(s,o){var i=n.map(this,t,s);return e.slice(-5)!=="Until"&&(o=s),o&&typeof o=="string"&&(i=n.filter(o,i)),this.length>1&&(Ne[e]||n.uniqueSort(i),kt.test(e)&&i.reverse()),this.pushStack(i)}}),p=/[^\x20\t\r\n\f]+/g;function Ht(e){var t={};return n.each(e.match(p)||[],function(e,n){t[n]=!0}),t}n.Callbacks=function(e){e=typeof e=="string"?Ht(e):n.extend({},e);var s,o,r,d,t=[],c=[],a=-1,u=function(){for(o=o||e.once,d=r=!0;c.length;a=-1)for(s=c.shift();++a<t.length;)t[a].apply(s[0],s[1])===!1&&e.stopOnFalse&&(a=t.length,s=!1);e.memory||(s=!1),r=!1,o&&(s?t=[]:t="")},l={add:function(){return t&&(s&&!r&&(a=t.length-1,c.push(s)),function s(o){n.each(o,function(n,o){i(o)?(!e.unique||!l.has(o))&&t.push(o):o&&o.length&&H(o)!=="string"&&s(o)})}(arguments),s&&!r&&u()),this},remove:function(){return n.each(arguments,function(e,s){for(var o;(o=n.inArray(s,t,o))>-1;)t.splice(o,1),o<=a&&a--}),this},has:function(e){return e?n.inArray(e,t)>-1:t.length>0},empty:function(){return t&&(t=[]),this},disable:function(){return o=c=[],t=s="",this},disabled:function(){return!t},lock:function(){return o=c=[],!s&&!r&&(t=s=""),this},locked:function(){return!!o},fireWith:function(e,t){return o||(t=t||[],t=[e,t.slice?t.slice():t],c.push(t),r||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!d}};return l};function z(e){return e}function J(e){throw e}function _t(e,t,n,s){var o;try{e&&i(o=e.promise)?o.call(e).done(t).fail(n):e&&i(o=e.then)?o.call(e,t,n):t.apply(0[0],[e].slice(s))}catch(e){n.apply(0[0],[e])}}n.extend({Deferred:function(t){var o=[["notify","progress",n.Callbacks("memory"),n.Callbacks("memory"),2],["resolve","done",n.Callbacks("once memory"),n.Callbacks("once memory"),0,"resolved"],["reject","fail",n.Callbacks("once memory"),n.Callbacks("once memory"),1,"rejected"]],r="pending",a={state:function(){return r},always:function(){return s.done(arguments).fail(arguments),this},catch:function(e){return a.then(null,e)},pipe:function(){var e=arguments;return n.Deferred(function(t){n.each(o,function(n,o){var a=i(e[o[4]])&&e[o[4]];s[o[1]](function(){var e=a&&a.apply(this,arguments);e&&i(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[o[0]+"With"](this,a?[e]:arguments)})}),e=null}).promise()},then:function(t,s,a){var r=0;function c(t,s,o,a){return function(){var l=this,d=arguments,h=function(){var e,n;if(t<r)return;if(e=o.apply(l,d),e===s.promise())throw new TypeError("Thenable self-resolution");n=e&&(typeof e=="object"||typeof e=="function")&&e.then,i(n)?a?n.call(e,c(r,s,z,a),c(r,s,J,a)):(r++,n.call(e,c(r,s,z,a),c(r,s,J,a),c(r,s,z,s.notifyWith))):(o!==z&&(l=0[0],d=[e]),(a||s.resolveWith)(l,d))},u=a?h:function(){try{h()}catch(e){n.Deferred.exceptionHook&&n.Deferred.exceptionHook(e,u.error),t+1>=r&&(o!==J&&(l=0[0],d=[e]),s.rejectWith(l,d))}};t?u():(n.Deferred.getErrorHook?u.error=n.Deferred.getErrorHook():n.Deferred.getStackHook&&(u.error=n.Deferred.getStackHook()),e.setTimeout(u))}}return n.Deferred(function(e){o[0][3].add(c(0,e,i(a)?a:z,e.notifyWith)),o[1][3].add(c(0,e,i(t)?t:z)),o[2][3].add(c(0,e,i(s)?s:J))}).promise()},promise:function(e){return e!=null?n.extend(e,a):a}},s={};return n.each(o,function(e,t){var n=t[2],i=t[5];a[t[1]]=n.add,i&&n.add(function(){r=i},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?0[0]:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),t&&t.call(s,s),s},when:function(e){var a=arguments.length,t=a,r=Array(t),o=h.call(arguments),s=n.Deferred(),c=function(e){return function(t){r[e]=this,o[e]=arguments.length>1?h.call(arguments):t,--a||s.resolveWith(r,o)}};if(a<=1&&(_t(e,s.done(c(t)).resolve,s.reject,!a),s.state()==="pending"||i(o[t]&&o[t].then)))return s.then();for(;t--;)_t(o[t],c(t),s.reject);return s.promise()}}),vt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/,n.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&vt.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},n.readyException=function(t){e.setTimeout(function(){throw t})},Q=n.Deferred(),n.fn.ready=function(e){return Q.then(e).catch(function(e){n.readyException(e)}),this},n.extend({isReady:!1,readyWait:1,ready:function(e){if(e===!0?--n.readyWait:n.isReady)return;if(n.isReady=!0,e!==!0&&--n.readyWait>0)return;Q.resolveWith(o,[n])}}),n.ready.then=Q.then;function Z(){o.removeEventListener("DOMContentLoaded",Z),e.removeEventListener("load",Z),n.ready()}o.readyState==="complete"||o.readyState!=="loading"&&!o.documentElement.doScroll?e.setTimeout(n.ready):(o.addEventListener("DOMContentLoaded",Z),e.addEventListener("load",Z)),b=function(e,t,s,o,a,r,c){var l=0,u=e.length,d=s==null;if(H(s)==="object"){a=!0;for(l in s)b(e,t,l,s[l],!0,r,c)}else if(o!==0[0]&&(a=!0,i(o)||(c=!0),d&&(c?(t.call(e,o),t=null):(d=t,t=function(e,t,s){return d.call(n(e),s)})),t))for(;l<u;l++)t(e[l],s,c?o:o.call(e[l],l,t(e[l],s)));return a?e:d?t.call(e):u?t(e[0],s):r},pt=/^-ms-/,ht=/-([a-z])/g;function Gt(e,t){return t.toUpperCase()}function j(e){return e.replace(pt,"ms-").replace(ht,Gt)}B=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType};function $(){this.expando=n.expando+$.uid++}$.uid=1,$.prototype={cache:function(e){var t=e[this.expando];return t||(t={},B(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var s,o=this.cache(e);if(typeof t=="string")o[j(t)]=n;else for(s in t)o[j(s)]=t[s];return o},get:function(e,t){return t===0[0]?this.cache(e):e[this.expando]&&e[this.expando][j(t)]},access:function(e,t,n){return t===0[0]||t&&typeof t=="string"&&n===0[0]?this.get(e,t):(this.set(e,t,n),n!==0[0]?n:t)},remove:function(e,t){var o,s=e[this.expando];if(s===0[0])return;if(t!==0[0])for(Array.isArray(t)?t=t.map(j):(t=j(t),t=t in s?[t]:t.match(p)||[]),o=t.length;o--;)delete s[t[o]];(t===0[0]||n.isEmptyObject(s))&&(e.nodeType?e[this.expando]=0[0]:delete e[this.expando])},hasData:function(e){var t=e[this.expando];return t!==0[0]&&!n.isEmptyObject(t)}},s=new $,d=new $,dt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Le=/[A-Z]/g;function Jt(e){return e==="true"||e!=="false"&&(e==="null"?null:e===+e+""?+e:dt.test(e)?JSON.parse(e):e)}function Qe(e,t,n){var s;if(n===0[0]&&e.nodeType===1)if(s="data-"+t.replace(Le,"-$&").toLowerCase(),n=e.getAttribute(s),typeof n=="string"){try{n=Jt(n)}catch{}d.set(e,t,n)}else n=0[0];return n}n.extend({hasData:function(e){return d.hasData(e)||s.hasData(e)},data:function(e,t,n){return d.access(e,t,n)},removeData:function(e,t){d.remove(e,t)},_data:function(e,t,n){return s.access(e,t,n)},_removeData:function(e,t){s.remove(e,t)}}),n.fn.extend({data:function(e,t){var o,i,a,n=this[0],r=n&&n.attributes;if(e===0[0]){if(this.length&&(a=d.get(n),n.nodeType===1&&!s.get(n,"hasDataAttrs"))){for(i=r.length;i--;)r[i]&&(o=r[i].name,o.indexOf("data-")===0&&(o=j(o.slice(5)),Qe(n,o,a[o])));s.set(n,"hasDataAttrs",!0)}return a}return typeof e=="object"?this.each(function(){d.set(this,e)}):b(this,function(t){var s;if(n&&t===0[0]){if(s=d.get(n,e),s!==0[0])return s;if(s=Qe(n,e),s!==0[0])return s;return}this.each(function(){d.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){d.remove(this,e)})}}),n.extend({queue:function(e,t,o){var i;if(e)return t=(t||"fx")+"queue",i=s.get(e,t),o&&(!i||Array.isArray(o)?i=s.access(e,t,n.makeArray(o)):i.push(o)),i||[]},dequeue:function(e,t){t=t||"fx";var s=n.queue(e,t),a=s.length,o=s.shift(),i=n._queueHooks(e,t),r=function(){n.dequeue(e,t)};o==="inprogress"&&(o=s.shift(),a--),o&&(t==="fx"&&s.unshift("inprogress"),delete i.stop,o.call(e,r,i)),!a&&i&&i.empty.fire()},_queueHooks:function(e,t){var o=t+"queueHooks";return s.get(e,o)||s.access(e,o,{empty:n.Callbacks("once memory").add(function(){s.remove(e,[t+"queue",o])})})}}),n.fn.extend({queue:function(e,t){var s=2;return typeof e!="string"&&(t=e,e="fx",s--),arguments.length<s?n.queue(this[0],e):t===0[0]?this:this.each(function(){var s=n.queue(this,e,t);n._queueHooks(this,e),e==="fx"&&s[0]!=="inprogress"&&n.dequeue(this,e)})},dequeue:function(e){return this.each(function(){n.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var o,a=1,r=n.Deferred(),i=this,c=this.length,l=function(){--a||r.resolveWith(i,[i])};for(typeof e!="string"&&(t=e,e=0[0]),e=e||"fx";c--;)o=s.get(i[c],e+"queueHooks"),o&&o.empty&&(a++,o.empty.add(l));return l(),r.promise(t)}}),he=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,F=new RegExp("^(?:([+-])=|)("+he+")([a-z%]*)$","i"),v=["Top","Right","Bottom","Left"],w=o.documentElement,k=function(e){return n.contains(e.ownerDocument,e)},Ge={composed:!0},w.getRootNode&&(k=function(e){return n.contains(e.ownerDocument,e)||e.getRootNode(Ge)===e.ownerDocument}),Y=function(e,t){return e=t||e,e.style.display==="none"||e.style.display===""&&k(e)&&n.css(e,"display")==="none"};function Ye(e,t,s,o){var c,l,d=20,u=o?function(){return o.cur()}:function(){return n.css(e,t,"")},r=u(),a=s&&s[3]||(n.cssNumber[t]?"":"px"),i=e.nodeType&&(n.cssNumber[t]||a!=="px"&&+r)&&F.exec(n.css(e,t));if(i&&i[3]!==a){for(r=r/2,a=a||i[3],i=+r||1;d--;)n.style(e,t,i+a),(1-l)*(1-(l=u()/r||.5))<=0&&(d=0),i=i/l;i=i*2,n.style(e,t,i+a),s=s||[]}return s&&(i=+i||+r||0,c=s[1]?i+(s[1]+1)*s[2]:+s[2],o&&(o.unit=a,o.start=i,o.end=c)),c}ye={};function sn(e){var s,i=e.ownerDocument,o=e.nodeName,t=ye[o];return t||(s=i.body.appendChild(i.createElement(o)),t=n.css(s,"display"),s.parentNode.removeChild(s),t==="none"&&(t="block"),ye[o]=t,t)}function D(e,t){for(var o,a,i=[],n=0,r=e.length;n<r;n++){if(o=e[n],!o.style)continue;a=o.style.display,t?(a==="none"&&(i[n]=s.get(o,"display")||null,i[n]||(o.style.display="")),o.style.display===""&&Y(o)&&(i[n]=sn(o))):a!=="none"&&(i[n]="none",s.set(o,"display",a))}for(n=0;n<r;n++)i[n]!=null&&(e[n].style.display=i[n]);return e}n.fn.extend({show:function(){return D(this,!0)},hide:function(){return D(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){Y(this)?n(this).show():n(this).hide()})}}),R=/^(?:checkbox|radio)$/i,xe=/<([a-z][^/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i,function(){var n=o.createDocumentFragment(),e=n.appendChild(o.createElement("div")),t=o.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),a.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",a.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",a.option=!!e.lastChild}(),f={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]},f.tbody=f.tfoot=f.colgroup=f.caption=f.thead,f.th=f.td,a.option||(f.optgroup=f.option=[1,"<select multiple='multiple'>","</select>"]);function m(e,t){var s;return typeof e.getElementsByTagName!="undefined"?s=e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!="undefined"?s=e.querySelectorAll(t||"*"):s=[],t===0[0]||t&&c(e,t)?n.merge([e],s):s}function Ae(e,t){for(var n=0,o=e.length;n<o;n++)s.set(e[n],"globalEval",!t||s.get(t[n],"globalEval"))}Ke=/<|&#?\w+;/;function We(e,t,s,o,i){for(var a,r,d,u,p,g,c=t.createDocumentFragment(),h=[],l=0,v=e.length;l<v;l++)if(a=e[l],a||a===0)if(H(a)==="object")n.merge(h,a.nodeType?[a]:a);else if(Ke.test(a)){for(r=r||c.appendChild(t.createElement("div")),p=(xe.exec(a)||["",""])[1].toLowerCase(),d=f[p]||f._default,r.innerHTML=d[1]+n.htmlPrefilter(a)+d[2],u=d[0];u--;)r=r.lastChild;n.merge(h,r.childNodes),r=c.firstChild,r.textContent=""}else h.push(t.createTextNode(a));for(c.textContent="",l=0;a=h[l++];){if(o&&n.inArray(a,o)>-1){i&&i.push(a);continue}if(g=k(a),r=m(c.appendChild(a),"script"),g&&Ae(r),s)for(u=0;a=r[u++];)Ce.test(a.type||"")&&s.push(a)}return c}Fe=/^([^.]*)(?:\.(.+)|)/;function V(){return!0}function T(){return!1}function De(e,t,s,o,i,a){var r,c;if(typeof t=="object"){typeof s!="string"&&(o=o||s,s=0[0]);for(c in t)De(e,c,s,o,t[c],a);return e}if(o==null&&i==null?(i=s,o=s=0[0]):i==null&&(typeof s=="string"?(i=o,o=0[0]):(i=o,o=s,s=0[0])),i===!1)i=T;else if(!i)return e;return a===1&&(r=i,i=function(e){return n().off(e),r.apply(this,arguments)},i.guid=r.guid||(r.guid=n.guid++)),e.each(function(){n.event.add(this,t,i,o,s)})}n.event={global:{},add:function(e,t,o,i,a){var r,c,l,d,u,h,m,g,v,b,j,f=s.get(e);if(!B(e))return;for(o.handler&&(u=o,o=u.handler,a=u.selector),a&&n.find.matchesSelector(w,a),o.guid||(o.guid=n.guid++),(m=f.events)||(m=f.events=Object.create(null)),(h=f.handle)||(h=f.handle=function(t){return typeof n!="undefined"&&n.event.triggered!==t.type?n.event.dispatch.apply(e,arguments):0[0]}),t=(t||"").match(p)||[""],v=t.length;v--;){if(g=Fe.exec(t[v])||[],r=j=g[1],b=(g[2]||"").split(".").sort(),!r)continue;c=n.event.special[r]||{},r=(a?c.delegateType:c.bindType)||r,c=n.event.special[r]||{},l=n.extend({type:r,origType:j,data:i,handler:o,guid:o.guid,selector:a,needsContext:a&&n.expr.match.needsContext.test(a),namespace:b.join(".")},u),(d=m[r])||(d=m[r]=[],d.delegateCount=0,(!c.setup||c.setup.call(e,i,b,h)===!1)&&e.addEventListener&&e.addEventListener(r,h)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=o.guid)),a?d.splice(d.delegateCount++,0,l):d.push(l),n.event.global[r]=!0}},remove:function(e,t,o,i,a){var r,c,l,d,u,h,m,f,v,b,j,g=s.hasData(e)&&s.get(e);if(!g||!(h=g.events))return;for(t=(t||"").match(p)||[""],f=t.length;f--;){if(l=Fe.exec(t[f])||[],r=j=l[1],v=(l[2]||"").split(".").sort(),!r){for(r in h)n.event.remove(e,r+t[f],o,i,!0);continue}for(d=n.event.special[r]||{},r=(i?d.delegateType:d.bindType)||r,u=h[r]||[],l=l[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"),b=m=u.length;m--;)c=u[m],(a||j===c.origType)&&(!o||o.guid===c.guid)&&(!l||l.test(c.namespace))&&(!i||i===c.selector||i==="**"&&c.selector)&&(u.splice(m,1),c.selector&&u.delegateCount--,d.remove&&d.remove.call(e,c));b&&!u.length&&((!d.teardown||d.teardown.call(e,v,g.handle)===!1)&&n.removeEvent(e,r,g.handle),delete h[r])}n.isEmptyObject(h)&&s.remove(e,"handle events")},dispatch:function(e){var o,i,a,c,d,u,l=new Array(arguments.length),t=n.event.fix(e),h=(s.get(this,"events")||Object.create(null))[t.type]||[],r=n.event.special[t.type]||{};l[0]=t;for(o=1;o<arguments.length;o++)l[o]=arguments[o];if(t.delegateTarget=this,r.preDispatch&&r.preDispatch.call(this,t)===!1)return;for(u=n.event.handlers.call(this,t,h),o=0;(a=u[o++])&&!t.isPropagationStopped();)for(t.currentTarget=a.elem,d=0;(i=a.handlers[d++])&&!t.isImmediatePropagationStopped();)(!t.rnamespace||i.namespace===!1||t.rnamespace.test(i.namespace))&&(t.handleObj=i,t.data=i.data,c=((n.event.special[i.origType]||{}).handle||i.handler).apply(a.elem,l),c!==0[0]&&(t.result=c)===!1&&(t.preventDefault(),t.stopPropagation()));return r.postDispatch&&r.postDispatch.call(this,t),t.result},handlers:function(e,t){var o,i,a,r,c,d=[],l=t.delegateCount,s=e.target;if(l&&s.nodeType&&!(e.type==="click"&&e.button>=1))for(;s!==this;s=s.parentNode||this)if(s.nodeType===1&&(e.type!=="click"||s.disabled!==!0)){r=[],c={};for(i=0;i<l;i++)a=t[i],o=a.selector+" ",c[o]===0[0]&&(c[o]=a.needsContext?n(o,this).index(s)>-1:n.find(o,this,null,[s]).length),c[o]&&r.push(a);r.length&&d.push({elem:s,handlers:r})}return s=this,l<t.length&&d.push({elem:s,handlers:t.slice(l)}),d},addProp:function(e,t){Object.defineProperty(n.Event.prototype,e,{enumerable:!0,configurable:!0,get:i(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[n.expando]?e:new n.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return R.test(t.type)&&t.click&&c(t,"input")&&ne(t,"click",!0),!1},trigger:function(e){var t=this||e;return R.test(t.type)&&t.click&&c(t,"input")&&ne(t,"click"),!0},_default:function(e){var t=e.target;return R.test(t.type)&&t.click&&c(t,"input")&&s.get(t,"click")||c(t,"a")}},beforeunload:{postDispatch:function(e){e.result!==0[0]&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}};function ne(e,t,o){if(!o){s.get(e,t)===0[0]&&n.event.add(e,t,V);return}s.set(e,t,!1),n.event.add(e,t,{namespace:!1,handler:function(e){var i,o=s.get(this,t);if(e.isTrigger&1&&this[t]){if(o)(n.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=h.call(arguments),s.set(this,t,o),this[t](),i=s.get(this,t),s.set(this,t,!1),o!==i)return e.stopImmediatePropagation(),e.preventDefault(),i}else o&&(s.set(this,t,n.event.trigger(o[0],o.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=V)}})}n.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},n.Event=function(e,t){if(!(this instanceof n.Event))return new n.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===0[0]&&e.returnValue===!1?V:T,this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&n.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[n.expando]=!0},n.Event.prototype={constructor:n.Event,isDefaultPrevented:T,isPropagationStopped:T,isImmediatePropagationStopped:T,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=V,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=V,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=V,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},n.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},n.event.addProp),n.each({focus:"focusin",blur:"focusout"},function(e,t){function i(e){if(o.documentMode){var a=s.get(this,"handle"),i=n.event.fix(e);i.type=e.type==="focusin"?"focus":"blur",i.isSimulated=!0,a(e),i.target===i.currentTarget&&a(i)}else n.event.simulate(t,e.target,n.event.fix(e))}n.event.special[e]={setup:function(){var n;if(ne(this,e,!0),o.documentMode)n=s.get(this,t),n||this.addEventListener(t,i),s.set(this,t,(n||0)+1);else return!1},trigger:function(){return ne(this,e),!0},teardown:function(){var e;if(o.documentMode)e=s.get(this,t)-1,e?s.set(this,t,e):(this.removeEventListener(t,i),s.remove(this,t));else return!1},_default:function(t){return s.get(t.target,e)},delegateType:t},n.event.special[t]={setup:function(){var n=this.ownerDocument||this.document||this,a=o.documentMode?this:n,r=s.get(a,t);r||(o.documentMode?this.addEventListener(t,i):n.addEventListener(e,i,!0)),s.set(a,t,(r||0)+1)},teardown:function(){var a=this.ownerDocument||this.document||this,n=o.documentMode?this:a,r=s.get(n,t)-1;r?s.set(n,t,r):(o.documentMode?this.removeEventListener(t,i):a.removeEventListener(e,i,!0),s.remove(n,t))}}}),n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){n.event.special[e]={delegateType:t,bindType:t,handle:function(e){var o,i=this,s=e.relatedTarget,a=e.handleObj;return(!s||s!==i&&!n.contains(i,s))&&(e.type=a.origType,o=a.handler.apply(this,arguments),e.type=t),o}}}),n.fn.extend({on:function(e,t,n,s){return De(this,e,t,n,s)},one:function(e,t,n,s){return De(this,e,t,n,s,1)},off:function(e,t,s){var o,i;if(e&&e.preventDefault&&e.handleObj)return o=e.handleObj,n(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||typeof t=="function")&&(s=t,t=0[0]),s===!1&&(s=T),this.each(function(){n.event.remove(this,e,s,t)})}});var nn=/<script|<style|<link/i,ln=/checked\s*(?:[^=]|=\s*.checked.)/i,cn=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function He(e,t){return c(e,"table")&&c(t.nodeType!==11?t:t.firstChild,"tr")?n(e).children("tbody")[0]||e:e}function rn(e){return e.type=(e.getAttribute("type")!==null)+"/"+e.type,e}function an(e){return(e.type||"").slice(0,5)==="true/"?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ve(e,t){var o,i,a,r,c,l,u;if(t.nodeType!==1)return;if(s.hasData(e)&&(c=s.get(e),o=c.events,o)){s.remove(t,"handle events");for(a in o)for(i=0,r=o[a].length;i<r;i++)n.event.add(t,a,o[a][i])}d.hasData(e)&&(l=d.access(e),u=n.extend({},l),d.set(t,u))}function on(e,t){var n=t.nodeName.toLowerCase();n==="input"&&R.test(e.type)?t.checked=e.checked:(n==="input"||n==="textarea")&&(t.defaultValue=e.defaultValue)}function I(e,t,o,r){t=Ee(t);var c,d,u,h,f,v,l=0,p=e.length,j=p-1,g=t[0],b=i(g);if(b||p>1&&typeof g=="string"&&!a.checkClone&&ln.test(g))return e.each(function(n){var s=e.eq(n);b&&(t[0]=g.call(this,n,s.html())),I(s,t,o,r)});if(p&&(u=We(t,e[0].ownerDocument,!1,e,r),v=u.firstChild,u.childNodes.length===1&&(u=v),v||r)){for(d=n.map(m(u,"script"),rn),h=d.length;l<p;l++)c=u,l!==j&&(c=n.clone(c,!0,!0),h&&n.merge(d,m(c,"script"))),o.call(e[l],c,l);if(h){f=d[d.length-1].ownerDocument,n.map(d,an);for(l=0;l<h;l++)c=d[l],Ce.test(c.type||"")&&!s.access(c,"globalEval")&&n.contains(f,c)&&(c.src&&(c.type||"").toLowerCase()!=="module"?n._evalUrl&&!c.noModule&&n._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},f):qe(c.textContent.replace(cn,""),c,f))}}return e}function Ue(e,t,s){for(var o,a=t?n.filter(t,e):e,i=0;(o=a[i])!=null;i++)!s&&o.nodeType===1&&n.cleanData(m(o)),o.parentNode&&(s&&k(o)&&Ae(m(o,"script")),o.parentNode.removeChild(o));return e}n.extend({htmlPrefilter:function(e){return e},clone:function(e,t,s){var o,i,r,l,c=e.cloneNode(!0),d=k(e);if(!a.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!n.isXMLDoc(e)){i=m(c),r=m(e);for(o=0,l=r.length;o<l;o++)on(r[o],i[o])}if(t)if(s){r=r||m(e),i=i||m(c);for(o=0,l=r.length;o<l;o++)Ve(r[o],i[o])}else Ve(e,c);return i=m(c,"script"),i.length>0&&Ae(i,!d&&m(e,"script")),c},cleanData:function(e){for(var t,o,i,r=n.event.special,a=0;(t=e[a])!==0[0];a++)if(B(t)){if(o=t[s.expando]){if(o.events)for(i in o.events)r[i]?n.event.remove(t,i):n.removeEvent(t,i,o.handle);t[s.expando]=0[0]}t[d.expando]&&(t[d.expando]=0[0])}}}),n.fn.extend({detach:function(e){return Ue(this,e,!0)},remove:function(e){return Ue(this,e)},text:function(e){return b(this,function(e){return e===0[0]?n.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return I(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=He(this,e);t.appendChild(e)}})},prepend:function(){return I(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=He(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return I(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return I(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;(e=this[t])!=null;t++)e.nodeType===1&&(n.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=e??!1,t=t??e,this.map(function(){return n.clone(this,e,t)})},html:function(e){return b(this,function(e){var t=this[0]||{},s=0,o=this.length;if(e===0[0]&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!nn.test(e)&&!f[(xe.exec(e)||["",""])[1].toLowerCase()]){e=n.htmlPrefilter(e);try{for(;s<o;s++)t=this[s]||{},t.nodeType===1&&(n.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch{}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return I(this,arguments,function(t){var s=this.parentNode;n.inArray(this,e)<0&&(n.cleanData(m(this)),s&&s.replaceChild(t,this))},e)}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){n.fn[e]=function(e){for(var o,i=[],a=n(e),r=a.length-1,s=0;s<=r;s++)o=s===r?this:this.clone(!0),n(a[s])[t](o),U.apply(i,o.get());return this.pushStack(i)}}),ee=new RegExp("^("+he+")(?!px)[a-z%]+$","i"),oe=/^--/,q=function(t){var n=t.ownerDocument.defaultView;return(!n||!n.opener)&&(n=e),n.getComputedStyle(t)},ve=function(e,t,n){var s,o,i={};for(s in t)i[s]=e.style[s],e.style[s]=t[s];o=n.call(e);for(s in t)e.style[s]=i[s];return o},Xe=new RegExp(v.join("|"),"i"),function(){function s(){if(!t)return;c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",t.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",w.appendChild(c).appendChild(t);var n=e.getComputedStyle(t),l=n.top!=="1%",m=i(n.marginLeft)===12;t.style.right="60%",h=i(n.right)===36,d=i(n.width)===36,t.style.position="absolute",u=i(t.offsetWidth/3)===12,w.removeChild(c),t=null}function i(e){return Math.round(parseFloat(e))}var r,l,d,u,h,m,c=o.createElement("div"),t=o.createElement("div");if(!t.style)return;t.style.backgroundClip="content-box",t.cloneNode(!0).style.backgroundClip="",a.clearCloneStyle=t.style.backgroundClip==="content-box",n.extend(a,{boxSizingReliable:function(){return s(),d},pixelBoxStyles:function(){return s(),h},pixelPosition:function(){return s(),l},reliableMarginLeft:function(){return s(),m},scrollboxSize:function(){return s(),u},reliableTrDimensions:function(){var t,n,s,i;return r==null&&(n=o.createElement("table"),t=o.createElement("tr"),s=o.createElement("div"),n.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",s.style.height="9px",s.style.display="block",w.appendChild(n).appendChild(t).appendChild(s),i=e.getComputedStyle(t),r=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===t.offsetHeight,w.removeChild(n)),r}})}();function K(e,t,s){var o,r,c,l,d=oe.test(t),i=e.style;return s=s||q(e),s&&(o=s.getPropertyValue(t)||s[t],d&&o&&(o=o.replace(P,"$1")||0[0]),o===""&&!k(e)&&(o=n.style(e,t)),!a.pixelBoxStyles()&&ee.test(o)&&Xe.test(t)&&(r=i.width,c=i.minWidth,l=i.maxWidth,i.minWidth=i.maxWidth=i.width=o,o=s.width,i.width=r,i.minWidth=c,i.maxWidth=l)),o!==0[0]?o+"":o}function Ze(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}var Je=["Webkit","Moz","ms"],et=o.createElement("div").style,tt={};function Dt(e){for(var n=e[0].toUpperCase()+e.slice(1),t=Je.length;t--;)if(e=Je[t]+n,e in et)return e}function de(e){var t=n.cssProps[e]||tt[e];return t?t:e in et?e:tt[e]=Dt(e)||e}var Zt=/^(none|table(?!-c[ea]).+)/,Qt={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function rt(e,t,n){var s=F.exec(t);return s?Math.max(0,s[2]-(n||0))+(s[3]||"px"):t}function le(e,t,s,o,i,a){var r=t==="width"?1:0,l=0,c=0,d=0;if(s===(o?"border":"content"))return 0;for(;r<4;r+=2)s==="margin"&&(d+=n.css(e,s+v[r],!0,i)),o?(s==="content"&&(c-=n.css(e,"padding"+v[r],!0,i)),s!=="margin"&&(c-=n.css(e,"border"+v[r]+"Width",!0,i))):(c+=n.css(e,"padding"+v[r],!0,i),s!=="padding"?c+=n.css(e,"border"+v[r]+"Width",!0,i):l+=n.css(e,"border"+v[r]+"Width",!0,i));return!o&&a>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-a-c-l-.5))||0),c+d}function lt(e,t,s){var i=q(e),u=!a.boxSizingReliable()||s,r=u&&n.css(e,"boxSizing",!1,i)==="border-box",l=r,o=K(e,t,i),d="offset"+t[0].toUpperCase()+t.slice(1);if(ee.test(o)){if(!s)return o;o="auto"}return(!a.boxSizingReliable()&&r||!a.reliableTrDimensions()&&c(e,"tr")||o==="auto"||!parseFloat(o)&&n.css(e,"display",!1,i)==="inline")&&e.getClientRects().length&&(r=n.css(e,"boxSizing",!1,i)==="border-box",l=d in e,l&&(o=e[d])),o=parseFloat(o)||0,o+le(e,t,s||(r?"border":"content"),l,i,o)+"px"}n.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=K(e,"opacity");return n===""?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,s,o){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,r,c,d=j(t),u=oe.test(t),l=e.style;if(u||(t=de(d)),r=n.cssHooks[t]||n.cssHooks[d],s!==0[0]){if(c=typeof s,c==="string"&&(i=F.exec(s))&&i[1]&&(s=Ye(e,t,i),c="number"),s==null||s!==s)return;c==="number"&&!u&&(s+=i&&i[3]||(n.cssNumber[d]?"":"px")),!a.clearCloneStyle&&s===""&&t.indexOf("background")===0&&(l[t]="inherit"),(!r||!("set"in r)||(s=r.set(e,s,o))!==0[0])&&(u?l.setProperty(t,s):l[t]=s)}else return r&&"get"in r&&(i=r.get(e,!1,o))!==0[0]?i:l[t]},css:function(e,t,s,o){var i,a,r,c=j(t),l=oe.test(t);return l||(t=de(c)),a=n.cssHooks[t]||n.cssHooks[c],a&&"get"in a&&(i=a.get(e,!0,s)),i===0[0]&&(i=K(e,t,o)),i==="normal"&&t in at&&(i=at[t]),s===""||s?(r=parseFloat(i),s===!0||isFinite(r)?r||0:i):i}}),n.each(["height","width"],function(e,t){n.cssHooks[t]={get:function(e,s,o){if(s)return Zt.test(n.css(e,"display"))&&(!e.getClientRects().length||!e.getBoundingClientRect().width)?ve(e,Qt,function(){return lt(e,t,o)}):lt(e,t,o)},set:function(e,s,o){var c,i=q(e),l=!a.scrollboxSize()&&i.position==="absolute",u=l||o,d=u&&n.css(e,"boxSizing",!1,i)==="border-box",r=o?le(e,t,o,d,i):0;return d&&l&&(r-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(i[t])-le(e,t,"border",!1,i)-.5)),r&&(c=F.exec(s))&&(c[3]||"px")!=="px"&&(e.style[t]=s,s=n.css(e,t)),rt(e,s,r)}}}),n.cssHooks.marginLeft=Ze(a.reliableMarginLeft,function(e,t){if(t)return(parseFloat(K(e,"marginLeft"))||e.getBoundingClientRect().left-ve(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),n.each({margin:"",padding:"",border:"Width"},function(e,t){n.cssHooks[e+t]={expand:function(n){for(var s=0,i={},o=typeof n=="string"?n.split(" "):[n];s<4;s++)i[e+v[s]+t]=o[s]||o[s-2]||o[0];return i}},e!=="margin"&&(n.cssHooks[e+t].set=rt)}),n.fn.extend({css:function(e,t){return b(this,function(e,t,s){var i,a,r={},o=0;if(Array.isArray(t)){for(i=q(e),a=t.length;o<a;o++)r[t[o]]=n.css(e,t[o],!1,i);return r}return s!==0[0]?n.style(e,t,s):n.css(e,t)},e,t,arguments.length>1)}});function u(e,t,n,s,o){return new u.prototype.init(e,t,n,s,o)}n.Tween=u,u.prototype={constructor:u,init:function(e,t,s,o,i,a){this.elem=e,this.prop=s,this.easing=i||n.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=o,this.unit=a||(n.cssNumber[s]?"":"px")},cur:function(){var e=u.propHooks[this.prop];return e&&e.get?e.get(this):u.propHooks._default.get(this)},run:function(e){var t,s=u.propHooks[this.prop];return this.options.duration?this.pos=t=n.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),s&&s.set?s.set(this):u.propHooks._default.set(this),this}},u.prototype.init.prototype=u.prototype,u.propHooks={_default:{get:function(e){var t;return e.elem.nodeType!==1||e.elem[e.prop]!=null&&e.elem.style[e.prop]==null?e.elem[e.prop]:(t=n.css(e.elem,e.prop,""),!t||t==="auto"?0:t)},set:function(e){n.fx.step[e.prop]?n.fx.step[e.prop](e):e.elem.nodeType===1&&(n.cssHooks[e.prop]||e.elem.style[de(e.prop)]!=null)?n.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},u.propHooks.scrollTop=u.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},n.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},n.fx=u.prototype.init,n.fx.step={},mt=/^(?:toggle|show|hide)$/,ft=/queueHooks$/;function Se(){te&&(o.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(Se):e.setTimeout(Se,n.fx.interval),n.fx.tick())}function gt(){return e.setTimeout(function(){L=0[0]}),L=Date.now()}function ie(e,t){var s,o=0,n={height:e};for(t=t?1:0;o<4;o+=2-t)s=v[o],n["margin"+s]=n["padding"+s]=e;return t&&(n.opacity=n.width=e),n}function bt(e,t,n){for(var o,i=(g.tweeners[t]||[]).concat(g.tweeners["*"]),s=0,a=i.length;s<a;s++)if(o=i[s].call(n,t,e))return o}function Yt(e,t,o){var i,r,c,d,u,p,g,v,b="width"in t||"height"in t,m=this,f={},l=e.style,h=e.nodeType&&Y(e),a=s.get(e,"fxshow");o.queue||(d=n._queueHooks(e,"fx"),d.unqueued==null&&(d.unqueued=0,v=d.empty.fire,d.empty.fire=function(){d.unqueued||v()}),d.unqueued++,m.always(function(){m.always(function(){d.unqueued--,n.queue(e,"fx").length||d.empty.fire()})}));for(i in t)if(p=t[i],mt.test(p)){if(delete t[i],g=g||p==="toggle",p===(h?"hide":"show"))if(p==="show"&&a&&a[i]!==0[0])h=!0;else continue;f[i]=a&&a[i]||n.style(e,i)}if(c=!n.isEmptyObject(t),!c&&n.isEmptyObject(f))return;b&&e.nodeType===1&&(o.overflow=[l.overflow,l.overflowX,l.overflowY],r=a&&a.display,r==null&&(r=s.get(e,"display")),u=n.css(e,"display"),u==="none"&&(r?u=r:(D([e],!0),r=e.style.display||r,u=n.css(e,"display"),D([e]))),(u==="inline"||u==="inline-block"&&r!=null)&&n.css(e,"float")==="none"&&(c||(m.done(function(){l.display=r}),r==null&&(u=l.display,r=u==="none"?"":u)),l.display="inline-block")),o.overflow&&(l.overflow="hidden",m.always(function(){l.overflow=o.overflow[0],l.overflowX=o.overflow[1],l.overflowY=o.overflow[2]})),c=!1;for(i in f)c||(a?"hidden"in a&&(h=a.hidden):a=s.access(e,"fxshow",{display:r}),g&&(a.hidden=!h),h&&D([e],!0),m.done(function(){h||D([e]),s.remove(e,"fxshow");for(i in f)n.style(e,i,f[i])})),c=bt(h?a[i]:0,i,m),i in a||(a[i]=c.start,h&&(c.end=c.start,c.start=0))}function qt(e,t){var s,o,i,a,r;for(s in e)if(i=j(s),a=t[i],o=e[s],Array.isArray(o)&&(a=o[1],o=e[s]=o[0]),s!==i&&(e[i]=o,delete e[s]),r=n.cssHooks[i],r&&"expand"in r){o=r.expand(o),delete e[i];for(s in o)s in e||(e[s]=o[s],t[s]=a)}else t[i]=a}function g(e,t,s){var r,c,l=0,h=g.prefilters.length,a=n.Deferred().always(function(){delete u.elem}),u=function(){if(c)return!1;for(var r=L||gt(),t=Math.max(0,o.startTime+o.duration-r),l=t/o.duration||0,n=1-l,s=0,i=o.tweens.length;s<i;s++)o.tweens[s].run(n);return a.notifyWith(e,[o,n,t]),n<1&&i?t:(i||a.notifyWith(e,[o,1,0]),a.resolveWith(e,[o]),!1)},o=a.promise({elem:e,props:n.extend({},t),opts:n.extend(!0,{specialEasing:{},easing:n.easing._default},s),originalProperties:t,originalOptions:s,startTime:L||gt(),duration:s.duration,tweens:[],createTween:function(t,s){var i=n.Tween(e,o.opts,t,s,o.opts.specialEasing[t]||o.opts.easing);return o.tweens.push(i),i},stop:function(t){var n=0,s=t?o.tweens.length:0;if(c)return this;for(c=!0;n<s;n++)o.tweens[n].run(1);return t?(a.notifyWith(e,[o,1,0]),a.resolveWith(e,[o,t])):a.rejectWith(e,[o,t]),this}}),d=o.props;for(qt(d,o.opts.specialEasing);l<h;l++)if(r=g.prefilters[l].call(o,e,d,o.opts),r)return i(r.stop)&&(n._queueHooks(o.elem,o.opts.queue).stop=r.stop.bind(r)),r;return n.map(d,bt,o),i(o.opts.start)&&o.opts.start.call(e,o),o.progress(o.opts.progress).done(o.opts.done,o.opts.complete).fail(o.opts.fail).always(o.opts.always),n.fx.timer(n.extend(u,{elem:e,anim:o,queue:o.opts.queue})),o}n.Animation=n.extend(g,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return Ye(n.elem,e,F.exec(t),n),n}]},tweener:function(e,t){i(e)?(t=e,e=["*"]):e=e.match(p);for(var n,s=0,o=e.length;s<o;s++)n=e[s],g.tweeners[n]=g.tweeners[n]||[],g.tweeners[n].unshift(t)},prefilters:[Yt],prefilter:function(e,t){t?g.prefilters.unshift(e):g.prefilters.push(e)}}),n.speed=function(e,t,s){var o=e&&typeof e=="object"?n.extend({},e):{complete:s||!s&&t||i(e)&&e,duration:e,easing:s&&t||t&&!i(t)&&t};return n.fx.off?o.duration=0:typeof o.duration!="number"&&(o.duration in n.fx.speeds?o.duration=n.fx.speeds[o.duration]:o.duration=n.fx.speeds._default),(o.queue==null||o.queue===!0)&&(o.queue="fx"),o.old=o.complete,o.complete=function(){i(o.old)&&o.old.call(this),o.queue&&n.dequeue(this,o.queue)},o},n.fn.extend({fadeTo:function(e,t,n,s){return this.filter(Y).css("opacity",0).show().end().animate({opacity:t},e,n,s)},animate:function(e,t,o,i){var c=n.isEmptyObject(e),r=n.speed(t,o,i),a=function(){var t=g(this,n.extend({},e),r);(c||s.get(this,"finish"))&&t.stop(!0)};return a.finish=a,c||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,t,o){var i=function(e){var t=e.stop;delete e.stop,t(o)};return typeof e!="string"&&(o=t,t=e,e=0[0]),t&&this.queue(e||"fx",[]),this.each(function(){var c=!0,t=e!=null&&e+"queueHooks",r=n.timers,a=s.get(this);if(t)a[t]&&a[t].stop&&i(a[t]);else for(t in a)a[t]&&a[t].stop&&ft.test(t)&&i(a[t]);for(t=r.length;t--;)r[t].elem===this&&(e==null||r[t].queue===e)&&(r[t].anim.stop(o),c=!1,r.splice(t,1));(c||!o)&&n.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,a=s.get(this),o=a[e+"queue"],r=a[e+"queueHooks"],i=n.timers,c=o?o.length:0;a.finish=!0,n.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0);for(t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<c;t++)o[t]&&o[t].finish&&o[t].finish.call(this);delete a.finish})}}),n.each(["toggle","show","hide"],function(e,t){var s=n.fn[t];n.fn[t]=function(e,n,o){return e==null||typeof e=="boolean"?s.apply(this,arguments):this.animate(ie(t,!0),e,n,o)}}),n.each({slideDown:ie("show"),slideUp:ie("hide"),slideToggle:ie("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){n.fn[e]=function(e,n,s){return this.animate(t,e,n,s)}}),n.timers=[],n.fx.tick=function(){var s,e=0,t=n.timers;for(L=Date.now();e<t.length;e++)s=t[e],!s()&&t[e]===s&&t.splice(e--,1);t.length||n.fx.stop(),L=0[0]},n.fx.timer=function(e){n.timers.push(e),n.fx.start()},n.fx.interval=13,n.fx.start=function(){if(te)return;te=!0,Se()},n.fx.stop=function(){te=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(t,s){return t=n.fx?n.fx.speeds[t]||t:t,s=s||"fx",this.queue(s,function(n,s){var o=e.setTimeout(n,t);s.stop=function(){e.clearTimeout(o)}})},function(){var e=o.createElement("input"),t=o.createElement("select"),n=t.appendChild(o.createElement("option"));e.type="checkbox",a.checkOn=e.value!=="",a.optSelected=n.selected,e=o.createElement("input"),e.value="t",e.type="radio",a.radioValue=e.value==="t"}(),N=n.expr.attrHandle,n.fn.extend({attr:function(e,t){return b(this,n.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){n.removeAttr(this,e)})}}),n.extend({attr:function(e,t,s){var o,i,a=e.nodeType;if(a===3||a===8||a===2)return;if(typeof e.getAttribute=="undefined")return n.prop(e,t,s);if((a!==1||!n.isXMLDoc(e))&&(i=n.attrHooks[t.toLowerCase()]||(n.expr.match.bool.test(t)?wt:0[0])),s!==0[0]){if(s===null){n.removeAttr(e,t);return}return i&&"set"in i&&(o=i.set(e,s,t))!==0[0]?o:(e.setAttribute(t,s+""),s)}return i&&"get"in i&&(o=i.get(e,t))!==null?o:(o=n.find.attr(e,t),o??0[0])},attrHooks:{type:{set:function(e,t){if(!a.radioValue&&t==="radio"&&c(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,o=0,s=t&&t.match(p);if(s&&e.nodeType===1)for(;n=s[o++];)e.removeAttribute(n)}}),wt={set:function(e,t,s){return t===!1?n.removeAttr(e,s):e.setAttribute(s,s),s}},n.each(n.expr.match.bool.source.match(/\w+/g),function(e,t){var s=N[t]||n.find.attr;N[t]=function(e,t,n){var i,a,o=t.toLowerCase();return n||(a=N[o],N[o]=i,i=s(e,t,n)!=null?o:null,N[o]=a),i}}),xt=/^(?:input|select|textarea|button)$/i,Ct=/^(?:a|area)$/i,n.fn.extend({prop:function(e,t){return b(this,n.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[n.propFix[e]||e]})}}),n.extend({prop:function(e,t,s){var o,i,a=e.nodeType;if(a===3||a===8||a===2)return;return(a!==1||!n.isXMLDoc(e))&&(t=n.propFix[t]||t,o=n.propHooks[t]),s!==0[0]?o&&"set"in o&&(i=o.set(e,s,t))!==0[0]?i:e[t]=s:o&&"get"in o&&(i=o.get(e,t))!==null?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=n.find.attr(e,"tabindex");return t?parseInt(t,10):xt.test(e.nodeName)||Ct.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),a.optSelected||(n.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});function O(e){var t=e.match(p)||[];return t.join(" ")}function x(e){return e.getAttribute&&e.getAttribute("class")||""}function re(e){return Array.isArray(e)?e:typeof e=="string"?e.match(p)||[]:[]}n.fn.extend({addClass:function(e){var t,s,o,a,r,c;return i(e)?this.each(function(t){n(this).addClass(e.call(this,t,x(this)))}):(s=re(e),s.length?this.each(function(){if(a=x(this),t=this.nodeType===1&&" "+O(a)+" ",t){for(o=0;o<s.length;o++)r=s[o],t.indexOf(" "+r+" ")<0&&(t+=r+" ");c=O(t),a!==c&&this.setAttribute("class",c)}}):this)},removeClass:function(e){var t,s,o,a,r,c;return i(e)?this.each(function(t){n(this).removeClass(e.call(this,t,x(this)))}):arguments.length?(s=re(e),s.length?this.each(function(){if(a=x(this),t=this.nodeType===1&&" "+O(a)+" ",t){for(o=0;o<s.length;o++)for(r=s[o];t.indexOf(" "+r+" ")>-1;)t=t.replace(" "+r+" "," ");c=O(t),a!==c&&this.setAttribute("class",c)}}):this):this.attr("class","")},toggleClass:function(e,t){var o,a,r,c,l=typeof e,d=l==="string"||Array.isArray(e);return i(e)?this.each(function(s){n(this).toggleClass(e.call(this,s,x(this),t),t)}):typeof t=="boolean"&&d?t?this.addClass(e):this.removeClass(e):(c=re(e),this.each(function(){if(d){r=n(this);for(a=0;a<c.length;a++)o=c[a],r.hasClass(o)?r.removeClass(o):r.addClass(o)}else(e===0[0]||l==="boolean")&&(o=x(this),o&&s.set(this,"__className__",o),this.setAttribute&&this.setAttribute("class",o||e===!1?"":s.get(this,"__className__")||""))}))},hasClass:function(e){for(var t,s=0,n=" "+e+" ";t=this[s++];)if(t.nodeType===1&&(" "+O(x(t))+" ").indexOf(n)>-1)return!0;return!1}}),St=/\r/g,n.fn.extend({val:function(e){var t,s,a,o=this[0];if(!arguments.length){if(o)return t=n.valHooks[o.type]||n.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&(s=t.get(o,"value"))!==0[0]?s:(s=o.value,typeof s=="string"?s.replace(St,""):s??"");return}return a=i(e),this.each(function(s){var o;if(this.nodeType!==1)return;a?o=e.call(this,s,n(this).val()):o=e,o==null?o="":typeof o=="number"?o+="":Array.isArray(o)&&(o=n.map(o,function(e){return e==null?"":e+""})),t=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],(!t||!("set"in t)||t.set(this,o,"value")===0[0])&&(this.value=o)})}}),n.extend({valHooks:{option:{get:function(e){var t=n.find.attr(e,"value");return t??O(n.text(e))}},select:{get:function(e){var t,s,a,r=e.options,o=e.selectedIndex,i=e.type==="select-one",l=i?null:[],d=i?o+1:r.length;for(o<0?s=d:s=i?o:0;s<d;s++)if(t=r[s],(t.selected||s===o)&&!t.disabled&&(!t.parentNode.disabled||!c(t.parentNode,"optgroup"))){if(a=n(t).val(),i)return a;l.push(a)}return l},set:function(e,t){for(var s,o,i=e.options,a=n.makeArray(t),r=i.length;r--;)s=i[r],(s.selected=n.inArray(n.valHooks.option.get(s),a)>-1)&&(o=!0);return o||(e.selectedIndex=-1),a}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=n.inArray(n(e).val(),t)>-1}},a.checkOn||(n.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})}),A=e.location,ae={guid:Date.now()},X=/\?/,n.parseXML=function(t){var s,o;if(!t||typeof t!="string")return null;try{s=(new e.DOMParser).parseFromString(t,"text/xml")}catch{}return o=s&&s.getElementsByTagName("parsererror")[0],(!s||o)&&n.error("Invalid XML: "+(o?n.map(o.childNodes,function(e){return e.textContent}).join(`
`):t)),s},fe=/^(?:focusinfocus|focusoutblur)$/,pe=function(e){e.stopPropagation()},n.extend(n.event,{trigger:function(t,a,r,c){var u,h,m,f,g,b,j,v=[r||o],l=M.call(t,"type")?t.type:t,p=M.call(t,"namespace")?t.namespace.split("."):[],d=g=u=r=r||o;if(r.nodeType===3||r.nodeType===8)return;if(fe.test(l+n.event.triggered))return;if(l.indexOf(".")>-1&&(p=l.split("."),l=p.shift(),p.sort()),m=l.indexOf(":")<0&&"on"+l,t=t[n.expando]?t:new n.Event(l,typeof t=="object"&&t),t.isTrigger=c?2:3,t.namespace=p.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=0[0],t.target||(t.target=r),a=a==null?[t]:n.makeArray(a,[t]),h=n.event.special[l]||{},!c&&h.trigger&&h.trigger.apply(r,a)===!1)return;if(!c&&!h.noBubble&&!E(r)){for(j=h.delegateType||l,fe.test(j+l)||(d=d.parentNode);d;d=d.parentNode)v.push(d),u=d;u===(r.ownerDocument||o)&&v.push(u.defaultView||u.parentWindow||e)}for(b=0;(d=v[b++])&&!t.isPropagationStopped();)g=d,t.type=b>1?j:h.bindType||l,f=(s.get(d,"events")||Object.create(null))[t.type]&&s.get(d,"handle"),f&&f.apply(d,a),f=m&&d[m],f&&f.apply&&B(d)&&(t.result=f.apply(d,a),t.result===!1&&t.preventDefault());return t.type=l,!c&&!t.isDefaultPrevented()&&(!h._default||h._default.apply(v.pop(),a)===!1)&&B(r)&&m&&i(r[l])&&!E(r)&&(u=r[m],u&&(r[m]=null),n.event.triggered=l,t.isPropagationStopped()&&g.addEventListener(l,pe),r[l](),t.isPropagationStopped()&&g.removeEventListener(l,pe),n.event.triggered=0[0],u&&(r[m]=u)),t.result},simulate:function(e,t,s){var o=n.extend(new n.Event,s,{type:e,isSimulated:!0});n.event.trigger(o,null,t)}}),n.fn.extend({trigger:function(e,t){return this.each(function(){n.event.trigger(e,t,this)})},triggerHandler:function(e,t){var s=this[0];if(s)return n.event.trigger(e,t,s,!0)}});var Nt=/\[\]$/,Tt=/\r?\n/g,Rt=/^(?:submit|button|image|reset|file)$/i,Pt=/^(?:input|select|textarea|keygen)/i;function ge(e,t,s,o){var i;if(Array.isArray(t))n.each(t,function(t,n){s||Nt.test(e)?o(e,n):ge(e+"["+(typeof n=="object"&&n!=null?t:"")+"]",n,s,o)});else if(!s&&H(t)==="object")for(i in t)ge(e+"["+i+"]",t[i],s,o);else o(e,t)}n.param=function(e,t){var s,o=[],a=function(e,t){var n=i(t)?t():t;o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(n??"")};if(e==null)return"";if(Array.isArray(e)||e.jquery&&!n.isPlainObject(e))n.each(e,function(){a(this.name,this.value)});else for(s in e)ge(s,e[s],t,a);return o.join("&")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=n.prop(this,"elements");return e?n.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!n(this).is(":disabled")&&Pt.test(this.nodeName)&&!Rt.test(e)&&(this.checked||!R.test(e))}).map(function(e,t){var s=n(this).val();return s==null?null:Array.isArray(s)?n.map(s,function(e){return{name:t.name,value:e.replace(Tt,`\r
`)}}):{name:t.name,value:s.replace(Tt,`\r
`)}}).get()}});var l,ke,h,Ee,y,W,U,Oe,M,je,Be,s,o,i,a,E,$e,jt,Ot,ct,r,P,zt,_,C,G,ue,ce,_e,Ft,Mt,At,kt,Ne,p,vt,b,Q,pt,ht,d,dt,Le,he,v,w,k,F,B,Ge,Y,ye,R,xe,Ce,f,Ke,Fe,ee,oe,q,ve,Xe,L,te,mt,ft,wt,N,xt,Ct,St,A,ae,X,fe,pe,nt,S,ze,se,Ie,Pe,Re,It=/%20/g,Bt=/#.*$/,Vt=/([?&])_=[^&]*/,$t=/^(.*?):[ \t]*([^\r\n]*)$/mg,Wt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ut=/^(?:GET|HEAD)$/,Kt=/^\/\//,yt={},be={},ut="*/".concat("*"),Me=o.createElement("a");Me.href=A.href;function it(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var s,o=0,a=t.toLowerCase().match(p)||[];if(i(n))for(;s=a[o++];)s[0]==="+"?(s=s.slice(1)||"*",(e[s]=e[s]||[]).unshift(n)):(e[s]=e[s]||[]).push(n)}}function ot(e,t,s,o){var i={},r=e===be;function a(c){var l;return i[c]=!0,n.each(e[c]||[],function(e,n){var c=n(t,s,o);if(typeof c=="string"&&!r&&!i[c])return t.dataTypes.unshift(c),a(c),!1;if(r)return!(l=c)}),l}return a(t.dataTypes[0])||!i["*"]&&a("*")}function Te(e,t){var s,o,i=n.ajaxSettings.flatOptions||{};for(s in t)t[s]!==0[0]&&((i[s]?e:o||(o={}))[s]=t[s]);return o&&n.extend(!0,e,o),e}function en(e,t,n){for(var o,i,a,r,c=e.contents,s=e.dataTypes;s[0]==="*";)s.shift(),a===0[0]&&(a=e.mimeType||t.getResponseHeader("Content-Type"));if(a)for(o in c)if(c[o]&&c[o].test(a)){s.unshift(o);break}if(s[0]in n)i=s[0];else{for(o in n){if(!s[0]||e.converters[o+" "+s[0]]){i=o;break}r||(r=o)}i=i||r}if(i)return i!==s[0]&&s.unshift(i),n[i]}function tn(e,t,n,s){var o,i,a,c,l,r={},d=e.dataTypes.slice();if(d[1])for(i in e.converters)r[i.toLowerCase()]=e.converters[i];for(o=d.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!a&&s&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=o,o=d.shift(),o)if(o==="*")o=a;else if(a!=="*"&&a!==o){if(i=r[a+" "+o]||r["* "+o],!i)for(l in r)if(c=l.split(" "),c[1]===o&&(i=r[a+" "+c[0]]||r["* "+c[0]],i)){i===!0?i=r[l]:r[l]!==!0&&(o=c[0],d.unshift(c[1]));break}if(i!==!0)if(i&&e.throws)t=i(t);else try{t=i(t)}catch(e){return{state:"parsererror",error:i?e:"No conversion from "+a+" to "+o}}}return{state:"success",data:t}}return n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:A.href,type:"GET",isLocal:Wt.test(A.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Te(Te(e,n.ajaxSettings),t):Te(n.ajaxSettings,e)},ajaxPrefilter:it(yt),ajaxTransport:it(be),ajax:function(t,s){typeof t=="object"&&(s=t,t=0[0]),s=s||{};var r,c,d,u,h,m,g,b,_,w,i=n.ajaxSetup({},s),l=i.context||i,j=i.context&&(l.nodeType||l.jquery)?n(l):n.event,y=n.Deferred(),O=n.Callbacks("once memory"),f=i.statusCode||{},x={},C={},E="canceled",a={readyState:0,getResponseHeader:function(e){if(c){if(!h){h={};for(var t;t=$t.exec(w);)h[t[1].toLowerCase()+" "]=(h[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=h[e.toLowerCase()+" "]}return t==null?null:t.join(", ")},getAllResponseHeaders:function(){return c?w:null},setRequestHeader:function(e,t){return c==null&&(e=C[e.toLowerCase()]=C[e.toLowerCase()]||e,x[e]=t),this},overrideMimeType:function(e){return c==null&&(i.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)a.always(e[a.status]);else for(t in e)f[t]=[f[t],e[t]];return this},abort:function(e){var t=e||E;return u&&u.abort(t),v(0,t),this}};if(y.promise(a),i.url=((t||i.url||A.href)+"").replace(Kt,A.protocol+"//"),i.type=s.method||s.type||i.method||i.type,i.dataTypes=(i.dataType||"*").toLowerCase().match(p)||[""],i.crossDomain==null){d=o.createElement("a");try{d.href=i.url,d.href=d.href,i.crossDomain=Me.protocol+"//"+Me.host!==d.protocol+"//"+d.host}catch{i.crossDomain=!0}}if(i.data&&i.processData&&typeof i.data!="string"&&(i.data=n.param(i.data,i.traditional)),ot(yt,i,s,a),c)return a;m=n.event&&i.global,m&&n.active++===0&&n.event.trigger("ajaxStart"),i.type=i.type.toUpperCase(),i.hasContent=!Ut.test(i.type),r=i.url.replace(Bt,""),i.hasContent?i.data&&i.processData&&(i.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(i.data=i.data.replace(It,"+")):(g=i.url.slice(r.length),i.data&&(i.processData||typeof i.data=="string")&&(r+=(X.test(r)?"&":"?")+i.data,delete i.data),i.cache===!1&&(r=r.replace(Vt,"$1"),g=(X.test(r)?"&":"?")+"_="+ae.guid+++g),i.url=r+g),i.ifModified&&(n.lastModified[r]&&a.setRequestHeader("If-Modified-Since",n.lastModified[r]),n.etag[r]&&a.setRequestHeader("If-None-Match",n.etag[r])),(i.data&&i.hasContent&&i.contentType!==!1||s.contentType)&&a.setRequestHeader("Content-Type",i.contentType),a.setRequestHeader("Accept",i.dataTypes[0]&&i.accepts[i.dataTypes[0]]?i.accepts[i.dataTypes[0]]+(i.dataTypes[0]!=="*"?", "+ut+"; q=0.01":""):i.accepts["*"]);for(_ in i.headers)a.setRequestHeader(_,i.headers[_]);if(i.beforeSend&&(i.beforeSend.call(l,a,i)===!1||c))return a.abort();if(E="abort",O.add(i.complete),a.done(i.success),a.fail(i.error),u=ot(be,i,s,a),u){if(a.readyState=1,m&&j.trigger("ajaxSend",[a,i]),c)return a;i.async&&i.timeout>0&&(b=e.setTimeout(function(){a.abort("timeout")},i.timeout));try{c=!1,u.send(x,v)}catch(e){if(c)throw e;v(-1,e)}}else v(-1,"No Transport");function v(t,s,o,d){var p,g,v,_,x,h=s;if(c)return;c=!0,b&&e.clearTimeout(b),u=0[0],w=d||"",a.readyState=t>0?4:0,p=t>=200&&t<300||t===304,o&&(g=en(i,a,o)),!p&&n.inArray("script",i.dataTypes)>-1&&n.inArray("json",i.dataTypes)<0&&(i.converters["text script"]=function(){}),g=tn(i,g,a,p),p?(i.ifModified&&(v=a.getResponseHeader("Last-Modified"),v&&(n.lastModified[r]=v),v=a.getResponseHeader("etag"),v&&(n.etag[r]=v)),t===204||i.type==="HEAD"?h="nocontent":t===304?h="notmodified":(h=g.state,x=g.data,_=g.error,p=!_)):(_=h,(t||!h)&&(h="error",t<0&&(t=0))),a.status=t,a.statusText=(s||h)+"",p?y.resolveWith(l,[x,h,a]):y.rejectWith(l,[a,h,_]),a.statusCode(f),f=0[0],m&&j.trigger(p?"ajaxSuccess":"ajaxError",[a,i,p?x:_]),O.fireWith(l,[a,h]),m&&(j.trigger("ajaxComplete",[a,i]),--n.active||n.event.trigger("ajaxStop"))}return a},getJSON:function(e,t,s){return n.get(e,t,s,"json")},getScript:function(e,t){return n.get(e,0[0],t,"script")}}),n.each(["get","post"],function(e,t){n[t]=function(e,s,o,a){return i(s)&&(a=a||o,o=s,s=0[0]),n.ajax(n.extend({url:e,type:t,dataType:a,data:s,success:o},n.isPlainObject(e)&&e))}}),n.ajaxPrefilter(function(e){var t;for(t in e.headers)t.toLowerCase()==="content-type"&&(e.contentType=e.headers[t]||"")}),n._evalUrl=function(e,t,s){return n.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){n.globalEval(e,t,s)}})},n.fn.extend({wrapAll:function(e){var t;return this[0]&&(i(e)&&(e=e.call(this[0])),t=n(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return i(e)?this.each(function(t){n(this).wrapInner(e.call(this,t))}):this.each(function(){var t=n(this),s=t.contents();s.length?s.wrapAll(e):t.append(e)})},wrap:function(e){var t=i(e);return this.each(function(s){n(this).wrapAll(t?e.call(this,s):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){n(this).replaceWith(this.childNodes)}),this}}),n.expr.pseudos.hidden=function(e){return!n.expr.pseudos.visible(e)},n.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},n.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}},nt={0:200,1223:204},S=n.ajaxSettings.xhr(),a.cors=!!S&&"withCredentials"in S,a.ajax=S=!!S,n.ajaxTransport(function(t){var n,s;if(a.cors||S&&!t.crossDomain)return{send:function(o,i){var r,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)a[r]=t.xhrFields[r];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),!t.crossDomain&&!o["X-Requested-With"]&&(o["X-Requested-With"]="XMLHttpRequest");for(r in o)a.setRequestHeader(r,o[r]);n=function(e){return function(){n&&(n=s=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,e==="abort"?a.abort():e==="error"?typeof a.status!="number"?i(0,"error"):i(a.status,a.statusText):i(nt[a.status]||a.status,a.statusText,(a.responseType||"text")!=="text"||typeof a.responseText!="string"?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),s=a.onerror=a.ontimeout=n("error"),a.onabort!==0[0]?a.onabort=s:a.onreadystatechange=function(){a.readyState===4&&e.setTimeout(function(){n&&s()})},n=n("abort");try{a.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),n.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return n.globalEval(e),e}}}),n.ajaxPrefilter("script",function(e){e.cache===0[0]&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),n.ajaxTransport("script",function(e){if(e.crossDomain||e.scriptAttrs){var t,s;return{send:function(i,a){s=n("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",t=function(e){s.remove(),t=null,e&&a(e.type==="error"?404:200,e.type)}),o.head.appendChild(s[0])},abort:function(){t&&t()}}}}),ze=[],se=/(=)\?(?=&|$)|\?\?/,n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ze.pop()||n.expando+"_"+ae.guid++;return this[e]=!0,e}}),n.ajaxPrefilter("json jsonp",function(t,s,o){var a,r,c,l=t.jsonp!==!1&&(se.test(t.url)?"url":typeof t.data=="string"&&(t.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&se.test(t.data)&&"data");if(l||t.dataTypes[0]==="jsonp")return a=t.jsonpCallback=i(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,l?t[l]=t[l].replace(se,"$1"+a):t.jsonp!==!1&&(t.url+=(X.test(t.url)?"&":"?")+t.jsonp+"="+a),t.converters["script json"]=function(){return c||n.error(a+" was not called"),c[0]},t.dataTypes[0]="json",r=e[a],e[a]=function(){c=arguments},o.always(function(){r===0[0]?n(e).removeProp(a):e[a]=r,t[a]&&(t.jsonpCallback=s.jsonpCallback,ze.push(a)),c&&i(r)&&r(c[0]),c=r=0[0]}),"script"}),a.createHTMLDocument=function(){var e=o.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",e.childNodes.length===2}(),n.parseHTML=function(e,t,s){if(typeof e!="string")return[];typeof t=="boolean"&&(s=t,t=!1);var i,r,c;return t||(a.createHTMLDocument?(t=o.implementation.createHTMLDocument(""),c=t.createElement("base"),c.href=o.location.href,t.head.appendChild(c)):t=o),i=_e.exec(e),r=!s&&[],i?[t.createElement(i[1])]:(i=We([e],t,r),r&&r.length&&n(r).remove(),n.merge([],i.childNodes))},n.fn.load=function(e,t,s){var o,c,l,a=this,r=e.indexOf(" ");return r>-1&&(o=O(e.slice(r)),e=e.slice(0,r)),i(t)?(s=t,t=0[0]):t&&typeof t=="object"&&(c="POST"),a.length>0&&n.ajax({url:e,type:c||"GET",dataType:"html",data:t}).done(function(e){l=arguments,a.html(o?n("<div>").append(n.parseHTML(e)).find(o):e)}).always(s&&function(e,t){a.each(function(){s.apply(this,l||[e.responseText,t,e])})}),this},n.expr.pseudos.animated=function(e){return n.grep(n.timers,function(t){return e===t.elem}).length},n.offset={setOffset:function(e,t,s){var o,r,c,l,d,u,f,h=n.css(e,"position"),m=n(e),a={};h==="static"&&(e.style.position="relative"),o=m.offset(),l=n.css(e,"top"),u=n.css(e,"left"),f=(h==="absolute"||h==="fixed")&&(l+u).indexOf("auto")>-1,f?(r=m.position(),d=r.top,c=r.left):(d=parseFloat(l)||0,c=parseFloat(u)||0),i(t)&&(t=t.call(e,s,n.extend({},o))),t.top!=null&&(a.top=t.top-o.top+d),t.left!=null&&(a.left=t.left-o.left+c),"using"in t?t.using.call(e,a):m.css(a)}},n.fn.extend({offset:function(e){if(arguments.length)return e===0[0]?this:this.each(function(t){n.offset.setOffset(this,e,t)});var s,o,t=this[0];if(!t)return;return t.getClientRects().length?(s=t.getBoundingClientRect(),o=t.ownerDocument.defaultView,{top:s.top+o.pageYOffset,left:s.left+o.pageXOffset}):{top:0,left:0}},position:function(){if(!this[0])return;var e,o,i,t=this[0],s={top:0,left:0};if(n.css(t,"position")==="fixed")o=t.getBoundingClientRect();else{for(o=this.offset(),i=t.ownerDocument,e=t.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&n.css(e,"position")==="static";)e=e.parentNode;e&&e!==t&&e.nodeType===1&&(s=n(e).offset(),s.top+=n.css(e,"borderTopWidth",!0),s.left+=n.css(e,"borderLeftWidth",!0))}return{top:o.top-s.top-n.css(t,"marginTop",!0),left:o.left-s.left-n.css(t,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&n.css(e,"position")==="static";)e=e.offsetParent;return e||w})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var s="pageYOffset"===t;n.fn[e]=function(n){return b(this,function(e,n,o){var i;if(E(e)?i=e:e.nodeType===9&&(i=e.defaultView),o===0[0])return i?i[t]:e[n];i?i.scrollTo(s?i.pageXOffset:o,s?o:i.pageYOffset):e[n]=o},e,n,arguments.length)}}),n.each(["top","left"],function(e,t){n.cssHooks[t]=Ze(a.pixelPosition,function(e,s){if(s)return s=K(e,t),ee.test(s)?n(e).position()[t]+"px":s})}),n.each({Height:"height",Width:"width"},function(e,t){n.each({padding:"inner"+e,content:t,"":"outer"+e},function(s,o){n.fn[o]=function(i,a){var r=arguments.length&&(s||typeof i!="boolean"),c=s||(i===!0||a===!0?"margin":"border");return b(this,function(t,s,i){var a;return E(t)?o.indexOf("outer")===0?t["inner"+e]:t.document.documentElement["client"+e]:t.nodeType===9?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):i===0[0]?n.css(t,s,c):n.style(t,s,i,c)},t,r?i:0[0],r)}})}),n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){n.fn[t]=function(e){return this.on(t,e)}}),n.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,s){return this.on(t,e,n,s)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),n.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){n.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),Ie=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g,n.proxy=function(e,t){var s,o,a;return typeof t=="string"&&(o=e[t],t=e,e=o),i(e)?(a=h.call(arguments,2),s=function(){return e.apply(t||this,a.concat(h.call(arguments)))},s.guid=e.guid=e.guid||n.guid++,s):0[0]},n.holdReady=function(e){e?n.readyWait++:n.ready(!0)},n.isArray=Array.isArray,n.parseJSON=JSON.parse,n.nodeName=c,n.isFunction=i,n.isWindow=E,n.camelCase=j,n.type=H,n.now=Date.now,n.isNumeric=function(e){var t=n.type(e);return(t==="number"||t==="string")&&!isNaN(e-parseFloat(e))},n.trim=function(e){return e==null?"":(e+"").replace(Ie,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return n}),Pe=e.jQuery,Re=e.$,n.noConflict=function(t){return e.$===n&&(e.$=Re),t&&e.jQuery===n&&(e.jQuery=Pe),n},typeof t=="undefined"&&(e.jQuery=e.$=n),n})}});function f(e,t){if(!e)throw new Error(t)}B=e({"node_modules/ol/asserts.js"(){}}),Nl=e({"node_modules/ol/extent/Relationship.js"(){A={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16}}});function Wl(e){const t=lt();for(let n=0,s=e.length;n<s;++n)Ps(t,e[n]);return t}function A8(e,t,n){const s=Math.min.apply(null,e),o=Math.min.apply(null,t),i=Math.max.apply(null,e),a=Math.max.apply(null,t);return wt(s,o,i,a,n)}function k8(e,t){return t?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):e.slice()}function Yl(e,t,n){let s,o;return t<e[0]?s=e[0]-t:e[2]<t?s=t-e[2]:s=0,n<e[1]?o=e[1]-n:e[3]<n?o=n-e[3]:o=0,s*s+o*o}function qr(e,t){return Xl(e,t[0],t[1])}function Xl(e,t,n){return e[0]<=t&&t<=e[2]&&e[1]<=n&&n<=e[3]}function td(e,t){const i=e[0],a=e[1],r=e[2],c=e[3],s=t[0],o=t[1];let n=A.UNKNOWN;return s<i?n=n|A.LEFT:s>r&&(n=n|A.RIGHT),o<a?n=n|A.BELOW:o>c&&(n=n|A.ABOVE),n===A.UNKNOWN&&(n=A.INTERSECTING),n}function lt(){return[1/0,1/0,-(1/0),-(1/0)]}function wt(e,t,n,s,o){return o?(o[0]=e,o[1]=t,o[2]=n,o[3]=s,o):[e,t,n,s]}function on(e){return wt(1/0,1/0,-(1/0),-(1/0),e)}function w8(e,t){const n=e[0],s=e[1];return wt(n,s,n,s,t)}function _8(e,t,n,s,o){const i=on(o);return id(i,e,t,n,s)}function vr(e,t){return e[0]==t[0]&&e[2]==t[2]&&e[1]==t[1]&&e[3]==t[3]}function y8(e,t){return t[0]<e[0]&&(e[0]=t[0]),t[2]>e[2]&&(e[2]=t[2]),t[1]<e[1]&&(e[1]=t[1]),t[3]>e[3]&&(e[3]=t[3]),e}function Ps(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function id(e,t,n,s,o){for(;n<s;n+=o)g8(e,t[n],t[n+1]);return e}function g8(e,t,n){e[0]=Math.min(e[0],t),e[1]=Math.min(e[1],n),e[2]=Math.max(e[2],t),e[3]=Math.max(e[3],n)}function md(e,t){let n;return n=t(Ws(e)),n||(n=t(rs(e)),n||(n=t(Ys(e)),n||(n=t(Se(e)),n||!1)))}function qa(e){let t=0;return pn(e)||(t=p(e)*J(e)),t}function Ws(e){return[e[0],e[1]]}function rs(e){return[e[2],e[1]]}function Ot(e){return[(e[0]+e[2])/2,(e[1]+e[3])/2]}function h8(e,t){let n;if(t==="bottom-left")n=Ws(e);else if(t==="bottom-right")n=rs(e);else if(t==="top-left")n=Se(e);else if(t==="top-right")n=Ys(e);else throw new Error("Invalid corner");return n}function Ha(e,t,n,s,o){const[i,a,r,c,l,d,u,h]=gd(e,t,n,s);return wt(Math.min(i,r,l,u),Math.min(a,c,d,h),Math.max(i,r,l,u),Math.max(a,c,d,h),o)}function gd(e,t,n,s){const d=t*s[0]/2,u=t*s[1]/2,h=Math.cos(n),m=Math.sin(n),o=d*h,i=d*m,a=u*h,r=u*m,c=e[0],l=e[1];return[c-o+r,l-i-a,c-o-r,l-i+a,c+o-r,l+i+a,c+o+r,l+i-a,c-o+r,l-i-a]}function J(e){return e[3]-e[1]}function ot(e,t,n){const s=n||lt();return fn(e,t)?(e[0]>t[0]?s[0]=e[0]:s[0]=t[0],e[1]>t[1]?s[1]=e[1]:s[1]=t[1],e[2]<t[2]?s[2]=e[2]:s[2]=t[2],e[3]<t[3]?s[3]=e[3]:s[3]=t[3]):on(s),s}function Se(e){return[e[0],e[3]]}function Ys(e){return[e[2],e[3]]}function p(e){return e[2]-e[0]}function fn(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]}function pn(e){return e[2]<e[0]||e[3]<e[1]}function d8(e,t){return t?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):e}function l8(e,t,n){let s=!1;const o=td(e,t),i=td(e,n);if(o===A.INTERSECTING||i===A.INTERSECTING)s=!0;else{const u=e[0],h=e[1],m=e[2],f=e[3],p=t[0],g=t[1],c=n[0],l=n[1],d=(l-g)/(c-p);let a,r;!!(i&A.ABOVE)&&!(o&A.ABOVE)&&(a=c-(l-f)/d,s=a>=u&&a<=m),!s&&!!(i&A.RIGHT)&&!(o&A.RIGHT)&&(r=l-(c-m)*d,s=r>=h&&r<=f),!s&&!!(i&A.BELOW)&&!(o&A.BELOW)&&(a=c-(l-h)/d,s=a>=u&&a<=m),!s&&!!(i&A.LEFT)&&!(o&A.LEFT)&&(r=l-(c-u)*d,s=r>=h&&r<=f)}return s}function c8(e,t,n,s){if(pn(e))return on(n);let o=[];if(s>1){const t=e[2]-e[0],n=e[3]-e[1];for(let i=0;i<s;++i)o.push(e[0]+t*i/s,e[1],e[2],e[1]+n*i/s,e[2]-t*i/s,e[3],e[0],e[3]-n*i/s)}else o=[e[0],e[1],e[2],e[1],e[2],e[3],e[0],e[3]];t(o,o,2);const i=[],a=[];for(let e=0,t=o.length;e<t;e+=2)i.push(o[e]),a.push(o[e+1]);return A8(i,a,n)}function r8(e,t){const n=t.getExtent(),s=Ot(e);if(t.canWrapX()&&(s[0]<n[0]||s[0]>=n[2])){const t=p(n),i=Math.floor((s[0]-n[0])/t),o=i*t;e[0]-=o,e[2]-=o}return e}function a8(e,t,n){if(t.canWrapX()){const s=t.getExtent();if(!isFinite(e[0])||!isFinite(e[2]))return[[s[0],e[1],s[2],e[3]]];r8(e,t);const o=p(s);if(p(e)>o&&!n)return[[s[0],e[1],s[2],e[3]]];if(e[0]<s[0])return[[e[0]+o,e[1],s[2],e[3]],[s[0],e[1],e[2],e[3]]];if(e[2]>s[2])return[[e[0],e[1],s[2],e[3]],[s[0],e[1],e[2]-o,e[3]]]}return[e]}b=e({"node_modules/ol/extent.js"(){Nl()}});function i8(e){let t=e.getComplianceLevelSupportedFeatures();return t===0[0]&&(t=$e[O.VERSION1].level0),{url:e.imageInfo["@id"]===0[0]?0[0]:e.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),supports:t.supports,formats:[...t.formats,e.imageInfo.formats===0[0]?[]:e.imageInfo.formats],qualities:[...t.qualities,e.imageInfo.qualities===0[0]?[]:e.imageInfo.qualities],resolutions:e.imageInfo.scale_factors,tileSize:e.imageInfo.tile_width!==0[0]?e.imageInfo.tile_height!==0[0]?[e.imageInfo.tile_width,e.imageInfo.tile_height]:[e.imageInfo.tile_width,e.imageInfo.tile_width]:e.imageInfo.tile_height!=0[0]?[e.imageInfo.tile_height,e.imageInfo.tile_height]:0[0]}}function n8(e){const t=e.getComplianceLevelSupportedFeatures(),n=Array.isArray(e.imageInfo.profile)&&e.imageInfo.profile.length>1,s=n&&e.imageInfo.profile[1].supports?e.imageInfo.profile[1].supports:[],o=n&&e.imageInfo.profile[1].formats?e.imageInfo.profile[1].formats:[],i=n&&e.imageInfo.profile[1].qualities?e.imageInfo.profile[1].qualities:[];return{url:e.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),sizes:e.imageInfo.sizes===0[0]?0[0]:e.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:e.imageInfo.tiles===0[0]?0[0]:[e.imageInfo.tiles.map(function(e){return e.width})[0],e.imageInfo.tiles.map(function(e){return e.height===0[0]?e.width:e.height})[0]],resolutions:e.imageInfo.tiles===0[0]?0[0]:e.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:[...t.supports,...s],formats:[...t.formats,...o],qualities:[...t.qualities,...i]}}function t8(e){const t=e.getComplianceLevelSupportedFeatures(),n=e.imageInfo.extraFormats===0[0]?t.formats:[...t.formats,...e.imageInfo.extraFormats],s=e.imageInfo.preferredFormats!==0[0]&&Array.isArray(e.imageInfo.preferredFormats)&&e.imageInfo.preferredFormats.length>0?e.imageInfo.preferredFormats.filter(function(e){return["jpg","png","gif"].includes(e)}).reduce(function(e,t){return e===0[0]&&n.includes(t)?t:e},0[0]):0[0];return{url:e.imageInfo.id,sizes:e.imageInfo.sizes===0[0]?0[0]:e.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:e.imageInfo.tiles===0[0]?0[0]:[e.imageInfo.tiles.map(function(e){return e.width})[0],e.imageInfo.tiles.map(function(e){return e.height})[0]],resolutions:e.imageInfo.tiles===0[0]?0[0]:e.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:e.imageInfo.extraFeatures===0[0]?t.supports:[...t.supports,...e.imageInfo.extraFeatures],formats:n,qualities:e.imageInfo.extraQualities===0[0]?t.qualities:[...t.qualities,...e.imageInfo.extraQualities],preferredFormat:s}}na=e({"node_modules/ol/format/IIIFInfo.js"(){B(),O={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"},$e={},$e[O.VERSION1]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},$e[O.VERSION2]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},$e[O.VERSION3]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},$e.none={none:{supports:[],formats:[],qualities:[]}},xd=/^https?:\/\/library\.stanford\.edu\/iiif\/image-api\/(?:1\.1\/)?compliance\.html#level[0-2]$/,va=/^https?:\/\/iiif\.io\/api\/image\/2\/level[0-2](?:\.json)?$/,Cd=/(^https?:\/\/iiif\.io\/api\/image\/3\/level[0-2](?:\.json)?$)|(^level[0-2]$)/,yn={},yn[O.VERSION1]=i8,yn[O.VERSION2]=n8,yn[O.VERSION3]=t8,Ed=class{constructor(e){this.setImageInfo(e)}setImageInfo(e){typeof e=="string"?this.imageInfo=JSON.parse(e):this.imageInfo=e}getImageApiVersion(){if(this.imageInfo===0[0])return 0[0];let e=this.imageInfo["@context"]||"ol-no-context";typeof e=="string"&&(e=[e]);for(let t=0;t<e.length;t++)switch(e[t]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return O.VERSION1;case"http://iiif.io/api/image/2/context.json":return O.VERSION2;case"http://iiif.io/api/image/3/context.json":return O.VERSION3;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(O.VERSION1)&&this.imageInfo.identifier)return O.VERSION1;break;default:}f(!1,"Cannot determine IIIF Image API version from provided image information JSON")}getComplianceLevelEntryFromProfile(e){if(this.imageInfo===0[0]||this.imageInfo.profile===0[0])return 0[0];switch(e===0[0]&&(e=this.getImageApiVersion()),e){case O.VERSION1:if(xd.test(this.imageInfo.profile))return this.imageInfo.profile;break;case O.VERSION3:if(Cd.test(this.imageInfo.profile))return this.imageInfo.profile;break;case O.VERSION2:if(typeof this.imageInfo.profile=="string"&&va.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&this.imageInfo.profile.length>0&&typeof this.imageInfo.profile[0]=="string"&&va.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0];break;default:}}getComplianceLevelFromProfile(e){const t=this.getComplianceLevelEntryFromProfile(e);if(t===0[0])return 0[0];const n=t.match(/level[0-2](?:\.json)?$/g);return Array.isArray(n)?n[0].replace(".json",""):0[0]}getComplianceLevelSupportedFeatures(){if(this.imageInfo===0[0])return 0[0];const e=this.getImageApiVersion(),t=this.getComplianceLevelFromProfile(e);return t===0[0]?$e.none.none:$e[e][t]}getTileSourceOptions(e){const n=e||{},s=this.getImageApiVersion();if(s===0[0])return 0[0];const t=s===0[0]?0[0]:yn[s](this);return t===0[0]?0[0]:{url:t.url,version:s,size:[this.imageInfo.width,this.imageInfo.height],sizes:t.sizes,format:n.format!==0[0]&&t.formats.includes(n.format)?n.format:t.preferredFormat!==0[0]?t.preferredFormat:"jpg",supports:t.supports,quality:n.quality&&t.qualities.includes(n.quality)?n.quality:t.qualities.includes("native")?"native":"default",resolutions:Array.isArray(t.resolutions)?t.resolutions.sort(function(e,t){return t-e}):0[0],tileSize:t.tileSize}}},sa=Ed}});function Dd(e){return e[0]>0&&e[1]>0}function Um(e,t,n){return n===0[0]&&(n=[0,0]),n[0]=e[0]*t+.5|0,n[1]=e[1]*t+.5|0,n}function P(e,t){return Array.isArray(e)?e:(t===0[0]?t=[e,e]:(t[0]=e,t[1]=e),t)}ae=e({"node_modules/ol/size.js"(){}});function Lt(e,t,n,s,o){return o!==0[0]?(o.minX=e,o.maxX=t,o.minY=n,o.maxY=s,o):new Yi(e,t,n,s)}wi=e({"node_modules/ol/TileRange.js"(){Yi=class{constructor(e,t,n,s){this.minX=e,this.maxX=t,this.minY=n,this.maxY=s}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}},$i=Yi}});function go(e,t){return e>t?1:e<t?-1:0}function yi(e,t,n){if(e[0]<=t)return 0;const s=e.length;if(t<=e[s-1])return s-1;if(typeof n=="function"){for(let o=1;o<s;++o){const i=e[o];if(i===t)return o;if(i<t)return n(t,e[o-1],i)>0?o-1:o}return s-1}if(n>0){for(let n=1;n<s;++n)if(e[n]<t)return n-1;return s-1}if(n<0){for(let n=1;n<s;++n)if(e[n]<=t)return n;return s-1}for(let n=1;n<s;++n){if(e[n]==t)return n;if(e[n]<t)return e[n-1]-t<t-e[n]?n-1:n}return s-1}function Bm(e,t){const n=Array.isArray(t)?t:[t],s=n.length;for(let t=0;t<s;t++)e[e.length]=n[t]}function vo(e,t){const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function Rm(e,t,n){const s=t||go;return e.every(function(t,o){if(o===0)return!0;const i=s(e[o-1],t);return!(i>0||n&&i===0)})}ee=e({"node_modules/ol/array.js"(){}});function Lm(e,t,n,s,o){const i=md(o,function(o){return!ct(e,t,n,s,o[0],o[1])});return!i}function ct(e,t,n,s,o,i){let c=0,r=e[n-s],a=e[n-s+1];for(;t<n;t+=s){const d=e[t],l=e[t+1];a<=i?l>i&&(d-r)*(i-a)-(o-r)*(l-a)>0&&c++:l<=i&&(d-r)*(i-a)-(o-r)*(l-a)<0&&c--,r=d,a=l}return c!==0}function ou(e,t,n,s,o,i){if(n.length===0)return!1;if(!ct(e,t,n[0],s,o,i))return!1;for(let t=1,a=n.length;t<a;++t)if(ct(e,n[t-1],n[t],s,o,i))return!1;return!0}Eo=e({"node_modules/ol/geom/flat/contains.js"(){b()}});function Fm(e,t,n,s,o){let i;for(t+=s;t<n;t+=s)if(i=o(e.slice(t-s,t),e.slice(t,t+s)),i)return i;return!1}au=e({"node_modules/ol/geom/flat/segments.js"(){}});function cu(e,t,n,s,o,i){return i=i??id(lt(),e,t,n,s),!!fn(o,i)&&(i[0]>=o[0]&&i[2]<=o[2]||i[1]>=o[1]&&i[3]<=o[3]||Fm(e,t,n,s,function(e,t){return l8(o,e,t)}))}function mu(e,t,n,s,o){return!!cu(e,t,n,s,o)||!!ct(e,t,n,s,o[0],o[1])||!!ct(e,t,n,s,o[0],o[3])||!!ct(e,t,n,s,o[2],o[1])||!!ct(e,t,n,s,o[2],o[3])}function km(e,t,n,s,o){if(!mu(e,t,n[0],s,o))return!1;if(n.length===1)return!0;for(let t=1,i=n.length;t<i;++t)if(Lm(e,n[t-1],n[t],s,o)&&!cu(e,n[t-1],n[t],s,o))return!1;return!0}Io=e({"node_modules/ol/geom/flat/intersectsextent.js"(){b(),Eo(),au()}});function w(e,t,n){return Math.min(Math.max(e,t),n)}function Om(e,t,n,s,o,i){const a=o-n,r=i-s;if(a!==0||r!==0){const c=((e-n)*a+(t-s)*r)/(a*a+r*r);c>1?(n=o,s=i):c>0&&(n+=a*c,s+=r*c)}return Ut(e,t,n,s)}function Ut(e,t,n,s){const o=n-e,i=s-t;return o*o+i*i}function bm(e){const t=e.length;for(let n=0;n<t;n++){let s=n,o=Math.abs(e[n][n]);for(let i=n+1;i<t;i++){const a=Math.abs(e[i][n]);a>o&&(o=a,s=i)}if(o===0)return null;const i=e[s];e[s]=e[n],e[n]=i;for(let s=n+1;s<t;s++){const o=-e[s][n]/e[n][n];for(let i=n;i<t+1;i++)n==i?e[s][i]=0:e[s][i]+=o*e[n][i]}}const n=new Array(t);for(let s=t-1;s>=0;s--){n[s]=e[s][t]/e[s][s];for(let o=s-1;o>=0;o--)e[o][t]-=e[o][s]*n[s]}return n}function Du(e){return e*180/Math.PI}function Pe(e){return e*Math.PI/180}function Wt(e,t){const n=e%t;return n*t<0?n+t:n}function dm(e,t,n){return e+n*(t-e)}function _i(e,t){const n=10**t;return Math.round(e*n)/n}function po(e,t){return Math.floor(_i(e,t))}function fo(e,t){return Math.ceil(_i(e,t))}function xi(e,t,n){if(e>=t&&e<n)return e;const s=n-t;return((e-t)%s+s)%s+t}M=e({"node_modules/ol/math.js"(){}});function lo(e,t,n,s){return s!==0[0]?(s[0]=e,s[1]=t,s[2]=n,s):[e,t,n]}function lm(e,t,n){return e+"/"+t+"/"+n}function cm(e){return rm(e[0],e[1],e[2])}function rm(e,t,n){return(t<<e)+n}function am(e,t){const n=e[0],o=e[1],i=e[2];if(t.getMinZoom()>n||n>t.getMaxZoom())return!1;const s=t.getFullTileRange(n);return!s||s.containsXY(o,i)}Vn=e({"node_modules/ol/tilecoord.js"(){}}),Un=e({"node_modules/ol/tilegrid/common.js"(){Lu=42,At=256}}),ar=e({"node_modules/ol/tilegrid/TileGrid.js"(){wi(),ee(),B(),b(),Io(),M(),ae(),Vn(),Un(),tt=[0,0,0],Ee=5,Yu=class{constructor(e){this.minZoom=e.minZoom!==0[0]?e.minZoom:0,this.resolutions_=e.resolutions,f(Rm(this.resolutions_,(e,t)=>t-e,!0),"`resolutions` must be sorted in descending order");let n;if(!e.origins)for(let e=0,t=this.resolutions_.length-1;e<t;++e)if(n){if(this.resolutions_[e]/this.resolutions_[e+1]!==n){n=0[0];break}}else n=this.resolutions_[e]/this.resolutions_[e+1];this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==0[0]?e.origin:null,this.origins_=null,e.origins!==0[0]&&(this.origins_=e.origins,f(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const t=e.extent;t!==0[0]&&!this.origin_&&!this.origins_&&(this.origin_=Se(t)),f(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==0[0]&&(this.tileSizes_=e.tileSizes,f(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==0[0]?e.tileSize:this.tileSizes_?null:At,f(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=t!==0[0]?t:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==0[0]?this.fullTileRanges_=e.sizes.map((e,n)=>{const s=new $i(Math.min(0,e[0]),Math.max(e[0]-1,-1),Math.min(0,e[1]),Math.max(e[1]-1,-1));if(t){const e=this.getTileRangeForExtentAndZ(t,n);s.minX=Math.max(e.minX,s.minX),s.maxX=Math.min(e.maxX,s.maxX),s.minY=Math.max(e.minY,s.minY),s.maxY=Math.min(e.maxY,s.maxY)}return s}):t&&this.calculateTileRanges_(t)}forEachTileCoord(e,t,n){const s=this.getTileRangeForExtentAndZ(e,t);for(let e=s.minX,o=s.maxX;e<=o;++e)for(let o=s.minY,i=s.maxY;o<=i;++o)n([t,e,o])}forEachTileCoordParentTileRange(e,t,n,s){let r,o,i,c=null,a=e[0]-1;for(this.zoomFactor_===2?(o=e[1],i=e[2]):c=this.getTileCoordExtent(e,s);a>=this.minZoom;){if(o!==0[0]&&i!==0[0]?(o=Math.floor(o/2),i=Math.floor(i/2),r=Lt(o,o,i,i,n)):r=this.getTileRangeForExtentAndZ(c,a,n),t(a,r))return!0;--a}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const n=e[1]*2,s=e[2]*2;return Lt(n,n+1,s,s+1,t)}const s=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;const i=e[0],s=e[1],o=e[2];if(t===i)return Lt(s,o,s,o,n);if(this.zoomFactor_){const e=this.zoomFactor_**(t-i),a=Math.floor(s*e),r=Math.floor(o*e);if(t<i)return Lt(a,a,r,r,n);const c=Math.floor(e*(s+1))-1,l=Math.floor(e*(o+1))-1;return Lt(a,c,r,l,n)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,n)}getTileRangeForExtentAndZ(e,t,n){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,tt);const s=tt[1],o=tt[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,tt);const i=tt[1],a=tt[2];return Lt(s,i,o,a,n)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),n=this.getResolution(e[0]),s=P(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*s[0]*n,t[1]-(e[2]+.5)*s[1]*n]}getTileCoordExtent(e,t){const o=this.getOrigin(e[0]),n=this.getResolution(e[0]),s=P(this.getTileSize(e[0]),this.tmpSize_),i=o[0]+e[1]*s[0]*n,a=o[1]-(e[2]+1)*s[1]*n,r=i+s[0]*n,c=a+s[1]*n;return wt(i,a,r,c,t)}getTileCoordForCoordAndResolution(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)}getTileCoordForXYAndResolution_(e,t,n,s,o){const r=this.getZForResolution(n),c=n/this.getResolution(r),l=this.getOrigin(r),d=P(this.getTileSize(r),this.tmpSize_);let i=c*(e-l[0])/n/d[0],a=c*(l[1]-t)/n/d[1];return s?(i=fo(i,Ee)-1,a=fo(a,Ee)-1):(i=po(i,Ee),a=po(a,Ee)),lo(r,i,a,o)}getTileCoordForXYAndZ_(e,t,n,s,o){const r=this.getOrigin(n),c=this.getResolution(n),l=P(this.getTileSize(n),this.tmpSize_);let i=(e-r[0])/c/l[0],a=(r[1]-t)/c/l[1];return s?(i=fo(i,Ee)-1,a=fo(a,Ee)-1):(i=po(i,Ee),a=po(a,Ee)),lo(n,i,a,o)}getTileCoordForCoordAndZ(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const n=yi(this.resolutions_,e,t||0);return w(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return mu(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,n=new Array(t);for(let s=this.minZoom;s<t;++s)n[s]=this.getTileRangeForExtentAndZ(e,s);this.fullTileRanges_=n}},Va=Yu}}),Re=e({"node_modules/ol/ImageState.js"(){l={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}}}),y=e({"node_modules/ol/events/EventType.js"(){a={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"}}}),Xn=e({"node_modules/ol/Disposable.js"(){D1=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}},Gn=D1}});function As(){return!0}function ks(){return!1}function Es(){}function r3(e){let n,t,s;return function(){const o=Array.prototype.slice.call(arguments);return(!t||this!==s||!vo(o,t))&&(s=this,t=o,n=e.apply(this,arguments)),n}}function Zh(e){function t(){let t;try{t=e()}catch(e){return Promise.reject(e)}return t instanceof Promise?t:Promise.resolve(t)}return t()}K=e({"node_modules/ol/functions.js"(){ee()}});function vs(e){for(const t in e)delete e[t]}function N1(e){let t;for(t in e)return!1;return!t}dt=e({"node_modules/ol/obj.js"(){}}),Ce=e({"node_modules/ol/events/Event.js"(){V1=class{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},Oe=V1}}),Zn=e({"node_modules/ol/events/Target.js"(){Xn(),K(),dt(),Ce(),$1=class extends Gn{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const n=this.listeners_||(this.listeners_={}),s=n[e]||(n[e]=[]);s.includes(t)||s.push(t)}dispatchEvent(e){const r=typeof e=="string",t=r?e:e.type,n=this.listeners_&&this.listeners_[t];if(!n)return;const s=r?new Oe(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});t in o||(o[t]=0,a[t]=0),++o[t];let i;for(let e=0,t=n.length;e<t;++e)if("handleEvent"in n[e]?i=n[e].handleEvent(s):i=n[e].call(this,s),i===!1||s.propagationStopped){i=!1;break}if(--o[t]===0){let e=a[t];for(delete a[t];e--;)this.removeEventListener(t,Es);delete o[t]}return i}disposeInternal(){this.listeners_&&vs(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||0[0]}hasListener(e){return!!this.listeners_&&(e?e in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(e,t){if(!this.listeners_)return;const n=this.listeners_[e];if(!n)return;const s=n.indexOf(t);s!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(n[s]=Es,++this.pendingRemovals_[e]):(n.splice(s,1),n.length===0&&delete this.listeners_[e]))}},ss=$1}});function h(e,t,n,s,o){if(o){const o=n;n=function(i){return e.removeEventListener(t,n),o.call(s??this,i)}}else s&&s!==e&&(n=n.bind(s));const i={target:e,type:t,listener:n};return e.addEventListener(t,n),i}function js(e,t,n,s){return h(e,t,n,s,!0)}function _(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),vs(e))}ie=e({"node_modules/ol/events.js"(){dt()}}),Bt=e({"node_modules/ol/has.js"(){Ke=typeof navigator!="undefined"&&typeof navigator.userAgent!="undefined"?navigator.userAgent.toLowerCase():"",W1=Ke.includes("safari")&&!Ke.includes("chrom"),Uh=W1&&(Ke.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Ke)),Y1=Ke.includes("webkit")&&!Ke.includes("edge"),Da=Ke.includes("macintosh"),Z1=typeof devicePixelRatio!="undefined"?devicePixelRatio:1,t4=typeof WorkerGlobalScope!="undefined"&&typeof OffscreenCanvas!="undefined"&&self instanceof WorkerGlobalScope,ui=typeof Image!="undefined"&&Image.prototype.decode,mi=function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return e}()}});function Rh(e,t,n){const s=e;let o=!0,i=!1,r=!1;const c=[js(s,a.LOAD,function(){r=!0,i||t()})];return s.src&&ui?(i=!0,s.decode().then(function(){o&&t()}).catch(function(){o&&(r?t():n())})):c.push(js(s,a.ERROR,n)),function(){o=!1,c.forEach(_)}}function Lh(e,t){return new Promise((n,s)=>{function o(){a(),n(e)}function i(){a(),s(new Error("Image load error"))}function a(){e.removeEventListener("load",o),e.removeEventListener("error",i)}e.addEventListener("load",o),e.addEventListener("error",i),t&&(e.src=t)})}function Dh(e,t){return t&&(e.src=t),e.src&&ui?new Promise((t,n)=>e.decode().then(()=>t(e)).catch(s=>e.complete&&e.width?t(e):n(s))):Lh(e)}Gr=e({"node_modules/ol/Image.js"(){y(),ie(),Bt()}}),pe=e({"node_modules/ol/TileState.js"(){s={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}}});function g4(e){return e**3}function Gt(e){return 1-g4(1-e)}function Jh(e){return 3*e*e-2*e*e*e}function Ah(e){return e}Me=e({"node_modules/ol/easing.js"(){}});function d(){throw new Error("Unimplemented abstract method.")}function z(e){return e.ol_uid||(e.ol_uid=String(++x4))}F=e({"node_modules/ol/util.js"(){x4=0}}),Ms=e({"node_modules/ol/Tile.js"(){pe(),Me(),y(),Zn(),F(),N4=class extends ss{constructor(e,t,n){super(),n=n||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=n.transition===0[0]?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(a.CHANGE)}release(){this.setState(s.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state===s.EMPTY)return;if(this.state!==s.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}load(){d()}getAlpha(e,t){if(!this.transition_)return 1;let n=this.transitionStarts_[e];if(n){if(n===-1)return 1}else n=t,this.transitionStarts_[e]=n;const s=t-n+1e3/60;return s>=this.transition_?1:g4(s/this.transition_)}inTransition(e){return!!this.transition_&&this.transitionStarts_[e]!==-1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}},Ss=N4}});function L(e,t,n,s){let o;return n&&n.length?o=n.shift():t4?o=new OffscreenCanvas(e||300,t||300):o=document.createElement("canvas"),e&&(o.width=e),t&&(o.height=t),o.getContext("2d",s)}function Fs(){return Ga||(Ga=L(1,1)),Ga}function Or(e){const t=e.canvas;t.width=1,t.height=1,e.clearRect(0,0,1,1)}function Ts(e,t){const n=t.parentNode;n&&n.replaceChild(e,t)}function yh(e){for(;e.lastChild;)e.lastChild.remove()}function vh(e,t){const n=e.childNodes;for(let i=0;!0;++i){const s=n[i],o=t[i];if(!s&&!o)break;if(s===o)continue;if(!s){e.appendChild(o);continue}if(!o){e.removeChild(s),--i;continue}e.insertBefore(o,s)}}I=e({"node_modules/ol/dom.js"(){Bt()}});function gh(){const e=L(1,1);return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),e.canvas}eo=e({"node_modules/ol/ImageTile.js"(){Gr(),Ms(),pe(),I(),u0=class extends Ss{constructor(e,t,n,s,o,i){super(e,t,i),this.crossOrigin_=s,this.src_=n,this.key=n,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=o}getImage(){return this.image_}setImage(e){this.image_=e,this.state=s.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=s.ERROR,this.unlistenImage_(),this.image_=gh(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=s.LOADED:this.state=s.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==s.ERROR&&(this.state=s.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==s.IDLE&&(this.state=s.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Rh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}},Js=u0}});function w0(...e){if(O0>ua.warn)return;console.warn(...e)}Gi=e({"node_modules/ol/console.js"(){ua={info:1,warn:2,error:3,none:4},O0=ua.info}});function hh(e,t){return e[0]+=+t[0],e[1]+=+t[1],e}function io(e,t){let n=!0;for(let s=e.length-1;s>=0;--s)if(e[s]!=t[s]){n=!1;break}return n}function ki(e,t){const n=Math.cos(t),s=Math.sin(t),o=e[0]*n-e[1]*s,i=e[1]*n+e[0]*s;return e[0]=o,e[1]=i,e}function rh(e,t){return e[0]*=t,e[1]*=t,e}function ah(e,t){if(t.canWrapX()){const n=p(t.getExtent()),s=ih(e,t,n);s&&(e[0]-=s*n)}return e}function ih(e,t,n){const s=t.getExtent();let o=0;return t.canWrapX()&&(e[0]<s[0]||e[0]>s[2])&&(n=n||p(s),o=Math.floor((e[0]-s[0])/n)),o}It=e({"node_modules/ol/coordinate.js"(){b()}}),ai=e({"node_modules/ol/proj/Units.js"(){Ht={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937}}}),Co=e({"node_modules/ol/proj/Projection.js"(){ai(),J0=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==0[0]?e.extent:null,this.worldExtent_=e.worldExtent!==0[0]?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==0[0]?e.axisOrientation:"enu",this.global_=e.global!==0[0]&&e.global,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ht[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}},Oo=J0}});function nh(e,t,n,s){const o=e.length;n=n>1?n:2,s=s??n,t===0[0]&&(n>2?t=e.slice():t=new Array(o));for(let n=0;n<o;n+=s){t[n]=Je*e[n]/180;let i=Pt*Math.log(Math.tan(Math.PI*(+e[n+1]+90)/360));i>Bn?i=Bn:i<-Bn&&(i=-Bn),t[n+1]=i}return t}function th(e,t,n,s){const o=e.length;n=n>1?n:2,s=s??n,t===0[0]&&(n>2?t=e.slice():t=new Array(o));for(let n=0;n<o;n+=s)t[n]=180*e[n]/Je,t[n+1]=360*Math.atan(Math.exp(e[n+1]/Pt))/Math.PI-90;return t}d2=e({"node_modules/ol/proj/epsg3857.js"(){Co(),Pt=6378137,Je=Math.PI*Pt,s2=[-Je,-Je,Je,Je],a2=[-180,-85,180,85],Bn=Pt*Math.log(Math.tan(Math.PI/2)),Qe=class extends Oo{constructor(e){super({code:e,units:"m",extent:s2,global:!0,worldExtent:a2,getPointResolution:function(e,t){return e/Math.cosh(t[1]/Pt)}})}},Ra=[new Qe("EPSG:3857"),new Qe("EPSG:102100"),new Qe("EPSG:102113"),new Qe("EPSG:900913"),new Qe("http://www.opengis.net/def/crs/EPSG/0/3857"),new Qe("http://www.opengis.net/gml/srs/epsg.xml#3857")]}}),f2=e({"node_modules/ol/proj/epsg4326.js"(){Co(),u2=6378137,Ja=[-180,-90,180,90],m2=Math.PI*u2/180,Ue=class extends Oo{constructor(e,t){super({code:e,units:"degrees",extent:Ja,axisOrientation:t,global:!0,metersPerUnit:m2,worldExtent:Ja})}},zr=[new Ue("CRS:84"),new Ue("EPSG:4326","neu"),new Ue("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ue("urn:ogc:def:crs:OGC:2:84"),new Ue("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ue("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ue("http://www.opengis.net/def/crs/EPSG/0/4326","neu")]}});function U3(e){return gs[e]||gs[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function I3(e,t){gs[e]=t}w2=e({"node_modules/ol/proj/projections.js"(){gs={}}});function ts(e,t,n){const s=e.getCode(),o=t.getCode();s in it||(it[s]={}),it[s][o]=n}function tc(e,t){return e in it&&t in it[e]?it[e][t]:null}x2=e({"node_modules/ol/proj/transforms.js"(){it={}}});function R3(e,t,n){const _=e-5e5,k=n.north?t:t-1e7,y=k/is,a=y/(Yn*Rr),c=a+P2*Math.sin(2*a)+B2*Math.sin(4*a)+V2*Math.sin(6*a)+q2*Math.sin(8*a),l=Math.sin(c),f=l*l,u=Math.cos(c),h=l/u,i=h*h,b=i*i,w=1-Y*f,x=(1-Y*f)**.5,O=Yn/x,j=(1-Y)/w,o=De*u**2,d=o*o,s=_/(O*is),m=s*s,v=m*s,g=v*s,p=g*s,C=p*s,E=c-h/j*(m/2-g/24*(5+3*i+10*o-4*d-9*De))+C/720*(61+90*i+298*o+45*b-252*De-3*d);let r=(s-v/6*(1+2*i+o)+p/120*(5-2*o+28*i-3*d+8*De+24*b))/u;return r=xi(r+Pe(E2(n.number)),-Math.PI,Math.PI),[Du(r),Du(E)]}function L3(e,t,n){e=xi(e,G2,Q2),t<yr?t=yr:t>br&&(t=br);const i=Pe(t),f=Math.sin(i),r=Math.cos(i),c=f/r,o=c*c,l=o*o,v=Pe(e),b=E2(n.number),w=Pe(b),h=Yn/(1-Y*f**2)**.5,a=De*r**2,s=r*xi(v-w,-Math.PI,Math.PI),p=s*s,g=p*s,d=g*s,m=d*s,j=m*s,y=Yn*(Rr*i-T2*Math.sin(2*i)+z2*Math.sin(4*i)-D2*Math.sin(6*i)),_=is*h*(s+g/6*(1-o+a)+m/120*(5-18*o+l+72*a-58*De))+5e5;let u=is*(y+h*c*(p/2+d/24*(5-o+9*a+4*a**2)+j/720*(61-58*o+l+600*a-330*De)));return n.north||(u+=1e7),[_,u]}function E2(e){return(e-1)*6-180+3}function A2(e){let t=0;for(const s of t3){const n=e.match(s);if(n){t=parseInt(n[1]);break}}if(!t)return null;let n=0,s=!1;return t>32700&&t<32761?n=t-32700:t>32600&&t<32661&&(s=!0,n=t-32600),n?{number:n,north:s}:null}function S2(e,t){return function(n,s,o,i){const a=n.length;o=o>1?o:2,i=i??o,s||(o>2?s=n.slice():s=new Array(a));for(let o=0;o<a;o+=i){const c=n[o],l=n[o+1],r=e(c,l,t);s[o]=r[0],s[o+1]=r[1]}return s}}function T3(e){const t=A2(e);return t?new Oo({code:e,units:"m"}):null}function M3(e){const t=A2(e.getCode());return t?{forward:S2(L3,t),inverse:S2(R3,t)}:null}n3=e({"node_modules/ol/proj/utm.js"(){M(),Co(),is=.9996,Y=.00669438,es=Y*Y,Jn=es*Y,De=Y/(1-Y),Ur=(1-Y)**.5,nt=(1-Ur)/(1+Ur),Hr=nt*nt,_s=Hr*nt,ws=_s*nt,Pr=ws*nt,Rr=1-Y/4-3*es/64-5*Jn/256,T2=3*Y/8+3*es/32+45*Jn/1024,z2=15*es/256+45*Jn/1024,D2=35*Jn/3072,P2=3/2*nt-27/32*_s+269/512*Pr,B2=21/16*Hr-55/32*ws,V2=151/96*_s-417/128*Pr,q2=1097/512*ws,Yn=6378137,yr=-80,br=84,G2=-180,Q2=180,t3=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/]}});function a3(e,t,n){n=n||i3;const s=Pe(e[1]),o=Pe(t[1]),i=(o-s)/2,a=Pe(t[0]-e[0])/2,r=Math.sin(i)*Math.sin(i)+Math.sin(a)*Math.sin(a)*Math.cos(s)*Math.cos(o);return 2*n*Math.atan2(r**.5,(1-r)**.5)}e3=e({"node_modules/ol/sphere.js"(){M(),i3=6371008.8}});function u3(e){const t=e===0[0]||e;mo=!t}function Ya(e,t){if(t!==0[0]){for(let n=0,s=e.length;n<s;++n)t[n]=e[n];t=t}else t=e.slice();return t}function Wa(e){I3(e.getCode(),e),ts(e,e,Ya)}function _3(e){e.forEach(Wa)}function oe(e){if(typeof e!="string")return e;const t=U3(e);if(t)return t;for(const n of i2){const t=n(e);if(t)return t}return null}function H2(e,t,n,s){e=oe(e);let o;const i=e.getPointResolutionFunc();if(i){if(o=i(t,n),s&&s!==e.getUnits()){const t=e.getMetersPerUnit();t&&(o=o*t/Ht[s])}}else{const i=e.getUnits();if(i=="degrees"&&!s||s=="degrees")o=t;else{const a=ja(e,oe("EPSG:4326"));if(!a&&i!=="degrees")o=t*e.getMetersPerUnit();else{let e=[n[0]-t/2,n[1],n[0]+t/2,n[1],n[0],n[1]-t/2,n[0],n[1]+t/2];e=a(e,e,2);const s=a3(e.slice(0,2),e.slice(2,4)),i=a3(e.slice(4,6),e.slice(6,8));o=(s+i)/2}const r=s?Ht[s]:e.getMetersPerUnit();r!==0[0]&&(o/=r)}}return o}function L2(e){_3(e),e.forEach(function(t){e.forEach(function(e){t!==e&&ts(t,e,Ya)})})}function E3(e,t,n,s){e.forEach(function(e){t.forEach(function(t){ts(e,t,n),ts(t,e,s)})})}function Aa(e,t){return e?typeof e=="string"?oe(e):e:oe(t)}function A3(e){return function(t,n,s,o){const i=t.length;s=s!==0[0]?s:2,o=o??s,n=n!==0[0]?n:new Array(i);for(let a=0;a<i;a+=o){const r=e(t.slice(a,a+s)),c=r.length;for(let e=0,s=o;e<s;++e)n[a+e]=e>=c?t[a+e]:r[e]}return n}}function Oa(e,t){if(e===t)return!0;const n=e.getUnits()===t.getUnits();if(e.getCode()===t.getCode())return n;const s=ja(e,t);return s===Ya&&n}function ja(e,t){const i=e.getCode(),a=t.getCode();let n=tc(i,a);if(n)return n;let s=null,o=null;for(const n of l2)s||(s=n(e)),o||(o=n(t));if(!s&&!o)return null;const r="EPSG:4326";if(o)if(s)n=ga(s.inverse,o.forward);else{const e=tc(i,r);e&&(n=ga(e,o.forward))}else{const e=tc(r,a);e&&(n=ga(s.inverse,e))}return n&&(Wa(e),Wa(t),ts(e,t,n)),n}function ga(e,t){return function(n,s,o,i){return s=e(n,s,o,i),t(s,s,o,i)}}function Hn(e,t){const n=oe(e),s=oe(t);return ja(n,s)}function no(e,t,n){const s=Hn(t,n);if(!s){const e=oe(t).getCode(),s=oe(n).getCode();throw new Error(`No transform available between ${e} and ${s}`)}return s(e,0[0],e.length)}function k2(e,t,n,s){const o=Hn(t,n);return c8(e,o,0[0],s)}function P3(){return me}function Hi(e,t){return me?no(e,t,me):e}function ge(e,t){return me?no(e,me,t):(mo&&!io(e,[0,0])&&e[0]>=-180&&e[0]<=180&&e[1]>=-90&&e[1]<=90&&(mo=!1,w0("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),e)}function X3(e,t){return me?k2(e,t,me):e}function qe(e,t){return me?k2(e,me,t):e}function Q3(){L2(Ra),L2(zr),E3(zr,Ra,nh,th)}re=e({"node_modules/ol/proj.js"(){Gi(),It(),b(),ai(),d2(),f2(),w2(),x2(),n3(),e3(),l2=[M3],i2=[T3],mo=!0,me=null,Q3()}});function o2(e,t,n,s,o){e.beginPath(),e.moveTo(0,0),e.lineTo(t,n),e.lineTo(s,o),e.closePath(),e.save(),e.clip(),e.fillRect(0,0,Math.max(t,s)+1,Math.max(n,o)),e.restore()}function bi(e,t){return Math.abs(e[t*4]-210)>2||Math.abs(e[t*4+3]-.75*255)>2}function J3(){if(ri===0[0]){const e=L(6,6,mt);e.globalCompositeOperation="lighter",e.fillStyle="rgba(210, 0, 0, 0.75)",o2(e,4,5,4,0),o2(e,4,5,0,5);const t=e.getImageData(0,0,3,3).data;ri=bi(t,0)||bi(t,4)||bi(t,8),Or(e),mt.push(e.canvas)}return ri}function n2(e,t,n,s){const i=no(n,t,e);let o=H2(t,s,n);const a=t.getMetersPerUnit();a!==0[0]&&(o*=a);const r=e.getMetersPerUnit();r!==0[0]&&(o/=r);const c=e.getExtent();if(!c||qr(c,i)){const t=H2(e,o,i)/o;isFinite(t)&&t>0&&(o/=t)}return o}function eh(e,t,n,s){const i=Ot(n);let o=n2(e,t,i,s);return(!isFinite(o)||o<=0)&&md(n,function(n){return o=n2(e,t,n,s),isFinite(o)&&o>0}),o}function oh(e,t,n,s,o,i,a,r,c,l,d,u,h,m){const f=L(Math.round(n*e),Math.round(n*t),mt);if(u||(f.imageSmoothingEnabled=!1),c.length===0)return f.canvas;f.scale(n,n);function y(e){return Math.round(e*n)/n}f.globalCompositeOperation="lighter";const j=lt();c.forEach(function(e){y8(j,e.extent)});let v;const g=n/s,_=(u?1:1+2**-24)/g;if(!h||c.length!==1||l!==0){if(v=L(Math.round(p(j)*g),Math.round(J(j)*g),mt),u||(v.imageSmoothingEnabled=!1),o&&m){const e=(o[0]-j[0])*g,t=-(o[3]-j[3])*g,n=p(o)*g,s=J(o)*g;v.rect(e,t,n,s),v.clip()}c.forEach(function(e){if(e.image.width>0&&e.image.height>0){if(e.clipExtent){v.save();const t=(e.clipExtent[0]-j[0])*g,n=-(e.clipExtent[3]-j[3])*g,s=p(e.clipExtent)*g,o=J(e.clipExtent)*g;v.rect(u?t:Math.round(t),u?n:Math.round(n),u?s:Math.round(t+s)-Math.round(t),u?o:Math.round(n+o)-Math.round(n)),v.clip()}const t=(e.extent[0]-j[0])*g,n=-(e.extent[3]-j[3])*g,s=p(e.extent)*g,o=J(e.extent)*g;v.drawImage(e.image,l,l,e.image.width-2*l,e.image.height-2*l,u?t:Math.round(t),u?n:Math.round(n),u?s:Math.round(t+s)-Math.round(t),u?o:Math.round(n+o)-Math.round(n)),e.clipExtent&&v.restore()}})}const b=Se(a);return r.getTriangles().forEach(function(e){const o=e.source,s=e.target;let M=o[0][0],S=o[0][1],g=o[1][0],x=o[1][1],O=o[2][0],w=o[2][1];const l=y((s[0][0]-b[0])/i),m=y(-(s[0][1]-b[1])/i),r=y((s[1][0]-b[0])/i),a=y(-(s[1][1]-b[1])/i),C=y((s[2][0]-b[0])/i),E=y(-(s[2][1]-b[1])/i),k=M,A=S;M=0,S=0,g-=k,x-=A,O-=k,w-=A;const F=[[g,x,0,0,r-l],[O,w,0,0,C-l],[0,0,g,x,a-m],[0,0,O,w,E-m]],h=bm(F);if(!h)return;if(f.save(),f.beginPath(),J3()||!u){f.moveTo(r,a);const e=4,t=l-r,n=m-a;for(let s=0;s<e;s++)f.lineTo(r+y((s+1)*t/e),a+y(s*n/(e-1))),s!=e-1&&f.lineTo(r+y((s+1)*t/e),a+y((s+1)*n/(e-1)));f.lineTo(C,E)}else f.moveTo(r,a),f.lineTo(l,m),f.lineTo(C,E);f.clip(),f.transform(h[0],h[2],h[1],h[3],l,m),f.translate(j[0]-k,j[3]-A);let d;if(v)d=v.canvas,f.scale(_,-_);else{const e=c[0],t=e.extent;d=e.image,f.scale(p(t)/d.width,-J(t)/d.height)}f.drawImage(d,0,0),f.restore()}),v&&(Or(v),mt.push(v.canvas)),d&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,r.getTriangles().forEach(function(e){const s=e.target,o=(s[0][0]-b[0])/i,a=-(s[0][1]-b[1])/i,r=(s[1][0]-b[0])/i,c=-(s[1][1]-b[1])/i,l=(s[2][0]-b[0])/i,d=-(s[2][1]-b[1])/i;f.beginPath(),f.moveTo(r,c),f.lineTo(o,a),f.lineTo(l,d),f.closePath(),f.stroke()}),f.restore()),f.canvas}G0=e({"node_modules/ol/reproj.js"(){I(),b(),M(),re(),mt=[]}});function Yt(){return[1,0,0,1,0,0]}function q(e,t){const n=t[0],s=t[1];return t[0]=e[0]*n+e[2]*s+e[4],t[1]=e[1]*n+e[3]*s+e[5],t}function Rn(e,t,n,s,o,i,a,r){const c=Math.sin(i),l=Math.cos(i);return e[0]=s*l,e[1]=o*c,e[2]=-s*c,e[3]=o*l,e[4]=a*s*l-r*s*c+t,e[5]=a*o*c+r*o*l+n,e}function Y0(e,t){const n=ch(t);f(n!==0,"Transformation matrix cannot be inverted");const s=t[0],o=t[1],i=t[2],a=t[3],r=t[4],c=t[5];return e[0]=a/n,e[1]=-o/n,e[2]=-i/n,e[3]=s/n,e[4]=(i*c-a*r)/n,e[5]=-(s*c-o*r)/n,e}function ch(e){return e[0]*e[3]-e[1]*e[2]}function lh(e){const t="matrix("+e.join(", ")+")";return t}function W0(e){const t=e.substring(7,e.length-1).split(",");return t.map(parseFloat)}function dh(e,t){const n=W0(e),s=W0(t);for(let e=0;e<6;++e)if(Math.round((n[e]-s[e])*N0[e])!==0)return!1;return!0}ut=e({"node_modules/ol/transform.js"(){B(),uh=new Array(6),N0=[1e5,1e5,1e5,1e5,2,2]}}),F0=e({"node_modules/ol/reproj/Triangulation.js"(){b(),M(),re(),ut(),D0=10,Ro=.25,z0=class{constructor(e,t,n,s,o,i,a){this.sourceProj_=e,this.targetProj_=t;let r={};const h=a?A3(e=>q(a,no(e,this.targetProj_,this.sourceProj_))):Hn(this.targetProj_,this.sourceProj_);this.transformInv_=function(e){const t=e[0]+"/"+e[1];return r[t]||(r[t]=h(e)),r[t]},this.maxSourceExtent_=s,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&p(s)>=p(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?p(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?p(this.targetProj_.getExtent()):null;const c=Se(n),l=Ys(n),d=rs(n),u=Ws(n),m=this.transformInv_(c),f=this.transformInv_(l),g=this.transformInv_(d),v=this.transformInv_(u),b=D0+(i?Math.max(0,Math.ceil(Math.log2(qa(n)/(i*i*256*256)))):0);if(this.addQuad_(c,l,d,u,m,f,g,v,b),this.wrapsXInSource_){let e=1/0;this.triangles_.forEach(function(t){e=Math.min(e,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(t=>{if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-e>this.sourceWorldWidth_/2){const n=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];n[0][0]-e>this.sourceWorldWidth_/2&&(n[0][0]-=this.sourceWorldWidth_),n[1][0]-e>this.sourceWorldWidth_/2&&(n[1][0]-=this.sourceWorldWidth_),n[2][0]-e>this.sourceWorldWidth_/2&&(n[2][0]-=this.sourceWorldWidth_);const s=Math.min(n[0][0],n[1][0],n[2][0]),o=Math.max(n[0][0],n[1][0],n[2][0]);o-s<this.sourceWorldWidth_/2&&(t.source=n)}})}r={}}addTriangle_(e,t,n,s,o,i){this.triangles_.push({source:[s,o,i],target:[e,t,n]})}addQuad_(e,t,n,s,o,i,a,r,c){const u=Wl([o,i,a,r]),h=this.sourceWorldWidth_?p(u)/this.sourceWorldWidth_:null,m=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&h>.5&&h<1;let l=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const o=Wl([e,t,n,s]),i=p(o)/this.targetWorldWidth_;l=i>Ro||l}!f&&this.sourceProj_.isGlobal()&&h&&(l=h>Ro||l)}if(!l&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!fn(u,this.maxSourceExtent_))return;let d=0;if(!l&&(!isFinite(o[0])||!isFinite(o[1])||!isFinite(i[0])||!isFinite(i[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(r[0])||!isFinite(r[1])))if(c>0)l=!0;else if(d=(!isFinite(o[0])||!isFinite(o[1])?8:0)+(!isFinite(i[0])||!isFinite(i[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(r[0])||!isFinite(r[1])?1:0),d!=1&&d!=2&&d!=4&&d!=8)return;if(c>0){if(!l){const r=[(e[0]+n[0])/2,(e[1]+n[1])/2],s=this.transformInv_(r);let t;if(f){const e=(Wt(o[0],m)+Wt(a[0],m))/2;t=e-Wt(s[0],m)}else t=(o[0]+a[0])/2-s[0];const i=(o[1]+a[1])/2-s[1],c=t*t+i*i;l=c>this.errorThresholdSquared_}if(l){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){const l=[(t[0]+n[0])/2,(t[1]+n[1])/2],u=this.transformInv_(l),d=[(s[0]+e[0])/2,(s[1]+e[1])/2],h=this.transformInv_(d);this.addQuad_(e,t,l,d,o,i,u,h,c-1),this.addQuad_(d,l,n,s,h,u,a,r,c-1)}else{const l=[(e[0]+t[0])/2,(e[1]+t[1])/2],u=this.transformInv_(l),d=[(n[0]+s[0])/2,(n[1]+s[1])/2],h=this.transformInv_(d);this.addQuad_(e,l,d,s,o,u,h,r,c-1),this.addQuad_(l,t,n,d,u,i,a,h,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(d&11)==0&&this.addTriangle_(e,n,s,o,a,r),(d&14)==0&&this.addTriangle_(e,n,t,o,a,i),d&&((d&13)==0&&this.addTriangle_(t,s,e,i,r,o),(d&7)==0&&this.addTriangle_(t,s,n,i,r,a))}calculateSourceExtent(){const e=lt();return this.triangles_.forEach(function(t){const o=t.source;Ps(e,o[0]),Ps(e,o[1]),Ps(e,o[2])}),e}getTriangles(){return this.triangles_}},T0=z0}}),C0=e({"node_modules/ol/reproj/common.js"(){M0=.5}}),Uo=e({"node_modules/ol/reproj/Tile.js"(){Ms(),pe(),I(),y(),ie(),b(),M(),G0(),F0(),C0(),x0=class extends Ss{constructor(e,t,n,o,i,a,r,c,l,d,u,h){super(i,s.IDLE,h),this.renderEdges_=u!==0[0]&&u,this.pixelRatio_=r,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=o,this.wrappedTileCoord_=a||i,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():0[0];const j=o.getTileCoordExtent(this.wrappedTileCoord_),y=this.targetTileGrid_.getExtent();let m=this.sourceTileGrid_.getExtent();const b=y?ot(j,y):j;if(qa(b)===0){this.state=s.EMPTY;return}const g=e.getExtent();g&&(m?m=ot(m,g):m=g);const _=o.getResolution(this.wrappedTileCoord_[0]),v=eh(e,n,b,_);if(!isFinite(v)||v<=0){this.state=s.EMPTY;return}const O=d!==0[0]?d:M0;if(this.triangulation_=new T0(e,n,b,m,v*O,_),this.triangulation_.getTriangles().length===0){this.state=s.EMPTY;return}this.sourceZ_=t.getZForResolution(v);let f=this.triangulation_.calculateSourceExtent();if(m&&(e.canWrapX()?(f[1]=w(f[1],m[1],m[3]),f[3]=w(f[3],m[1],m[3])):f=ot(f,m)),qa(f)){let n=0,o=0;e.canWrapX()&&(n=p(g),o=Math.floor((f[0]-g[0])/n));const i=a8(f.slice(),e,!0);i.forEach(e=>{const s=t.getTileRangeForExtentAndZ(e,this.sourceZ_);for(let e=s.minX;e<=s.maxX;e++)for(let t=s.minY;t<=s.maxY;t++){const i=l(this.sourceZ_,e,t,r);if(i){const e=o*n;this.sourceTiles_.push({tile:i,offset:e})}}++o}),this.sourceTiles_.length===0&&(this.state=s.EMPTY)}else this.state=s.EMPTY}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{const n=t.tile;if(n&&n.getState()==s.LOADED){const o=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);o[0]+=t.offset,o[2]+=t.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=t.offset,s[2]+=t.offset),e.push({extent:o,clipExtent:s,image:n.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=s.ERROR;else{const n=this.wrappedTileCoord_[0],t=this.targetTileGrid_.getTileSize(n),o=typeof t=="number"?t:t[0],i=typeof t=="number"?t:t[1],a=this.targetTileGrid_.getResolution(n),r=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=oh(o,i,this.pixelRatio_,r,this.sourceTileGrid_.getExtent(),a,c,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=s.LOADED}this.changed()}load(){if(this.state==s.IDLE){this.state=s.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const n=t.getState();if(n==s.IDLE||n==s.LOADING){e++;const n=h(t,a.CHANGE,o=>{const i=t.getState();(i==s.LOADED||i==s.ERROR||i==s.EMPTY)&&(_(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e}){const o=e.getState();o==s.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(_),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Or(this.canvas_.getContext("2d")),mt.push(this.canvas_),this.canvas_=null),super.release()}},Wo=x0}});function v0(e){let t=e.getDefaultTileGrid();return t||(t=wh(e),e.setDefaultTileGrid(t)),t}function ph(e,t,n){const i=t[0],s=e.getTileCoordCenter(t),o=B4(n);if(!qr(o,s)){const t=p(o),n=Math.ceil((o[0]-s[0])/t);return s[0]+=t*n,e.getTileCoordForCoordAndZ(s,i)}return t}function jh(e,t,n,s){s=s!==0[0]?s:"top-left";const o=_h(e,t,n);return new Va({extent:e,origin:h8(e,s),resolutions:o,tileSize:n})}function _h(e,t,n,s){t=t!==0[0]?t:Lu,n=P(n!==0[0]?n:At);const a=J(e),r=p(e);s=s>0?s:Math.max(r/n[0],a/n[1]);const o=t+1,i=new Array(o);for(let e=0;e<o;++e)i[e]=s/2**e;return i}function wh(e,t,n,s){const o=B4(e);return jh(o,t,n,s)}function B4(e){e=oe(e);let t=e.getExtent();if(!t){const n=180*Ht.degrees/e.getMetersPerUnit();t=wt(-n,-n,n,n)}return t}Zo=e({"node_modules/ol/tilegrid.js"(){b(),re(),ae(),ar(),Un()}});function xh(e,t,n,s,o){return e.replace(O4,t.toString()).replace(w4,n.toString()).replace(v4,s.toString()).replace(u4,function(){if(o===0[0])throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(o-s).toString()})}function Ch(e){const n=[];let t=/\{([a-z])-([a-z])\}/.exec(e);if(t){const o=t[1].charCodeAt(0),i=t[2].charCodeAt(0);let s;for(s=o;s<=i;++s)n.push(e.replace(t[0],String.fromCharCode(s)));return n}if(t=/\{(\d+)-(\d+)\}/.exec(e),t){const s=parseInt(t[2],10);for(let o=parseInt(t[1],10);o<=s;o++)n.push(e.replace(t[0],o.toString()));return n}return n.push(e),n}ii=e({"node_modules/ol/uri.js"(){O4=/\{z\}/g,w4=/\{x\}/g,v4=/\{y\}/g,u4=/\{-y\}/g}});function Th(e,t){return function(n){if(!n)return 0[0];let i;const a=n[0];if(t){const e=t.getFullTileRange(a);e&&(i=e.getHeight()-1)}return xh(e,a,n[1],n[2],i)}}function Nh(e,t){const n=e.length,s=new Array(n);for(let o=0;o<n;++o)s[o]=Th(e[o],t);return Bh(s)}function Bh(e){return e.length===1?e[0]:function(t,n,s){if(!t)return 0[0];const o=cm(t),i=Wt(o,e.length);return e[i](t,n,s)}}e4=e({"node_modules/ol/tileurlfunction.js"(){M(),Vn(),ii()}}),Mn=e({"node_modules/ol/ObjectEventType.js"(){Vt={PROPERTYCHANGE:"propertychange"}}});function Vh(e){if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)_(e[t]);else _(e)}pi=e({"node_modules/ol/Observable.js"(){y(),Zn(),ie(),Sn=class extends ss{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(a.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const n=e.length,s=new Array(n);for(let o=0;o<n;++o)s[o]=h(this,e[o],t);return s}return h(this,e,t)}onceInternal(e,t){let n;if(Array.isArray(e)){const s=e.length;n=new Array(s);for(let o=0;o<s;++o)n[o]=js(this,e[o],t)}else n=js(this,e,t);return t.ol_key=n,n}unInternal(e,t){const n=t.ol_key;if(n)Vh(n);else if(Array.isArray(e))for(let n=0,s=e.length;n<s;++n)this.removeEventListener(e[n],t);else this.removeEventListener(e,t)}},Sn.prototype.on,Sn.prototype.once,Sn.prototype.un,fi=Sn}}),he=e({"node_modules/ol/Object.js"(){Mn(),pi(),Ce(),dt(),F(),gi=class extends Oe{constructor(e,t,n){super(e),this.key=t,this.oldValue=n}},X1=class extends fi{constructor(e){super(),this.on,this.once,this.un,z(this),this.values_=null,e!==0[0]&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let n;n=`change:${e}`,this.hasListener(n)&&this.dispatchEvent(new gi(n,e,t)),n=Vt.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new gi(n,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,n){const s=this.values_||(this.values_={});if(n)s[e]=t;else{const n=s[e];s[e]=t,n!==t&&this.notify(e,n)}}setProperties(e,t){for(const n in e)this.set(n,e[n],t)}applyProperties(e){if(!e.values_)return;Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const n=this.values_[e];delete this.values_[e],N1(this.values_)&&(this.values_=null),t||this.notify(e,n)}}},ve=X1}});function G1(e){return e?typeof e=="function"?e:(Array.isArray(e)||(e=[e]),t=>e):null}I1=e({"node_modules/ol/source/Source.js"(){he(),re(),q1=class extends ve{constructor(e){super(),this.projection=oe(e.projection),this.attributions_=G1(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==0[0]?e.state:"ready",this.wrapX_=e.wrapX!==0[0]&&e.wrapX,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(e,n){t.viewResolver=e,t.viewRejector=n})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=G1(e),this.changed()}setState(e){this.state_=e,this.changed()}},K1=q1}}),A1=e({"node_modules/ol/source/Tile.js"(){Ce(),ae(),Vn(),Zo(),F(),I1(),H1=class extends K1{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==0[0]?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==0[0]?e.tileGrid:null;const t=[256,256];this.tileGrid&&P(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||z(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(){return d()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:v0(e)}getTilePixelRatio(){return this.tilePixelRatio_}getTilePixelSize(e,t,n){const i=this.getTileGridForProjection(n),s=this.getTilePixelRatio(t),o=P(i.getTileSize(e),this.tmpSize);return s==1?o:Um(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const n=t!==0[0]?t:this.getProjection(),s=t!==0[0]?this.getTileGridForProjection(n):this.tileGrid||this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(e=ph(s,e,n)),am(e,s)?e:null}clear(){}refresh(){this.clear(),super.refresh()}},P1=class extends Oe{constructor(e,t){super(e),this.tile=t}},S1=H1}}),k1=e({"node_modules/ol/source/TileEventType.js"(){uo={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"}}}),_1=e({"node_modules/ol/source/UrlTile.js"(){pe(),e4(),ii(),F(),A1(),k1(),E1=class _UrlTile extends S1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===_UrlTile.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,o=z(n),i=n.getState();let t;i==s.LOADING?(this.tileLoadingKeys_[o]=!0,t=uo.TILELOADSTART):o in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[o],t=i==s.ERROR?uo.TILELOADERROR:i==s.LOADED?uo.TILELOADEND:0[0]),t!=null&&this.dispatchEvent(new P1(t,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t!="undefined"?this.setKey(t):this.changed()}setUrl(e){const t=Ch(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Nh(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(){}},w1=E1}});function nm(e,t){e.getImage().src=t}u1=e({"node_modules/ol/source/TileImage.js"(){eo(),pe(),y(),re(),Uo(),Zo(),F(),_1(),f1=class extends w1{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:nm,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate===0[0]||e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==0[0]?e.crossOrigin:null,this.tileClass=e.tileClass!==0[0]?e.tileClass:Js,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Oa(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||Oa(n,e)))return this.tileGrid;const t=z(e);return t in this.tileGridForProjection||(this.tileGridForProjection[t]=v0(e)),this.tileGridForProjection[t]}createTile_(e,t,n,o,i,r){const d=[e,t,n],u=this.getTileCoordForTileUrlFunction(d,i),c=u?this.tileUrlFunction(u,o,i):0[0],l=new this.tileClass(d,c!==0[0]?s.IDLE:s.EMPTY,c!==0[0]?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=r,l.addEventListener(a.CHANGE,this.handleTileChange.bind(this)),l}getTile(e,t,n,s,o){const i=this.getProjection();if(!i||!o||Oa(i,o))return this.getTileInternal(e,t,n,s,i||o);const a=[e,t,n],c=this.getKey(),l=this.getTileGridForProjection(i),d=this.getTileGridForProjection(o),u=this.getTileCoordForTileUrlFunction(a,o),r=new Wo(i,l,o,d,a,u,this.getTilePixelRatio(s),this.getGutter(),(e,t,n,s)=>this.getTileInternal(e,t,n,s,i),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return r.key=c,r}getTileInternal(e,t,n,s,o){const i=this.getKey();return this.createTile_(e,t,n,s,o,i)}setRenderReprojectionEdges(e){if(this.renderReprojectionEdges_==e)return;this.renderReprojectionEdges_=e,this.changed()}setTileGridForProjection(e,t){const n=oe(e);if(n){const e=z(n);e in this.tileGridForProjection||(this.tileGridForProjection[e]=t)}}},h1=f1}}),c1=e({"node_modules/ol/source/Zoomify.js"(){eo(),pe(),I(),l1=class extends Js{constructor(e,t,n,s,o,i,a){super(t,n,s,o,i,a),this.zoomifyImage_=null,this.tileSize_=e}getImage(){if(this.zoomifyImage_)return this.zoomifyImage_;const e=super.getImage();if(this.state==s.LOADED){const t=this.tileSize_;if(e.width==t[0]&&e.height==t[1])return this.zoomifyImage_=e,e;const n=L(t[0],t[1]);return n.drawImage(e,0,0),this.zoomifyImage_=n.canvas,n.canvas}return e}}}});function xn(e){return e.toLocaleString("en",{maximumFractionDigits:10})}i1=e({"node_modules/ol/source/IIIF.js"(){B(),b(),na(),ae(),ar(),Un(),u1(),c1(),a1=class extends h1{constructor(e){const n=e||{};let h=n.url||"";h=h+(h.lastIndexOf("/")===h.length-1||h===""?"":"/");const p=n.version||O.VERSION2,l=n.sizes||[],d=n.size;f(d!=null&&Array.isArray(d)&&d.length==2&&!isNaN(d[0])&&d[0]>0&&!isNaN(d[1])&&d[1]>0,"Missing or invalid `size`");const o=d[0],r=d[1],t=n.tileSize,_=n.tilePixelRatio||1,y=n.format||"jpg",j=n.quality||(n.version==O.VERSION1?"native":"default");let c=n.resolutions||[];const s=n.supports||[],b=n.extent||[0,-r,o,0],v=l!=null&&Array.isArray(l)&&l.length>0,g=t!==0[0]&&(typeof t=="number"&&Number.isInteger(t)&&t>0||Array.isArray(t)&&t.length>0),m=s!=null&&Array.isArray(s)&&(s.includes("regionByPx")||s.includes("regionByPct"))&&(s.includes("sizeByWh")||s.includes("sizeByH")||s.includes("sizeByW")||s.includes("sizeByPct"));let i,a,u;if(c.sort(function(e,t){return t-e}),g||m)if(t!=null&&(typeof t=="number"&&Number.isInteger(t)&&t>0?(i=t,a=t):Array.isArray(t)&&t.length>0&&((t.length==1||t[1]==0[0]&&Number.isInteger(t[0]))&&(i=t[0],a=t[0]),t.length==2&&(Number.isInteger(t[0])&&Number.isInteger(t[1])?(i=t[0],a=t[1]):t[0]==0[0]&&Number.isInteger(t[1])&&(i=t[1],a=t[1])))),(i===0[0]||a===0[0])&&(i=At,a=At),c.length==0){u=Math.max(Math.ceil(Math.log(o/i)/Math.LN2),Math.ceil(Math.log(r/a)/Math.LN2));for(let e=u;e>=0;e--)c.push(2**e)}else{const e=Math.max(...c);u=Math.round(Math.log(e)/Math.LN2)}else if(i=o,a=r,c=[],v){{l.sort(function(e,t){return e[0]-t[0]}),u=-1;const e=[];for(let t=0;t<l.length;t++){const n=o/l[t][0];if(c.length>0&&c[c.length-1]==n){e.push(t);continue}c.push(n),u++}if(e.length>0)for(let t=0;t<e.length;t++)l.splice(e[t]-t,1)}}else c.push(1),l.push([o,r]),u=0;const w=new Va({tileSize:[i,a],extent:b,origin:Se(b),resolutions:c}),x=function(e){let b,f;const _=e[0];if(_>u)return;const w=e[1],x=e[2],d=c[_];if(w===0[0]||x===0[0]||d===0[0]||w<0||Math.ceil(o/d/i)<=w||x<0||Math.ceil(r/d/a)<=x)return;if(m||g){const e=w*i*d,t=x*a*d;let n=i*d,c=a*d,l=i,u=a;if(e+n>o&&(n=o-e),t+c>r&&(c=r-t),e+i*d>o&&(l=Math.floor((o-e+d-1)/d)),t+a*d>r&&(u=Math.floor((r-t+d-1)/d)),e==0&&n==o&&t==0&&c==r)b="full";else if(!m||s.includes("regionByPx"))b=e+","+t+","+n+","+c;else if(s.includes("regionByPct")){const s=xn(e/o*100),i=xn(t/r*100),a=xn(n/o*100),l=xn(c/r*100);b="pct:"+s+","+i+","+a+","+l}p==O.VERSION3&&(!m||s.includes("sizeByWh"))?f=l+","+u:!m||s.includes("sizeByW")?f=l+",":s.includes("sizeByH")?f=","+u:s.includes("sizeByWh")?f=l+","+u:s.includes("sizeByPct")&&(f="pct:"+xn(100/d))}else if(b="full",v){const e=l[_][0],t=l[_][1];p==O.VERSION3?e==o&&t==r?f="max":f=e+","+t:e==o?f="full":f=e+","}else f=p==O.VERSION3?"max":"full";return h+b+"/"+f+"/0/"+j+"."+y},C=l1.bind(null,P(t||256).map(function(e){return e*_}));super({attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,interpolate:n.interpolate,projection:n.projection,reprojectionErrorThreshold:n.reprojectionErrorThreshold,state:n.state,tileClass:C,tileGrid:w,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:x,transition:n.transition}),this.zDirection=n.zDirection}},Bi=a1}}),oo=e({"node_modules/ol/CollectionEventType.js"(){Q={ADD:"add",REMOVE:"remove"}}}),wn=e({"node_modules/ol/Collection.js"(){oo(),he(),Ce(),Ui={LENGTH:"length"},On=class extends Oe{constructor(e,t,n){super(e),this.element=t,this.index=n}},s1=class extends ve{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let e=0,t=this.array_.length;e<t;++e)this.assertUnique_(this.array_[e],e);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,n=e.length;t<n;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let n=0,s=t.length;n<s;++n)e(t[n],n,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(Ui.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new On(Q.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let n=0,s=t.length;n<s;++n)if(t[n]===e)return this.removeAt(n)}removeAt(e){if(e<0||e>=this.getLength())return 0[0];const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new On(Q.REMOVE,t,e)),t}setAt(e,t){const n=this.getLength();if(e>=n){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const s=this.array_[e];this.array_[e]=t,this.dispatchEvent(new On(Q.REMOVE,s,e)),this.dispatchEvent(new On(Q.ADD,t,e))}updateLength_(){this.set(Ui.LENGTH,this.array_.length)}assertUnique_(e,t){for(let n=0,s=this.array_.length;n<s;++n)if(this.array_[n]===e&&n!==t)throw new Error("Duplicate item added to a unique collection")}},fe=s1}}),Zi=e({"node_modules/ol/MapEvent.js"(){Ce(),Zu=class extends Oe{constructor(e,t,n){super(e),this.map=t,this.frameState=n!==0[0]?n:null}},Xe=Zu}}),ta=e({"node_modules/ol/MapBrowserEvent.js"(){Zi(),Qu=class extends Xe{constructor(e,t,n,s,o,i){super(e,t,o),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=s!==0[0]&&s,this.activePointers=i}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},ke=Qu}}),Qt=e({"node_modules/ol/MapBrowserEventType.js"(){y(),j={SINGLECLICK:"singleclick",CLICK:a.CLICK,DBLCLICK:a.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}}}),ia=e({"node_modules/ol/pointer/EventType.js"(){so={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}}}),Wu=e({"node_modules/ol/MapBrowserEventHandler.js"(){ta(),Qt(),y(),Zn(),ie(),Bt(),ia(),Xu=class extends ss{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===0[0]?1:t,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=h(n,so.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=h(n,so.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(a.TOUCHMOVE,this.boundHandleTouchMove_,!!mi&&{passive:!1})}emulateClick_(e){let t=new ke(j.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==0[0]?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0[0],t=new ke(j.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=0[0];const t=new ke(j.SINGLECLICK,this.map_,e);this.dispatchEvent(t)},250)}updateActivePointers_(e){const t=e,n=t.pointerId;if(t.type==j.POINTERUP||t.type==j.POINTERCANCEL){{delete this.trackedTouches_[n];for(const e in this.trackedTouches_)if(this.trackedTouches_[e].target!==t.target){delete this.trackedTouches_[e];break}}}else(t.type==j.POINTERDOWN||t.type==j.POINTERMOVE)&&(this.trackedTouches_[n]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new ke(j.POINTERUP,this.map_,e,0[0],0[0],this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(_),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new ke(j.POINTERDOWN,this.map_,e,0[0],0[0],this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const e=this.map_.getOwnerDocument();this.dragListenerKeys_.push(h(e,j.POINTERMOVE,this.handlePointerMove_,this),h(e,j.POINTERUP,this.handlePointerUp_,this),h(this.element_,j.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==e&&this.dragListenerKeys_.push(h(this.element_.getRootNode(),j.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new ke(j.POINTERDRAG,this.map_,e,this.dragging_,0[0],this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new ke(j.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(_(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(a.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(_(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(_),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Ku=Xu}}),da=e({"node_modules/ol/MapEventType.js"(){xe={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"}}}),ha=e({"node_modules/ol/MapProperty.js"(){k={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"}}}),Bu=e({"node_modules/ol/structs/PriorityQueue.js"(){B(),dt(),jn=1/0,$u=class{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,vs(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const s=this.keyFunction_(n);return delete this.queuedElements_[s],n}enqueue(e){f(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=jn&&(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,t=this.priorities_,s=n.length,o=n[e],i=t[e],a=e;for(;e<s>>1;){const a=this.getLeftChildIndex_(e),o=this.getRightChildIndex_(e),i=o<s&&t[o]<t[a]?o:a;n[e]=n[i],t[e]=t[i],e=i}n[e]=o,t[e]=i,this.siftDown_(a,e)}siftDown_(e,t){const s=this.elements_,n=this.priorities_,i=s[t],o=n[t];for(;t>e;){const e=this.getParentIndex_(t);if(n[e]>o)s[t]=s[e],n[t]=n[e],t=e;else break}s[t]=i,n[t]=o}reprioritize(){const a=this.priorityFunction_,e=this.elements_,i=this.priorities_;let t=0;const r=e.length;let n,s,o;for(s=0;s<r;++s)n=e[s],o=a(n),o==jn?delete this.queuedElements_[this.keyFunction_(n)]:(i[t]=o,e[t++]=n);e.length=t,i.length=t,this.heapify_()}},Vu=$u}});function om(e,t,n,s,o){if(!e||!(n in e.wantedTiles))return jn;if(!e.wantedTiles[n][t.getKey()])return jn;const i=e.viewState.center,a=s[0]-i[0],r=s[1]-i[1];return 65536*Math.log(o)+(a*a+r*r)**.5/o}Cu=e({"node_modules/ol/TileQueue.js"(){pe(),y(),Bu(),Pu=class extends Vu{constructor(e,t){super(t=>e.apply(null,t),e=>e[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);if(t){const t=e[0];t.addEventListener(a.CHANGE,this.boundHandleTileChange_)}return t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,t=n.getState();if(t===s.LOADED||t===s.ERROR||t===s.EMPTY){t!==s.ERROR&&n.removeEventListener(a.CHANGE,this.boundHandleTileChange_);const e=n.getKey();e in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let n=0;for(;this.tilesLoading_<e&&n<t&&this.getCount()>0;){const e=this.dequeue()[0],t=e.getKey(),o=e.getState();o===s.IDLE&&!(t in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[t]=!0,++this.tilesLoading_,++n,e.load())}}},Nu=Pu}}),wa=e({"node_modules/ol/ViewHint.js"(){X={ANIMATING:0,INTERACTING:1}}}),xu=e({"node_modules/ol/ViewProperty.js"(){ne={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"}}});function wu(e,t,n){return function(s,o,i,a,r){if(!s)return 0[0];if(!o&&!t)return s;const h=t?0:i[0]*o,m=t?0:i[1]*o,f=r?r[0]:0,p=r?r[1]:0;let c=e[0]+h/2+f,d=e[2]-h/2+f,l=e[1]+m/2+p,u=e[3]-m/2+p;c>d&&(c=(d+c)/2,d=c),l>u&&(l=(u+l)/2,u=l);let g=w(s[0],c,d),v=w(s[1],l,u);if(a&&n&&o){const e=30*o;g+=-e*Math.log(1+Math.max(0,c-s[0])/e)+e*Math.log(1+Math.max(0,s[0]-d)/e),v+=-e*Math.log(1+Math.max(0,l-s[1])/e)+e*Math.log(1+Math.max(0,s[1]-u)/e)}return[g,v]}}function wm(e){return e}bu=e({"node_modules/ol/centerconstraint.js"(){M()}});function xm(e,t,n,s,o,i,a){i=i||[],a=a||2;let r=0;for(let c=t;c<n;c+=s){const l=e[c],d=e[c+1];i[r++]=o[0]*l+o[2]*d+o[4],i[r++]=o[1]*l+o[3]*d+o[5];for(let t=2;t<a;t++)i[r++]=e[c+t]}return i&&i.length!=r&&(i.length=r),i}function Cm(e,t,n,s,o,i,a){a=a||[];const c=Math.cos(o),l=Math.sin(o),d=i[0],u=i[1];let r=0;for(let o=t;o<n;o+=s){const i=e[o]-d,h=e[o+1]-u;a[r++]=d+i*c-h*l,a[r++]=u+i*l+h*c;for(let t=o+2;t<o+s;++t)a[r++]=e[t]}return a&&a.length!=r&&(a.length=r),a}function Em(e,t,n,s,o,i,a,r){r=r||[];const l=a[0],d=a[1];let c=0;for(let a=t;a<n;a+=s){const u=e[a]-l,h=e[a+1]-d;r[c++]=l+o*u,r[c++]=d+i*h;for(let t=a+2;t<a+s;++t)r[c++]=e[t]}return r&&r.length!=c&&(r.length=c),r}function Am(e,t,n,s,o,i,a){a=a||[];let r=0;for(let c=t;c<n;c+=s){a[r++]=e[c]+o,a[r++]=e[c+1]+i;for(let t=c+2;t<c+s;++t)a[r++]=e[t]}return a&&a.length!=r&&(a.length=r),a}Ta=e({"node_modules/ol/geom/flat/transform.js"(){}}),lu=e({"node_modules/ol/geom/Geometry.js"(){he(),b(),K(),re(),ut(),F(),Ta(),za=Yt(),hu=[NaN,NaN],uu=class extends ve{constructor(){super(),this.extent_=lt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=r3((e,t,n)=>{if(!n)return this.getSimplifiedGeometry(t);const s=this.clone();return s.applyTransform(n),s.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return d()}closestPointXY(){return d()}containsXY(e,t){return this.closestPointXY(e,t,hu,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(){return d()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&on(e),this.extentRevision_=this.getRevision()}return d8(this.extent_,e)}rotate(){d()}scale(){d()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(){return d()}getType(){return d()}applyTransform(){d()}intersectsExtent(){return d()}translate(){d()}transform(e,t){const n=oe(e),s=n.getUnits()=="tile-pixels"?function(e,s,o){const l=n.getExtent(),i=n.getWorldExtent(),r=J(i)/J(l);Rn(za,i[0],i[3],r,-r,0,0,0);const a=xm(e,0,e.length,o,za,s),c=Hn(n,t);return c?c(a,a,o):a}:Hn(n,t);return this.applyTransform(s),this}},du=uu}});function Sm(e){let t;return e==2?t="XY":e==3?t="XYZ":e==4&&(t="XYZM"),t}function iu(e){let t;return e=="XY"?t=2:e=="XYZ"||e=="XYM"?t=3:e=="XYZM"&&(t=4),t}Us=e({"node_modules/ol/geom/SimpleGeometry.js"(){b(),F(),lu(),Ta(),Qd=class extends du{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return _8(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return d()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e),n=t.getFlatCoordinates();return n.length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=iu(e),this.layout=e,this.flatCoordinates=t}setCoordinates(){d()}setLayout(e,t,n){let s;if(e)s=iu(e);else{for(let e=0;e<n;++e){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}s=t.length,e=Sm(s)}this.layout=e,this.stride=s}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const n=this.getFlatCoordinates();if(n){const s=this.getStride();Cm(n,0,n.length,s,e,t,n),this.changed()}}scale(e,t,n){t===0[0]&&(t=e),n||(n=Ot(this.getExtent()));const s=this.getFlatCoordinates();if(s){const o=this.getStride();Em(s,0,s.length,o,e,t,n,s),this.changed()}}translate(e,t){const n=this.getFlatCoordinates();if(n){const s=this.getStride();Am(n,0,n.length,s,e,t,n),this.changed()}}},Ks=Qd}});function Gd(e,t,n,s){let o=0;const r=e[n-s],c=e[n-s+1];let i=0,a=0;for(;t<n;t+=s){const l=e[t]-r,d=e[t+1]-c;o+=a*l-i*d,i=l,a=d}return o/2}function Im(e,t,n,s){let o=0;for(let i=0,r=n.length;i<r;++i){const a=n[i];o+=Gd(e,t,a,s),t=a}return o}Ua=e({"node_modules/ol/geom/flat/area.js"(){}});function qd(e,t,n,s,o,i,a){const d=e[t],u=e[t+1],r=e[n]-d,c=e[n+1]-u;let l;if(r===0&&c===0)l=t;else{const h=((o-d)*r+(i-u)*c)/(r*r+c*c);if(h>1)l=n;else if(h>0){for(let o=0;o<s;++o)a[o]=dm(e[t+o],e[n+o],h);a.length=s;return}else l=t}for(let t=0;t<s;++t)a[t]=e[l+t];a.length=s}function Vd(e,t,n,s,o){let i=e[t],a=e[t+1];for(t+=s;t<n;t+=s){const r=e[t],c=e[t+1],l=Ut(i,a,r,c);l>o&&(o=l),i=r,a=c}return o}function Km(e,t,n,s,o){for(let i=0,r=n.length;i<r;++i){const a=n[i];o=Vd(e,t,a,s,o),t=a}return o}function Hd(e,t,n,s,o,i,a,r,c,l,d){if(t==n)return l;let u,h;if(o===0){if(h=Ut(a,r,e[t],e[t+1]),h<l){for(u=0;u<s;++u)c[u]=e[t+u];return c.length=s,h}return l}d=d||[NaN,NaN];let m=t+s;for(;m<n;)if(qd(e,m-s,m,s,a,r,d),h=Ut(a,r,d[0],d[1]),h<l){l=h;for(u=0;u<s;++u)c[u]=d[u];c.length=s,m+=s}else m+=s*Math.max((h**.5-l**.5)/o|0,1);if(i&&(qd(e,n-s,t,s,a,r,d),h=Ut(a,r,d[0],d[1]),h<l)){l=h;for(u=0;u<s;++u)c[u]=d[u];c.length=s}return l}function tm(e,t,n,s,o,i,a,r,c,l,d){d=d||[NaN,NaN];for(let u=0,m=n.length;u<m;++u){const h=n[u];l=Hd(e,t,h,s,o,i,a,r,c,l,d),t=h}return l}Qa=e({"node_modules/ol/geom/flat/closest.js"(){M()}});function Gm(e,t,n){for(let s=0,o=n.length;s<o;++s)e[t++]=n[s];return t}function Nd(e,t,n,s){for(let o=0,i=n.length;o<i;++o){const a=n[o];for(let n=0;n<s;++n)e[t++]=a[n]}return t}function Xm(e,t,n,s,o){o=o||[];let i=0;for(let a=0,c=n.length;a<c;++a){const r=Nd(e,t,n[a],s);o[i++]=r,t=r}return o.length=i,o}Is=e({"node_modules/ol/geom/flat/deflate.js"(){}});function Ad(e,t,n,s,o){o=o!==0[0]?o:[];let i=0;for(let a=t;a<n;a+=s)o[i++]=e.slice(a,a+s);return o.length=i,o}function Qm(e,t,n,s,o){o=o!==0[0]?o:[];let i=0;for(let a=0,c=n.length;a<c;++a){const r=n[a];o[i++]=Ad(e,t,r,s,o[i]),t=r}return o.length=i,o}or=e({"node_modules/ol/geom/flat/inflate.js"(){}});function Zm(e,t,n,s,o,i,a){const l=(n-t)/s;if(l<3){for(;t<n;t+=s)i[a++]=e[t],i[a++]=e[t+1];return a}const d=new Array(l);d[0]=1,d[l-1]=1;const c=[t,n-s];let r=0;for(;c.length>0;){const n=c.pop(),i=c.pop();let a=0;const l=e[i],u=e[i+1],h=e[n],m=e[n+1];for(let t=i+s;t<n;t+=s){const c=e[t],d=e[t+1],o=Om(c,d,l,u,h,m);o>a&&(r=t,a=o)}a>o&&(d[(r-t)/s]=1,i+s<r&&c.push(i,r),r+s<n&&c.push(r,n))}for(let n=0;n<l;++n)d[n]&&(i[a++]=e[t+n*s],i[a++]=e[t+n*s+1]);return a}function vt(e,t){return t*Math.round(e/t)}function Jm(e,t,n,s,o,i,a){if(t==n)return a;let l=vt(e[t],o),d=vt(e[t+1],o);t+=s,i[a++]=l,i[a++]=d;let r,c;do if(r=vt(e[t],o),c=vt(e[t+1],o),t+=s,t==n)return i[a++]=r,i[a++]=c,a;while(r==l&&c==d)for(;t<n;){const h=vt(e[t],o),m=vt(e[t+1],o);if(t+=s,h==r&&m==c)continue;const n=r-l,u=c-d,f=h-l,p=m-d;if(n*p==u*f&&(n<0&&f<n||n==f||n>0&&f>n)&&(u<0&&p<u||u==p||u>0&&p>u)){r=h,c=m;continue}i[a++]=r,i[a++]=c,l=r,d=c,r=h,c=m}return i[a++]=r,i[a++]=c,a}function e8(e,t,n,s,o,i,a,r){for(let c=0,d=n.length;c<d;++c){const l=n[c];a=Jm(e,t,l,s,o,i,a),r.push(a),t=l}return a}lr=e({"node_modules/ol/geom/flat/simplify.js"(){M()}}),yd=e({"node_modules/ol/geom/LinearRing.js"(){b(),Us(),Ua(),Qa(),Is(),or(),lr(),_d=class _LinearRing extends Ks{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==0[0]&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new _LinearRing(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,n,s){return s<Yl(this.getExtent(),e,t)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Vd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)**.5,this.maxDeltaRevision_=this.getRevision()),Hd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,n,s))}getArea(){return Gd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ad(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Zm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new _LinearRing(t,"XY")}getType(){return"LinearRing"}intersectsExtent(){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Nd(this.flatCoordinates,0,e,this.stride),this.changed()}},ur=_d}}),fd=e({"node_modules/ol/geom/Point.js"(){b(),M(),Us(),Is(),jd=class _Point extends Ks{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new _Point(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,n,s){const o=this.flatCoordinates,i=Ut(e,t,o[0],o[1]);if(i<s){const e=this.stride;for(let t=0;t<e;++t)n[t]=o[t];return n.length=e,i}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return w8(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Xl(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Gm(this.flatCoordinates,0,e,this.stride),this.changed()}},bd=jd}});function m8(e,t,n,s,o,i,a){let r,v,h,c,d,u,m;const l=o[i+1],f=[];for(let o=0,a=n.length;o<a;++o){const i=n[o];c=e[i-s],u=e[i-s+1];for(r=t;r<i;r+=s)d=e[r],m=e[r+1],(l<=u&&m<=l||u<=l&&l<=m)&&(h=(l-u)/(m-u)*(d-c)+c,f.push(h)),c=d,u=m}let p=NaN,g=-(1/0);f.sort(go),c=f[0];for(r=1,v=f.length;r<v;++r){d=f[r];const o=Math.abs(d-c);o>g&&(h=(c+d)/2,ou(e,t,n,s,h,l)&&(p=h,g=o)),c=d}return isNaN(p)&&(p=o[i]),a?(a.push(p,l,g),a):[p,l,g]}cd=e({"node_modules/ol/geom/flat/interiorpoint.js"(){ee(),Eo()}});function p8(e,t,n,s){for(;t<n-s;){for(let o=0;o<s;++o){const i=e[t+o];e[t+o]=e[n-s+o],e[n-s+o]=i}t+=s,n-=s}}ad=e({"node_modules/ol/geom/flat/reverse.js"(){}});function sd(e,t,n,s){let o=0,i=e[n-s],a=e[n-s+1];for(;t<n;t+=s){const r=e[t],c=e[t+1];o+=(r-i)*(c+a),i=r,a=c}return o===0?0[0]:o>0}function j8(e,t,n,s,o){o=o!==0[0]&&o;for(let i=0,c=n.length;i<c;++i){const r=n[i],a=sd(e,t,r,s);if(i===0){if(o&&a||!o&&!a)return!1}else if(o&&!a||!o&&a)return!1;t=r}return!0}function Jl(e,t,n,s,o){o=o!==0[0]&&o;for(let i=0,c=n.length;i<c;++i){const r=n[i],a=sd(e,t,r,s),l=i===0?o&&a||!o&&!a:o&&!a||!o&&a;l&&p8(e,t,r,s),t=r}return t}Zl=e({"node_modules/ol/geom/flat/orient.js"(){ad()}});function Ql(e){if(pn(e))throw new Error("Cannot create polygon from empty extent");const t=e[0],n=e[1],s=e[2],o=e[3],i=[t,n,t,o,s,o,s,n,t,n];return new Cr(i,"XY",[i.length])}kr=e({"node_modules/ol/geom/Polygon.js"(){ee(),b(),yd(),fd(),Us(),Ua(),Qa(),Eo(),Is(),or(),cd(),Io(),Zl(),lr(),Cr=class _Polygon extends Ks{constructor(e,t,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==0[0]&&n?(this.setFlatCoordinates(t,e),this.ends_=n):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?Bm(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new _Polygon(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,n,s){return s<Yl(this.getExtent(),e,t)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Km(this.flatCoordinates,0,this.ends_,this.stride,0)**.5,this.maxDeltaRevision_=this.getRevision()),tm(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,n,s))}containsXY(e,t){return ou(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Im(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==0[0]?(t=this.getOrientedFlatCoordinates().slice(),Jl(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Qm(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Ot(this.getExtent());this.flatInteriorPoint_=m8(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new bd(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new ur(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const s=this.layout,o=this.flatCoordinates,e=this.ends_,t=[];let n=0;for(let i=0,r=e.length;i<r;++i){const a=e[i],c=new ur(o.slice(n,a),s);t.push(c),n=a}return t}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;j8(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Jl(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],n=[];return t.length=e8(this.flatCoordinates,0,this.ends_,this.stride,e**.5,t,0,n),new _Polygon(t,"XY",n)}getType(){return"Polygon"}intersectsExtent(e){return km(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Xm(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}},ql=Cr}});function Ar(e,t,n,s){const o=p(t)/n[0],i=J(t)/n[1];return s?Math.min(e,Math.max(o,i)):Math.min(e,Math.min(o,i))}function Sr(e,t,n){let s=Math.min(e,t);const o=50;return s*=Math.log(1+o*Math.max(0,e/t-1))/o+1,n&&(s=Math.max(s,n),s/=Math.log(1+o*Math.max(0,n/e-1))/o+1),w(s,n/2,t*2)}function S8(e,t,n,s){return t=t===0[0]||t,function(o,i,a,r){if(o!==0[0]){const d=e[0],u=e[e.length-1],c=n?Ar(d,n,a,s):d;if(r)return t?Sr(o,c,u):w(o,u,c);const h=Math.min(c,o),l=Math.floor(yi(e,h,i));return e[l]>c&&l<e.length-1?e[l+1]:e[l]}}}function M8(e,t,n,s,o,i){return s=s===0[0]||s,n=n!==0[0]?n:0,function(a,r,c,l){if(a!==0[0]){const d=o?Ar(t,o,c,i):t;if(l)return s?Sr(a,d,n):w(a,n,d);const u=1e-9,h=Math.ceil(Math.log(t/d)/Math.log(e)-u),m=-r*(.5-u)+.5,f=Math.min(d,a),p=Math.floor(Math.log(t/f)/Math.log(e)+m),g=Math.max(h,p),v=t/e**g;return w(v,n,d)}}}function Vl(e,t,n,s,o){return n=n===0[0]||n,function(i,a,r,c){if(i!==0[0]){const a=s?Ar(e,s,r,o):e;return!n||!c?w(i,t,a):Sr(i,a,t)}}}Bl=e({"node_modules/ol/resolutionconstraint.js"(){ee(),b(),M()}});function Dr(e){return e!==0[0]?0:0[0]}function Il(e){return e!==0[0]?e:0[0]}function F8(e){const t=2*Math.PI/e;return function(e,n){return n?e:e!==0[0]?(e=Math.floor(e/t+.5)*t,e):0[0]}}function T8(e){const t=e===0[0]?Pe(5):e;return function(e,n){return n||e===0[0]?e:(e<0?-e:e)<=t?0:e}}Os=e({"node_modules/ol/rotationconstraint.js"(){M()}});function ys(e,t){setTimeout(function(){e(t)},0)}function z8(e){if(e.extent!==0[0]){const t=e.smoothExtentConstraint===0[0]||e.smoothExtentConstraint;return wu(e.extent,e.constrainOnlyCenter,t)}const t=Aa(e.projection,"EPSG:3857");if(e.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-(1/0),e[2]=1/0,wu(e,!1,!1)}return wm}function R8(e){let r,n,t;const f=28,m=2;let i=e.minZoom!==0[0]?e.minZoom:bs,a=e.maxZoom!==0[0]?e.maxZoom:f;const s=e.zoomFactor!==0[0]?e.zoomFactor:m,g=e.multiWorld!==0[0]&&e.multiWorld,l=e.smoothResolutionConstraint===0[0]||e.smoothResolutionConstraint,d=e.showFullExtent!==0[0]&&e.showFullExtent,h=Aa(e.projection,"EPSG:3857"),u=h.getExtent();let c=e.constrainOnlyCenter,o=e.extent;if(!g&&!o&&h.isGlobal()&&(c=!1,o=u),e.resolutions!==0[0]){const s=e.resolutions;n=s[i],t=s[a]!==0[0]?s[a]:s[s.length-1],e.constrainResolution?r=S8(s,l,!c&&o,d):r=Vl(n,t,l,!c&&o,d)}else{const v=u?Math.max(p(u),J(u)):360*Ht.degrees/h.getMetersPerUnit(),g=v/At/m**bs,b=g/m**(f-bs);n=e.maxResolution,n!==0[0]?i=0:n=g/s**i,t=e.minResolution,t===0[0]&&(e.maxZoom!==0[0]?e.maxResolution!==0[0]?t=n/s**a:t=g/s**a:t=b),a=i+Math.floor(Math.log(n/t)/Math.log(s)),t=n/s**(a-i),e.constrainResolution?r=M8(s,n,t,l,!c&&o,d):r=Vl(n,t,l,!c&&o,d)}return{constraint:r,maxResolution:n,minResolution:t,minZoom:i,zoomFactor:s}}function I8(e){const t=e.enableRotation===0[0]||e.enableRotation;if(t){const t=e.constrainRotation;return t===0[0]||t===!0?T8():t===!1?Il:typeof t=="number"?F8(t):Il}return Dr}function V8(e){return!(e.sourceCenter&&e.targetCenter&&!io(e.sourceCenter,e.targetCenter))&&e.sourceResolution===e.targetResolution&&e.sourceRotation===e.targetRotation}function Wr(e,t,n,s,o){const a=Math.cos(-o);let i=Math.sin(-o),r=e[0]*a-e[1]*i,c=e[1]*a+e[0]*i;r+=(t[0]/2-n[0])*s,c+=(n[1]-t[1]/2)*s,i=-i;const l=r*a-c*i,d=c*a+r*i;return[l,d]}ps=e({"node_modules/ol/View.js"(){he(),wa(),xu(),ee(),B(),bu(),It(),Me(),b(),K(),kr(),M(),re(),Bl(),Os(),Un(),bs=0,Ml=class extends ve{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Aa(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=0[0],e.projection&&u3(),e.center&&(e.center=ge(e.center,this.projection_)),e.extent&&(e.extent=qe(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const e in ne)delete n[e];this.setProperties(n,!0);const t=R8(e);this.maxResolution_=t.maxResolution,this.minResolution_=t.minResolution,this.zoomFactor_=t.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=t.minZoom;const s=z8(e),o=t.constraint,i=I8(e);this.constraints_={center:s,resolution:o,rotation:i},this.setRotation(e.rotation!==0[0]?e.rotation:0),this.setCenterInternal(e.center!==0[0]?e.center:null),e.resolution!==0[0]?this.setResolution(e.resolution):e.zoom!==0[0]&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const n=this.getCenterInternal();if(n){const s=e||[0,0,0,0];t=t||[0,0,0,0];const o=this.getResolution(),i=o/2*(s[3]-t[3]+t[1]-s[1]),a=o/2*(s[0]-t[0]+t[2]-s[2]);this.setCenterInternal([n[0]+i,n[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==0[0]?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let n=0;n<t.length;++n){let e=arguments[n];e.center&&(e=Object.assign({},e),e.center=ge(e.center,this.getProjection())),e.anchor&&(e=Object.assign({},e),e.anchor=ge(e.anchor,this.getProjection())),t[n]=e}this.animateInternal.apply(this,t)}animateInternal(){let t=arguments.length,s;t>1&&typeof arguments[t-1]=="function"&&(s=arguments[t-1],--t);let n=0;for(;n<t&&!this.isDef();++n){const e=arguments[n];e.center&&this.setCenterInternal(e.center),e.zoom!==0[0]?this.setZoom(e.zoom):e.resolution&&this.setResolution(e.resolution),e.rotation!==0[0]&&this.setRotation(e.rotation)}if(n===t){s&&ys(s,!0);return}let a=Date.now(),r=this.targetCenter_.slice(),o=this.targetResolution_,i=this.targetRotation_;const c=[];for(;n<t;++n){const l=arguments[n],e={start:a,complete:!1,anchor:l.anchor,duration:l.duration!==0[0]?l.duration:1e3,easing:l.easing||Jh,callback:s};if(l.center&&(e.sourceCenter=r,e.targetCenter=l.center.slice(),r=e.targetCenter),l.zoom!==0[0]?(e.sourceResolution=o,e.targetResolution=this.getResolutionForZoom(l.zoom),o=e.targetResolution):l.resolution&&(e.sourceResolution=o,e.targetResolution=l.resolution,o=e.targetResolution),l.rotation!==0[0]){e.sourceRotation=i;const t=Wt(l.rotation-i+Math.PI,2*Math.PI)-Math.PI;e.targetRotation=i+t,i=e.targetRotation}V8(e)?e.complete=!0:a+=e.duration,c.push(e)}this.animations_.push(c),this.setHint(X.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[X.ANIMATING]>0}getInteracting(){return this.hints_[X.INTERACTING]>0}cancelAnimations(){this.setHint(X.ANIMATING,-this.hints_[X.ANIMATING]);let e;for(let n=0,s=this.animations_.length;n<s;++n){const t=this.animations_[n];if(t[0].callback&&ys(t[0].callback,!1),!e)for(let n=0,o=t.length;n<o;++n){const s=t[n];if(!s.complete){e=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==0[0]&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=0[0]),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const s=this.animations_[n];let o=!0;for(let a=0,c=s.length;a<c;++a){const n=s[a];if(n.complete)continue;const l=t-n.start;let r=n.duration>0?l/n.duration:1;r>=1?(n.complete=!0,r=1):o=!1;const i=n.easing(r);if(n.sourceCenter){const e=n.sourceCenter[0],t=n.sourceCenter[1],s=n.targetCenter[0],o=n.targetCenter[1];this.nextCenter_=n.targetCenter;const a=e+i*(s-e),r=t+i*(o-t);this.targetCenter_=[a,r]}if(n.sourceResolution&&n.targetResolution){const e=i===1?n.targetResolution:n.sourceResolution+i*(n.targetResolution-n.sourceResolution);if(n.anchor){const t=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(e,0,t,!0);this.targetCenter_=this.calculateCenterZoom(s,n.anchor)}this.nextResolution_=n.targetResolution,this.targetResolution_=e,this.applyTargetState_(!0)}if(n.sourceRotation!==0[0]&&n.targetRotation!==0[0]){const e=i===1?Wt(n.targetRotation+Math.PI,2*Math.PI)-Math.PI:n.sourceRotation+i*(n.targetRotation-n.sourceRotation);if(n.anchor){const t=this.constraints_.rotation(e,!0);this.targetCenter_=this.calculateCenterRotate(t,n.anchor)}this.nextRotation_=n.targetRotation,this.targetRotation_=e}if(this.applyTargetState_(!0),e=!0,!n.complete)break}if(o){this.animations_[n]=null,this.setHint(X.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const e=s[0].callback;e&&ys(e,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===0[0]&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let n;const s=this.getCenterInternal();return s!==0[0]&&(n=[s[0]-t[0],s[1]-t[1]],ki(n,e-this.getRotation()),hh(n,t)),n}calculateCenterZoom(e,t){let o;const n=this.getCenterInternal(),s=this.getResolution();if(n!==0[0]&&s!==0[0]){const i=t[0]-e*(t[0]-n[0])/s,a=t[1]-e*(t[1]-n[1])/s;o=[i,a]}return o}getViewportSize_(e){const t=this.viewportSize_;if(e){const n=t[0],s=t[1];return[Math.abs(n*Math.cos(e))+Math.abs(s*Math.sin(e)),Math.abs(n*Math.sin(e))+Math.abs(s*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Hi(e,this.getProjection())}getCenterInternal(){return this.get(ne.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==0[0]?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return X3(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();f(t,"The view center is not defined");const n=this.getResolution();f(n!==0[0],"The view resolution is not defined");const s=this.getRotation();return f(s!==0[0],"The view rotation is not defined"),Ha(t,n,s,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(ne.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(qe(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const n=p(e)/t[0],s=J(e)/t[1];return Math.max(n,s)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(t/n)/Math.log(e);return function(n){const o=t/e**(n*s);return o}}getRotation(){return this.get(ne.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),n=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,o=Math.log(n/s)/t;return function(e){const s=Math.log(n/e)/t/o;return s}}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const t=this.padding_;return t&&(n=[n[0]-t[1]-t[3],n[1]-t[0]-t[2]]),n}getState(){const n=this.getProjection(),s=this.getResolution(),o=this.getRotation();let e=this.getCenterInternal();const t=this.padding_;if(t){const n=this.getViewportSizeMinusPadding_();e=Wr(e,this.getViewportSize_(),[n[0]/2+t[3],n[1]/2+t[0]],s,o)}return{center:e.slice(0),projection:n!==0[0]?n:null,resolution:s,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:o,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==0[0]&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let s=this.minZoom_||0,t,n;if(this.resolutions_){const o=yi(this.resolutions_,e,1);s=o,t=this.resolutions_[o],o==this.resolutions_.length-1?n=2:n=t/this.resolutions_[o+1]}else t=this.maxResolution_,n=this.zoomFactor_;return s+Math.log(t/e)/Math.log(n)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const t=w(Math.floor(e),0,this.resolutions_.length-2),n=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/n**w(e-t,0,1)}return this.maxResolution_/this.zoomFactor_**(e-this.minZoom_)}fit(e,t){let n;if(f(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){f(!pn(e),"Cannot fit empty extent provided as `geometry`");const t=qe(e,this.getProjection());n=Ql(t)}else if(e.getType()==="Circle"){const t=qe(e.getExtent(),this.getProjection());n=Ql(t),n.rotate(this.getRotation(),Ot(t))}else{const t=P3();t?n=e.clone().transform(t,this.getProjection()):n=e}this.fitInternal(n,t)}rotatedExtentForGeometry(e){const a=this.getRotation(),r=Math.cos(a),c=Math.sin(-a),t=e.getFlatCoordinates(),l=e.getStride();let n=1/0,s=1/0,o=-(1/0),i=-(1/0);for(let e=0,u=t.length;e<u;e+=l){const a=t[e]*r-t[e+1]*c,d=t[e]*c+t[e+1]*r;n=Math.min(n,a),s=Math.min(s,d),o=Math.max(o,a),i=Math.max(i,d)}return[n,s,o,i]}fitInternal(e,t){t=t||{};let a=t.size;a||(a=this.getViewportSizeMinusPadding_());const s=t.padding!==0[0]?t.padding:[0,0,0,0],m=t.nearest!==0[0]&&t.nearest;let i;t.minResolution!==0[0]?i=t.minResolution:t.maxZoom!==0[0]?i=this.getResolutionForZoom(t.maxZoom):i=0;const r=this.rotatedExtentForGeometry(e);let n=this.getResolutionForExtentInternal(r,[a[0]-s[1]-s[3],a[1]-s[0]-s[2]]);n=isNaN(n)?i:Math.max(n,i),n=this.getConstrainedResolution(n,m?0:1);const c=this.getRotation(),l=Math.sin(c),d=Math.cos(c),o=Ot(r);o[0]+=(s[1]-s[3])/2*n,o[1]+=(s[0]-s[2])/2*n;const f=o[0]*d-o[1]*l,p=o[1]*d+o[0]*l,u=this.getConstrainedCenter([f,p],n),h=t.callback?t.callback:Es;t.duration!==0[0]?this.animateInternal({resolution:n,center:u,duration:t.duration,easing:t.easing},h):(this.targetResolution_=n,this.targetCenter_=u,this.applyTargetState_(!1,!0),ys(h,!0))}centerOn(e,t,n){this.centerOnInternal(ge(e,this.getProjection()),t,n)}centerOnInternal(e,t,n){this.setCenterInternal(Wr(e,t,n,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,n,s){let i;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-n),r=Wr(e,s,[a[0]/2+o[3],a[1]/2+o[0]],t,n);i=[e[0]-r[0],e[1]-r[1]]}return i}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==0[0]}adjustCenter(e){const t=Hi(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&ge(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const n=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*e,0,s,n);t&&(this.targetCenter_=this.calculateCenterZoom(o,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(this.zoomFactor_**-e,t)}adjustRotation(e,t){t&&(t=ge(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const n=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+e,n);t&&(this.targetCenter_=this.calculateCenterRotate(s,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&ge(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const o=this.getAnimating()||this.getInteracting()||t,n=this.constraints_.rotation(this.targetRotation_,o),i=this.getViewportSize_(n),s=this.constraints_.resolution(this.targetResolution_,0,i,o),a=this.constraints_.center(this.targetCenter_,s,i,o,this.calculateCenterShift(this.targetCenter_,s,n,i));this.get(ne.ROTATION)!==n&&this.set(ne.ROTATION,n),this.get(ne.RESOLUTION)!==s&&(this.set(ne.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(ne.CENTER)||!io(this.get(ne.CENTER),a))&&this.set(ne.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=0[0]}resolveConstraints(e,t,n){e=e!==0[0]?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),i=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,r,i),a=this.constraints_.center(this.targetCenter_,o,i,!1,this.calculateCenterShift(this.targetCenter_,o,s,i));if(e===0&&!this.cancelAnchor_){this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=a,this.applyTargetState_();return}n=n||(e===0?this.cancelAnchor_:0[0]),this.cancelAnchor_=0[0],(this.getResolution()!==o||this.getRotation()!==s||!this.getCenterInternal()||!io(this.getCenterInternal(),a))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:a,resolution:o,duration:e,easing:Gt,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(X.INTERACTING,1)}endInteraction(e,t,n){n=n&&ge(n,this.getProjection()),this.endInteractionInternal(e,t,n)}endInteractionInternal(e,t,n){if(!this.getInteracting())return;this.setHint(X.INTERACTING,-1),this.resolveConstraints(e,t,n)}getConstrainedCenter(e,t){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),n)}getConstrainedZoom(e,t){const n=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(n,t))}getConstrainedResolution(e,t){t=t||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,n)}},se=Ml}}),Mt=e({"node_modules/ol/css.js"(){nn="ol-hidden",xt="ol-unselectable",Qr="ol-unsupported",tn="ol-control",Jr="ol-collapsed",U8=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i")}}),$t=e({"node_modules/ol/control/Control.js"(){da(),he(),ie(),K(),nl=class extends ve{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let e=0,t=this.listenerKeys.length;e<t;++e)_(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=e,e){const t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==Es&&this.listenerKeys.push(h(e,xe.POSTRENDER,this.render,this)),e.render()}}render(){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}},et=nl}}),Wc=e({"node_modules/ol/control/Attribution.js"(){ee(),Mt(),I(),y(),K(),$t(),tl=class extends et{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed===0[0]||e.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==0[0],this.collapsible_=e.collapsible===0[0]||e.collapsible,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==0[0]?e.className:"ol-attribution",i=e.tipLabel!==0[0]?e.tipLabel:"Attributions",r=e.expandClassName!==0[0]?e.expandClassName:t+"-expand",n=e.collapseLabel!==0[0]?e.collapseLabel:"›",c=e.collapseClassName!==0[0]?e.collapseClassName:t+"-collapse";typeof n=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n,this.collapseLabel_.className=c):this.collapseLabel_=n;const s=e.label!==0[0]?e.label:"i";typeof s=="string"?(this.label_=document.createElement("span"),this.label_.textContent=s,this.label_.className=r):this.label_=s;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(a.CLICK,this.handleClick_.bind(this),!1);const d=t+" "+xt+" "+tn+(this.collapsed_&&this.collapsible_?" "+Jr:"")+(this.collapsible_?"":" ol-uncollapsible"),o=this.element;o.className=d,o.appendChild(this.toggleButton_),o.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),t=new Set(n.flatMap(t=>t.getAttributions(e)));if(this.attributions_!==0[0]&&(Array.isArray(this.attributions_)?this.attributions_.forEach(e=>t.add(e)):t.add(this.attributions_)),!this.overrideCollapsible_){const e=!n.some(e=>e.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(e)}return Array.from(t)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(e=>Zh(()=>e))),n=t.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),vo(t,this.renderedAttributions_))return;yh(this.ulElement_);for(let e=0,s=t.length;e<s;++e){const n=document.createElement("li");n.innerHTML=t[e],this.ulElement_.appendChild(n)}this.renderedAttributions_=t}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Jr),this.collapsed_?Ts(this.collapseLabel_,this.label_):Ts(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){if(this.collapsible_===e)return;this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_()}setCollapsed(e){if(this.userCollapsed_=e,!this.collapsible_||this.collapsed_===e)return;this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}},Uc=tl}}),dc=e({"node_modules/ol/control/Rotate.js"(){Mt(),Me(),y(),$t(),Vc=class extends et{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const s=e.className!==0[0]?e.className:"ol-rotate",n=e.label!==0[0]?e.label:"⇧",o=e.compassClassName!==0[0]?e.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=o,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(o));const r=e.tipLabel?e.tipLabel:"Reset rotation",t=document.createElement("button");t.className=s+"-reset",t.setAttribute("type","button"),t.title=r,t.appendChild(this.label_),t.addEventListener(a.CLICK,this.handleClick_.bind(this),!1);const c=s+" "+xt+" "+tn,i=this.element;i.className=c,i.appendChild(t),this.callResetNorth_=e.resetNorth?e.resetNorth:0[0],this.duration_=e.duration!==0[0]?e.duration:250,this.autoHide_=e.autoHide===0[0]||e.autoHide,this.rotation_=0[0],this.autoHide_&&this.element.classList.add(nn)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==0[0]?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap(),e=n.getView();if(!e)return;const t=e.getRotation();t!==0[0]&&(this.duration_>0&&t%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:Gt}):e.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const t=n.viewState.rotation;if(t!=this.rotation_){const e="rotate("+t+"rad)";if(this.autoHide_){const e=this.element.classList.contains(nn);!e&&t===0?this.element.classList.add(nn):e&&t!==0&&this.element.classList.remove(nn)}this.label_.style.transform=e}this.rotation_=t}},lc=Vc}}),mc=e({"node_modules/ol/control/Zoom.js"(){Mt(),Me(),y(),$t(),Bc=class extends et{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const s=e.className!==0[0]?e.className:"ol-zoom",c=e.delta!==0[0]?e.delta:1,l=e.zoomInClassName!==0[0]?e.zoomInClassName:s+"-in",d=e.zoomOutClassName!==0[0]?e.zoomOutClassName:s+"-out",o=e.zoomInLabel!==0[0]?e.zoomInLabel:"+",i=e.zoomOutLabel!==0[0]?e.zoomOutLabel:"–",u=e.zoomInTipLabel!==0[0]?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==0[0]?e.zoomOutTipLabel:"Zoom out",t=document.createElement("button");t.className=l,t.setAttribute("type","button"),t.title=u,t.appendChild(typeof o=="string"?document.createTextNode(o):o),t.addEventListener(a.CLICK,this.handleClick_.bind(this,c),!1);const n=document.createElement("button");n.className=d,n.setAttribute("type","button"),n.title=h,n.appendChild(typeof i=="string"?document.createTextNode(i):i),n.addEventListener(a.CLICK,this.handleClick_.bind(this,-c),!1);const m=s+" "+xt+" "+tn,r=this.element;r.className=m,r.appendChild(t),r.appendChild(n),this.duration_=e.duration!==0[0]?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const s=this.getMap(),t=s.getView();if(!t)return;const n=t.getZoom();if(n!==0[0]){const s=t.getConstrainedZoom(n+e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:s,duration:this.duration_,easing:Gt})):t.setZoom(s)}}},hc=Bc}});function K8(e){e=e||{};const t=new fe,n=e.zoom===0[0]||e.zoom;n&&t.push(new hc(e.zoomOptions));const s=e.rotate===0[0]||e.rotate;s&&t.push(new lc(e.rotateOptions));const o=e.attribution===0[0]||e.attribution;return o&&t.push(new Uc(e.attributionOptions)),t}Pc=e({"node_modules/ol/control/defaults.js"(){wn(),Wc(),dc(),mc()}}),Tc=e({"node_modules/ol/Kinetic.js"(){Nc=class{constructor(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const o=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<o)return!1;let e=t-3;for(;e>0&&this.points_[e+2]>o;)e-=3;const i=this.points_[t+2]-this.points_[e+2];if(i<1e3/60)return!1;const n=this.points_[t]-this.points_[e],s=this.points_[t+1]-this.points_[e+1];return this.angle_=Math.atan2(s,n),this.initialVelocity_=(n*n+s*s)**.5/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},Dc=Nc}}),Sc=e({"node_modules/ol/interaction/Property.js"(){jc={ACTIVE:"active"}}});function N8(e,t,n){const s=e.getCenterInternal();if(s){const o=[s[0]+t[0],s[1]+t[1]];e.animateInternal({duration:n!==0[0]?n:250,easing:Ah,center:e.getConstrainedCenter(o)})}}function wc(e,t,n,s){const o=e.getZoom();if(o===0[0])return;const i=e.getConstrainedZoom(o+t),a=e.getResolutionForZoom(i);e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:a,anchor:n,duration:s!==0[0]?s:250,easing:Gt})}Xt=e({"node_modules/ol/interaction/Interaction.js"(){he(),Me(),Sc(),t2=class extends ve{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(jc.ACTIVE)}getMap(){return this.map_}handleEvent(){return!0}setActive(e){this.set(jc.ACTIVE,e)}setMap(e){this.map_=e}},Dt=t2}}),Ac=e({"node_modules/ol/interaction/DoubleClickZoom.js"(){Qt(),Xt(),Ec=class extends Dt{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==0[0]?e.duration:250}handleEvent(e){let t=!1;if(e.type==j.DBLCLICK){const n=e.originalEvent,s=e.map,o=e.coordinate,i=n.shiftKey?-this.delta_:this.delta_,a=s.getView();wc(a,i,o,this.duration_),n.preventDefault(),t=!0}return!t}},kc=Ec}});function yc(){const t=arguments;return function(e){let n=!0;for(let s=0,o=t.length;s<o;++s)if(n=n&&t[s](e),!n)break;return n}}Te=e({"node_modules/ol/events/condition.js"(){K(),Bt(),Mc=function(e){const t=e.originalEvent;return t.altKey&&!t.metaKey&&!t.ctrlKey&&t.shiftKey},Fc=function(e){const t=e.map.getTargetElement(),n=t.getRootNode(),s=e.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(s):t.contains(s)},bc=function(e){const t=e.map.getTargetElement(),n=t.getRootNode(),s=n instanceof ShadowRoot?n.host:t;return!s.hasAttribute("tabindex")||Fc(e)},zc=As,vc=function(e){const t=e.originalEvent;return"pointerId"in t&&t.button==0&&!(Y1&&Da&&t.ctrlKey)},gc=function(e){const t=e.originalEvent;return!t.altKey&&!t.metaKey&&!t.ctrlKey&&!t.shiftKey},Lc=function(e){const t=e.originalEvent;return Da?t.metaKey:t.ctrlKey},Rc=function(e){const t=e.originalEvent;return!t.altKey&&!t.metaKey&&!t.ctrlKey&&t.shiftKey},pc=function(e){const n=e.originalEvent,t=n.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!n.target.isContentEditable},ds=function(e){const t=e.originalEvent;return"pointerId"in t&&t.pointerType=="mouse"},Ic=function(e){const t=e.originalEvent;return"pointerId"in t&&t.isPrimary&&t.button===0}}});function cc(e){const t=e.length;let n=0,s=0;for(let o=0;o<t;o++)n+=e[o].clientX,s+=e[o].clientY;return{clientX:n/t,clientY:s/t}}Kt=e({"node_modules/ol/interaction/Pointer.js"(){Qt(),Xt(),$c=class extends Dt{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(){return!1}handleDragEvent(){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==j.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==j.POINTERUP){const t=this.handleUpEvent(e);this.handlingDownUpSequence=t&&this.targetPointers.length>0}}else if(e.type==j.POINTERDOWN){const n=this.handleDownEvent(e);this.handlingDownUpSequence=n,t=this.stopDown(n)}else e.type==j.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(){}handleUpEvent(){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}},qt=$c}}),Yc=e({"node_modules/ol/interaction/DragPan.js"(){It(),Me(),Te(),K(),Kt(),Kc=class extends qt{constructor(e){super({stopDown:ks}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:yc(gc,Ic);this.condition_=e.onFocusOnly?yc(bc,t):t,this.noKinetic_=!1}handleDragEvent(e){const s=e.map;this.panning_||(this.panning_=!0,s.getView().beginInteraction());const n=this.targetPointers,t=s.getEventPixel(cc(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(t[0],t[1]),this.lastCentroid){const n=[this.lastCentroid[0]-t[0],t[1]-this.lastCentroid[1]],o=e.map,s=o.getView();rh(n,s.getResolution()),ki(n,s.getRotation()),s.adjustCenterInternal(n)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=t,this.lastPointersCount_=n.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,t=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const e=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),i=t.getCenterInternal(),o=n.getPixelFromCoordinateInternal(i),a=n.getCoordinateFromPixelInternal([o[0]-e*Math.cos(s),o[1]-e*Math.sin(s)]);t.animateInternal({center:t.getConstrainedCenter(a),duration:500,easing:Gt})}return this.panning_&&(this.panning_=!1,t.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const n=e.map,t=n.getView();return this.lastCentroid=null,t.getAnimating()&&t.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},qc=Kc}}),Qc=e({"node_modules/ol/interaction/DragRotate.js"(){Te(),K(),Os(),Kt(),Gc=class extends qt{constructor(e){e=e||{},super({stopDown:ks}),this.condition_=e.condition?e.condition:Mc,this.lastAngle_=0[0],this.duration_=e.duration!==0[0]?e.duration:250}handleDragEvent(e){if(!ds(e))return;const t=e.map,n=t.getView();if(n.getConstraints().rotation===Dr)return;const s=t.getSize(),o=e.pixel,i=Math.atan2(s[1]/2-o[1],o[0]-s[0]/2);if(this.lastAngle_!==0[0]){const e=i-this.lastAngle_;n.adjustRotationInternal(-e)}this.lastAngle_=i}handleUpEvent(e){if(!ds(e))return!0;const t=e.map,n=t.getView();return n.endInteraction(this.duration_),!1}handleDownEvent(e){if(!ds(e))return!1;if(vc(e)&&this.condition_(e)){const t=e.map;return t.getView().beginInteraction(),this.lastAngle_=0[0],!0}return!1}},Xc=Gc}}),el=e({"node_modules/ol/render/Box.js"(){Xn(),kr(),Zc=class extends Gn{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,n="px",s=this.element_.style;s.left=Math.min(e[0],t[0])+n,s.top=Math.min(e[1],t[1])+n,s.width=Math.abs(t[0]-e[0])+n,s.height=Math.abs(t[1]-e[1])+n}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,n=this.endPixel_,s=[t,[t[0],n[1]],n,[n[0],t[1]]],e=s.map(this.map_.getCoordinateFromPixelInternal,this.map_);e[4]=e[0].slice(),this.geometry_?this.geometry_.setCoordinates([e]):this.geometry_=new ql([e])}getGeometry(){return this.geometry_}},Jc=Zc}}),il=e({"node_modules/ol/interaction/DragBox.js"(){Ce(),Te(),el(),Kt(),ht={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},Ft=class extends Oe{constructor(e,t,n){super(e),this.coordinate=t,this.mapBrowserEvent=n}},sl=class extends qt{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new Jc(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??vc,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,n){const s=n[0]-t[0],o=n[1]-t[1];return s*s+o*o>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){if(!this.startPixel_)return;this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Ft(ht.BOXDRAG,e.coordinate,e))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Ft(t?ht.BOXEND:ht.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return!!this.condition_(e)&&(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ft(ht.BOXSTART,e.coordinate,e)),!0)}onBoxEnd(){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ft(ht.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){const t=this.getMap();t&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ft(ht.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}},ol=sl}}),cl=e({"node_modules/ol/interaction/DragZoom.js"(){Me(),Te(),il(),al=class extends ol{constructor(e){e=e||{};const t=e.condition?e.condition:Rc;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==0[0]?e.duration:200,this.out_=e.out!==0[0]&&e.out}onBoxEnd(){const s=this.getMap(),n=s.getView();let t=this.getGeometry();if(this.out_){const s=n.rotatedExtentForGeometry(t),o=n.getResolutionForExtentInternal(s),e=n.getResolution()/o;t=t.clone(),t.scale(e*e)}n.fitInternal(t,{duration:this.duration_,easing:Gt})}},rl=al}}),dl=e({"node_modules/ol/events/Key.js"(){Ve={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"}}}),ml=e({"node_modules/ol/interaction/KeyboardPan.js"(){It(),y(),dl(),Te(),Xt(),ul=class extends Dt{constructor(e){super(),e=e||{},this.defaultCondition_=function(e){return gc(e)&&pc(e)},this.condition_=e.condition!==0[0]?e.condition:this.defaultCondition_,this.duration_=e.duration!==0[0]?e.duration:100,this.pixelDelta_=e.pixelDelta!==0[0]?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==a.KEYDOWN){const s=e.originalEvent,n=s.key;if(this.condition_(e)&&(n==Ve.DOWN||n==Ve.LEFT||n==Ve.RIGHT||n==Ve.UP)){const l=e.map,i=l.getView(),o=i.getResolution()*this.pixelDelta_;let a=0,r=0;n==Ve.DOWN?r=-o:n==Ve.LEFT?a=-o:n==Ve.RIGHT?a=o:r=o;const c=[a,r];ki(c,i.getRotation()),N8(i,c,this.duration_),s.preventDefault(),t=!0}}return!t}},hl=ul}}),gl=e({"node_modules/ol/interaction/KeyboardZoom.js"(){y(),Te(),Xt(),fl=class extends Dt{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(e){return!Lc(e)&&pc(e)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==0[0]?e.duration:100}handleEvent(e){let t=!1;if(e.type==a.KEYDOWN||e.type==a.KEYPRESS){const s=e.originalEvent,n=s.key;if(this.condition_(e)&&(n==="+"||n==="-")){const o=e.map,i=n==="+"?this.delta_:-this.delta_,a=o.getView();wc(a,i,0[0],this.duration_),s.preventDefault(),t=!0}}return!t}},pl=fl}}),_l=e({"node_modules/ol/interaction/MouseWheelZoom.js"(){y(),Te(),M(),Xt(),vl=40,bl=300,jl=class extends Dt{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==0[0]?e.maxDelta:1,this.duration_=e.duration!==0[0]?e.duration:250,this.timeout_=e.timeout!==0[0]?e.timeout:80,this.useAnchor_=e.useAnchor===0[0]||e.useAnchor,this.constrainResolution_=e.constrainResolution!==0[0]&&e.constrainResolution;const t=e.condition?e.condition:zc;this.condition_=e.onFocusOnly?yc(bc,t):t,this.lastAnchor_=null,this.startTime_=0[0],this.timeoutId_,this.mode_=0[0],this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=0[0];const e=this.getMap();if(!e)return;const t=e.getView();t.endInteraction(0[0],this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e))return!0;const r=e.type;if(r!==a.WHEEL)return!0;const o=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let t=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:t*=vl;break;case WheelEvent.DOM_DELTA_PAGE:t*=bl;break;default:}if(t===0)return!1;this.lastDelta_=t;const s=Date.now();this.startTime_===0[0]&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(t)<4?"trackpad":"wheel");const n=o.getView();if(this.mode_==="trackpad"&&!n.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(n.getAnimating()&&n.cancelAnimations(),n.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),n.adjustZoom(-t/this.deltaPerZoom_,this.lastAnchor_?o.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=s,!1;this.totalDelta_+=t;const c=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),c),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let n=-w(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),wc(t,n,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=0[0],this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=0[0],this.timeoutId_=0[0]}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}},yl=jl}}),xl=e({"node_modules/ol/interaction/PinchRotate.js"(){K(),Os(),Kt(),wl=class extends qt{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=ks),super(t),this.anchor_=null,this.lastAngle_=0[0],this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==0[0]?e.threshold:.3,this.duration_=e.duration!==0[0]?e.duration:250}handleDragEvent(e){let n=0;const s=this.targetPointers[0],o=this.targetPointers[1],i=Math.atan2(o.clientY-s.clientY,o.clientX-s.clientX);if(this.lastAngle_!==0[0]){const e=i-this.lastAngle_;this.rotationDelta_+=e,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=e}this.lastAngle_=i;const t=e.map,a=t.getView();if(a.getConstraints().rotation===Dr)return;this.anchor_=t.getCoordinateFromPixelInternal(t.getEventPixel(cc(this.targetPointers))),this.rotating_&&(t.render(),a.adjustRotationInternal(n,this.anchor_))}handleUpEvent(e){if(this.targetPointers.length<2){const t=e.map,n=t.getView();return n.endInteraction(this.duration_),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=0[0],this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}},Ol=wl}}),kl=e({"node_modules/ol/interaction/PinchZoom.js"(){K(),Kt(),Oc=class extends qt{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=ks),super(t),this.anchor_=null,this.duration_=e.duration!==0[0]?e.duration:400,this.lastDistance_=0[0],this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const s=this.targetPointers[0],o=this.targetPointers[1],i=s.clientX-o.clientX,a=s.clientY-o.clientY,r=(i*i+a*a)**.5;this.lastDistance_!==0[0]&&(t=this.lastDistance_/r),this.lastDistance_=r;const n=e.map,c=n.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=n.getCoordinateFromPixelInternal(n.getEventPixel(cc(this.targetPointers))),n.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const t=e.map,n=t.getView(),s=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,s),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=0[0],this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}},El=Oc}});function W8(e){e=e||{};const t=new fe,n=new Dc(-.005,.05,100),s=e.altShiftDragRotate===0[0]||e.altShiftDragRotate;s&&t.push(new Xc);const o=e.doubleClickZoom===0[0]||e.doubleClickZoom;o&&t.push(new kc({delta:e.zoomDelta,duration:e.zoomDuration}));const i=e.dragPan===0[0]||e.dragPan;i&&t.push(new qc({onFocusOnly:e.onFocusOnly,kinetic:n}));const a=e.pinchRotate===0[0]||e.pinchRotate;a&&t.push(new Ol);const r=e.pinchZoom===0[0]||e.pinchZoom;r&&t.push(new El({duration:e.zoomDuration}));const c=e.keyboard===0[0]||e.keyboard;c&&(t.push(new hl),t.push(new pl({delta:e.zoomDelta,duration:e.zoomDuration})));const l=e.mouseWheelZoom===0[0]||e.mouseWheelZoom;l&&t.push(new yl({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));const d=e.shiftDragZoom===0[0]||e.shiftDragZoom;return d&&t.push(new rl({duration:e.zoomDuration})),t}Sl=e({"node_modules/ol/interaction/defaults.js"(){wn(),Tc(),Ac(),Yc(),Qc(),cl(),ml(),gl(),_l(),xl(),kl()}}),$r=e({"node_modules/ol/layer/Property.js"(){m={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"}}}),Br=e({"node_modules/ol/layer/Base.js"(){he(),B(),M(),F(),$r(),Tl=class extends ve{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[m.OPACITY]=e.opacity!==0[0]?e.opacity:1,f(typeof t[m.OPACITY]=="number","Layer opacity must be a number"),t[m.VISIBLE]=e.visible===0[0]||e.visible,t[m.Z_INDEX]=e.zIndex,t[m.MAX_RESOLUTION]=e.maxResolution!==0[0]?e.maxResolution:1/0,t[m.MIN_RESOLUTION]=e.minResolution!==0[0]?e.minResolution:0,t[m.MIN_ZOOM]=e.minZoom!==0[0]?e.minZoom:-(1/0),t[m.MAX_ZOOM]=e.maxZoom!==0[0]?e.maxZoom:1/0,this.className_=t.className!==0[0]?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===0[0]||e},n=this.getZIndex();return t.opacity=w(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=n===0[0]&&!t.managed?1/0:n,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(){return d()}getLayerStatesArray(){return d()}getExtent(){return this.get(m.EXTENT)}getMaxResolution(){return this.get(m.MAX_RESOLUTION)}getMinResolution(){return this.get(m.MIN_RESOLUTION)}getMinZoom(){return this.get(m.MIN_ZOOM)}getMaxZoom(){return this.get(m.MAX_ZOOM)}getOpacity(){return this.get(m.OPACITY)}getSourceState(){return d()}getVisible(){return this.get(m.VISIBLE)}getZIndex(){return this.get(m.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(m.EXTENT,e)}setMaxResolution(e){this.set(m.MAX_RESOLUTION,e)}setMinResolution(e){this.set(m.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(m.MAX_ZOOM,e)}setMinZoom(e){this.set(m.MIN_ZOOM,e)}setOpacity(e){f(typeof e=="number","Layer opacity must be a number"),this.set(m.OPACITY,e)}setVisible(e){this.set(m.VISIBLE,e)}setZIndex(e){this.set(m.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},Vr=Tl}}),Hl=e({"node_modules/ol/layer/Group.js"(){wn(),oo(),Mn(),B(),Ce(),y(),ie(),b(),dt(),F(),Br(),we=class extends Oe{constructor(e,t){super(e),this.layer=t}},xs={LAYERS:"layers"},Rl=class _LayerGroup extends Vr{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let t=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(xs.LAYERS,this.handleLayersChanged_),t?Array.isArray(t)?t=new fe(t.slice(),{unique:!0}):f(typeof t.getArray=="function","Expected `layers` to be an array or a `Collection`"):t=new fe(0[0],{unique:!0}),this.setLayers(t)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(_),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(h(e,Q.ADD,this.handleLayersAdd_,this),h(e,Q.REMOVE,this.handleLayersRemove_,this));for(const e in this.listenerKeys_)this.listenerKeys_[e].forEach(_);vs(this.listenerKeys_);const t=e.getArray();for(let e=0,s=t.length;e<s;e++){const n=t[e];this.registerLayerListeners_(n),this.dispatchEvent(new we("addlayer",n))}this.changed()}registerLayerListeners_(e){const t=[h(e,Vt.PROPERTYCHANGE,this.handleLayerChange_,this),h(e,a.CHANGE,this.handleLayerChange_,this)];e instanceof _LayerGroup&&t.push(h(e,"addlayer",this.handleLayerGroupAdd_,this),h(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[z(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new we("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new we("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new we("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,n=z(t);this.listenerKeys_[n].forEach(_),delete this.listenerKeys_[n],this.dispatchEvent(new we("removelayer",t)),this.changed()}getLayers(){return this.get(xs.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const e=t.getArray();for(let t=0,n=e.length;t<n;++t)this.dispatchEvent(new we("removelayer",e[t]))}this.set(xs.LAYERS,e)}getLayersArray(e){return e=e!==0[0]?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==0[0]?e:[],o=n.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(n)});const t=this.getLayerState();let s=t.zIndex;!e&&t.zIndex===0[0]&&(s=0);for(let i=o,a=n.length;i<a;i++){const e=n[i];e.opacity*=t.opacity,e.visible=e.visible&&t.visible,e.maxResolution=Math.min(e.maxResolution,t.maxResolution),e.minResolution=Math.max(e.minResolution,t.minResolution),e.minZoom=Math.max(e.minZoom,t.minZoom),e.maxZoom=Math.min(e.maxZoom,t.maxZoom),t.extent!==0[0]&&(e.extent!==0[0]?e.extent=ot(e.extent,t.extent):e.extent=t.extent),e.zIndex===0[0]&&(e.zIndex=s)}return n}getSourceState(){return"ready"}},sn=Rl}}),an=e({"node_modules/ol/render/EventType.js"(){ce={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"}}});function Tr(e,t){if(!e.visible)return!1;const n=t.resolution;if(n<e.minResolution||n>=e.maxResolution)return!1;const s=t.zoom;return s>e.minZoom&&s<=e.maxZoom}yt=e({"node_modules/ol/layer/Layer.js"(){ps(),B(),y(),ie(),b(),an(),Br(),$r(),$l=class extends Vr{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(m.SOURCE,this.handleSourcePropertyChange_);const n=e.source?e.source:null;this.setSource(n)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(m.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){if(this.changed(),this.sourceReady_||this.getSource().getState()!=="ready")return;this.sourceReady_=!0,this.dispatchEvent("sourceready")}handleSourcePropertyChange_(){this.sourceChangeKey_&&(_(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=h(e,a.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const n=this.getMapInternal();!e&&n&&(e=n.getView()),e instanceof se?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&n&&(t.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let s;if(t.layerStatesArray){if(s=t.layerStatesArray.find(e=>e.layer===this),!s)return!1}else s=this.getLayerState();const o=this.getExtent();return Tr(s,t.viewState)&&(!o||fn(o,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];const n=this.getSource()?.getAttributions();if(!n)return[];const s=e instanceof se?e.getViewStateAndExtent():e;let t=n(s);return Array.isArray(t)||(t=[t]),t}render(e,t){const n=this.getRenderer();return n.prepareFrame(e)?(this.rendered=!0,n.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(){}renderDeferred(e){const t=this.getRenderer();if(!t)return;t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(m.MAP,e)}getMapInternal(){return this.get(m.MAP)}setMap(e){this.mapPrecomposeKey_&&(_(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(_(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=h(e,ce.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=h(this,a.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,n=this.getLayerState(!1);f(!t.some(e=>e.layer===n.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(n)}setSource(e){this.set(m.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}},rn=$l}});function Kl(e,t,n=0,s=e.length-1,o=E8){for(;s>n;){if(s-n>600){const i=s-n+1,r=t-n+1,c=Math.log(i),a=.5*Math.exp(2*c/3),l=.5*(c*a*(i-a)/i)**.5*(r-i/2<0?-1:1),d=Math.max(n,Math.floor(t-r*a/i+l)),u=Math.min(s,Math.floor(t+(i-r)*a/i+l));Kl(e,t,d,u,o)}const r=e[t];let a=n,i=s;for(cn(e,n,t),o(e[s],r)>0&&cn(e,n,s);a<i;){for(cn(e,a,i),a++,i--;o(e[a],r)<0;)a++;for(;o(e[i],r)>0;)i--}o(e[n],r)===0?cn(e,n,i):(i++,cn(e,i,s)),i<=t&&(n=i+1),t<=i&&(s=i-1)}}function cn(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function E8(e,t){return e<t?-1:e>t?1:0}Gl=e({"node_modules/quickselect/index.js"(){}});function C8(e,t,n){if(!n)return t.indexOf(e);for(let s=0;s<t.length;s++)if(n(e,t[s]))return s;return-1}function bt(e,t){ln(e,0,e.children.length,t,e)}function ln(e,t,n,s,o){o||(o=gt(null)),o.minX=1/0,o.minY=1/0,o.maxX=-(1/0),o.maxY=-(1/0);for(let i=t;i<n;i++){const a=e.children[i];dn(o,e.leaf?s(a):a)}return o}function dn(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function x8(e,t){return e.minX-t.minX}function O8(e,t){return e.minY-t.minY}function _r(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function zs(e){return e.maxX-e.minX+(e.maxY-e.minY)}function b8(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function v8(e,t){const n=Math.max(e.minX,t.minX),s=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,i-s)}function jr(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function Ds(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function gt(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)}}function ld(e,t,n,s,o){const i=[t,n];for(;i.length;){if(n=i.pop(),t=i.pop(),n-t<=s)continue;const a=t+Math.ceil((n-t)/s/2)*s;Kl(e,a,t,n,o),i.push(t,a,a,n)}}ud=e({"node_modules/rbush/index.js"(){Gl(),dd=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!Ds(e,t))return n;const o=this.toBBox,s=[];for(;t;){for(let a=0;a<t.children.length;a++){const i=t.children[a],r=t.leaf?o(i):i;Ds(e,r)&&(t.leaf?n.push(i):jr(e,r)?this._all(i,n):s.push(i))}t=s.pop()}return n}collides(e){let t=this.data;if(!Ds(e,t))return!1;const n=[];for(;t;){for(let s=0;s<t.children.length;s++){const o=t.children[s],i=t.leaf?this.toBBox(o):o;if(Ds(e,i)){if(t.leaf||jr(e,i))return!0;n.push(o)}}t=n.pop()}return!1}load(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}else this.data=t;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=gt([]),this}remove(e,t){if(!e)return this;let n=this.data;const c=this.toBBox(e),s=[],r=[];let o,i,a;for(;n||s.length;){if(n||(n=s.pop(),i=s[s.length-1],o=r.pop(),a=!0),n.leaf){const o=C8(e,n.children,t);if(o!==-1)return n.children.splice(o,1),s.push(n),this._condense(s),this}!a&&!n.leaf&&jr(n,c)?(s.push(n),r.push(o),o=0,i=n,n=n.children[0]):i?(o++,n=i.children[o],a=!1):n=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,s){const a=n-t+1;let i=this._maxEntries,o;if(a<=i)return o=gt(e.slice(t,n+1)),bt(o,this.toBBox),o;s||(s=Math.ceil(Math.log(a)/Math.log(i)),i=Math.ceil(a/i**(s-1))),o=gt([]),o.leaf=!1,o.height=s;const r=Math.ceil(a/i),c=r*Math.ceil(i**.5);ld(e,t,n,c,this.compareMinX);for(let i=t;i<=n;i+=c){const a=Math.min(i+c-1,n);ld(e,i,a,r,this.compareMinY);for(let t=i;t<=a;t+=r){const n=Math.min(t+r-1,a);o.children.push(this._build(e,t,n,s-1))}}return bt(o,this.toBBox),o}_chooseSubtree(e,t,n,s){for(;!0;){if(s.push(t),t.leaf||s.length-1===n)break;let o=1/0,i=1/0,a;for(let r=0;r<t.children.length;r++){const s=t.children[r],n=_r(s),c=b8(e,s)-n;c<i?(i=c,o=n<o?n:o,a=s):c===i&&n<o&&(o=n,a=s)}t=a||t.children[0]}return t}_insert(e,t,n){const o=n?e:this.toBBox(e),s=[],i=this._chooseSubtree(o,this.data,t,s);for(i.children.push(e),dn(i,o);t>=0;)if(s[t].children.length>this._maxEntries)this._split(s,t),t--;else break;this._adjustParentBBoxes(o,s,t)}_split(e,t){const n=e[t],o=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,o);const a=this._chooseSplitIndex(n,i,o),s=gt(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,bt(n,this.toBBox),bt(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)}_splitRoot(e,t){this.data=gt([e,t]),this.data.height=e.height+1,this.data.leaf=!1,bt(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let o,i=1/0,s=1/0;for(let a=t;a<=n-t;a++){const l=ln(e,0,a,this.toBBox),d=ln(e,a,n,this.toBBox),c=v8(l,d),r=_r(l)+_r(d);c<i?(i=c,o=a,s=r<s?r:s):c===i&&r<s&&(s=r,o=a)}return o||n-t}_chooseSplitAxis(e,t,n){const s=e.leaf?this.compareMinX:x8,o=e.leaf?this.compareMinY:O8,i=this._allDistMargin(e,t,n,s),a=this._allDistMargin(e,t,n,o);i<a&&e.children.sort(s)}_allDistMargin(e,t,n,s){e.children.sort(s);const o=this.toBBox,i=ln(e,0,t,o),a=ln(e,n-t,n,o);let r=zs(i)+zs(a);for(let s=t;s<n-t;s++){const a=e.children[s];dn(i,e.leaf?o(a):a),r+=zs(i)}for(let s=n-t-1;s>=t;s--){const i=e.children[s];dn(a,e.leaf?o(i):i),r+=zs(a)}return r}_adjustParentBBoxes(e,t,n){for(let s=n;s>=0;s--)dn(t[s],e)}_condense(e){for(let t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():bt(e[t],this.toBBox)}}}});function f8(){return nr||(nr=L(1,1,0[0],{willReadFrequently:!0,desynchronized:!0})),nr}function Ls(e,t){return e.endsWith("%")?Number(e.substring(0,e.length-1))/t:Number(e)}function un(e){throw new Error('failed to parse "'+e+'" as color')}function pd(e){if(e.toLowerCase().startsWith("rgb")){const t=e.match(Md)||e.match(Sd)||e.match(Fd);if(t){const n=t[4],e=100/255;return[w(Ls(t[1],e)+.5|0,0,255),w(Ls(t[2],e)+.5|0,0,255),w(Ls(t[3],e)+.5|0,0,255),n!==0[0]?w(Ls(n,100),0,1):1]}un(e)}if(e.startsWith("#")){if(Td.test(e)){const s=e.substring(1),t=s.length<=4?1:2,n=[0,0,0,255];for(let e=0,i=s.length;e<i;e+=t){let o=parseInt(s.substring(e,e+t),16);t===1&&(o+=o<<4),n[e/t]=o}return n[3]=n[3]/255,n}un(e)}const t=f8();t.fillStyle="#abcdef";let n=t.fillStyle;t.fillStyle=e,t.fillStyle===n&&(t.fillStyle="#fedcba",n=t.fillStyle,t.fillStyle=e,t.fillStyle===n&&un(e));const s=t.fillStyle;if(s.startsWith("#")||s.startsWith("rgba"))return pd(s);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const o=Array.from(t.getImageData(0,0,1,1).data);return o[3]=_i(o[3]/255,3),o}function u8(e){return typeof e=="string"?e:ir(e)}function o8(e){if(e.length===4)return e;const t=e.slice();return t[3]=1,t}function fr(e){return e>.0031308?e**(1/2.4)*269.025-14.025:e*3294.6}function mr(e){return e>.2068965?e**3:(e-4/29)*(108/841)}function hr(e){return e>10.314724?((e+14.025)/269.025)**2.4:e/3294.6}function dr(e){return e>.0088564?e**(1/3):e/(108/841)+4/29}function wd(e){const t=hr(e[0]),n=hr(e[1]),s=hr(e[2]),o=dr(t*.222488403+n*.716873169+s*.06060791),i=500*(dr(t*.452247074+n*.399439023+s*.148375274)-o),a=200*(o-dr(t*.016863605+n*.117638439+s*.865350722)),r=Math.atan2(a,i)*(180/Math.PI);return[116*o-16,(i*i+a*a)**.5,r<0?r+360:r,e[3]]}function s8(e){const t=(e[0]+16)/116,i=e[1],a=e[2]*Math.PI/180,n=mr(t),s=mr(t+i/500*Math.cos(a)),o=mr(t-i/200*Math.sin(a)),r=fr(s*3.021973625-n*1.617392459-o*.404875592),c=fr(s*-.943766287+n*1.916279586+o*.027607165),l=fr(s*.069407491-n*.22898585+o*1.159737864);return[w(r+.5|0,0,255),w(c+.5|0,0,255),w(l+.5|0,0,255),e[3]]}function cr(e){if(e==="none")return Hs;if(jt.hasOwnProperty(e))return jt[e];if(Bs>=zd){let e=0;for(const t in jt)(e++&3)===0&&(delete jt[t],--Bs)}const t=pd(e);t.length!==4&&un(e);for(const n of t)isNaN(n)&&un(e);return jt[e]=t,++Bs,t}function pt(e){return Array.isArray(e)?e:cr(e)}function ir(e){let t=e[0];t!=(t|0)&&(t=t+.5|0);let n=e[1];n!=(n|0)&&(n=n+.5|0);let s=e[2];s!=(s|0)&&(s=s+.5|0);const o=e[3]===0[0]?1:Math.round(e[3]*1e3)/1e3;return"rgba("+t+","+n+","+s+","+o+")"}le=e({"node_modules/ol/color.js"(){I(),M(),Hs=[NaN,NaN,NaN,0],Sd=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Md=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Fd=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Td=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i,zd=1024,jt={},Bs=0}});function Ym(e){return e in Xs}function hn(e){const t=[];for(const n of vu)mn(e,n)&&t.push(Xs[n]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function mn(e,t){return(e&t)===t}function Ne(e,t){return e===t}function Bd(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function T(e,t,n){switch(typeof e){case"boolean":{if(Ne(t,R))return new C(R,e?"true":"false");if(!mn(t,D))throw new Error(`got a boolean, but expected ${hn(t)}`);return new C(D,e)}case"number":{if(Ne(t,St))return new C(St,P(e));if(Ne(t,D))return new C(D,!!e);if(Ne(t,R))return new C(R,e.toString());if(!mn(t,c))throw new Error(`got a number, but expected ${hn(t)}`);return new C(c,e)}case"string":{if(Ne(t,te))return new C(te,cr(e));if(Ne(t,D))return new C(D,!!e);if(!mn(t,R))throw new Error(`got a string, but expected ${hn(t)}`);return new C(R,e)}default:}if(!Array.isArray(e))throw new Error("expression must be an array or a primitive value");if(e.length===0)throw new Error("empty expression");if(typeof e[0]=="string")return Mm(e,t,n);for(const t of e)if(typeof t!="number")throw new Error("expected an array of numbers");if(Ne(t,St)){if(e.length!==2)throw new Error(`expected an array of two values for a size, got ${e.length}`);return new C(St,e)}if(Ne(t,te)){if(e.length===3)return new C(te,[...e,1]);if(e.length===4)return new C(te,e);throw new Error(`expected an array of 3 or 4 values for a color, got ${e.length}`)}if(!mn(t,Ie))throw new Error(`got an array of numbers, but expected ${hn(t)}`);return new C(Ie,e)}function $d(e,t,n){const o=e.length-1,s=new Array(o);for(let t=0;t<o;++t){const i=e[t+1];switch(typeof i){case"number":{s[t]=new C(c,i);break}case"string":{s[t]=new C(R,i);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${i}`)}t===0&&n.properties.add(String(i))}return s}function Wm(e,t,n){const s=e[1];if(typeof s!="string")throw new Error("expected a string argument for var operation");return n.variables.add(s),[new C(R,s)]}function $m(e,t,n){n.featureId=!0}function Vm(e,t,n){n.geometryType=!0}function Ka(e,t,n){n.mapState=!0}function ft(e){const s=e[0];if(e.length!==1)throw new Error(`expected no arguments for ${s} operation`);return[]}function i(e,t){return function(n){const a=n[0],i=n.length-1;if(e===t){if(i!==e){const t=e===1?"":"s";throw new Error(`expected ${e} argument${t} for ${a}, got ${i}`)}}else if(i<e||i>t){const n=t===1/0?`${e} or more`:`${e} to ${t}`;throw new Error(`expected ${n} arguments for ${a}, got ${i}`)}}}function Xd(e,t,n){const s=e.length-1,o=new Array(s);for(let i=0;i<s;++i){const a=T(e[i+1],t,n);o[i]=a}return o}function u(e){return function(t,n,s){const o=t.length-1,i=new Array(o);for(let n=0;n<o;++n){const a=T(t[n+1],e,s);i[n]=a}return i}}function Hm(e){const o=e[0],s=e.length-1;if(s%2===0)throw new Error(`expected an odd number of arguments for ${o}, got ${s} instead`)}function Jd(e){const o=e[0],s=e.length-1;if(s%2===1)throw new Error(`expected an even number of arguments for operation ${o}, got ${s} instead`)}function Pm(e,t,n){const o=e.length-1,r=R|c|D,i=T(e[1],r,n),a=T(e[e.length-1],t,n),s=new Array(o-2);for(let t=0;t<o-2;t+=2){try{const o=T(e[t+2],i.type,n);s[t]=o}catch(e){throw new Error(`failed to parse argument ${t+1} of match expression: ${e.message}`)}try{const o=T(e[t+3],a.type,n);s[t+1]=o}catch(e){throw new Error(`failed to parse argument ${t+2} of match expression: ${e.message}`)}}return[i,...s,a]}function Nm(e,t,n){const o=e[1];let i;switch(o[0]){case"linear":i=1;break;case"exponential":const e=o[1];if(typeof e!="number"||e<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(e)} instead`);i=e;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(o)}`)}const r=new C(c,i);let a;try{a=T(e[2],c,n)}catch(e){throw new Error(`failed to parse argument 1 in interpolate expression: ${e.message}`)}const s=new Array(e.length-3);for(let o=0;o<s.length;o+=2){try{const t=T(e[o+3],c,n);s[o]=t}catch(e){throw new Error(`failed to parse argument ${o+2} for interpolate expression: ${e.message}`)}try{const i=T(e[o+4],t,n);s[o+1]=i}catch(e){throw new Error(`failed to parse argument ${o+3} for interpolate expression: ${e.message}`)}}return[r,a,...s]}function Dm(e,t,n){const o=T(e[e.length-1],t,n),s=new Array(e.length-1);for(let t=0;t<s.length-1;t+=2){try{const o=T(e[t+1],D,n);s[t]=o}catch(e){throw new Error(`failed to parse argument ${t} of case expression: ${e.message}`)}try{const i=T(e[t+2],o.type,n);s[t+1]=i}catch(e){throw new Error(`failed to parse argument ${t+1} of case expression: ${e.message}`)}}return s[s.length-1]=o,s}function zm(e,t,n){let s=e[2];if(!Array.isArray(s))throw new Error(`the second argument for the "in" operator must be an array`);let o;if(typeof s[0]=="string"){if(s[0]!=="literal")throw new Error(`for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions`);if(!Array.isArray(s[1]))throw new Error(`failed to parse "in" expression: the literal operator must be followed by an array`);s=s[1],o=R}else o=c;const i=new Array(s.length);for(let e=0;e<i.length;e++)try{const t=T(s[e],o,n);i[e]=t}catch(t){throw new Error(`failed to parse haystack item ${e} for "in" expression: ${t.message}`)}const a=T(e[1],o,n);return[a,...i]}function Tm(e,t,n){let i;try{i=T(e[1],c,n)}catch(e){throw new Error(`failed to parse first argument in palette expression: ${e.message}`)}const s=e[2];if(!Array.isArray(s))throw new Error("the second argument of palette must be an array");const o=new Array(s.length);for(let e=0;e<o.length;e++){let t;try{t=T(s[e],te,n)}catch(t){throw new Error(`failed to parse color at index ${e} in palette expression: ${t.message}`)}if(!(t instanceof C))throw new Error(`the palette color at index ${e} must be a literal value`);o[e]=t}return[i,...o]}function o(...e){return function(t,n,s){const i=t[0];let o;for(let i=0;i<e.length;i++){const a=e[i](t,n,s);if(i==e.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");o=a}}return new ju(n,i,...o)}}function Mm(e,t,n){const s=e[0],o=_u[s];if(!o)throw new Error(`unknown operator: ${s}`);return o(e,t,n)}function ru(e){if(!e)return"";const t=e.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return ru(e.getGeometries()[0]);default:return""}}Ca=e({"node_modules/ol/expr/expression.js"(){ee(),le(),ae(),Le=0,D=1<<Le++,c=1<<Le++,R=1<<Le++,te=1<<Le++,Ie=1<<Le++,St=1<<Le++,gn=2**Le-1,Xs={[D]:"boolean",[c]:"number",[R]:"string",[te]:"color",[Ie]:"number[]",[St]:"size"},vu=Object.keys(Xs).map(Number).sort(go),C=class{constructor(e,t){if(!Ym(e))throw new Error(`literal expressions must have a specific type, got ${hn(e)}`);this.type=e,this.value=t}},ju=class{constructor(e,t,...n){this.type=e,this.operator=t,this.args=n}},t={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},_u={[t.Get]:o(i(1,1/0),$d),[t.Var]:o(i(1,1),Wm),[t.Has]:o(i(1,1/0),$d),[t.Id]:o($m,ft),[t.Concat]:o(i(2,1/0),u(R)),[t.GeometryType]:o(Vm,ft),[t.LineMetric]:o(ft),[t.Resolution]:o(Ka,ft),[t.Zoom]:o(Ka,ft),[t.Time]:o(Ka,ft),[t.Any]:o(i(2,1/0),u(D)),[t.All]:o(i(2,1/0),u(D)),[t.Not]:o(i(1,1),u(D)),[t.Equal]:o(i(2,2),u(gn)),[t.NotEqual]:o(i(2,2),u(gn)),[t.GreaterThan]:o(i(2,2),u(c)),[t.GreaterThanOrEqualTo]:o(i(2,2),u(c)),[t.LessThan]:o(i(2,2),u(c)),[t.LessThanOrEqualTo]:o(i(2,2),u(c)),[t.Multiply]:o(i(2,1/0),Xd),[t.Coalesce]:o(i(2,1/0),Xd),[t.Divide]:o(i(2,2),u(c)),[t.Add]:o(i(2,1/0),u(c)),[t.Subtract]:o(i(2,2),u(c)),[t.Clamp]:o(i(3,3),u(c)),[t.Mod]:o(i(2,2),u(c)),[t.Pow]:o(i(2,2),u(c)),[t.Abs]:o(i(1,1),u(c)),[t.Floor]:o(i(1,1),u(c)),[t.Ceil]:o(i(1,1),u(c)),[t.Round]:o(i(1,1),u(c)),[t.Sin]:o(i(1,1),u(c)),[t.Cos]:o(i(1,1),u(c)),[t.Atan]:o(i(1,2),u(c)),[t.Sqrt]:o(i(1,1),u(c)),[t.Match]:o(i(4,1/0),Jd,Pm),[t.Between]:o(i(3,3),u(c)),[t.Interpolate]:o(i(6,1/0),Jd,Nm),[t.Case]:o(i(3,1/0),Hm,Dm),[t.In]:o(i(2,2),zm),[t.Number]:o(i(1,1/0),u(gn)),[t.String]:o(i(1,1/0),u(gn)),[t.Array]:o(i(1,1/0),u(c)),[t.Color]:o(i(1,4),u(c)),[t.Band]:o(i(1,3),u(c)),[t.Palette]:o(i(2,2),Tm),[t.ToString]:o(i(1,1),u(D|c|R|te))}}});function Ou(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function je(e,t,n){const s=T(e,t,n);return de(s,n)}function de(e,n){if(e instanceof C){if(e.type===te&&typeof e.value=="string"){const t=cr(e.value);return function(){return t}}return function(){return e.value}}const s=e.operator;switch(s){case t.Number:case t.String:case t.Coalesce:return _m(e,n);case t.Get:case t.Var:case t.Has:return ym(e,n);case t.Id:return e=>e.featureId;case t.GeometryType:return e=>e.geometryType;case t.Concat:{const t=e.args.map(e=>de(e,n));return e=>"".concat(...t.map(t=>t(e).toString()))}case t.Resolution:return e=>e.resolution;case t.Any:case t.All:case t.Between:case t.In:case t.Not:return vm(e,n);case t.Equal:case t.NotEqual:case t.LessThan:case t.LessThanOrEqualTo:case t.GreaterThan:case t.GreaterThanOrEqualTo:return jm(e,n);case t.Multiply:case t.Divide:case t.Add:case t.Subtract:case t.Clamp:case t.Mod:case t.Pow:case t.Abs:case t.Floor:case t.Ceil:case t.Round:case t.Sin:case t.Cos:case t.Atan:case t.Sqrt:return gm(e,n);case t.Case:return pm(e,n);case t.Match:return fm(e,n);case t.Interpolate:return mm(e,n);case t.ToString:return c3(e,n);default:throw new Error(`Unsupported operator ${s}`)}}function _m(e,n){const s=e.operator,o=e.args.length,i=new Array(o);for(let t=0;t<o;++t)i[t]=de(e.args[t],n);switch(s){case t.Coalesce:return e=>{for(let t=0;t<o;++t){const n=i[t](e);if(typeof n!="undefined"&&n!==null)return n}throw new Error("Expected one of the values to be non-null")};case t.Number:case t.String:return e=>{for(let t=0;t<o;++t){const n=i[t](e);if(typeof n===s)return n}throw new Error(`Expected one of the values to be a ${s}`)};default:throw new Error(`Unsupported assertion operator ${s}`)}}function ym(e){const o=e.args[0],s=o.value;switch(e.operator){case t.Get:return t=>{const o=e.args;let n=t.properties[s];for(let e=1,t=o.length;e<t;++e){const s=o[e],i=s.value;n=n[i]}return n};case t.Var:return e=>e.variables[s];case t.Has:return t=>{const o=e.args;if(!(s in t.properties))return!1;let n=t.properties[s];for(let e=1,s=o.length;e<s;++e){const i=o[e],t=i.value;if(!n||!Object.hasOwn(n,t))return!1;n=n[t]}return!0};default:throw new Error(`Unsupported accessor operator ${e.operator}`)}}function jm(e,n){const i=e.operator,s=de(e.args[0],n),o=de(e.args[1],n);switch(i){case t.Equal:return e=>s(e)===o(e);case t.NotEqual:return e=>s(e)!==o(e);case t.LessThan:return e=>s(e)<o(e);case t.LessThanOrEqualTo:return e=>s(e)<=o(e);case t.GreaterThan:return e=>s(e)>o(e);case t.GreaterThanOrEqualTo:return e=>s(e)>=o(e);default:throw new Error(`Unsupported comparison operator ${i}`)}}function vm(e,n){const i=e.operator,o=e.args.length,s=new Array(o);for(let t=0;t<o;++t)s[t]=de(e.args[t],n);switch(i){case t.Any:return e=>{for(let t=0;t<o;++t)if(s[t](e))return!0;return!1};case t.All:return e=>{for(let t=0;t<o;++t)if(!s[t](e))return!1;return!0};case t.Between:return e=>{const t=s[0](e),n=s[1](e),o=s[2](e);return t>=n&&t<=o};case t.In:return e=>{const t=s[0](e);for(let n=1;n<o;++n)if(t===s[n](e))return!0;return!1};case t.Not:return e=>!s[0](e);default:throw new Error(`Unsupported logical operator ${i}`)}}function gm(e,n){const i=e.operator,o=e.args.length,s=new Array(o);for(let t=0;t<o;++t)s[t]=de(e.args[t],n);switch(i){case t.Multiply:return e=>{let t=1;for(let n=0;n<o;++n)t*=s[n](e);return t};case t.Divide:return e=>s[0](e)/s[1](e);case t.Add:return e=>{let t=0;for(let n=0;n<o;++n)t+=s[n](e);return t};case t.Subtract:return e=>s[0](e)-s[1](e);case t.Clamp:return e=>{const t=s[0](e),n=s[1](e);if(t<n)return n;const o=s[2](e);return t>o?o:t};case t.Mod:return e=>s[0](e)%s[1](e);case t.Pow:return e=>s[0](e)**s[1](e);case t.Abs:return e=>Math.abs(s[0](e));case t.Floor:return e=>Math.floor(s[0](e));case t.Ceil:return e=>Math.ceil(s[0](e));case t.Round:return e=>Math.round(s[0](e));case t.Sin:return e=>Math.sin(s[0](e));case t.Cos:return e=>Math.cos(s[0](e));case t.Atan:return o===2?e=>Math.atan2(s[0](e),s[1](e)):e=>Math.atan(s[0](e));case t.Sqrt:return e=>s[0](e)**.5;default:throw new Error(`Unsupported numeric operator ${i}`)}}function pm(e,t){const n=e.args.length,s=new Array(n);for(let o=0;o<n;++o)s[o]=de(e.args[o],t);return e=>{for(let t=0;t<n-1;t+=2){const o=s[t](e);if(o)return s[t+1](e)}return s[n-1](e)}}function fm(e,t){const s=e.args.length,n=new Array(s);for(let o=0;o<s;++o)n[o]=de(e.args[o],t);return e=>{const t=n[0](e);for(let o=1;o<s-1;o+=2)if(t===n[o](e))return n[o+1](e);return n[s-1](e)}}function mm(e,t){const s=e.args.length,n=new Array(s);for(let o=0;o<s;++o)n[o]=de(e.args[o],t);return e=>{const a=n[0](e),o=n[1](e);let i,t;for(let c=2;c<s;c+=2){const l=n[c](e);let r=n[c+1](e);const d=Array.isArray(r);if(d&&(r=o8(r)),l>=o)return c===2?r:d?im(a,o,i,t,l,r):vn(a,o,i,t,l,r);i=l,t=r}return t}}function c3(e,n){const s=e.operator,o=e.args.length,i=new Array(o);for(let t=0;t<o;++t)i[t]=de(e.args[t],n);switch(s){case t.ToString:return t=>{const n=i[0](t);return e.args[0].type===te?ir(n):n.toString()};default:throw new Error(`Unsupported convert operator ${s}`)}}function vn(e,t,n,s,o,i){const a=o-n;if(a===0)return s;const r=t-n,c=e===1?r/a:(e**r-1)/(e**a-1);return s+c*(i-s)}function im(e,t,n,s,o,i){const l=o-n;if(l===0)return s;const r=wd(s),c=wd(i);let a=c[2]-r[2];a>180?a-=360:a<-180&&(a+=360);const d=[vn(e,t,n,r[0],o,c[0]),vn(e,t,n,r[1],o,c[1]),r[2]+vn(e,t,n,0,o,a),vn(e,t,n,s[3],o,i[3])];return s8(d)}Ru=e({"node_modules/ol/expr/cpu.js"(){le(),Ca()}});function ba(e,t,n){const s=n?pt(n):"null";return t+":"+e+":"+s}bn=e({"node_modules/ol/style/IconImageCache.js"(){Re(),le(),I(),Hu=class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const n=this.cache_[t];(e++&3)===0&&!n.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,n){const s=ba(e,t,n);return s in this.cache_?this.cache_[s]:null}getPattern(e,t,n){const s=ba(e,t,n);return s in this.patternCache_?this.patternCache_[s]:null}set(e,t,n,s,o){const i=ba(e,t,n),a=i in this.cache_;this.cache_[i]=s,o&&(s.getImageState()===l.IDLE&&s.load(),s.getImageState()===l.LOADING?s.ready().then(()=>{this.patternCache_[i]=Fs().createPattern(s.getImage(1),"repeat")}):this.patternCache_[i]=Fs().createPattern(s.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}},Z=new Hu}});function pa(e,t,n,s,o,i){let a=t===0[0]?0[0]:Z.get(t,n,o);return a||(a=new ca(e,e&&"src"in e?e.src||0[0]:t,n,s,o),Z.set(t,n,o,a,i)),i&&a&&!Z.getPattern(t,n,o)&&Z.set(t,n,o,a,i),a}_n=e({"node_modules/ol/style/IconImage.js"(){Gr(),Re(),le(),I(),y(),Zn(),bn(),Tt=null,ca=class extends ss{constructor(e,t,n,s,o){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=n,this.canvas_={},this.color_=o,this.imageState_=s===0[0]?l.IDLE:s,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===0[0]&&this.imageState_===l.LOADED){Tt||(Tt=L(1,1,0[0],{willReadFrequently:!0})),Tt.drawImage(this.image_,0,0);try{Tt.getImageData(0,0,1,1),this.tainted_=!1}catch{Tt=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(a.CHANGE)}handleImageError_(){this.imageState_=l.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=l.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],n=L(e,t);n.fillRect(0,0,e,t),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_!==l.IDLE)return;this.image_||this.initializeImage_(),this.imageState_=l.LOADING;try{this.src_!==0[0]&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Dh(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==l.LOADED)return;const n=this.image_,t=L(Math.ceil(n.width*e),Math.ceil(n.height*e)),s=t.canvas;t.scale(e,e),t.drawImage(n,0,0),t.globalCompositeOperation="multiply",t.fillStyle=u8(this.color_),t.fillRect(0,0,s.width/e,s.height/e),t.globalCompositeOperation="destination-in",t.drawImage(n,0,0),this.canvas_[e]=s}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===l.LOADED||this.imageState_===l.ERROR)e();else{const t=()=>{(this.imageState_===l.LOADED||this.imageState_===l.ERROR)&&(this.removeEventListener(a.CHANGE,t),e())};this.addEventListener(a.CHANGE,t)}})),this.ready_}},Uu=ca}});function qu(e){return e?Array.isArray(e)?ir(e):typeof e=="object"&&"src"in e?sm(e):e:null}function sm(e){if(!e.offset||!e.size)return Z.getPattern(e.src,"anonymous",e.color);const t=e.src+":"+e.offset,n=Z.getPattern(t,0[0],e.color);if(n)return n;const s=Z.get(e.src,"anonymous",null);if(s.getImageState()!==l.LOADED)return null;const o=L(e.size[0],e.size[1]);return o.drawImage(s.getImage(1),e.offset[0],e.offset[1],e.size[0],e.size[1],0,0,e.size[0],e.size[1]),pa(o.canvas,t,0[0],l.LOADED,e.color,!0),Z.getPattern(t,0[0],e.color)}Gu=e({"node_modules/ol/colorlike.js"(){Re(),le(),I(),_n(),bn()}}),qi=e({"node_modules/ol/render/canvas.js"(){he(),aa="#000",Ji="round",Xi="round",Ju=10,e1="#000",t1=1,n1=new ve}}),Ii=e({"node_modules/ol/style/Image.js"(){ae(),F(),o1=class _ImageStyle{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=P(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new _ImageStyle({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return d()}getImage(){return d()}getHitDetectionImage(){return d()}getPixelRatio(){return 1}getImageState(){return d()}getImageSize(){return d()}getOrigin(){return d()}getSize(){return d()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=P(e)}listenImageChange(){d()}load(){d()}unlistenImageChange(){d()}ready(){return Promise.resolve()}},Fo=o1}}),Ri=e({"node_modules/ol/style/RegularShape.js"(){Re(),le(),Gu(),I(),qi(),_n(),bn(),Ii(),r1=class _RegularShape extends Fo{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==0[0]&&e.rotateWithView,rotation:e.rotation!==0[0]?e.rotation:0,scale:e.scale!==0[0]?e.scale:1,displacement:e.displacement!==0[0]?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==0[0]?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==0[0]?e.angle:0,this.stroke_=e.stroke!==0[0]?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?l.LOADING:l.LOADED,this.imageState_===l.LOADING&&this.ready().then(()=>this.imageState_=l.LOADED),this.render()}clone(){const e=this.getScale(),t=new _RegularShape({fill:this.getFill()?this.getFill().clone():0[0],points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():0[0],rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),n=this.getScaleArray();return[e[0]/2-t[0]/n[0],e[1]/2+t[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const s=this.fill_?.getKey(),n=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${s}`+Object.values(this.renderOptions_).join(",");let t=Z.get(n,null,null)?.getImage(1);if(!t){const s=this.renderOptions_,o=Math.ceil(s.size*e),i=L(o,o);this.draw_(s,i,e),t=i.canvas,Z.set(n,null,null,new Uu(t,0[0],null,l.LOADED,null))}return t}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(){}load(){}unlistenImageChange(){}calculateLineJoinSize_(e,t,n){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let s=this.radius,o=this.radius2_===0[0]?s:this.radius2_;if(s<o){const e=s;s=o,o=e}const b=this.radius2_===0[0]?this.points_:this.points_*2,h=2*Math.PI/b,i=o*Math.sin(h),y=(o*o-i*i)**.5,c=s-y,u=(i*i+c*c)**.5,r=u/i;if(e==="miter"&&r<=n)return r*t;const m=t/2/r,f=t/2*(c/u),g=((s+m)*(s+m)+f*f)**.5,l=g-s;if(this.radius2_===0[0]||e==="bevel")return l*2;const a=s*Math.sin(h),v=(s*s-a*a)**.5,d=o-v,j=(a*a+d*d)**.5,p=j/a;if(p<=n){const e=p*t/2-o-s;return 2*Math.max(l,e)}return l*2}createRenderOptions(){let s=Ji,e=Xi,t=0,o=null,i=0,a,n=0;this.stroke_&&(a=qu(this.stroke_.getColor()??e1),n=this.stroke_.getWidth()??t1,o=this.stroke_.getLineDash(),i=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Xi,s=this.stroke_.getLineCap()??Ji,t=this.stroke_.getMiterLimit()??Ju);const r=this.calculateLineJoinSize_(e,n,t),c=Math.max(this.radius,this.radius2_||0),l=Math.ceil(2*c+r);return{strokeStyle:a,strokeWidth:n,size:l,lineCap:s,lineDash:o,lineDashOffset:i,lineJoin:e,miterLimit:t}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,n){if(t.scale(n,n),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let e=this.fill_.getColor();e===null&&(e=aa),t.fillStyle=qu(e),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let n=this.fill_.getColor(),s=0;typeof n=="string"&&(n=pt(n)),n===null?s=1:Array.isArray(n)&&(s=n.length===4?n[3]:1),s===0&&(t=L(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const n=this.radius;if(t===1/0)e.arc(0,0,n,0,2*Math.PI);else{const s=this.radius2_===0[0]?n:this.radius2_;this.radius2_!==0[0]&&(t*=2);const o=this.angle_-Math.PI/2,i=2*Math.PI/t;for(let a=0;a<t;a++){const r=o+a*i,c=a%2===0?n:s;e.lineTo(c*Math.cos(r),c*Math.sin(r))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=aa,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}},Pi=r1}}),Ni=e({"node_modules/ol/style/Circle.js"(){Ri(),d1=class _CircleStyle extends Pi{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==0[0]?e.scale:1,rotation:e.rotation!==0[0]?e.rotation:0,rotateWithView:e.rotateWithView!==0[0]&&e.rotateWithView,displacement:e.displacement!==0[0]?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new _CircleStyle({fill:this.getFill()?this.getFill().clone():0[0],stroke:this.getStroke()?this.getStroke().clone():0[0],radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}},Li=d1}}),ro=e({"node_modules/ol/style/Fill.js"(){Re(),le(),F(),_n(),m1=class _Fill{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==0[0]&&this.setColor(e.color)}clone(){const e=this.getColor();return new _Fill({color:Array.isArray(e)?e.slice():e||0[0]})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=pa(null,e.src,"anonymous",0[0],e.offset?null:e.color?e.color:null,!e.offset||!e.size);t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===l.IDLE&&t.load(),t.getImageState()===l.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?z(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:pt(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}},ao=m1}});function g1(e,t,n,s){return n!==0[0]&&s!==0[0]?[n/e,s/t]:n!==0[0]?n/e:s!==0[0]?s/t:1}j1=e({"node_modules/ol/style/Icon.js"(){Re(),B(),le(),y(),F(),_n(),Ii(),v1=class _Icon extends Fo{constructor(e){e=e||{};const o=e.opacity!==0[0]?e.opacity:1,i=e.rotation!==0[0]?e.rotation:0,a=e.scale!==0[0]?e.scale:1,r=e.rotateWithView!==0[0]&&e.rotateWithView;super({opacity:o,rotation:i,scale:a,displacement:e.displacement!==0[0]?e.displacement:[0,0],rotateWithView:r,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==0[0]?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==0[0]?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==0[0]?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==0[0]?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==0[0]?e.crossOrigin:null;const t=e.img!==0[0]?e.img:null;let n=e.src;f(n===0[0]||!t,"`image` and `src` cannot be provided at the same time"),(n===0[0]||n.length===0)&&t&&(n=t.src||z(t)),f(n!==0[0]&&n.length>0,"A defined and non-empty `src` or `image` must be provided"),f(e.width===0[0]&&e.height===0[0]||e.scale===0[0],"`width` or `height` cannot be provided together with `scale`");let s;if(e.src!==0[0]?s=l.IDLE:t!==0[0]&&("complete"in t?t.complete?s=t.src?l.LOADED:l.IDLE:s=l.LOADING:s=l.LOADED),this.color_=e.color!==0[0]?pt(e.color):null,this.iconImage_=pa(t,n,this.crossOrigin_,s,this.color_),this.offset_=e.offset!==0[0]?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==0[0]?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==0[0]?e.size:null,this.initialOptions_,e.width!==0[0]||e.height!==0[0]){let t,n;if(e.size)[t,n]=e.size;else{const s=this.getImage(1);if(s.width&&s.height)t=s.width,n=s.height;else if(s instanceof HTMLImageElement){this.initialOptions_=e;const t=()=>{if(this.unlistenImageChange(t),!this.initialOptions_)return;const n=this.iconImage_.getSize();this.setScale(g1(n[0],n[1],e.width,e.height))};this.listenImageChange(t);return}}t!==0[0]&&this.setScale(g1(t,n,e.width,e.height))}}clone(){let e,t,n;return this.initialOptions_?(t=this.initialOptions_.width,n=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new _Icon({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||0[0],crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:n,size:this.size_!==null?this.size_.slice():0[0],src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const t=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!t)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=t[0]),this.anchorYUnits_=="fraction"&&(e[1]*=t[1])}if(this.anchorOrigin_!="top-left"){if(!t)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+t[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+t[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),n=this.getScaleArray();return[e[0]-t[0]/n[0],e[1]+t[1]/n[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),n=this.iconImage_.getSize();if(!t||!n)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=n[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=n[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();return this.size_?this.size_[0]*e[0]:this.iconImage_.getImageState()==l.LOADED?this.iconImage_.getSize()[0]*e[0]:0[0]}getHeight(){const e=this.getScaleArray();return this.size_?this.size_[1]*e[1]:this.iconImage_.getImageState()==l.LOADED?this.iconImage_.getSize()[1]*e[1]:0[0]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(a.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(a.CHANGE,e)}ready(){return this.iconImage_.ready()}},b1=v1}}),Fi=e({"node_modules/ol/style/Stroke.js"(){y1=class _Stroke{constructor(e){e=e||{},this.color_=e.color!==0[0]?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==0[0]?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new _Stroke({color:Array.isArray(e)?e.slice():e||0[0],lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():0[0],lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}},Ti=y1}});function qm(e){let t;if(typeof e=="function")t=e;else{let n;if(Array.isArray(e))n=e;else{f(typeof e.getZIndex=="function","Expected an `Style` or an array of `Style`");const t=e;n=[t]}t=function(){return n}}return t}function x1(){if(!co){const e=new ao({color:"rgba(255,255,255,0.4)"}),t=new Ti({color:"#3399CC",width:1.25});co=[new Mi({image:new Li({fill:e,stroke:t,radius:5}),fill:e,stroke:t})]}return co}function C1(e){return e.getGeometry()}Ei=e({"node_modules/ol/style/Style.js"(){B(),Ni(),ro(),Fi(),Mi=class _Style{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=C1,e.geometry!==0[0]&&this.setGeometry(e.geometry),this.fill_=e.fill!==0[0]?e.fill:null,this.image_=e.image!==0[0]?e.image:null,this.renderer_=e.renderer!==0[0]?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==0[0]?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==0[0]?e.stroke:null,this.text_=e.text!==0[0]?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new _Style({geometry:e??0[0],fill:this.getFill()?this.getFill().clone():0[0],image:this.getImage()?this.getImage().clone():0[0],renderer:this.getRenderer()??0[0],stroke:this.getStroke()?this.getStroke().clone():0[0],text:this.getText()?this.getText().clone():0[0],zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==0[0]&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=C1,this.geometry_=e}setZIndex(e){this.zIndex_=e}},co=null,Cn=Mi}}),z1=e({"node_modules/ol/style/Text.js"(){ae(),ro(),M1="#333",F1=class _Text{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=P(e.scale!==0[0]?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==0[0]?e.fill:new ao({color:M1}),this.maxAngle_=e.maxAngle!==0[0]?e.maxAngle:Math.PI/4,this.placement_=e.placement!==0[0]?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==0[0]?e.stroke:null,this.offsetX_=e.offsetX!==0[0]?e.offsetX:0,this.offsetY_=e.offsetY!==0[0]?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===0[0]?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new _Text({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():0[0],stroke:this.getStroke()?this.getStroke().clone():0[0],offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():0[0],backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():0[0],padding:this.getPadding()||0[0],declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=P(e!==0[0]?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}},T1=F1}});function um(){return!0}function Qh(e){const n=Bd(),s=Xh(e,n),t=Ou();return function(e,o){if(t.properties=e.getPropertiesInternal(),t.resolution=o,n.featureId){const n=e.getId();n!==0[0]?t.featureId=n:t.featureId=null}return n.geometryType&&(t.geometryType=ru(e.getGeometry())),s(t)}}function L1(e){const o=Bd(),n=e.length,i=new Array(n);for(let t=0;t<n;++t)i[t]=Ci(e[t],o);const t=Ou(),s=new Array(n);return function(e,a){if(t.properties=e.getPropertiesInternal(),t.resolution=a,o.featureId){const n=e.getId();n!==0[0]?t.featureId=n:t.featureId=null}let r=0;for(let e=0;e<n;++e){const o=i[e](t);o&&(s[r]=o,r+=1)}return s.length=r,s}}function Xh(e,t){const n=e.length,s=new Array(n);for(let i=0;i<n;++i){const o=e[i],r="filter"in o?je(o.filter,D,t):um;let a;if(Array.isArray(o.style)){const e=o.style.length;a=new Array(e);for(let n=0;n<e;++n)a[n]=Ci(o.style[n],t)}else a=[Ci(o.style,t)];s[i]={filter:r,styles:a}}return function(t){const o=[];let i=!1;for(let a=0;a<n;++a){const r=s[a].filter;if(!r(t))continue;if(e[a].else&&i)continue;i=!0;for(const n of s[a].styles){const e=n(t);if(!e)continue;o.push(e)}}return o}}function Ci(e,t){const s=En(e,"",t),o=An(e,"",t),i=Gh(e,t),a=Yh(e,t),r=U(e,"z-index",t);if(!s&&!o&&!i&&!a&&!N1(e))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(e));const n=new Cn;return function(e){let t=!0;if(s){const o=s(e);o&&(t=!1),n.setFill(o)}if(o){const s=o(e);s&&(t=!1),n.setStroke(s)}if(i){const s=i(e);s&&(t=!1),n.setText(s)}if(a){const s=a(e);s&&(t=!1),n.setImage(s)}return r&&n.setZIndex(r(e)),t?null:n}}function En(e,t,n){let s;if(t+"fill-pattern-src"in e)s=$h(e,t+"fill-",n);else{if(e[t+"fill-color"]==="none")return e=>null;s=vi(e,t+"fill-color",n)}if(!s)return null;const o=new ao;return function(e){const t=s(e);return t===Hs?null:(o.setColor(t),o)}}function An(e,t,n){const o=U(e,t+"stroke-width",n),i=vi(e,t+"stroke-color",n);if(!o&&!i)return null;const a=ye(e,t+"stroke-line-cap",n),r=ye(e,t+"stroke-line-join",n),c=Q1(e,t+"stroke-line-dash",n),l=U(e,t+"stroke-line-dash-offset",n),d=U(e,t+"stroke-miter-limit",n),s=new Ti;return function(e){if(i){const t=i(e);if(t===Hs)return null;s.setColor(t)}if(o&&s.setWidth(o(e)),a){const t=a(e);if(t!=="butt"&&t!=="round"&&t!=="square")throw new Error("Expected butt, round, or square line cap");s.setLineCap(t)}if(r){const t=r(e);if(t!=="bevel"&&t!=="round"&&t!=="miter")throw new Error("Expected bevel, round, or miter line join");s.setLineJoin(t)}return c&&s.setLineDash(c(e)),l&&s.setLineDashOffset(l(e)),d&&s.setMiterLimit(d(e)),s}}function Gh(e,t){const n="text-",O=ye(e,n+"value",t);if(!O)return null;const h=En(e,n,t),p=En(e,n+"background-",t),a=An(e,n,t),r=An(e,n+"background-",t),c=ye(e,n+"font",t),l=U(e,n+"max-angle",t),d=U(e,n+"offset-x",t),u=U(e,n+"offset-y",t),o=Rt(e,n+"overflow",t),m=ye(e,n+"placement",t),f=U(e,n+"repeat",t),i=jo(e,n+"scale",t),g=Rt(e,n+"rotate-with-view",t),v=U(e,n+"rotation",t),b=ye(e,n+"align",t),j=ye(e,n+"justify",t),y=ye(e,n+"baseline",t),_=Rt(e,n+"keep-upright",t),w=Q1(e,n+"padding",t),x=wo(e,n+"declutter-mode"),s=new T1({declutterMode:x});return function(e){if(s.setText(O(e)),h&&s.setFill(h(e)),p&&s.setBackgroundFill(p(e)),a&&s.setStroke(a(e)),r&&s.setBackgroundStroke(r(e)),c&&s.setFont(c(e)),l&&s.setMaxAngle(l(e)),d&&s.setOffsetX(d(e)),u&&s.setOffsetY(u(e)),o&&s.setOverflow(o(e)),m){const t=m(e);if(t!=="point"&&t!=="line")throw new Error("Expected point or line for text-placement");s.setPlacement(t)}if(f&&s.setRepeat(f(e)),i&&s.setScale(i(e)),g&&s.setRotateWithView(g(e)),v&&s.setRotation(v(e)),b){const t=b(e);if(t!=="left"&&t!=="center"&&t!=="right"&&t!=="end"&&t!=="start")throw new Error("Expected left, right, center, start, or end for text-align");s.setTextAlign(t)}if(j){const t=j(e);if(t!=="left"&&t!=="right"&&t!=="center")throw new Error("Expected left, right, or center for text-justify");s.setJustify(t)}if(y){const t=y(e);if(t!=="bottom"&&t!=="top"&&t!=="middle"&&t!=="alphabetic"&&t!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");s.setTextBaseline(t)}return w&&s.setPadding(w(e)),_&&s.setKeepUpright(_(e)),s}}function Yh(e,t){return"icon-src"in e?qh(e,t):"shape-points"in e?Kh(e,t):"circle-radius"in e?Wh(e,t):null}function qh(e,t){const n="icon-",o=n+"src",w=d4(e[o],o),i=bo(e,n+"anchor",t),a=jo(e,n+"scale",t),r=U(e,n+"opacity",t),c=bo(e,n+"displacement",t),l=U(e,n+"rotation",t),d=Rt(e,n+"rotate-with-view",t),h=o4(e,n+"anchor-origin"),u=i4(e,n+"anchor-x-units"),m=i4(e,n+"anchor-y-units"),f=zh(e,n+"color"),p=Hh(e,n+"cross-origin"),g=Ph(e,n+"offset"),v=o4(e,n+"offset-origin"),b=_o(e,n+"width"),j=_o(e,n+"height"),y=Ih(e,n+"size"),_=wo(e,n+"declutter-mode"),s=new b1({src:w,anchorOrigin:h,anchorXUnits:u,anchorYUnits:m,color:f,crossOrigin:p,offset:g,offsetOrigin:v,height:j,width:b,size:y,declutterMode:_});return function(e){return r&&s.setOpacity(r(e)),c&&s.setDisplacement(c(e)),l&&s.setRotation(l(e)),d&&s.setRotateWithView(d(e)),a&&s.setScale(a(e)),i&&s.setAnchor(i(e)),s}}function Kh(e,t){const n="shape-",u=n+"points",l=n+"radius",h=oi(e[u],u),m=oi(e[l],l),i=En(e,n,t),a=An(e,n,t),r=jo(e,n+"scale",t),c=bo(e,n+"displacement",t),o=U(e,n+"rotation",t),d=Rt(e,n+"rotate-with-view",t),f=_o(e,n+"radius2"),p=_o(e,n+"angle"),g=wo(e,n+"declutter-mode"),s=new Pi({points:h,radius:m,radius2:f,angle:p,declutterMode:g});return function(e){return i&&s.setFill(i(e)),a&&s.setStroke(a(e)),c&&s.setDisplacement(c(e)),o&&s.setRotation(o(e)),d&&s.setRotateWithView(d(e)),r&&s.setScale(r(e)),s}}function Wh(e,t){const n="circle-",o=En(e,n,t),i=An(e,n,t),a=U(e,n+"radius",t),r=jo(e,n+"scale",t),c=bo(e,n+"displacement",t),l=U(e,n+"rotation",t),d=Rt(e,n+"rotate-with-view",t),u=wo(e,n+"declutter-mode"),s=new Li({radius:5,declutterMode:u});return function(e){return a&&s.setRadius(a(e)),o&&s.setFill(o(e)),i&&s.setStroke(i(e)),c&&s.setDisplacement(c(e)),l&&s.setRotation(l(e)),d&&s.setRotateWithView(d(e)),r&&s.setScale(r(e)),s}}function U(e,t,n){if(!(t in e))return 0[0];const s=je(e[t],c,n);return function(e){return oi(s(e),t)}}function ye(e,t,n){if(!(t in e))return null;const s=je(e[t],R,n);return function(e){return d4(s(e),t)}}function $h(e,t,n){const a=ye(e,t+"pattern-src",n),s=J1(e,t+"pattern-offset",n),o=J1(e,t+"pattern-size",n),i=vi(e,t+"color",n);return function(e){return{src:a(e),offset:s&&s(e),size:o&&o(e),color:i&&i(e)}}}function Rt(e,t,n){if(!(t in e))return null;const s=je(e[t],D,n);return function(e){const n=s(e);if(typeof n!="boolean")throw new Error(`Expected a boolean for ${t}`);return n}}function vi(e,t,n){if(!(t in e))return null;const s=je(e[t],te,n);return function(e){return h4(s(e),t)}}function Q1(e,t,n){if(!(t in e))return null;const s=je(e[t],Ie,n);return function(e){return Fn(s(e),t)}}function bo(e,t,n){if(!(t in e))return null;const s=je(e[t],Ie,n);return function(e){const n=Fn(s(e),t);if(n.length!==2)throw new Error(`Expected two numbers for ${t}`);return n}}function J1(e,t,n){if(!(t in e))return null;const s=je(e[t],Ie,n);return function(e){return m4(s(e),t)}}function jo(e,t,n){if(!(t in e))return null;const s=je(e[t],Ie|c,n);return function(e){return Fh(s(e),t)}}function _o(e,t){const n=e[t];if(n===0[0])return 0[0];if(typeof n!="number")throw new Error(`Expected a number for ${t}`);return n}function Ih(e,t){const n=e[t];if(n===0[0])return 0[0];if(typeof n=="number")return P(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${t}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return n}function Hh(e,t){const n=e[t];if(n===0[0])return 0[0];if(typeof n!="string")throw new Error(`Expected a string for ${t}`);return n}function o4(e,t){const n=e[t];if(n===0[0])return 0[0];if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return n}function i4(e,t){const n=e[t];if(n===0[0])return 0[0];if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return n}function Ph(e,t){const n=e[t];return n===0[0]?0[0]:Fn(n,t)}function wo(e,t){const n=e[t];if(n===0[0])return 0[0];if(typeof n!="string")throw new Error(`Expected a string for ${t}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return n}function zh(e,t){const n=e[t];return n===0[0]?0[0]:h4(n,t)}function Fn(e,t){if(!Array.isArray(e))throw new Error(`Expected an array for ${t}`);const n=e.length;for(let s=0;s<n;++s)if(typeof e[s]!="number")throw new Error(`Expected an array of numbers for ${t}`);return e}function d4(e,t){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}function oi(e,t){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}function h4(e,t){if(typeof e=="string")return e;const n=Fn(e,t),s=n.length;if(s<3||s>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return n}function m4(e,t){const n=Fn(e,t);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return n}function Fh(e,t){return typeof e=="number"?e:m4(e,t)}p4=e({"node_modules/ol/render/canvas/style.js"(){le(),Ru(),Ca(),dt(),ae(),Ni(),ro(),j1(),Ri(),Fi(),Ei(),z1()}});function Mh(e){if(e===0[0])return x1;if(!e)return null;if(typeof e=="function")return e;if(e instanceof Cn)return e;if(!Array.isArray(e))return L1([e]);if(e.length===0)return[];const t=e.length,n=e[0];if(n instanceof Cn){const n=new Array(t);for(let s=0;s<t;++s){const o=e[s];if(!(o instanceof Cn))throw new Error("Expected a list of style instances");n[s]=o}return n}if("style"in n){const n=new Array(t);for(let s=0;s<t;++s){const o=e[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");n[s]=o}return Qh(n)}const s=e;return L1(s)}y4=e({"node_modules/ol/layer/BaseVector.js"(){ud(),p4(),Ei(),yt(),si={RENDER_ORDER:"renderOrder"},b4=class extends rn{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):0[0],this.renderBuffer_=e.renderBuffer!==0[0]?e.renderBuffer:100,this.style_=null,this.styleFunction_=0[0],this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==0[0]&&e.updateWhileAnimating,this.updateWhileInteracting_=e.updateWhileInteracting!==0[0]&&e.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(si.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const n=this.getDeclutter();n in e.declutter===!1&&(e.declutter[n]=new dd(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(si.RENDER_ORDER,e)}setStyle(e){this.style_=e===0[0]?x1:e;const t=Mh(e);this.styleFunction_=e===null?0[0]:qm(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):0[0],this.changed()}},j4=b4}}),ti=e({"node_modules/ol/render/Event.js"(){Ce(),_4=class extends Oe{constructor(e,t,n,s){super(e),this.inversePixelTransform=t,this.frameState=n,this.context=s}},ni=_4}});function kh(){Z.expire()}k4=e({"node_modules/ol/renderer/Map.js"(){Xn(),It(),b(),K(),yt(),bn(),ut(),F(),C4=class extends Gn{constructor(e){super(),this.map_=e}dispatchRenderEvent(){d()}calculateMatrices2D(e){const t=e.viewState,n=e.coordinateToPixelTransform,s=e.pixelToCoordinateTransform;Rn(n,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Y0(s,n)}forEachFeatureAtCoordinate(e,t,n,s,o,i,a,r){let l;const m=t.viewState;function g(e,t,n,s){return o.call(i,t,e?n:null,s)}const u=m.projection,v=ah(e.slice(),u),d=[[0,0]];if(u.canWrapX()&&s){const t=u.getExtent(),e=p(t);d.push([-e,0],[e,0])}const f=t.layerStatesArray,b=f.length,c=[],h=[];for(let s=0;s<d.length;s++)for(let i=b-1;i>=0;--i){const u=f[i],o=u.layer;if(o.hasRenderer()&&Tr(u,m)&&a.call(r,o)){const i=o.getRenderer(),a=o.getSource();if(i&&a){const o=a.getWrapX()?v:e,r=g.bind(null,u.managed);h[0]=o[0]+d[s][0],h[1]=o[1]+d[s][1],l=i.forEachFeatureAtCoordinate(h,t,n,r,c)}if(l)return l}}if(c.length===0)return 0[0];const j=1/c.length;return c.forEach((e,t)=>e.distanceSq+=t*j),c.sort((e,t)=>e.distanceSq-t.distanceSq),c.some(e=>l=e.callback(e.feature,e.layer,e.geometry)),l}hasFeatureAtCoordinate(e,t,n,s,o,i){const a=this.forEachFeatureAtCoordinate(e,t,n,s,As,this,o,i);return a!==0[0]}getMap(){return this.map_}renderFrame(){d()}scheduleExpireIconCache(e){Z.canExpireCache()&&e.postRenderFunctions.push(kh)}},E4=C4}}),M4=e({"node_modules/ol/renderer/Composite.js"(){Mn(),Mt(),I(),ie(),y4(),yt(),ti(),an(),qi(),k4(),A4=class extends E4{constructor(e){super(e),this.fontChangeListenerKey_=h(n1,Vt.PROPERTYCHANGE,e.redrawText,e),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=xt+" ol-layers";const n=e.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const n=this.getMap();if(n.hasListener(e)){const s=new ni(e,0[0],t);n.dispatchEvent(s)}}disposeInternal(){_(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(ce.PRECOMPOSE,e);const t=e.layerStatesArray.sort((e,t)=>e.zIndex-t.zIndex),o=t.some(e=>e.layer instanceof j4&&e.layer.getDeclutter());o&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let n=null;for(let o=0,d=t.length;o<d;++o){const r=t[o];e.layerIndex=o;const c=r.layer,l=c.getSourceState();if(!Tr(r,i)||l!="ready"&&l!="undefined"){c.unrender();continue}const a=c.render(e,n);if(!a)continue;a!==n&&(this.children_.push(a),n=a),s.push(r)}this.declutter(e,s),vh(this.element_,this.children_),this.dispatchRenderEvent(ce.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(!e.declutter)return;for(let n=t.length-1;n>=0;--n){const s=t[n],o=s.layer;o.getDeclutter()&&o.renderDeclutter(e,s)}t.forEach(t=>t.layer.renderDeferred(e))}},S4=A4}});function F4(e){if(e instanceof rn){e.setMapInternal(null);return}e instanceof sn&&e.getLayers().forEach(F4)}function T4(e,t){if(e instanceof rn){e.setMapInternal(t);return}if(e instanceof sn){const n=e.getLayers().getArray();for(let e=0,s=n.length;e<s;++e)T4(n[e],t)}}function Eh(e){let i=null;e.keyboardEventTarget!==0[0]&&(i=typeof e.keyboardEventTarget=="string"?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);const t={},a=e.layers&&typeof e.layers.getLayers=="function"?e.layers:new sn({layers:e.layers});t[k.LAYERGROUP]=a,t[k.TARGET]=e.target,t[k.VIEW]=e.view instanceof se?e.view:new se;let s;e.controls!==0[0]&&(Array.isArray(e.controls)?s=new fe(e.controls.slice()):(f(typeof e.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),s=e.controls));let o;e.interactions!==0[0]&&(Array.isArray(e.interactions)?o=new fe(e.interactions.slice()):(f(typeof e.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),o=e.interactions));let n;return e.overlays!==0[0]?Array.isArray(e.overlays)?n=new fe(e.overlays.slice()):(f(typeof e.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),n=e.overlays):n=new fe,{controls:s,interactions:o,keyboardEventTarget:i,overlays:n,values:t}}L4=e({"node_modules/ol/Map.js"(){wn(),oo(),ta(),Wu(),Qt(),Zi(),da(),ha(),he(),Mn(),Cu(),ps(),wa(),ee(),B(),Gi(),Pc(),y(),ie(),b(),K(),Bt(),Sl(),Hl(),yt(),ia(),re(),an(),M4(),ae(),ut(),F(),D4=class extends ve{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=Eh(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==0[0]?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==0[0]?e.pixelRatio:Z1,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Yt(),this.pixelToCoordinateTransform_=Yt(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||K8(),this.interactions=t.interactions||W8({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Nu(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(k.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(k.VIEW,this.handleViewChanged_),this.addChangeListener(k.SIZE,this.handleSizeChanged_),this.addChangeListener(k.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const n=this;e.view&&!(e.view instanceof se)&&e.view.then(function(e){n.setView(new se(e))}),this.controls.addEventListener(Q.ADD,e=>{e.element.setMap(this)}),this.controls.addEventListener(Q.REMOVE,e=>{e.element.setMap(null)}),this.interactions.addEventListener(Q.ADD,e=>{e.element.setMap(this)}),this.interactions.addEventListener(Q.REMOVE,e=>{e.element.setMap(null)}),this.overlays_.addEventListener(Q.ADD,e=>{this.addOverlayInternal_(e.element)}),this.overlays_.addEventListener(Q.REMOVE,e=>{const t=e.element.getId();t!==0[0]&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)}),this.controls.forEach(e=>{e.setMap(this)}),this.interactions.forEach(e=>{e.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){const t=this.getLayerGroup().getLayers();t.push(e)}handleLayerAdd_(e){T4(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==0[0]&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,n){if(!this.frameState_||!this.renderer_)return;const s=this.getCoordinateFromPixelInternal(e);n=n!==0[0]?n:{};const o=n.hitTolerance!==0[0]?n.hitTolerance:0,i=n.layerFilter!==0[0]?n.layerFilter:As,a=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(s,this.frameState_,o,a,t,null,i,null)}getFeaturesAtPixel(e,t){const n=[];return this.forEachFeatureAtPixel(e,function(e){n.push(e)},t),n}getAllLayers(){const e=[];function t(n){n.forEach(function(n){n instanceof sn?t(n.getLayers()):e.push(n)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(e);t=t!==0[0]?t:{};const s=t.layerFilter!==0[0]?t.layerFilter:As,o=t.hitTolerance!==0[0]?t.hitTolerance:0,i=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,o,i,s,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const o=this.viewport_,t=o.getBoundingClientRect(),n=this.getSize(),i=t.width/n[0],a=t.height/n[1],s="changedTouches"in e?e.changedTouches[0]:e;return[(s.clientX-t.left)/i,(s.clientY-t.top)/a]}getTarget(){return this.get(k.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Hi(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?q(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==0[0]?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(k.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof fe){t.setLayers(e);return}const n=t.getLayers();n.clear(),n.extend(e)}getLayers(){const e=this.getLayerGroup().getLayers();return e}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const n=e[t];if(!n.visible)continue;const s=n.layer.getRenderer();if(s&&!s.ready)return!0;const o=n.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=ge(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?q(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(k.SIZE)}getView(){return this.get(k.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,n,s){return om(this.frameState_,e,t,n,s)}handleBrowserEvent(e,t){t=t||e.type;const n=new ke(t,this,e);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,t=n.type;if(t===so.POINTERDOWN||t===a.WHEEL||t===a.KEYDOWN){const t=this.getOwnerDocument(),e=this.viewport_.getRootNode?this.viewport_.getRootNode():t,s=n.target,o=e instanceof ShadowRoot?e.host===s?e.host.ownerDocument:e:e===t?t.documentElement:e;if(this.overlayContainerStopEvent_.contains(s)||!o.contains(s))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const t=this.getInteractions().getArray().slice();for(let n=t.length-1;n>=0;n--){const s=t[n];if(s.getMap()!==this||!s.getActive()||!this.getTargetElement())continue;const o=s.handleEvent(e);if(!o||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let n=this.maxTilesLoading_,s=n;if(e){const t=e.viewHints;if(t[X.ANIMATING]||t[X.INTERACTING]){const t=Date.now()-e.time>8;n=t?0:8,s=t?0:2}}t.getTilesLoading()<n&&(t.reprioritize(),t.loadMoreTiles(n,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(ce.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(ce.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Xe(xe.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Xe(xe.LOADSTART,this,e))));const n=this.postRenderFunctions_;if(e)for(let t=0,s=n.length;t<s;++t)n[t](this,e);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let e=0,t=this.targetChangeHandlerKeys_.length;e<t;++e)_(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(a.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(a.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const e=this.targetElement_.getRootNode();e instanceof ShadowRoot&&this.resizeObserver_.unobserve(e.host),this.setSize(0[0])}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new S4(this)),this.mapBrowserEventHandler_=new Ku(this,this.moveTolerance_);for(const e in j)this.mapBrowserEventHandler_.addEventListener(j[e],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(a.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(a.WHEEL,this.boundHandleBrowserEvent_,!!mi&&{passive:!1});let t;if(this.keyboardEventTarget_)t=this.keyboardEventTarget_;else{const n=e.getRootNode(),s=n instanceof ShadowRoot?n.host:e;t=s}this.targetChangeHandlerKeys_=[h(t,a.KEYDOWN,this.handleBrowserEvent,this),h(t,a.KEYPRESS,this.handleBrowserEvent,this)];const n=e.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=0[0],this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=0[0]);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(_(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(_(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=h(e,Vt.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=h(e,a.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(_),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new we("addlayer",e)),this.layerGroupPropertyListenerKeys_=[h(e,Vt.PROPERTYCHANGE,this.render,this),h(e,a.CHANGE,this.render,this),h(e,"addlayer",this.handleLayerAdd_,this),h(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=0[0],this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,s=e.length;t<s;++t){const n=e[t].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===0[0]&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){const t=this.getLayerGroup().getLayers();return t.remove(e)}handleLayerRemove_(e){F4(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),s=this.getView(),o=this.frameState_;let t=null;if(n!==0[0]&&Dd(n)&&s&&s.isDef()){const i=s.getHints(this.frameState_?this.frameState_.viewHints:0[0]),o=s.getState();if(t={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Ha(o.center,o.resolution,o.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:o,viewHints:i,wantedTiles:{},mapId:z(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const e=isNaN(o.nextRotation)?o.rotation:o.nextRotation;t.nextExtent=Ha(o.nextCenter,o.nextResolution,e,n)}}if(this.frameState_=t,this.renderer_.renderFrame(t),t){if(t.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,t.postRenderFunctions),o){const e=!this.previousExtent_||!pn(this.previousExtent_)&&!vr(t.extent,this.previousExtent_);e&&(this.dispatchEvent(new Xe(xe.MOVESTART,this,o)),this.previousExtent_=on(this.previousExtent_))}const e=this.previousExtent_&&!t.viewHints[X.ANIMATING]&&!t.viewHints[X.INTERACTING]&&!vr(t.extent,this.previousExtent_);e&&(this.dispatchEvent(new Xe(xe.MOVEEND,this,t)),k8(t.extent,this.previousExtent_))}this.dispatchEvent(new Xe(xe.POSTRENDER,this,t)),this.renderComplete_=(this.hasListener(xe.LOADSTART)||this.hasListener(xe.LOADEND)||this.hasListener(ce.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=0[0],this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new we("removelayer",t)),this.set(k.LAYERGROUP,e)}setSize(e){this.set(k.SIZE,e)}setTarget(e){this.set(k.TARGET,e)}setView(e){if(!e||e instanceof se){this.set(k.VIEW,e);return}this.set(k.VIEW,new se);const t=this;e.then(function(e){t.setView(new se(e))})}updateSize(){const e=this.getTargetElement();let t=0[0];if(e){const n=getComputedStyle(e),s=e.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),o=e.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(t=[Math.max(0,s),Math.max(0,o)],!Dd(t)&&!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&w0("No map visible because the map container's width or height are 0."))}const n=this.getSize();t&&(!n||!vo(t,n))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}},ei=D4}});function Jo(e){return e instanceof Image||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageBitmap?e:null}V4=e({"node_modules/ol/DataTile.js"(){Ms(),pe(),P4=new Error("disposed"),H4=[256,256],I4=class extends Ss{constructor(e){const t=s.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Jo(this.data_);return e?[e.width,e.height]:H4}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==s.IDLE&&this.state!==s.ERROR)return;this.state=s.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=s.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=s.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(P4),this.controller_=null),super.disposeInternal()}},Qo=I4}}),U4=e({"node_modules/ol/structs/LRUCache.js"(){Xn(),B(),$4=class{constructor(e){this.highWaterMark=e!==0[0]?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Gn&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e){const n=this.entries_[e];return f(n!==0[0],"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?n.value_:(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n,n.value_)}remove(e){const t=this.entries_[e];return f(t!==0[0],"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let n=0,e;for(e=this.newest_;e;e=e.older)t[n++]=e.key_;return t}getValues(){const t=new Array(this.count_);let n=0,e;for(e=this.newest_;e;e=e.older)t[n++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){f(!(e in this.entries_),"Tried to set a value for a key that is used already");const n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_}setSize(e){this.highWaterMark=e}},W4=$4}}),Y4=e({"node_modules/ol/render/canvas/ZIndexContext.js"(){I(),K4=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Fs(),{get:(e,t)=>typeof Fs()[t]!="function"?0[0]:(this.push_(t),this.pushMethodArgs_),set:(e,t,n)=>(this.push_(t,n),!0)})}push_(...n){const e=this.instructions_,t=this.zIndex+this.offset_;e[t]||(e[t]=[]),e[t].push(...n)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let s=0,i=t.length;s<i;++s){const n=t[s];if(typeof n=="function"){n(e);continue}const o=t[++s];if(typeof e[n]=="function")e[n](...o);else{if(typeof o=="function"){e[n]=o(e);continue}e[n]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},q4=K4}}),Z4=e({"node_modules/ol/renderer/Layer.js"(){Re(),pi(),y(),F(),G4=5,X4=class extends fi{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=G4}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(){return d()}getData(){return null}prepareFrame(){return d()}renderFrame(){return d()}forEachFeatureAtCoordinate(){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===l.LOADED||t.getState()===l.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=l.LOADED&&t!=l.ERROR&&e.addEventListener(a.CHANGE,this.boundHandleImageChange_),t==l.IDLE&&(e.load(),t=e.getState()),t==l.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(){}disposeInternal(){delete this.layer_,super.disposeInternal()}},Q4=X4}});function Oh(){rt=L(1,1,0[0],{willReadFrequently:!0})}s0=e({"node_modules/ol/renderer/canvas/Layer.js"(){ee(),le(),I(),b(),ti(),an(),Y4(),ut(),Z4(),rt=null,t0=class extends Q4{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Yt(),this.pixelTransform=Yt(),this.inversePixelTransform=Yt(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,n){rt||Oh(),rt.clearRect(0,0,1,1);let s;try{rt.drawImage(e,t,n,1,1,0,0,1,1),s=rt.getImageData(0,0,1,1).data}catch{return rt=null,null}return s}getBackground(e){const n=this.getLayer();let t=n.getBackground();return typeof t=="function"&&(t=t(e.viewState.resolution)),t||0[0]}useContainer(e,t,n){const i=this.getLayer().getClassName();let o,s;if(e&&e.className===i&&(!n||e&&e.style.backgroundColor&&vo(pt(e.style.backgroundColor),pt(n)))){const t=e.firstElementChild;t instanceof HTMLCanvasElement&&(s=t.getContext("2d"))}if(s&&dh(s.canvas.style.transform,t)?(this.container=e,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){o=document.createElement("div"),o.className=i;let e=o.style;e.position="absolute",e.width="100%",e.height="100%",s=L();const t=s.canvas;o.appendChild(t),e=t.style,e.position="absolute",e.left="0",e.transformOrigin="top left",this.container=o,this.context=s}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(e,t,n){const s=Se(n),o=Ys(n),i=rs(n),a=Ws(n);q(t.coordinateToPixelTransform,s),q(t.coordinateToPixelTransform,o),q(t.coordinateToPixelTransform,i),q(t.coordinateToPixelTransform,a);const r=this.inversePixelTransform;q(r,s),q(r,o),q(r,i),q(r,a),e.save(),e.beginPath(),e.moveTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const a=e.extent,r=e.viewState.resolution,c=e.viewState.rotation,n=e.pixelRatio,s=Math.round(p(a)/r*n),o=Math.round(J(a)/r*n);Rn(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/n,1/n,c,-s/2,-o/2),Y0(this.inversePixelTransform,this.pixelTransform);const i=lh(this.pixelTransform);if(this.useContainer(t,i,this.getBackground(e)),!this.containerReused){const e=this.context.canvas;e.width!=s||e.height!=o?(e.width=s,e.height=o):this.context.clearRect(0,0,s,o),i!==e.style.transform&&(e.style.transform=i)}}dispatchRenderEvent_(e,t,n){const s=this.getLayer();if(s.hasListener(e)){const o=new ni(e,this.inversePixelTransform,n,t);s.dispatchEvent(o)}}preRender(e,t){if(this.frameState=t,t.declutter)return;this.dispatchRenderEvent_(ce.PRERENDER,e,t)}postRender(e,t){if(t.declutter)return;this.dispatchRenderEvent_(ce.POSTRENDER,e,t)}renderDeferredInternal(){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new q4),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){if(!e.declutter)return;this.dispatchRenderEvent_(ce.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(ce.POSTRENDER,this.context,e)}getRenderTransform(e,t,n,s,o,i,a){const c=o/2,l=i/2,r=s/t,d=-r,u=-e[0]+a,h=-e[1];return Rn(this.tempTransform,c,l,r,d,-n,u,h)}disposeInternal(){delete this.frameState,super.disposeInternal()}},n0=t0}});function Go(e,t,n,s,o){return`${z(e)},${t},${lm(n,s,o)}`}function Yo(e,t,n){if(!(n in e))return e[n]=new Set([t]),!0;const s=e[n],o=s.has(t);return o||s.add(t),!o}function bh(e,t,n){const s=e[n];return!!s&&s.delete(t)}function r0(e,t){const n=e.layerStatesArray[e.layerIndex];n.extent&&(t=ot(t,qe(n.extent,e.viewState.projection)));const s=n.layer.getRenderSource();if(!s.getWrapX()){const n=s.getTileGridForProjection(e.viewState.projection).getExtent();n&&(t=ot(t,n))}return t}d0=e({"node_modules/ol/renderer/canvas/TileLayer.js"(){V4(),eo(),wi(),pe(),ee(),b(),re(),Uo(),ae(),U4(),Vn(),ut(),F(),s0(),c0=class extends n0{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=lt(),this.tempTileRange_=new $i(0,0,0,0),this.tempTileCoord_=lo(0,0,0);const n=t.cacheSize!==0[0]?t.cacheSize:512;this.tileCache_=new W4(n),this.maxStaleKeys=n*.5}getTileCache(){return this.tileCache_}getOrCreateTile(e,t,n,s){const i=this.tileCache_,c=this.getLayer(),a=c.getSource(),r=Go(a,a.getKey(),e,t,n);let o;if(i.containsKey(r))o=i.get(r);else{if(o=a.getTile(e,t,n,s.pixelRatio,s.viewState.projection),!o)return null;i.set(r,o)}return o}getTile(e,t,n,s){const o=this.getOrCreateTile(e,t,n,s);return o||null}getData(e){const n=this.frameState;if(!n)return null;const c=this.getLayer(),o=q(n.pixelToCoordinateTransform,e.slice()),l=c.getExtent();if(l&&!qr(l,o))return null;const i=n.viewState,a=c.getRenderSource(),t=a.getTileGridForProjection(i.projection),r=a.getTilePixelRatio(n.pixelRatio);for(let e=t.getZForResolution(i.resolution);e>=t.getMinZoom();--e){const l=t.getTileCoordForCoordAndZ(o,e),c=this.getTile(e,l[1],l[2],n);if(!c||c.getState()!==s.LOADED)continue;const u=t.getOrigin(e),h=P(t.getTileSize(e)),m=t.getResolution(e);let d;if(c instanceof Js||c instanceof Wo)d=c.getImage();else if(c instanceof Qo){if(d=Jo(c.getData()),!d)continue}else continue;const p=Math.floor(r*((o[0]-u[0])/m-l[1]*h[0])),g=Math.floor(r*((u[1]-o[1])/m-l[2]*h[1])),f=Math.round(r*a.getGutterForProjection(i.projection));return this.getImageData(d,p+f,g+f)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const n=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==n&&(this.renderedSourceRevision_=n,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedSourceRevision_=n,!0}enqueueTiles(e,t,n,o,i){const r=e.viewState,c=this.getLayer(),d=c.getRenderSource(),a=d.getTileGridForProjection(r.projection),l=z(d);l in e.wantedTiles||(e.wantedTiles[l]={});const m=e.wantedTiles[l],h=c.getMapInternal(),f=Math.max(n-i,a.getMinZoom(),a.getZForResolution(Math.min(c.getMaxResolution(),h?h.getView().getResolutionForZoom(Math.max(c.getMinZoom(),0)):a.getResolution(0)),d.zDirection)),u=r.rotation,p=u?gd(r.center,r.resolution,u,e.size):0[0];for(let i=n;i>=f;--i){const r=a.getTileRangeForExtentAndZ(t,i,this.tempTileRange_),c=a.getResolution(i);for(let t=r.minX;t<=r.maxX;++t)for(let n=r.minY;n<=r.maxY;++n){if(u&&!a.tileCoordIntersectsViewport([i,t,n],p))continue;const d=this.getTile(i,t,n,e);if(!d)continue;const f=Yo(o,d,i);if(!f)continue;const h=d.getKey();if(m[h]=!0,d.getState()===s.IDLE&&!e.tileQueue.isKeyQueued(h)){const s=lo(i,t,n,this.tempTileCoord_);e.tileQueue.enqueue([d,l,a.getTileCoordCenter(s),c])}}}}findStaleTile_(e,t){const n=this.tileCache_,o=e[0],a=e[1],r=e[2],i=this.getStaleKeys();for(let e=0;e<i.length;++e){const c=Go(this.getLayer().getSource(),i[e],o,a,r);if(n.containsKey(c)){const e=n.peek(c);if(e.getState()===s.LOADED)return e.endTransition(z(this)),Yo(t,e,o),!0}}return!1}findAltTiles_(e,t,n,o){const i=e.getTileRangeForTileCoordAndZ(t,n,this.tempTileRange_);if(!i)return!1;let a=!0;const r=this.tileCache_,c=this.getLayer().getRenderSource(),l=c.getKey();for(let e=i.minX;e<=i.maxX;++e)for(let t=i.minY;t<=i.maxY;++t){const d=Go(c,l,n,e,t);let u=!1;if(r.containsKey(d)){const e=r.peek(d);e.getState()===s.LOADED&&(Yo(o,e,n),u=!0)}u||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;const m=e.layerStatesArray[e.layerIndex],b=e.viewState,u=b.projection,M=b.resolution,f=b.center,v=e.pixelRatio,S=this.getLayer(),a=S.getSource(),r=a.getTileGridForProjection(u),c=r.getZForResolution(M,a.zDirection),l=r.getResolution(c),y=a.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==y&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=y):this.renderedSourceKey_=y;let w=e.extent;const d=a.getTilePixelRatio(v);this.prepareContainer(e,t);const j=this.context.canvas.width,O=this.context.canvas.height,k=m.extent&&qe(m.extent,u);k&&(w=ot(w,qe(m.extent,u)));const A=l*j/2/d,F=l*O/2/d,h=[f[0]-A,f[1]-F,f[0]+A,f[1]+F],o={};this.renderedTiles.length=0;const x=S.getPreload();if(e.nextExtent){const t=r.getZForResolution(b.nextResolution,a.zDirection),n=r0(e,e.nextExtent);this.enqueueTiles(e,n,t,o,x)}const C=r0(e,w);if(this.enqueueTiles(e,C,c,o,0),x>0&&setTimeout(()=>{this.enqueueTiles(e,C,c-1,o,x-1)},0),!(c in o))return this.container;const E=z(this),D=e.time;for(const t of o[c]){const n=t.getState();if(n===s.EMPTY)continue;const i=t.tileCoord;if(n===s.LOADED){const e=t.getAlpha(E,D);if(e===1){t.endTransition(E);continue}}n!==s.ERROR&&(this.renderComplete=!1);const a=this.findStaleTile_(i,o);if(a){bh(o,t,c),e.animate=!0;continue}const l=this.findAltTiles_(r,i,c+1,o);if(l)continue;const d=r.getMinZoom();for(let e=c-1;e>=d;--e){const t=this.findAltTiles_(r,i,e,o);if(t)break}}const p=l/M*v/d,n=this.getRenderContext(e);Rn(this.tempTransform,j/2,O/2,p,p,0,-j/2,-O/2),m.extent&&this.clipUnrotated(n,e,k),a.getInterpolate()||(n.imageSmoothingEnabled=!1),this.preRender(n,e);const g=Object.keys(o).map(Number);g.sort(go);let i;const _=[],T=[];for(let m=g.length-1;m>=0;--m){const t=g[m],b=a.getTilePixelSize(t,v,u),x=r.getResolution(t),j=x/l,y=b[0]*j*p,w=b[1]*j*p,f=r.getTileCoordForCoordAndZ(Se(h),t),O=r.getTileCoordExtent(f),c=q(this.tempTransform,[d*(O[0]-h[0])/l,d*(h[3]-O[3])/l]),C=d*a.getGutterForProjection(u);for(const d of o[t]){if(d.getState()!==s.LOADED)continue;const p=d.tileCoord,v=f[1]-p[1],O=Math.round(c[0]-(v-1)*y),b=f[2]-p[2],x=Math.round(c[1]-(b-1)*w),r=Math.round(c[0]-v*y),l=Math.round(c[1]-b*w),u=O-r,h=x-l,j=g.length===1;let m=!1;i=[r,l,r+u,l,r+u,l+h,r,l+h];for(let e=0,s=_.length;e<s;++e)if(!j&&t<T[e]){const t=_[e];fn([r,l,r+u,l+h],[t[0],t[3],t[4],t[7]])&&(m||(n.save(),m=!0),n.beginPath(),n.moveTo(i[0],i[1]),n.lineTo(i[2],i[3]),n.lineTo(i[4],i[5]),n.lineTo(i[6],i[7]),n.moveTo(t[6],t[7]),n.lineTo(t[4],t[5]),n.lineTo(t[2],t[3]),n.lineTo(t[0],t[1]),n.clip())}_.push(i),T.push(t),this.drawTile(d,e,r,l,u,h,C,j),m&&n.restore(),this.renderedTiles.unshift(d),this.updateUsedTiles(e.usedTiles,a,d)}}if(this.renderedResolution=l,this.extentChanged=!this.renderedExtent_||!vr(this.renderedExtent_,h),this.renderedExtent_=h,this.renderedPixelRatio=v,this.postRender(this.context,e),m.extent&&n.restore(),n.imageSmoothingEnabled=!0,this.renderComplete){const t=(e,t)=>{const s=z(a),n=t.wantedTiles[s],o=n?Object.keys(n).length:0;this.updateCacheSize(o),this.tileCache_.expireCache()};e.postRenderFunctions.push(t)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,n,s,o,i,a,r){let c;if(e instanceof Qo){if(c=Jo(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const l=this.getRenderContext(t),u=z(this),h=t.layerStatesArray[t.layerIndex],d=h.opacity*(r?e.getAlpha(u,t.time):1),m=d!==l.globalAlpha;m&&(l.save(),l.globalAlpha=d),l.drawImage(c,a,a,c.width-2*a,c.height-2*a,n,s,o,i),m&&l.restore(),d!==h.opacity?t.animate=!0:r&&e.endTransition(u)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,n){const s=z(t);s in e||(e[s]={}),e[s][n.getKey()]=!0}},l0=c0}}),h0=e({"node_modules/ol/layer/TileProperty.js"(){Tn={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"}}}),p0=e({"node_modules/ol/layer/BaseTile.js"(){yt(),h0(),m0=class extends rn{constructor(e){e=e||{};const t=Object.assign({},e),n=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=n,this.setPreload(e.preload!==0[0]?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError===0[0]||e.useInterimTilesOnError)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Tn.PRELOAD)}setPreload(e){this.set(Tn.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Tn.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Tn.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}},f0=m0}}),b0=e({"node_modules/ol/layer/Tile.js"(){d0(),p0(),g0=class extends f0{constructor(e){super(e)}createRenderer(){return new l0(this,{cacheSize:this.getCacheSize()})}},Ko=g0}});function j0(e){const t=e.body;return!!(t.webkitRequestFullscreen||t.requestFullscreen&&e.fullscreenEnabled)}function y0(e){return!!(e.webkitIsFullScreen||e.fullscreenElement)}function _0(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function fh(e){e.webkitRequestFullscreen?e.webkitRequestFullscreen():_0(e)}function mh(e){e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()}A0=e({"node_modules/ol/control/FullScreen.js"(){ha(),Mt(),I(),y(),ie(),$t(),$o=["fullscreenchange","webkitfullscreenchange"],Vo={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"},E0=class extends et{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target}),this.on,this.once,this.un,this.keys_=e.keys!==0[0]&&e.keys,this.source_=e.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=e.className!==0[0]?e.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=e.activeClassName!==0[0]?e.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=e.inactiveClassName!==0[0]?e.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const t=e.label!==0[0]?e.label:"⤢";this.labelNode_=typeof t=="string"?document.createTextNode(t):t;const n=e.labelActive!==0[0]?e.labelActive:"\xD7";this.labelActiveNode_=typeof n=="string"?document.createTextNode(n):n;const s=e.tipLabel?e.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=s,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener(a.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${xt} ${tn}`,this.element.appendChild(this.button_)}handleClick_(e){e.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const t=this.getMap();if(!t)return;const e=t.getOwnerDocument();if(!j0(e))return;if(y0(e))mh(e);else{let n;this.source_?n=typeof this.source_=="string"?e.getElementById(this.source_):this.source_:n=t.getTargetElement(),this.keys_?fh(n):_0(n)}}handleFullScreenChange_(){const e=this.getMap();if(!e)return;const t=this.isInFullscreen_;this.isInFullscreen_=y0(e.getOwnerDocument()),t!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(Ts(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(Vo.ENTERFULLSCREEN)):(Ts(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(Vo.LEAVEFULLSCREEN)),e.updateSize())}setClassName_(e,t){t?(e.classList.remove(...this.inactiveClassName_),e.classList.add(...this.activeClassName_)):(e.classList.remove(...this.activeClassName_),e.classList.add(...this.inactiveClassName_))}setMap(e){const t=this.getMap();t&&t.removeChangeListener(k.TARGET,this.boundHandleMapTargetChange_),super.setMap(e),this.handleMapTargetChange_(),e&&e.addChangeListener(k.TARGET,this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const e=this.documentListeners_;for(let t=0,n=e.length;t<n;++t)_(e[t]);e.length=0;const t=this.getMap();if(t){const n=t.getOwnerDocument();j0(n)?this.element.classList.remove(Qr):this.element.classList.add(Qr);for(let t=0,s=$o.length;t<s;++t)e.push(h(n,$o[t],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}},k0=E0}}),S0=e({"node_modules/ol/control.js"(){$t(),A0(),dc(),mc()}});function v(e,t){let s=e.length;Array.isArray(e[0])||(e=[e]),Array.isArray(t[0])||(t=t.map(e=>[e]));let o=t[0].length,i=t[0].map((e,n)=>t.map(e=>e[n])),n=e.map(e=>i.map(t=>{let n=0;if(!Array.isArray(e)){for(let s of t)n+=e*s;return n}for(let s=0;s<e.length;s++)n+=e[s]*(t[s]||0);return n}));return s===1&&(n=n[0]),o===1?n.map(e=>e[0]):n}function Dn(e){return ze(e)==="string"}function ze(e){let t=Object.prototype.toString.call(e);return(t.match(/^\[object\s+(.*?)\]$/)[1]||"").toLowerCase()}function ko(e,{precision:t,unit:n}){return Fe(e)?"none":L0(e,t)+(n??"")}function Fe(e){return Number.isNaN(e)||e instanceof Number&&e?.none}function E(e){return Fe(e)?0:e}function L0(e,t){if(e===0)return 0;let n=~~e,s=0;n&&t&&(s=~~Math.log10(Math.abs(n))+1);const o=10**(t-s);return Math.floor(e*o+.5)/o}function R0(e){if(!e)return;e=e.trim();const n=/^([a-z]+)\((.+?)\)$/i,s=/^-?[\d.]+$/,o=/%|deg|g?rad|turn$/,i=/\/?\s*(none|[-\w.]+(?:%|deg|g?rad|turn)?)/g;let t=e.match(n);if(t){let e=[];return t[2].replace(i,(t,n)=>{let a=n.match(o),i=n;if(a){let e=a[0],t=i.slice(0,-e.length);e==="%"?(i=new Number(t/100),i.type="<percentage>"):(i=new Number(t*K2[e]),i.type="<angle>",i.unit=e)}else s.test(i)?(i=new Number(i),i.type="<number>"):i==="none"&&(i=new Number(NaN),i.none=!0);t.startsWith("/")&&(i=i instanceof Number?i:new Number(i),i.alpha=!0),typeof i=="object"&&i instanceof Number&&(i.raw=n),e.push(i)}),{name:t[1].toLowerCase(),rawName:t[1],rawArgs:t[2],args:e}}}function P0(e){return e[e.length-1]}function Nn(e,t,n){return isNaN(e)?t:isNaN(t)?e:e+(t-e)*n}function I0(e,t,n){return(n-e)/(t-e)}function Ea(e,t,n){return Nn(t[0],t[1],I0(e[0],e[1],n))}function V0(e){return e.map(e=>e.split("|").map(e=>{e=e.trim();let t=e.match(/^(<[a-z]+>)\[(-?[.\d]+),\s*(-?[.\d]+)\]?$/);if(t){let e=new String(t[1]);return e.range=[+t[2],+t[3]],e}return e}))}function $0(e,t,n){return Math.max(Math.min(n,t),e)}function cs(e,t){return Math.sign(e)===Math.sign(t)?e:-e}function be(e,t){return cs((e<0?-e:e)**t,e)}function No(e,t){return t===0?0:e/t}function q0(e,t,n=0,s=e.length){for(;n<s;){const o=n+s>>1;e[o]<t?n=o+1:s=o}return n}function Lo(e){return Array.isArray(e)?e:N[e]}function xo(e,t,n,s={}){if(e=Lo(e),t=Lo(t),!e||!t)throw new TypeError(`Missing white point to convert ${e?"":"from"}${!e&&!t?"/":""}${t?"":"to"}`);if(e===t)return n;let o={W1:e,W2:t,XYZ:n,options:s};if(Ae.run("chromatic-adaptation-start",o),o.M||(o.W1===N.D65&&o.W2===N.D50?o.M=[[1.0479297925449969,.022946870601609652,-.05019226628920524],[.02962780877005599,.9904344267538799,-.017073799063418826],[-.009243040646204504,.015055191490298152,.7518742814281371]]:o.W1===N.D50&&o.W2===N.D65&&(o.M=[[.955473421488075,-.02309845494876471,.06325924320057072],[-.0283697093338637,1.0099953980813041,.021041441191917323],[.012314014864481998,-.020507649298898964,1.330365926242124]])),Ae.run("chromatic-adaptation-end",o),o.M)return v(o.M,o.XYZ);throw new TypeError("Only Bradford CAT with white points D50 and D65 supported for now.")}function X0(e,t,n,s){let o=Object.entries(e.coords).map(([e,o],i)=>{let d=t.coordGrammar[i],r=s[i],c=r?.type,a;if(r.none?a=d.find(e=>R2.has(e)):a=d.find(e=>e==c),!a){let t=o.name||e;throw new TypeError(`${c??r.raw} not allowed for ${t} in ${n}()`)}let l=a.range;c==="<percentage>"&&(l||=[0,1]);let u=o.range||o.refRange;return l&&u&&(s[i]=Ea(l,u,s[i])),a});return o}function Q0(e,{meta:t}={}){let s={str:String(e)?.trim()};if(Ae.run("parse-start",s),s.color)return s.color;if(s.parsed=R0(s.str),s.parsed){{let e=s.parsed.name;if(e==="color"){let e=s.parsed.args.shift(),o=e.startsWith("--")?e.substring(2):`--${e}`,i=[e,o],c=s.parsed.rawArgs.indexOf("/")>0?s.parsed.args.pop():1;for(let a of n.all){let o=a.getFormat("color");if(o&&(i.includes(o.id)||o.ids?.filter(e=>i.includes(e)).length)){const n=Object.keys(a.coords).map((e,t)=>s.parsed.args[t]||0);let i;return o.coordGrammar&&(i=X0(a,o,"color",n)),t&&Object.assign(t,{formatId:"color",types:i}),o.id.startsWith("--")&&!e.startsWith("--")&&V.warn(`${a.name} is a non-standard space and not currently supported in the CSS spec. Use prefixed color(${o.id}) instead of color(${e}).`),e.startsWith("--")&&!o.id.startsWith("--")&&V.warn(`${a.name} is a standard space and supported in the CSS spec. Use color(${o.id}) instead of prefixed color(${e}).`),{spaceId:a.id,coords:n,alpha:c}}}let a="",r=e in n.registry?e:o;if(r in n.registry){let e=n.registry[r].formats?.color?.id;e&&(a=`Did you mean color(${e})?`)}throw new TypeError(`Cannot parse color(${e}). `+(a||"Missing a plugin?"))}for(let i of n.all){let o=i.getFormat(e);if(o&&o.type==="function"){let n=1;(o.lastAlpha||P0(s.parsed.args).alpha)&&(n=s.parsed.args.pop());let a=s.parsed.args,r;return o.coordGrammar&&(r=X0(i,o,e,a)),t&&Object.assign(t,{formatId:o.name,types:r}),{spaceId:i.id,coords:a,alpha:n}}}}}else for(let e of n.all)for(let i in e.formats){let n=e.formats[i];if(n.type!=="custom")continue;if(n.test&&!n.test(s.str))continue;let o=n.parse(s.str);if(o)return o.alpha??=1,t&&(t.formatId=i),o}throw new TypeError(`Could not parse ${e} as a color. Missing a plugin?`)}function r(e){if(Array.isArray(e))return e.map(r);if(!e)throw new TypeError("Empty color reference");Dn(e)&&(e=Q0(e));let t=e.space||e.spaceId;return t instanceof n||(e.space=n.get(t)),e.alpha===0[0]&&(e.alpha=1),e}function sh(e){let t=[e];for(let n=e;n=n.base;)t.push(n);return t}function e2(e,{coords:t}={}){if(e.coords&&!e.coordGrammar){e.type||="function",e.name||="color",e.coordGrammar=V0(e.coords);let n=Object.entries(t).map(([t,n],s)=>{let o=e.coordGrammar[s][0],r=n.range||n.refRange,a=o.range,i="";return o=="<percentage>"?(a=[0,100],i="%"):o=="<angle>"&&(i="deg"),{fromRange:r,toRange:a,suffix:i}});e.serializeCoords=(e,t)=>e.map((e,s)=>{let{fromRange:o,toRange:i,suffix:a}=n[s];return o&&i&&(e=Ea(o,i,e)),e=ko(e,{precision:t,unit:a}),e})}return e}function Pn(e,t){return e=r(e),!t||e.space.equals(t)?e.coords.slice():(t=n.get(t),t.from(e))}function G(e,t){e=r(e);let{space:s,index:o}=n.resolveCoord(t,e.space),i=Pn(e,s);return i[o]}function hi(e,t,s){return e=r(e),t=n.get(t),e.coords=t.to(e.space,s),e}function _e(e,t,s){if(e=r(e),arguments.length===2&&ze(arguments[1])==="object"){let t=arguments[1];for(let n in t)_e(e,n,t[n])}else{typeof s=="function"&&(s=s(G(e,t)));let{space:o,index:a}=n.resolveCoord(t,e.space),i=Pn(e,o);i[a]=s,hi(e,o,i)}return e}function ue(e){return(e%360+360)%360}function Z3(e,t){if(e==="raw")return t;let[s,o]=t.map(ue),n=o-s;return e==="increasing"?n<0&&(o+=360):e==="decreasing"?n>0&&(s+=360):e==="longer"?-180<n&&n<180&&(n>0?s+=360:o+=360):e==="shorter"&&(n>180?s+=360:n<-180&&(o+=360)),[s,o]}function r2(e){const t=e*e,n=t*t*t*e;return n}function c2(e,t,{kL:n=1,kC:s=1,kH:o=1}={}){[e,t]=r([e,t]);let[w,A,g]=W.from(e),x=Ct.from(W,[w,A,g])[1],[b,z,v]=W.from(t),O=Ct.from(W,[b,z,v])[1];x<0&&(x=0),O<0&&(O=0);let R=(x+O)/2,C=r2(R),F=.5*(1-(C/(C+ic))**.5),y=(1+F)*A,j=(1+F)*z,c=(y**2+g**2)**.5,f=(j**2+v**2)**.5,m=y===0&&g===0?0:Math.atan2(g,y),h=j===0&&v===0?0:Math.atan2(v,j);m<0&&(m+=2*os),h<0&&(h+=2*os),m*=Yr,h*=Yr;let $=b-w,M=f-c,a=h-m,l=m+h,k=a<0?-a:a,u;c*f===0?u=0:k<=180?u=a:a>180?u=a-360:a<-180?u=a+360:V.warn("the unthinkable has happened");let S=2*(f*c)**.5*Math.sin(u*Ye/2),P=(w+b)/2,_=(c+f)/2,T=r2(_),i;c*f===0?i=l:k<=180?i=l/2:l<360?i=(l+360)/2:i=(l-360)/2;let D=(P-50)**2,L=1+.015*D/(20+D)**.5,N=1+.045*_,d=1;d-=.17*Math.cos((i-30)*Ye),d+=.24*Math.cos(2*i*Ye),d+=.32*Math.cos((3*i+6)*Ye),d-=.2*Math.cos((4*i-63)*Ye);let E=1+.015*_*d,H=30*Math.exp(-1*((i-275)/25)**2),I=2*(T/(T+ic))**.5,B=-1*Math.sin(2*H*Ye)*I,p=($/(n*L))**2;return p+=(M/(s*N))**2,p+=(S/(o*E))**2,p+=B*(M/(s*N))*(S/(o*E)),p**.5}function Ai(e,t){[e,t]=r([e,t]);let[n,s,o]=Ze.from(e),[i,a,c]=Ze.from(t),l=n-i,d=s-a,u=o-c;return(l**2+d**2+u**2)**.5}function Ge(e,t,{epsilon:s=g2}={}){e=r(e),t||(t=e.space),t=n.get(t);let o=e.coords;return t!==e.space&&(o=t.from(e)),t.inGamut(o,{epsilon:s})}function zt(e){return{space:e.space,coords:e.coords.slice(),alpha:e.alpha}}function h2(e,t,s="lab"){s=n.get(s);let o=s.from(e),i=s.from(t);return o.reduce((e,t,n)=>{let s=i[n];return isNaN(t)||isNaN(s)?e:e+(s-t)**2},0)**.5}function G3(e,t){return h2(e,t,"lab")}function Y3(e,t,{l:n=2,c:s=1}={}){[e,t]=r([e,t]);let[a,f,h]=W.from(e),[,o,i]=Ct.from(W,[a,f,h]),[p,m,b]=W.from(t),c=Ct.from(W,[p,m,b])[1];o<0&&(o=0),c<0&&(c=0);let C=a-p,u=o-c,O=f-m,w=h-b,_=O**2+w**2-u**2,j=.511;a>=16&&(j=.040975*a/(1+.01765*a));let y=.0638*o/(1+.0131*o)+.638,d;Number.isNaN(i)&&(i=0),i>=164&&i<=345?d=.56+Math.abs(.2*Math.cos((i+168)*Nr)):d=.36+Math.abs(.4*Math.cos((i+35)*Nr));let v=o**4,g=(v/(v+1900))**.5,x=y*(g*d+1-g),l=(C/(n*j))**2;return l+=(u/(s*y))**2,l+=_/x**2,l**.5}function q3(e,t){[e,t]=r([e,t]);let[a,o,n]=to.from(e),[c,i,s]=to.from(t),l=a-c,d=o-i;Number.isNaN(n)&&Number.isNaN(s)?(n=0,s=0):Number.isNaN(n)?n=s:Number.isNaN(s)&&(s=n);let u=n-s,h=2*(o*i)**.5*Math.sin(u/2*(Math.PI/180));return(l**2+d**2+h**2)**.5}function K3(e){let t=e.map(function(e){let t=ma+Sa*(e/1e4)**Xa,n=1+Na*(e/1e4)**Xa;return(t/n)**a0});return v(e0,t)}function W3(e){let t=v(J4,e),n=t.map(function(e){let t=Math.max(e**pr-ma,0),n=Sa-Na*e**pr;return 1e4*(t/n)**i0});return n}function $3(e,t){[e,t]=r([e,t]);let[n,s,o]=Cs.from(e),[i,a,c]=Cs.from(t);return 720*((n-i)**2+.25*(s-a)**2+(o-c)**2)**.5}function j2(e,t){const n=e.map(e=>{const n=be(t*(e<0?-e:e)*.01,Zr);return 400*cs(n,e)/(n+27.13)});return n}function V3(e,t){const n=100/t*27.13**$a;return e.map(e=>{const t=e<0?-e:e;return cs(n*be(t/(400-t),$a),e)})}function B3(e){let t=ue(e);t<=He.h[0]&&(t+=360);const n=q0(He.h,t)-1,[o,i]=He.h.slice(n,n+2),[a,r]=He.e.slice(n,n+2),c=He.H[n],s=(t-o)/a;return c+100*s/(s+(i-t)/r)}function H3(e){let t=(e%400+400)%400;const n=Math.floor(.01*t);t=t%100;const[o,a]=He.h.slice(n,n+2),[i,s]=He.e.slice(n,n+2);return ue((t*(s*o-i*a)-100*o*s)/(t*(s-i)-100*s))}function O2(e,t,n,s,o){const i={};i.discounting=o,i.refWhite=e,i.surround=s;const c=e.map(e=>e*100);i.la=t,i.yb=n;const l=c[1],d=v(oc,c);s=c4[i.surround];const u=s[0];i.c=s[1],i.nc=s[2];const h=1/(5*i.la+1),a=h**4;i.fl=a*i.la+.1*(1-a)*(1-a)*Math.cbrt(5*i.la),i.flRoot=i.fl**.25,i.n=i.yb/l,i.z=1.48+i.n**.5,i.nbb=.725*i.n**-.2,i.ncb=i.nbb;const m=Math.max(Math.min(u*(1-1/3.6*Math.exp((-i.la-42)/92)),1),0);i.dRgb=d.map(e=>Nn(1,l/e,m)),i.dRgbInv=i.dRgb.map(e=>1/e);const f=d.map((e,t)=>e*i.dRgb[t]),r=j2(f,i.fl);return i.aW=i.nbb*(2*r[0]+r[1]+.05*r[2]),i}function Wi(e,t){if(!(e.J!==0[0]^e.Q!==0[0]))throw new Error("Conversion requires one and only one: 'J' or 'Q'");if(!(e.C!==0[0]^e.M!==0[0]^e.s!==0[0]))throw new Error("Conversion requires one and only one: 'C', 'M' or 's'");if(!(e.h!==0[0]^e.H!==0[0]))throw new Error("Conversion requires one and only one: 'h' or 'H'");if(e.J===0||e.Q===0)return[0,0,0];let s=0;e.h!==0[0]?s=ue(e.h)*Fr:s=H3(e.H)*Fr;const c=Math.cos(s),a=Math.sin(s);let n=0;e.J!==0[0]?n=be(e.J,1/2)*.1:e.Q!==0[0]&&(n=.25*t.c*e.Q/((t.aW+4)*t.flRoot));let o=0;e.C!==0[0]?o=e.C/n:e.M!==0[0]?o=e.M/t.flRoot/n:e.s!==0[0]&&(o=4e-4*e.s**2*(t.aW+4)/t.c);const r=be(o*(1.64-.29**t.n)**-.73,10/9),d=.25*(Math.cos(s+2)+3.8),u=t.aW*be(n,2/t.c/t.z),h=5e4/13*t.nc*t.ncb*d,i=u/t.nbb,l=23*(i+.305)*No(r,23*h+r*(11*c+108*a)),m=l*c,f=l*a,p=V3(v(l4,[i,m,f]).map(e=>e*1/1403),t.fl);return v(f4,p.map((e,n)=>e*t.dRgbInv[n])).map(e=>e/100)}function C2(e,t){const f=e.map(e=>e*100),n=j2(v(oc,f).map((e,n)=>e*t.dRgb[n]),t.fl),i=n[0]+(-12*n[1]+n[2])/11,c=(n[0]+n[1]-2*n[2])/9,a=(Math.atan2(c,i)%us+us)%us,g=.25*(Math.cos(a+2)+3.8),d=5e4/13*t.nc*t.ncb*No(g*(i**2+c**2)**.5,n[0]+n[1]+1.05*n[2]+.305),l=be(d,.9)*(1.64-.29**t.n)**.73,u=t.nbb*(2*n[0]+n[1]+.05*n[2]),s=be(u/t.aW,.5*t.c*t.z),h=100*be(s,2),m=4/t.c*s*(t.aW+4)*t.flRoot,o=l*s,p=o*t.flRoot,r=ue(a*r4),b=B3(r),j=50*be(t.c*l/(t.aW+4),1/2);return{J:h,C:o,h:r,s:j,Q:m,M:p,H:b}}function N3(e){const t=e>n4?Math.cbrt(e):(Po*e+16)/116;return 116*t-16}function oa(e){return e>8?((e+16)/116)**3:e/Po}function D3(e,t){let[i,a,n]=e,o=[],s=0;if(n===0)return[0,0,0];let r=oa(n);n>0?s=.00379058511492914*n**2+.608983189401032*n+.9155088574762233:s=9514440756550361e-21*n**2+.08693057439788597*n-21.928975842194614;const d=2e-12,u=15;let c=0,l=1/0;for(;c<=u;){o=Wi({J:s,C:a,h:i},t);const e=Math.abs(o[1]-r);if(e<l){if(e<=d)return o;l=e}s=s-(o[1]-r)*s/(2*o[1]),c+=1}return Wi({J:s,C:a,h:i},t)}function z3(e){const n=N3(e[1]);if(n===0)return[0,0,0];const s=C2(e,yo);return[ue(s.h),s.C,n]}function M2(e){e[1]<0&&(e=Nt.fromBase(Nt.toBase(e)));const t=Math.log(Math.max(1+wr[2]*e[1]*yo.flRoot,1))/wr[2],n=e[0]*U1,s=t*Math.cos(n),o=t*Math.sin(n);return[e[2],s,o]}function F3(e,t){[e,t]=r([e,t]);let[n,s,o]=M2(Nt.from(e)),[i,a,c]=M2(Nt.from(t));return((n-i)**2+(s-a)**2+(o-c)**2)**.5}function S3(e){const t=e?Math.floor(Math.log10(e<0?-e:e)):0;return Math.max(parseFloat(`1e${t-2}`),1e-6)}function We(e,{method:t=V.gamut_mapping,space:s=0[0],deltaEMethod:o="",jnd:i=2,blackWhiteClamp:a={}}={}){if(e=r(e),Dn(arguments[1])?s=arguments[1]:s||(s=e.space),s=n.get(s),Ge(e,s,{epsilon:0}))return e;let c;if(t==="css")c=k3(e,{space:s});else{if(t!=="clip"&&!Ge(e,s)){Object.prototype.hasOwnProperty.call(fc,t)&&({method:t,jnd:i,deltaEMethod:o,blackWhiteClamp:a}=fc[t]);let r=c2;if(o!=="")for(let e in at)if("deltae"+o.toLowerCase()===e.toLowerCase()){r=at[e];break}let l=We(g(e,s),{method:"clip",space:s});if(r(e,l)>i){if(Object.keys(a).length===3){let s=n.resolveCoord(a.channel),t=G(g(e,s.space),s.id);if(Fe(t)&&(t=0),t>=a.max)return g({space:"xyz-d65",coords:N.D65},e.space);if(t<=a.min)return g({space:"xyz-d65",coords:[0,0,0]},e.space)}let l=n.resolveCoord(t),f=l.space,d=l.id,o=g(e,f);o.coords.forEach((e,t)=>{Fe(e)&&(o.coords[t]=0)});let p=l.range||l.refRange,v=p[0],m=S3(i),u=v,h=G(o,d);for(;h-u>m;){let e=zt(o);e=We(e,{space:s,method:"clip"});let t=r(o,e);t-i<m?u=G(o,d):h=G(o,d),_e(o,d,(u+h)/2)}c=g(o,s)}else c=l}else c=g(e,s);if(t==="clip"||!Ge(c,s,{epsilon:0})){let e=Object.values(s.coords).map(e=>e.range||[]);c.coords=c.coords.map((t,n)=>{let[s,o]=e[n];return s!==0[0]&&(t=Math.max(s,t)),o!==0[0]&&(t=Math.min(t,o)),t})}}return s!==e.space&&(c=g(c,e.space)),e.coords=c.coords,e}function k3(e,{space:t}={}){const l=.02,u=1e-4;e=r(e),t||(t=e.space),t=n.get(t);const p=n.get("oklch");if(t.isUnbounded)return g(e,t);const o=g(e,p);let h=o.coords[0];if(h>=1){const n=g(Vi.WHITE,t);return n.alpha=e.alpha,g(n,t)}if(h<=0){const n=g(Vi.BLACK,t);return n.alpha=e.alpha,g(n,t)}if(Ge(o,t,{epsilon:0}))return g(o,t);function m(e){const n=g(e,t),s=Object.values(t.coords);return n.coords=n.coords.map((e,t)=>{if("range"in s[t]){const[n,o]=s[t].range;return $0(n,e,o)}return e}),n}let a=0,d=o.coords[1],f=!0,s=zt(o),i=m(s),c=Ai(i,s);if(c<l)return i;for(;d-a>u;){const e=(a+d)/2;if(s.coords[1]=e,f&&Ge(s,t,{epsilon:0}))a=e;else if(i=m(s),c=Ai(i,s),c<l){if(l-c<u)break;f=!1,a=e}else d=e}return i}function g(e,t,{inGamut:s}={}){e=r(e),t=n.get(t);let i=t.from(e),o={space:t,coords:i,alpha:e.alpha};return s&&(o=We(o,s===!0?0[0]:s)),o}function $n(e,{precision:t=V.precision,format:s="default",inGamut:o=!0,...i}={}){let c;e=r(e);let l=s;s=e.space.getFormat(s)??e.space.getFormat("default")??n.DEFAULT_FORMAT;let a=e.coords.slice();if(o||=s.toGamut,o&&!Ge(e)&&(a=We(zt(e),o===!0?0[0]:o).coords),s.type==="custom")if(i.precision=t,s.serialize)c=s.serialize(a,e.alpha,i);else throw new TypeError(`format ${l} can only be used to parse colors, not for serialization`);else{let o=s.name||"color";s.serializeCoords?a=s.serializeCoords(a,t):t!==null&&(a=a.map(e=>ko(e,{precision:t})));let i=[...a];if(o==="color"){let t=s.id||s.ids?.[0]||e.space.id;i.unshift(t)}let n=e.alpha;t!==null&&(n=ko(n,{precision:t}));let r=e.alpha>=1||s.noAlpha?"":`${s.commas?",":" /"} ${n}`;c=`${o}(${i.join(s.commas?", ":" ")}${r})`}return c}function C3(e,{space:t=V.display_space,...n}={}){let s=$n(e,n);if(typeof CSS=="undefined"||CSS.supports("color",s)||!V.display_space)s=new String(s),s.color=e;else{let o=e,i=e.coords.some(Fe)||Fe(e.alpha);if(i&&!(hm??=CSS.supports("color","hsl(none 50% 50%)"))&&(o=zt(e),o.coords=o.coords.map(E),o.alpha=E(o.alpha),s=$n(o,n),CSS.supports("color",s)))return s=new String(s),s.color=o,s;o=g(o,t),s=new String($n(o,n)),s.color=o}return s}function x3(e,t){return e=r(e),t=r(t),e.space===t.space&&e.alpha===t.alpha&&e.coords.every((e,n)=>e===t.coords[n])}function Be(e){return G(e,[S,"y"])}function I2(e,t){_e(e,[S,"y"],t)}function O3(e){Object.defineProperty(e.prototype,"luminance",{get(){return Be(this)},set(e){I2(this,e)}})}function w3(e,t){e=r(e),t=r(t);let n=Math.max(Be(e),0),s=Math.max(Be(t),0);return s>n&&([n,s]=[s,n]),(n+.05)/(s+.05)}function $2(e){return e>=ci?e:e+(ci-e)**Au}function kt(e){let t=e<0?-1:1,n=e<0?-e:e;return t*n**2.4}function y3(e,t){t=r(t),e=r(e);let s,n,o,i,a,c;t=g(t,"srgb"),[i,a,c]=t.coords;let u=kt(i)*.2126729+kt(a)*.7151522+kt(c)*.072175;e=g(e,"srgb"),[i,a,c]=e.coords;let h=kt(i)*.2126729+kt(a)*.7151522+kt(c)*.072175,l=$2(u),d=$2(h),m=d>l;return Math.abs(d-l)<Eu?n=0:m?(s=d**Tu-l**Fu,n=s*yu):(s=d**Su-l**Mu,n=s*gu),(n<0?-n:n)<ku?o=0:n>0?o=n-Bo:o=n+Bo,o*100}function j3(e,t){e=r(e),t=r(t);let n=Math.max(Be(e),0),s=Math.max(Be(t),0);s>n&&([n,s]=[s,n]);let o=n+s;return o===0?0:(n-s)/o}function p3(e,t){e=r(e),t=r(t);let s=Math.max(Be(e),0),n=Math.max(Be(t),0);return n>s&&([s,n]=[n,s]),n===0?pu:(s-n)/n}function f3(e,t){e=r(e),t=r(t);let n=G(e,[W,"l"]),s=G(t,[W,"l"]);return Math.abs(n-s)}function m3(e,t){e=r(e),t=r(t);let s=G(e,[So,"l"]),o=G(t,[So,"l"]),i=Math.abs(s**Ao-o**Ao),n=i**(1/Ao)*Math.SQRT2-40;return n<7.5?0:n}function h3(e,t,n={}){Dn(n)&&(n={algorithm:n});let{algorithm:s,...o}=n;if(!s){let e=Object.keys(zn).map(e=>e.replace(/^contrast/,"")).join(", ");throw new TypeError(`contrast() function needs a contrast algorithm. Please specify one of: ${e}`)}e=r(e),t=r(t);for(let n in zn)if("contrast"+s.toLowerCase()===n.toLowerCase())return zn[n](e,t,o);throw new TypeError(`Unknown contrast algorithm: ${s}`)}function Vs(e){let[t,n,o]=Pn(e,S),s=t+15*n+3*o;return[4*t/s,9*n/s]}function Z2(e){let[t,n,o]=Pn(e,S),s=t+n+o;return[t/s,n/s]}function d3(e){Object.defineProperty(e.prototype,"uv",{get(){return Vs(this)}}),Object.defineProperty(e.prototype,"xy",{get(){return Z2(this)}})}function Kn(e,t,n={}){Dn(n)&&(n={method:n});let{method:s=V.deltaE,...o}=n;for(let n in at)if("deltae"+s.toLowerCase()===n.toLowerCase())return at[n](e,t,o);throw new TypeError(`Unknown deltaE method: ${s}`)}function l3(e,t=.25){let s=n.get("oklch","lch"),o=[s,"l"];return _e(e,o,e=>e*(1+t))}function em(e,t=.25){let s=n.get("oklch","lch"),o=[s,"l"];return _e(e,o,e=>e*(1-t))}function s3(e,t,n=.5,s={}){[e,t]=[r(e),r(t)],ze(n)==="object"&&([n,s]=[.5,n]);let o=qn(e,t,s);return o(n)}function o3(e,t,n={}){let o;sr(e)&&([o,n]=[e,t],[e,t]=o.rangeArgs.colors);let{maxDeltaE:a,deltaEMethod:d,steps:l=2,maxSteps:c=1e3,...u}=n;o||([e,t]=[r(e),r(t)],o=qn(e,t,u));let h=Kn(e,t),i=a>0?Math.max(l,Math.ceil(h/a)+1):l,s=[];if(c!==0[0]&&(i=Math.min(i,c)),i===1)s=[{p:.5,color:o(.5)}];else{let e=1/(i-1);s=Array.from({length:i},(t,n)=>{let s=n*e;return{p:s,color:o(s)}})}if(a>0){let e=s.reduce((e,t,n)=>{if(n===0)return 0;let o=Kn(t.color,s[n-1].color,d);return Math.max(e,o)},0);for(;e>a;){e=0;for(let t=1;t<s.length&&s.length<c;t++){let i=s[t-1],a=s[t],n=(a.p+i.p)/2,r=o(n);e=Math.max(e,Kn(r,i.color),Kn(r,a.color)),s.splice(t,0,{p:n,color:o(n)}),t++}}}return s=s.map(e=>e.color),s}function qn(e,t,s={}){if(sr(e)){let[n,s]=[e,t];return qn(...n.rangeArgs.colors,{...n.rangeArgs.options,...s})}let{space:o,outputSpace:i,progression:a,premultiplied:c}=s;e=r(e),t=r(t),e=zt(e),t=zt(t);let l={colors:[e,t],options:s};if(o?o=n.get(o):o=n.registry[V.interpolationSpace]||e.space,i=i?n.get(i):o,e=g(e,o),t=g(t,o),e=We(e),t=We(t),o.coords.h&&o.coords.h.type==="angle"){let r=s.hue=s.hue||"shorter",a=[o,"h"],[n,i]=[G(e,a),G(t,a)];isNaN(n)&&!isNaN(i)?n=i:isNaN(i)&&!isNaN(n)&&(i=n),[n,i]=Z3(r,[n,i]),_e(e,a,n),_e(t,a,i)}return c&&(e.coords=e.coords.map(t=>t*e.alpha),t.coords=t.coords.map(e=>e*t.alpha)),Object.assign(n=>{n=a?a(n):n;let l=e.coords.map((e,s)=>{let o=t.coords[s];return Nn(e,o,n)}),r=Nn(e.alpha,t.alpha,n),s={space:o,coords:l,alpha:r};return c&&(s.coords=s.coords.map(e=>e/r)),i!==o&&(s=g(s,i)),s},{rangeArgs:l})}function sr(e){return ze(e)==="function"&&!!e.rangeArgs}function Sh(e){e.defineFunction("mix",s3,{returns:"color"}),e.defineFunction("range",qn,{returns:"function<color>"}),e.defineFunction("steps",o3,{returns:"array<color>"})}function Et(e,t,n){const s=t/(Math.sin(n)-e*Math.cos(n));return s<0?1/0:s}function Rs(e){const i=(e+16)**3/1560896,t=i>Od?i:e/vd,a=t*(284517*xa-94839*Qs),r=t*(838422*Qs+769860*To+731718*xa),n=t*(632260*Qs-126452*To),c=t*(284517*Ma-94839*Gs),l=t*(838422*Gs+769860*Fa+731718*Ma),s=t*(632260*Gs-126452*Fa),d=t*(284517*Pa-94839*$s),u=t*(838422*$s+769860*Ia+731718*Pa),o=t*(632260*$s-126452*Ia);return{r0s:a/n,r0i:r*e/n,r1s:a/(n+126452),r1i:(r-769860)*e/(n+126452),g0s:c/s,g0i:l*e/s,g1s:c/(s+126452),g1i:(l-769860)*e/(s+126452),b0s:d/o,b0i:u*e/o,b1s:d/(o+126452),b1i:(u-769860)*e/(o+126452)}}function J2(e,t){const n=t/360*Math.PI*2,s=Et(e.r0s,e.r0i,n),o=Et(e.r1s,e.r1i,n),i=Et(e.g0s,e.g0i,n),a=Et(e.g1s,e.g1i,n),r=Et(e.b0s,e.b0i,n),c=Et(e.b1s,e.b1i,n);return Math.min(s,o,i,a,r,c)}function _t(e,t){return(t<0?-t:t)/(e**2+1)**.5}function X2(e){let t=_t(e.r0s,e.r0i),n=_t(e.r1s,e.r1i),s=_t(e.g0s,e.g0i),o=_t(e.g1s,e.g1i),i=_t(e.b0s,e.b0i),a=_t(e.b1s,e.b1i);return Math.min(t,n,s,o,i,a)}function Ns({id:e,toCone_M:t,fromCone_M:n}){nc[e]=arguments[0]}function Y2(e,t,n="Bradford"){let s=nc[n],[o,i,a]=v(s.toCone_M,e),[r,c,l]=v(s.toCone_M,t),d=[[r/o,0,0],[0,c/i,0],[0,0,l/a]],u=v(d,s.toCone_M),h=v(s.fromCone_M,u);return h}function Er(e,t){let s=e.replace(/-/g,"_");Object.defineProperty($.prototype,s,{get(){let s=this.getAll(e);return typeof Proxy=="undefined"?s:new Proxy(s,{has:(e,s)=>{try{return n.resolveCoord([t,s]),!0}catch{}return Reflect.has(e,s)},get:(e,s,o)=>{if(s&&typeof s!="symbol"&&!(s in e)){let{index:o}=n.resolveCoord([t,s]);if(o>=0)return e[o]}return Reflect.get(e,s,o)},set:(s,o,i,a)=>{if(o&&typeof o!="symbol"&&!(o in s)||o>=0){let{index:a}=n.resolveCoord([t,o]);if(a>=0)return s[a]=i,this.setAll(e,s),!0}return Reflect.set(s,o,i,a)}})},set(t){this.setAll(e,t)},configurable:!0,enumerable:!0})}function g3(){try{const e=screen.colorDepth/3,t=e>8,n=window.matchMedia("(dynamic-range: high)").matches,s=window.matchMedia("(color-gamut: rec2020)").matches||window.matchMedia("(color-gamut: p3)").matches;return!!(s&&n)&&e===Math.round(e)&&!!t}catch(e){return console.error("Bad window.screen test",e),!1}}function v3(){const e="rec2100-pq";try{const t=document.createElement("canvas");if(!t.getContext)return!1;const n=t.getContext("2d",{colorSpace:e,pixelFormat:"float16"});return n!==null}catch{return console.error("Bad canvas ColorSpace test - make sure that the Chromium browser flag 'enable-experimental-web-platform-features' has been enabled"),!1}}function b3(){HTMLCanvasElement.prototype._getContext=HTMLCanvasElement.prototype.getContext,HTMLCanvasElement.prototype.getContext=function(e,t){return t!==0[0]?t=Object.assign({},t,_c):t=_c,this._getContext(e,t)}}Fl=e({"node_modules/hdr-canvas/dist/hdr-canvas.js"(){if(K2={deg:1,grad:.9,rad:180/Math.PI,turn:360},U2=Object.freeze({__proto__:null,bisectLeft:q0,clamp:$0,copySign:cs,interpolate:Nn,interpolateInv:I0,isNone:Fe,isString:Dn,last:P0,mapRange:Ea,multiplyMatrices:v,parseCoordGrammar:V0,parseFunction:R0,serializeNumber:ko,skipNone:E,spow:be,toPrecision:L0,type:ze,zdiv:No}),W2=class{add(e,t,n){if(typeof arguments[0]!="string"){for(var e in arguments[0])this.add(e,arguments[0][e],arguments[1]);return}(Array.isArray(e)?e:[e]).forEach(function(e){this[e]=this[e]||[],t&&this[e][n?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(e){e.call(t&&t.context?t.context:t,t)})}},Ae=new W2,V={gamut_mapping:"css",precision:5,deltaE:"76",verbose:globalThis?.process?.env?.NODE_ENV?.toLowerCase()!=="test",warn:function(t){this.verbose&&globalThis?.console?.warn?.(t)}},N={D50:[.3457/.3585,1,(1-.3457-.3585)/.3585],D65:[.3127/.329,1,(1-.3127-.329)/.329]},R2=new Set(["<number>","<percentage>","<angle>"]),N2=75e-6,n=class _ColorSpace{constructor(e){this.id=e.id,this.name=e.name,this.base=e.base?_ColorSpace.get(e.base):null,this.aliases=e.aliases,this.base&&(this.fromBase=e.fromBase,this.toBase=e.toBase);let t=e.coords??this.base.coords;for(let e in t)"name"in t[e]||(t[e].name=e);this.coords=t;let n=e.white??this.base.white??"D65";this.white=Lo(n),this.formats=e.formats??{};for(let e in this.formats){let t=this.formats[e];t.type||="function",t.name||=e}this.formats.color?.id||(this.formats.color={...this.formats.color??{},id:e.cssId||this.id}),e.gamutSpace?this.gamutSpace=e.gamutSpace==="self"?this:_ColorSpace.get(e.gamutSpace):this.isPolar?this.gamutSpace=this.base:this.gamutSpace=this,this.gamutSpace.isUnbounded&&(this.inGamut=()=>!0),this.referred=e.referred,Object.defineProperty(this,"path",{value:sh(this).reverse(),writable:!1,enumerable:!0,configurable:!0}),Ae.run("colorspace-init-end",this)}inGamut(e,{epsilon:t=N2}={}){if(!this.equals(this.gamutSpace))return e=this.to(this.gamutSpace,e),this.gamutSpace.inGamut(e,{epsilon:t});let n=Object.values(this.coords);return e.every((e,s)=>{let o=n[s];if(o.type!=="angle"&&o.range){if(Number.isNaN(e))return!0;let[n,s]=o.range;return(n===0[0]||e>=n-t)&&(s===0[0]||e<=s+t)}return!0})}get isUnbounded(){return Object.values(this.coords).every(e=>!("range"in e))}get cssId(){return this.formats?.color?.id||this.id}get isPolar(){for(let e in this.coords)if(this.coords[e].type==="angle")return!0;return!1}getFormat(e){if(typeof e=="object")return e=e2(e,this),e;let t;return e==="default"?t=Object.values(this.formats)[0]:t=this.formats[e],t?(t=e2(t,this),t):null}equals(e){return!!e&&(this===e||this.id===e||this.id===e.id)}to(e,t){if(arguments.length===1){const n=r(e);[e,t]=[n.space,n.coords]}if(e=_ColorSpace.get(e),this.equals(e))return t;t=t.map(e=>Number.isNaN(e)?0:e);let n=this.path,s=e.path,i,o;for(let e=0;e<n.length;e++)if(n[e].equals(s[e]))i=n[e],o=e;else break;if(!i)throw new Error(`Cannot convert between color spaces ${this} and ${e}: no connection space was found`);for(let e=n.length-1;e>o;e--)t=n[e].toBase(t);for(let e=o+1;e<s.length;e++)t=s[e].fromBase(t);return t}from(e,t){if(arguments.length===1){const n=r(e);[e,t]=[n.space,n.coords]}return e=_ColorSpace.get(e),e.to(this,t)}toString(){return`${this.name} (${this.id})`}getMinCoords(){let e=[];for(let n in this.coords){let t=this.coords[n],s=t.range||t.refRange;e.push(s?.min??0)}return e}static registry={};static get all(){return[...new Set(Object.values(_ColorSpace.registry))]}static register(e,t){if(arguments.length===1&&(t=arguments[0],e=t.id),t=this.get(t),this.registry[e]&&this.registry[e]!==t)throw new Error(`Duplicate color space registration: '${e}'`);if(this.registry[e]=t,arguments.length===1&&t.aliases)for(let e of t.aliases)this.register(e,t);return t}static get(e,...t){if(!e||e instanceof _ColorSpace)return e;let n=ze(e);if(n==="string"){let t=_ColorSpace.registry[e.toLowerCase()];if(!t)throw new TypeError(`No color space found with id = "${e}"`);return t}if(t.length)return _ColorSpace.get(...t);throw new TypeError(`${e} is not a valid color space`)}static resolveCoord(e,t){let o=ze(e),n,s;if(o==="string"?e.includes(".")?[n,s]=e.split("."):[n,s]=[,e]:Array.isArray(e)?[n,s]=e:(n=e.space,s=e.coordId),n=_ColorSpace.get(n),n||(n=t),!n)throw new TypeError(`Cannot resolve coordinate reference ${e}: No color space specified and relative references are not allowed here`);if(o=ze(s),o==="number"||o==="string"&&s>=0){let e=Object.entries(n.coords)[s];if(e)return{space:n,id:e[0],index:s,...e[1]}}n=_ColorSpace.get(n);let i=s.toLowerCase(),a=0;for(let e in n.coords){let t=n.coords[e];if(e.toLowerCase()===i||t.name?.toLowerCase()===i)return{space:n,id:e,index:a,...t};a++}throw new TypeError(`No "${s}" coordinate found in ${n.name}. Its coordinates are: ${Object.keys(n.coords).join(", ")}`)}static DEFAULT_FORMAT={type:"functions",name:"color"}},S=new n({id:"xyz-d65",name:"XYZ D65",coords:{x:{name:"X"},y:{name:"Y"},z:{name:"Z"}},white:"D65",formats:{color:{ids:["xyz-d65","xyz"]}},aliases:["xyz"]}),H=class extends n{constructor(e){e.coords||(e.coords={r:{range:[0,1],name:"Red"},g:{range:[0,1],name:"Green"},b:{range:[0,1],name:"Blue"}}),e.base||(e.base=S),e.toXYZ_M&&e.fromXYZ_M&&(e.toBase??=t=>{let n=v(e.toXYZ_M,t);return this.white!==this.base.white&&(n=xo(this.white,this.base.white,n)),n},e.fromBase??=t=>(t=xo(this.base.white,this.white,t),v(e.fromXYZ_M,t))),e.referred??="display",super(e)}},hi.returns="color",_e.returns="color",hs=new n({id:"xyz-d50",name:"XYZ D50",white:"D50",base:S,fromBase:e=>xo(S.white,"D50",e),toBase:e=>xo("D50",S.white,e)}),F2=216/24389,ac=24/116,Zt=24389/27,ls=N.D50,W=new n({id:"lab",name:"Lab",coords:{l:{refRange:[0,100],name:"Lightness"},a:{refRange:[-125,125]},b:{refRange:[-125,125]}},white:ls,base:hs,fromBase(e){let n=e.map((e,t)=>e/ls[t]),t=n.map(e=>e>F2?Math.cbrt(e):(Zt*e+16)/116);return[116*t[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])]},toBase(e){let t=[];t[1]=(e[0]+16)/116,t[0]=e[1]/500+t[1],t[2]=t[1]-e[2]/200;let n=[t[0]>ac?t[0]**3:(116*t[0]-16)/Zt,e[0]>8?((e[0]+16)/116)**3:e[0]/Zt,t[2]>ac?t[2]**3:(116*t[2]-16)/Zt];return n.map((e,t)=>e*ls[t])},formats:{lab:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),Ct=new n({id:"lch",name:"LCH",coords:{l:{refRange:[0,100],name:"Lightness"},c:{refRange:[0,150],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:W,fromBase(e){let[i,t,n]=e,s;const o=.02;return(t<0?-t:t)<o&&(n<0?-n:n)<o?s=NaN:s=Math.atan2(n,t)*180/Math.PI,[i,(t**2+n**2)**.5,ue(s)]},toBase(e){let[s,t,n]=e;return t<0&&(t=0),isNaN(n)&&(n=0),[s,t*Math.cos(n*Math.PI/180),t*Math.sin(n*Math.PI/180)]},formats:{lch:{coords:["<number> | <percentage>","<number> | <percentage>","<number> | <angle>"]}}}),ic=25**7,os=Math.PI,Yr=180/os,Ye=os/180,_2=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],y2=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],b2=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],v2=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],Ze=new n({id:"oklab",name:"Oklab",coords:{l:{refRange:[0,1],name:"Lightness"},a:{refRange:[-.4,.4]},b:{refRange:[-.4,.4]}},white:"D65",base:S,fromBase(e){let t=v(_2,e),n=t.map(e=>Math.cbrt(e));return v(b2,n)},toBase(e){let t=v(v2,e),n=t.map(e=>e**3);return v(y2,n)},formats:{oklab:{coords:["<percentage> | <number>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),g2=75e-6,p2=Math.PI,Nr=p2/180,tr=203,qs=new n({id:"xyz-abs-d65",cssId:"--xyz-abs-d65",name:"Absolute XYZ D65",coords:{x:{refRange:[0,9504.7],name:"Xa"},y:{refRange:[0,1e4],name:"Ya"},z:{refRange:[0,10888.3],name:"Za"}},base:S,fromBase(e){return e.map(e=>Math.max(e*tr,0))},toBase(e){return e.map(e=>Math.max(e/tr,0))}}),Wn=1.15,In=.66,ra=2610/2**14,xc=2**14/2610,Do=3424/2**12,zo=2413/2**7,qo=2392/2**7,Z0=1.7*2523/2**5,Oi=2**5/(1.7*2523),kn=-.56,ho=16295499532821565e-27,K0=[[.41478972,.579999,.014648],[-.20151,1.120649,.0531008],[-.0166008,.2648,.6684799]],U0=[[1.9242264357876067,-1.0047923125953657,.037651404030618],[.35031676209499907,.7264811939316552,-.06538442294808501],[-.09098281098284752,-.3127282905230739,1.5227665613052603]],B0=[[.5,.5,0],[3.524,-4.066708,.542708],[.199076,1.096799,-1.295875]],H0=[[1,.1386050432715393,.05804731615611886],[.9999999999999999,-.1386050432715393,-.05804731615611886],[.9999999999999998,-.09601924202631895,-.8118918960560388]],Ki=new n({id:"jzazbz",name:"Jzazbz",coords:{jz:{refRange:[0,1],name:"Jz"},az:{refRange:[-.5,.5]},bz:{refRange:[-.5,.5]}},base:qs,fromBase(e){let[t,o,n]=e,i=Wn*t-(Wn-1)*n,a=In*o-(In-1)*t,r=v(K0,[i,a,n]),c=r.map(function(e){let t=Do+zo*(e/1e4)**ra,n=1+qo*(e/1e4)**ra;return(t/n)**Z0}),[s,l,d]=v(B0,c),u=(1+kn)*s/(1+kn*s)-ho;return[u,l,d]},toBase(e){let[t,o,i]=e,a=(t+ho)/(1+kn-kn*(t+ho)),r=v(H0,[a,o,i]),c=r.map(function(e){let t=Do-e**Oi,n=qo*e**Oi-zo,s=1e4*(t/n)**xc;return s}),[l,d,n]=v(U0,c),s=(l+(Wn-1)*n)/Wn,u=(d+(In-1)*s)/In;return[s,u,n]},formats:{color:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),to=new n({id:"jzczhz",name:"JzCzHz",coords:{jz:{refRange:[0,1],name:"Jz"},cz:{refRange:[0,1],name:"Chroma"},hz:{refRange:[0,360],type:"angle",name:"Hue"}},base:Ki,fromBase(e){let[i,t,n]=e,s;const o=2e-4;return(t<0?-t:t)<o&&(n<0?-n:n)<o?s=NaN:s=Math.atan2(n,t)*180/Math.PI,[i,(t**2+n**2)**.5,ue(s)]},toBase(e){return[e[0],e[1]*Math.cos(e[2]*Math.PI/180),e[1]*Math.sin(e[2]*Math.PI/180)]}}),ma=3424/4096,Sa=2413/128,Na=2392/128,Xa=2610/16384,a0=2523/32,i0=16384/2610,pr=32/2523,o0=[[.3592832590121217,.6976051147779502,-.035891593232029],[-.1920808463704993,1.100476797037432,.0753748658519118],[.0070797844607479,.0748396662186362,.8433265453898765]],e0=[[2048/4096,2048/4096,0],[6610/4096,-13613/4096,7003/4096],[17933/4096,-17390/4096,-543/4096]],J4=[[.9999999999999998,.0086090370379328,.111029625003026],[.9999999999999998,-.0086090370379328,-.1110296250030259],[.9999999999999998,.5600313357106791,-.3206271749873188]],R4=[[2.0701522183894223,-1.3263473389671563,.2066510476294053],[.3647385209748072,.6805660249472273,-.0453045459220347],[-.0497472075358123,-.0492609666966131,1.1880659249923042]],Cs=new n({id:"ictcp",name:"ICTCP",coords:{i:{refRange:[0,1],name:"I"},ct:{refRange:[-.5,.5],name:"CT"},cp:{refRange:[-.5,.5],name:"CP"}},base:qs,fromBase(e){let t=v(o0,e);return K3(t)},toBase(e){let t=W3(e);return v(R4,t)}}),z4=N.D65,Zr=.42,$a=1/Zr,us=2*Math.PI,oc=[[.401288,.650173,-.051461],[-.250268,1.204414,.045854],[-.002079,.048952,.953127]],f4=[[1.8620678550872327,-1.0112546305316843,.14918677544445175],[.38752654323613717,.6214474419314753,-.008973985167612518],[-.015841498849333856,-.03412293802851557,1.0499644368778496]],l4=[[460,451,288],[460,-891,-261],[460,-220,-6300]],c4={dark:[.8,.525,.8],dim:[.9,.59,.9],average:[1,.69,1]},He={h:[20.14,90,164.25,237.53,380.14],e:[.8,.7,1,1.2,.8],H:[0,100,200,300,400]},r4=180/Math.PI,Fr=Math.PI/180,La=O2(z4,64/Math.PI*.2,20,"average",!1),a4=new n({id:"cam16-jmh",cssId:"--cam16-jmh",name:"CAM16-JMh",coords:{j:{refRange:[0,100],name:"J"},m:{refRange:[0,105],name:"Colorfulness"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:S,fromBase(e){const t=C2(e,La);return[t.J,t.M,t.h]},toBase(e){return Wi({J:e[0],M:e[1],h:e[2]},La)}}),s4=N.D65,n4=216/24389,Po=24389/27,yo=O2(s4,200/Math.PI*oa(50),oa(50)*100,"average",!1),Nt=new n({id:"hct",name:"HCT",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},c:{refRange:[0,145],name:"Colorfulness"},t:{refRange:[0,100],name:"Tone"}},base:S,fromBase(e){return z3(e)},toBase(e){return D3(e,yo)},formats:{color:{id:"--hct",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),U1=Math.PI/180,wr=[1,.007,.0228],at={deltaE76:G3,deltaECMC:Y3,deltaE2000:c2,deltaEJz:q3,deltaEITP:$3,deltaEOK:Ai,deltaEHCT:F3},fc={hct:{method:"hct.c",jnd:2,deltaEMethod:"hct",blackWhiteClamp:{}},"hct-tonal":{method:"hct.c",jnd:0,deltaEMethod:"hct",blackWhiteClamp:{channel:"hct.t",min:0,max:100}}},We.returns="color",Vi={WHITE:{space:Ze,coords:[1,0,0]},BLACK:{space:Ze,coords:[0,0,0]}},g.returns="color",B1=[[.6369580483012914,.14461690358620832,.1688809751641721],[.2627002120112671,.6779980715188708,.05930171646986196],[0,.028072693049087428,1.060985057710791]],R1=[[1.716651187971268,-.355670783776392,-.25336628137366],[-.666684351832489,1.616481236634939,.0157685458139111],[.017639857445311,-.042770613257809,.942103121235474]],ns=new H({id:"rec2020-linear",cssId:"--rec2020-linear",name:"Linear REC.2020",white:"D65",toXYZ_M:B1,fromXYZ_M:R1}),Qn=1.09929682680944,Lr=.018053968510807,gr=new H({id:"rec2020",name:"REC.2020",base:ns,toBase(e){return e.map(function(e){return e<Lr*4.5?e/4.5:((e+Qn-1)/Qn)**(1/.45)})},fromBase(e){return e.map(function(e){return e>=Lr?Qn*e**.45-(Qn-1):4.5*e})}}),O1=[[.4865709486482162,.26566769316909306,.1982172852343625],[.2289745640697488,.6917385218365064,.079286914093745],[0,.04511338185890264,1.043944368900976]],p1=[[2.493496911941425,-.9313836179191239,-.40271078445071684],[-.8294889695615747,1.7626640603183463,.023624685841943577],[.03584583024378447,-.07617238926804182,.9568845240076872]],Ba=new H({id:"p3-linear",cssId:"--display-p3-linear",name:"Linear P3",white:"D65",toXYZ_M:O1,fromXYZ_M:p1}),Iu=[[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],x=[[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]],ka=new H({id:"srgb-linear",name:"Linear sRGB",white:"D65",toXYZ_M:Iu,fromXYZ_M:x}),Di={aliceblue:[240/255,248/255,1],antiquewhite:[250/255,235/255,215/255],aqua:[0,1,1],aquamarine:[127/255,1,212/255],azure:[240/255,1,1],beige:[245/255,245/255,220/255],bisque:[1,228/255,196/255],black:[0,0,0],blanchedalmond:[1,235/255,205/255],blue:[0,0,1],blueviolet:[138/255,43/255,226/255],brown:[165/255,42/255,42/255],burlywood:[222/255,184/255,135/255],cadetblue:[95/255,158/255,160/255],chartreuse:[127/255,1,0],chocolate:[210/255,105/255,30/255],coral:[1,127/255,80/255],cornflowerblue:[100/255,149/255,237/255],cornsilk:[1,248/255,220/255],crimson:[220/255,20/255,60/255],cyan:[0,1,1],darkblue:[0,0,139/255],darkcyan:[0,139/255,139/255],darkgoldenrod:[184/255,134/255,11/255],darkgray:[169/255,169/255,169/255],darkgreen:[0,100/255,0],darkgrey:[169/255,169/255,169/255],darkkhaki:[189/255,183/255,107/255],darkmagenta:[139/255,0,139/255],darkolivegreen:[85/255,107/255,47/255],darkorange:[1,140/255,0],darkorchid:[153/255,50/255,204/255],darkred:[139/255,0,0],darksalmon:[233/255,150/255,122/255],darkseagreen:[143/255,188/255,143/255],darkslateblue:[72/255,61/255,139/255],darkslategray:[47/255,79/255,79/255],darkslategrey:[47/255,79/255,79/255],darkturquoise:[0,206/255,209/255],darkviolet:[148/255,0,211/255],deeppink:[1,20/255,147/255],deepskyblue:[0,191/255,1],dimgray:[105/255,105/255,105/255],dimgrey:[105/255,105/255,105/255],dodgerblue:[30/255,144/255,1],firebrick:[178/255,34/255,34/255],floralwhite:[1,250/255,240/255],forestgreen:[34/255,139/255,34/255],fuchsia:[1,0,1],gainsboro:[220/255,220/255,220/255],ghostwhite:[248/255,248/255,1],gold:[1,215/255,0],goldenrod:[218/255,165/255,32/255],gray:[128/255,128/255,128/255],green:[0,128/255,0],greenyellow:[173/255,1,47/255],grey:[128/255,128/255,128/255],honeydew:[240/255,1,240/255],hotpink:[1,105/255,180/255],indianred:[205/255,92/255,92/255],indigo:[75/255,0,130/255],ivory:[1,1,240/255],khaki:[240/255,230/255,140/255],lavender:[230/255,230/255,250/255],lavenderblush:[1,240/255,245/255],lawngreen:[124/255,252/255,0],lemonchiffon:[1,250/255,205/255],lightblue:[173/255,216/255,230/255],lightcoral:[240/255,128/255,128/255],lightcyan:[224/255,1,1],lightgoldenrodyellow:[250/255,250/255,210/255],lightgray:[211/255,211/255,211/255],lightgreen:[144/255,238/255,144/255],lightgrey:[211/255,211/255,211/255],lightpink:[1,182/255,193/255],lightsalmon:[1,160/255,122/255],lightseagreen:[32/255,178/255,170/255],lightskyblue:[135/255,206/255,250/255],lightslategray:[119/255,136/255,153/255],lightslategrey:[119/255,136/255,153/255],lightsteelblue:[176/255,196/255,222/255],lightyellow:[1,1,224/255],lime:[0,1,0],limegreen:[50/255,205/255,50/255],linen:[250/255,240/255,230/255],magenta:[1,0,1],maroon:[128/255,0,0],mediumaquamarine:[102/255,205/255,170/255],mediumblue:[0,0,205/255],mediumorchid:[186/255,85/255,211/255],mediumpurple:[147/255,112/255,219/255],mediumseagreen:[60/255,179/255,113/255],mediumslateblue:[123/255,104/255,238/255],mediumspringgreen:[0,250/255,154/255],mediumturquoise:[72/255,209/255,204/255],mediumvioletred:[199/255,21/255,133/255],midnightblue:[25/255,25/255,112/255],mintcream:[245/255,1,250/255],mistyrose:[1,228/255,225/255],moccasin:[1,228/255,181/255],navajowhite:[1,222/255,173/255],navy:[0,0,128/255],oldlace:[253/255,245/255,230/255],olive:[128/255,128/255,0],olivedrab:[107/255,142/255,35/255],orange:[1,165/255,0],orangered:[1,69/255,0],orchid:[218/255,112/255,214/255],palegoldenrod:[238/255,232/255,170/255],palegreen:[152/255,251/255,152/255],paleturquoise:[175/255,238/255,238/255],palevioletred:[219/255,112/255,147/255],papayawhip:[1,239/255,213/255],peachpuff:[1,218/255,185/255],peru:[205/255,133/255,63/255],pink:[1,192/255,203/255],plum:[221/255,160/255,221/255],powderblue:[176/255,224/255,230/255],purple:[128/255,0,128/255],rebeccapurple:[102/255,51/255,153/255],red:[1,0,0],rosybrown:[188/255,143/255,143/255],royalblue:[65/255,105/255,225/255],saddlebrown:[139/255,69/255,19/255],salmon:[250/255,128/255,114/255],sandybrown:[244/255,164/255,96/255],seagreen:[46/255,139/255,87/255],seashell:[1,245/255,238/255],sienna:[160/255,82/255,45/255],silver:[192/255,192/255,192/255],skyblue:[135/255,206/255,235/255],slateblue:[106/255,90/255,205/255],slategray:[112/255,128/255,144/255],slategrey:[112/255,128/255,144/255],snow:[1,250/255,250/255],springgreen:[0,1,127/255],steelblue:[70/255,130/255,180/255],tan:[210/255,180/255,140/255],teal:[0,128/255,128/255],thistle:[216/255,191/255,216/255],tomato:[1,99/255,71/255],turquoise:[64/255,224/255,208/255],violet:[238/255,130/255,238/255],wheat:[245/255,222/255,179/255],white:[1,1,1],whitesmoke:[245/255,245/255,245/255],yellow:[1,1,0],yellowgreen:[154/255,205/255,50/255]},zi=Array(3).fill("<percentage> | <number>[0, 255]"),Si=Array(3).fill("<number>[0, 255]"),st=new H({id:"srgb",name:"sRGB",base:ka,fromBase:e=>e.map(e=>{let t=e<0?-1:1,n=e*t;return n>.0031308?t*(1.055*n**(1/2.4)-.055):12.92*e}),toBase:e=>e.map(e=>{let t=e<0?-1:1,n=e*t;return n<=.04045?e/12.92:t*((n+.055)/1.055)**2.4}),formats:{rgb:{coords:zi},rgb_number:{name:"rgb",commas:!0,coords:Si,noAlpha:!0},color:{},rgba:{coords:zi,commas:!0,lastAlpha:!0},rgba_number:{name:"rgba",commas:!0,coords:Si},hex:{type:"custom",toGamut:!0,test:e=>/^#([a-f0-9]{3,4}){1,2}$/i.test(e),parse(e){e.length<=5&&(e=e.replace(/[a-f0-9]/gi,"$&$&"));let t=[];return e.replace(/[a-f0-9]{2}/gi,e=>{t.push(parseInt(e,16)/255)}),{spaceId:"srgb",coords:t.slice(0,3),alpha:t.slice(3)[0]}},serialize:(e,t,{collapse:n=!0}={})=>{t<1&&e.push(t),e=e.map(e=>Math.round(e*255));let s=n&&e.every(e=>e%17===0),o=e.map(e=>s?(e/17).toString(16):e.toString(16).padStart(2,"0")).join("");return"#"+o}},keyword:{type:"custom",test:e=>/^[a-z]+$/i.test(e),parse(e){e=e.toLowerCase();let t={spaceId:"srgb",coords:null,alpha:1};if(e==="transparent"?(t.coords=Di.black,t.alpha=0):t.coords=Di[e],t.coords)return t}}}}),li=new H({id:"p3",cssId:"display-p3",name:"P3",base:Ba,fromBase:st.fromBase,toBase:st.toBase}),V.display_space=st,typeof CSS!="undefined"&&CSS.supports)for(let e of[W,gr,li]){let t=e.getMinCoords(),n={space:e,coords:t,alpha:1},s=$n(n);if(CSS.supports("color",s)){V.display_space=e;break}}zu=Object.freeze({__proto__:null,getLuminance:Be,register:O3,setLuminance:I2}),Tu=.56,Fu=.57,Mu=.62,Su=.65,ci=.022,Au=1.414,ku=.1,Eu=5e-4,yu=1.14,Bo=.027,gu=1.14,pu=5e4,fu=216/24389,Ho=24/116,Ln=24389/27,Mo=N.D65,So=new n({id:"lab-d65",name:"Lab D65",coords:{l:{refRange:[0,100],name:"Lightness"},a:{refRange:[-125,125]},b:{refRange:[-125,125]}},white:Mo,base:S,fromBase(e){let n=e.map((e,t)=>e/Mo[t]),t=n.map(e=>e>fu?Math.cbrt(e):(Ln*e+16)/116);return[116*t[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])]},toBase(e){let t=[];t[1]=(e[0]+16)/116,t[0]=e[1]/500+t[1],t[2]=t[1]-e[2]/200;let n=[t[0]>Ho?t[0]**3:(116*t[0]-16)/Ln,e[0]>8?((e[0]+16)/116)**3:e[0]/Ln,t[2]>Ho?t[2]**3:(116*t[2]-16)/Ln];return n.map((e,t)=>e*Mo[t])},formats:{"lab-d65":{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),Ao=5**.5*.5+.5,zn=Object.freeze({__proto__:null,contrastAPCA:y3,contrastDeltaPhi:m3,contrastLstar:f3,contrastMichelson:j3,contrastWCAG21:w3,contrastWeber:p3}),su=Object.freeze({__proto__:null,register:d3,uv:Vs,xy:Z2}),nu=Object.freeze({__proto__:null,darken:em,lighten:l3}),V.interpolationSpace="lab",tu=Object.freeze({__proto__:null,isRange:sr,mix:s3,range:qn,register:Sh,steps:o3}),Xo=new n({id:"hsl",name:"HSL",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:st,fromBase:e=>{let o=Math.max(...e),l=Math.min(...e),[c,i,a]=e,[t,s,n]=[NaN,0,(l+o)/2],r=o-l;if(r!==0){switch(s=n===0||n===1?0:(o-n)/Math.min(n,1-n),o){case c:t=(i-a)/r+(i<a?6:0);break;case i:t=(a-c)/r+2;break;case a:t=(c-i)/r+4}t=t*60}return s<0&&(t+=180,s=s<0?-s:s),t>=360&&(t-=360),[t,s*100,n*100]},toBase:e=>{let[t,o,n]=e;t=t%360,t<0&&(t+=360),o/=100,n/=100;function s(e){let s=(e+t/30)%12,i=o*Math.min(n,1-n);return n-i*Math.max(-1,Math.min(s-3,9-s,1))}return[s(0),s(8),s(4)]},formats:{hsl:{coords:["<number> | <angle>","<percentage>","<percentage>"]},hsla:{coords:["<number> | <angle>","<percentage>","<percentage>"],commas:!0,lastAlpha:!0}}}),di=new n({id:"hsv",name:"HSV",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},v:{range:[0,100],name:"Value"}},base:Xo,fromBase(e){let[o,s,t]=e;s/=100,t/=100;let n=t+s*Math.min(t,1-t);return[o,n===0?0:200*(1-t/n),100*n]},toBase(e){let[o,s,n]=e;s/=100,n/=100;let t=n*(1-s/2);return[o,t===0||t===1?0:(n-t)/Math.min(t,1-t)*100,t*100]},formats:{color:{id:"--hsv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),eu=new n({id:"hwb",name:"HWB",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},w:{range:[0,100],name:"Whiteness"},b:{range:[0,100],name:"Blackness"}},base:di,fromBase(e){let[n,s,t]=e;return[n,t*(100-s)/100,100-t]},toBase(e){let[o,t,n]=e;t/=100,n/=100;let i=t+n;if(i>=1){let e=t/i;return[o,0,e*100]}let s=1-n,a=s===0?0:1-t/s;return[o,a*100,s*100]},formats:{hwb:{coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),Zd=[[.5766690429101305,.1855582379065463,.1882286462349947],[.29734497525053605,.6273635662554661,.07529145849399788],[.02703136138641234,.07068885253582723,.9913375368376388]],Yd=[[2.0415879038107465,-.5650069742788596,-.34473135077832956],[-.9692436362808795,1.8759675015077202,.04155505740717557],[.013444280632031142,-.11836239223101838,1.0151749943912054]],ji=new H({id:"a98rgb-linear",cssId:"--a98-rgb-linear",name:"Linear Adobe\xAE 98 RGB compatible",white:"D65",toXYZ_M:Zd,fromXYZ_M:Yd}),Kd=new H({id:"a98rgb",cssId:"a98-rgb",name:"Adobe\xAE 98 RGB compatible",base:ji,toBase:e=>e.map(e=>(e<0?-e:e)**(563/256)*Math.sign(e)),fromBase:e=>e.map(e=>(e<0?-e:e)**(256/563)*Math.sign(e))}),Ud=[[.7977666449006423,.13518129740053308,.0313477341283922],[.2880748288194013,.711835234241873,8993693872564e-17],[0,0,.8251046025104602]],Wd=[[1.3457868816471583,-.25557208737979464,-.05110186497554526],[-.5446307051249019,1.5082477428451468,.02052744743642139],[0,0,1.2119675456389452]],Qi=new H({id:"prophoto-linear",cssId:"--prophoto-rgb-linear",name:"Linear ProPhoto",white:"D50",base:hs,toXYZ_M:Ud,fromXYZ_M:Wd}),Id=1/512,Pd=16/512,Rd=new H({id:"prophoto",cssId:"prophoto-rgb",name:"ProPhoto",base:Qi,toBase(e){return e.map(e=>e<Pd?e/16:e**1.8)},fromBase(e){return e.map(e=>e>=Id?e**(1/1.8):16*e)}}),Ld=new n({id:"oklch",name:"Oklch",coords:{l:{refRange:[0,1],name:"Lightness"},c:{refRange:[0,.4],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},white:"D65",base:Ze,fromBase(e){let[i,t,n]=e,s;const o=2e-4;return(t<0?-t:t)<o&&(n<0?-n:n)<o?s=NaN:s=Math.atan2(n,t)*180/Math.PI,[i,(t**2+n**2)**.5,ue(s)]},toBase(e){let[i,o,t]=e,n,s;return isNaN(t)?(n=0,s=0):(n=o*Math.cos(t*Math.PI/180),s=o*Math.sin(t*Math.PI/180)),[i,n,s]},formats:{oklch:{coords:["<percentage> | <number>","<number> | <percentage>[0,1]","<number> | <angle>"]}}}),ea=N.D65,kd=216/24389,la=24389/27,[fa,ya]=Vs({space:S,coords:ea}),_a=new n({id:"luv",name:"Luv",coords:{l:{refRange:[0,100],name:"Lightness"},u:{refRange:[-215,215]},v:{refRange:[-215,215]}},white:ea,base:S,fromBase(e){let s=[E(e[0]),E(e[1]),E(e[2])],t=s[1],[o,i]=Vs({space:S,coords:s});if(!Number.isFinite(o)||!Number.isFinite(i))return[0,0,0];let n=t<=kd?la*t:116*Math.cbrt(t)-16;return[n,13*n*(o-fa),13*n*(i-ya)]},toBase(e){let[t,n,s]=e;if(t===0||Fe(t))return[0,0,0];n=E(n),s=E(s);let a=n/(13*t)+fa,o=s/(13*t)+ya,i=t<=8?t/la:((t+16)/116)**3;return[i*(9*a/(4*o)),i,i*((12-3*a-20*o)/(4*o))]},formats:{color:{id:"--luv",coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),Zs=new n({id:"lchuv",name:"LChuv",coords:{l:{refRange:[0,100],name:"Lightness"},c:{refRange:[0,220],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:_a,fromBase(e){let[i,t,n]=e,s;const o=.02;return(t<0?-t:t)<o&&(n<0?-n:n)<o?s=NaN:s=Math.atan2(n,t)*180/Math.PI,[i,(t**2+n**2)**.5,ue(s)]},toBase(e){let[s,t,n]=e;return t<0&&(t=0),isNaN(n)&&(n=0),[s,t*Math.cos(n*Math.PI/180),t*Math.sin(n*Math.PI/180)]},formats:{color:{id:"--lchuv",coords:["<number> | <percentage>","<number> | <percentage>","<number> | <angle>"]}}}),Od=216/24389,vd=24389/27,xa=x[0][0],To=x[0][1],Qs=x[0][2],Ma=x[1][0],Fa=x[1][1],Gs=x[1][2],Pa=x[2][0],Ia=x[2][1],$s=x[2][2],hd=new n({id:"hsluv",name:"HSLuv",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:Zs,gamutSpace:st,fromBase(e){let[t,o,s]=[E(e[0]),E(e[1]),E(e[2])],n;if(t>99.9999999)n=0,t=100;else if(t<1e-8)n=0,t=0;else{let e=Rs(t),i=J2(e,s);n=o/i*100}return[s,n,t]},toBase(e){let[s,o,t]=[E(e[0]),E(e[1]),E(e[2])],n;if(t>99.9999999)t=100,n=0;else if(t<1e-8)t=0,n=0;else{let e=Rs(t),i=J2(e,s);n=i/100*o}return[t,n,s]},formats:{color:{id:"--hsluv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),x[0][0],x[0][1],x[0][2],x[1][0],x[1][1],x[1][2],x[2][0],x[2][1],x[2][2],rd=new n({id:"hpluv",name:"HPLuv",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:Zs,gamutSpace:"self",fromBase(e){let[t,s,o]=[E(e[0]),E(e[1]),E(e[2])],n;if(t>99.9999999)n=0,t=100;else if(t<1e-8)n=0,t=0;else{let e=Rs(t),o=X2(e);n=s/o*100}return[o,n,t]},toBase(e){let[s,o,t]=[E(e[0]),E(e[1]),E(e[2])],n;if(t>99.9999999)t=100,n=0;else if(t<1e-8)t=0,n=0;else{let e=Rs(t),s=X2(e);n=s/100*o}return[t,n,s]},formats:{color:{id:"--hpluv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),Za=203,er=2610/2**14,od=2**14/2610,nd=2523/2**5,rr=2**5/2523,xr=3424/2**12,Mr=2413/2**7,Ir=2392/2**7,ed=new H({id:"rec2100pq",cssId:"rec2100-pq",name:"REC.2100-PQ",base:ns,toBase(e){return e.map(function(e){let t=(Math.max(e**rr-xr,0)/(Mr-Ir*e**rr))**od;return t*1e4/Za})},fromBase(e){return e.map(function(e){let t=Math.max(e*Za/1e4,0),n=xr+Mr*t**er,s=1+Ir*t**er;return(n/s)**nd})}}),Kr=.17883277,Xr=.28466892,ec=.55991073,fs=3.7743,Ul=new H({id:"rec2100hlg",cssId:"rec2100-hlg",name:"REC.2100-HLG",referred:"scene",base:ns,toBase(e){return e.map(function(e){return e<=.5?e**2/3*fs:(Math.exp((e-ec)/Kr)+Xr)/12*fs})},fromBase(e){return e.map(function(e){return e/=fs,e<=1/12?(3*e)**.5:Kr*Math.log(12*e-Xr)+ec})}}),nc={},Ae.add("chromatic-adaptation-start",e=>{e.options.method&&(e.M=Y2(e.W1,e.W2,e.options.method))}),Ae.add("chromatic-adaptation-end",e=>{e.M||(e.M=Y2(e.W1,e.W2,e.options.method))}),Ns({id:"von Kries",toCone_M:[[.40024,.7076,-.08081],[-.2263,1.16532,.0457],[0,0,.91822]],fromCone_M:[[1.8599363874558397,-1.1293816185800916,.21989740959619328],[.3611914362417676,.6388124632850422,-6370596838649899e-21],[0,0,1.0890636230968613]]}),Ns({id:"Bradford",toCone_M:[[.8951,.2664,-.1614],[-.7502,1.7135,.0367],[.0389,-.0685,1.0296]],fromCone_M:[[.9869929054667121,-.14705425642099013,.15996265166373122],[.4323052697233945,.5183602715367774,.049291228212855594],[-.00852866457517732,.04004282165408486,.96848669578755]]}),Ns({id:"CAT02",toCone_M:[[.7328,.4296,-.1624],[-.7036,1.6975,.0061],[.003,.0136,.9834]],fromCone_M:[[1.0961238208355142,-.27886900021828726,.18274517938277307],[.4543690419753592,.4735331543074117,.07209780371722911],[-.009627608738429355,-.00569803121611342,1.0153256399545427]]}),Ns({id:"CAT16",toCone_M:[[.401288,.650173,-.051461],[-.250268,1.204414,.045854],[-.002079,.048952,.953127]],fromCone_M:[[1.862067855087233,-1.0112546305316845,.14918677544445172],[.3875265432361372,.6214474419314753,-.008973985167612521],[-.01584149884933386,-.03412293802851557,1.0499644368778496]]}),Object.assign(N,{A:[1.0985,1,.35585],C:[.98074,1,1.18232],D55:[.95682,1,.92149],D75:[.94972,1,1.22638],E:[1,1,1],F2:[.99186,1,.67393],F7:[.95041,1,1.08747],F11:[1.00962,1,.6435]}),N.ACES=[.32168/.33767,1,(1-.32168-.33767)/.33767],Pl=[[.6624541811085053,.13400420645643313,.1561876870049078],[.27222871678091454,.6740817658111484,.05368951740793705],[-.005574649490394108,.004060733528982826,1.0103391003129971]],Ll=[[1.6410233796943257,-.32480329418479,-.23642469523761225],[-.6636628587229829,1.6153315916573379,.016756347685530137],[.011721894328375376,-.008284441996237409,.9883948585390215]],sc=new H({id:"acescg",cssId:"--acescg",name:"ACEScg",coords:{r:{range:[0,65504],name:"Red"},g:{range:[0,65504],name:"Green"},b:{range:[0,65504],name:"Blue"}},referred:"scene",white:N.ACES,toXYZ_M:Pl,fromXYZ_M:Ll}),en=2**-16,ms=-.35828683,Jt=(Math.log2(65504)+9.72)/17.52,Dl=new H({id:"acescc",cssId:"--acescc",name:"ACEScc",coords:{r:{range:[ms,Jt],name:"Red"},g:{range:[ms,Jt],name:"Green"},b:{range:[ms,Jt],name:"Blue"}},referred:"scene",base:sc,toBase(e){const t=(9.72-15)/17.52;return e.map(function(e){return e<=t?(2**(e*17.52-9.72)-en)*2:e<Jt?2**(e*17.52-9.72):65504})},fromBase(e){return e.map(function(e){return e<=0?(Math.log2(en)+9.72)/17.52:e<en?(Math.log2(en+e*.5)+9.72)/17.52:(Math.log2(e)+9.72)/17.52})}}),rc=Object.freeze({__proto__:null,A98RGB:Kd,A98RGB_Linear:ji,ACEScc:Dl,ACEScg:sc,CAM16_JMh:a4,HCT:Nt,HPLuv:rd,HSL:Xo,HSLuv:hd,HSV:di,HWB:eu,ICTCP:Cs,JzCzHz:to,Jzazbz:Ki,LCH:Ct,LCHuv:Zs,Lab:W,Lab_D65:So,Luv:_a,OKLCH:Ld,OKLab:Ze,P3:li,P3_Linear:Ba,ProPhoto:Rd,ProPhoto_Linear:Qi,REC_2020:gr,REC_2020_Linear:ns,REC_2100_HLG:Ul,REC_2100_PQ:ed,XYZ_ABS_D65:qs,XYZ_D50:hs,XYZ_D65:S,sRGB:st,sRGB_Linear:ka}),$=class _Color{constructor(...o){let e;o.length===1&&(e=r(o[0]));let i,s,t;e?(i=e.space||e.spaceId,s=e.coords,t=e.alpha):[i,s,t]=o,Object.defineProperty(this,"space",{value:n.get(i),writable:!1,enumerable:!0,configurable:!0}),this.coords=s?s.slice():[0,0,0],this.alpha=t>1||t===0[0]?1:t<0?0:t;for(let e=0;e<this.coords.length;e++)this.coords[e]==="NaN"&&(this.coords[e]=NaN);for(let e in this.space.coords)Object.defineProperty(this,e,{get:()=>this.get(e),set:t=>this.set(e,t)})}get spaceId(){return this.space.id}clone(){return new _Color(this.space,this.coords,this.alpha)}toJSON(){return{spaceId:this.spaceId,coords:this.coords,alpha:this.alpha}}display(...t){let e=C3(this,...t);return e.color=new _Color(e.color),e}static get(e,...t){return e instanceof _Color?e:new _Color(e,...t)}static defineFunction(e,t,n=t){let{instance:i=!0,returns:s}=n,o=function(...n){let e=t(...n);if(s==="color")e=_Color.get(e);else if(s==="function<color>"){let t=e;e=function(...e){let n=t(...e);return _Color.get(n)},Object.assign(e,t)}else s==="array<color>"&&(e=e.map(e=>_Color.get(e)));return e};e in _Color||(_Color[e]=o),i&&(_Color.prototype[e]=function(...e){return o(this,...e)})}static defineFunctions(e){for(let t in e)_Color.defineFunction(t,e[t],e[t])}static extend(e){if(e.register)e.register(_Color);else for(let t in e)_Color.defineFunction(t,e[t])}},$.defineFunctions({get:G,getAll:Pn,set:_e,setAll:hi,to:g,equals:x3,inGamut:Ge,toGamut:We,distance:h2,toString:$n}),Object.assign($,{util:U2,hooks:Ae,WHITES:N,Space:n,spaces:n.registry,parse:Q0,defaults:V});for(let e of Object.keys(rc))n.register(rc[e]);for(let e in n.registry)Er(e,n.registry[e]);Ae.add("colorspace-init-end",e=>{Er(e.id,e),e.aliases?.forEach(t=>{Er(t,e)})}),$.extend(at),$.extend({deltaE:Kn}),Object.assign($,{deltaEMethods:at}),$.extend(nu),$.extend({contrast:h3}),$.extend(su),$.extend(zu),$.extend(tu),$.extend(zn),zl=class _Uint16Image{height;width;data;static DEFAULT_COLORSPACE="rec2100-hlg";static SDR_MULTIPLIER=2**16-1;static COLORSPACES={"rec2100-hlg":"rec2100hlg","display-p3":"p3",srgb:"sRGB","rec2100-pq":"rec2100pq"};colorSpace;constructor(e,t,n){n==null?this.colorSpace=_Uint16Image.DEFAULT_COLORSPACE:this.colorSpace=n,this.height=t,this.width=e,this.data=new Uint16Array(t*e*4)}fill(e){if(e.length!=4)return;for(let t=0;t<this.data.length;t+=4)this.data[t]=e[0],this.data[t+1]=e[1],this.data[t+2]=e[2],this.data[t+3]=e[3];return this}getPixel(e,t){const n=(t*this.width+e)*4;return this.data.slice(n,n+4)}setPixel(e,t,n){const s=(t*this.width+e)*4;this.data[s+0]=n[0],this.data[s+1]=n[1],this.data[s+2]=n[2],this.data[s+3]=n[3]}static scaleUint8ToUint16(e){return e<<8|e}getImageData(){return this.data===0[0]||this.data===null?null:new ImageData(this.data,this.width,this.height,{colorSpace:this.colorSpace})}static convertPixelToRec2100_hlg(e){const s=_Uint16Image.COLORSPACES["rec2100-hlg"],o=new $("srgb",Array.from(e.slice(0,3)).map(e=>e/255),e[3]/255),t=o.to(s),n=t.coords.map(e=>Math.round(e*_Uint16Image.SDR_MULTIPLIER));return n.push(t.alpha*_Uint16Image.SDR_MULTIPLIER),Uint16Array.from(n)}static convertArrayToRec2100_hlg(e){const t=new Uint16Array(e.length);for(let n=0;n<e.length;n+=4){const s=e.slice(n,n+4),o=_Uint16Image.convertPixelToRec2100_hlg(s);t.set(o,n)}return t}pixelCallback(e){for(let t=0;t<this.data.length;t+=4)this.data.set(e(this.data[t],this.data[t+1],this.data[t+2],this.data[t+3]),t)}static async loadSDRImageData(e){return fetch(e).then(e=>e.blob()).then(e=>createImageBitmap(e)).then(e=>{const{width:n,height:s}=e,o=new OffscreenCanvas(n,s),t=o.getContext("2d");return t?.drawImage(e,0,0),t}).then(e=>e?.getImageData(0,0,e?.canvas.width,e?.canvas.height))}static fromImageData(e){const t=new _Uint16Image(e.width,e.height);if(e.colorSpace=="srgb")t.data=_Uint16Image.convertArrayToRec2100_hlg(e.data);else if(e.colorSpace==_Uint16Image.DEFAULT_COLORSPACE)t.data=e.data;else throw new Error(`ColorSpace ${e.colorSpace} isn't supported!`);return t}static async fromURL(e){return _Uint16Image.loadSDRImageData(e).then(e=>{if(e!==0[0])return _Uint16Image.fromImageData(e)})}setImageData(e){if(this.width=e.width,this.height=e.height,e.colorSpace=="srgb")this.data=_Uint16Image.convertArrayToRec2100_hlg(e.data);else if(e.colorSpace==_Uint16Image.DEFAULT_COLORSPACE)this.data=e.data;else throw new Error(`ColorSpace ${e.colorSpace} isn't supported!`);this.colorSpace=_Uint16Image.DEFAULT_COLORSPACE}clone(){const e=new _Uint16Image(this.width,this.height,this.colorSpace);return e.data=this.data.slice(),e}},_c={colorSpace:zl.DEFAULT_COLORSPACE,pixelFormat:"float16"}}}),$8={},Cc=e({"ns-hugo-imp:/home/runner/work/schriftmuster/schriftmuster/themes/projektemacher-base/assets/js/iiif-image-viewer.js"(){i1(),na(),L4(),b0(),ps(),S0(),re(),Fl(),Al=class extends se{constructor(e){const t=e||{};super(e),this.pauseableAnimations_=[],this.animationsPointer_=-1,this.lastAnimation_={},this.initalCenter=this.getCenter()}getPauseableAnimation_(){return this.pauseableAnimations_.length-1>this.animationsPointer_?(this.animationsPointer_++,this.pauseableAnimations_[this.animationsPointer_]):(this.animationsPointer_=0,this.pauseableAnimations_[this.animationsPointer_])}nextAnimation_(e){if(e===0[0]||e){var t=this,n=this.getPauseableAnimation_();this.animate(n,function(e){t.nextAnimation_(e)})}}pauseAnimation(){if(!this.getAnimating())return;var e=this.animations_[0][0],t=Date.now(),n=t-e.start;let s={center:e.center,zoom:e.zoom,rotation:e.rotation,duration:e.duration-n};this.lastAnimation_=s,this.cancelAnimations()}startAnimation_(){if(this.getAnimating())return;Object.keys(this.lastAnimation_).length!==0&&(this.lastAnimation_={});var e=this;this.animate(this.getPauseableAnimation_,function(t){e.nextAnimation_(t)})}resumeAnimation(){if(this.getAnimating())return;if(Object.keys(this.lastAnimation_).length===0)this.startAnimation_();else{var e=this;this.animate(this.lastAnimation_,function(t){e.nextAnimation_(t)})}}setPauseableAnimation(){var n,t=new Array(arguments.length);for(let e=0;e<t.length;++e)n=arguments[e],t[e]=n;this.animationsPointer_=-1,this.pauseableAnimations_=t}getPauseableAnimation(){return this.pauseableAnimations_}setCenter(e){this.initalCenter=e,this.setCenterInternal(ge(e,this.getProjection()))}isNoopAnimation(){return!1}setResolutions(e){this.resolutions_=e}setExtent(e){var t={};t.extent=qe(e,this.projection_),this.applyOptions_(t)}},ll=class extends et{constructor(e){const n=e||{},o=n.tipLabel?n.tipLabel:"Rotate 90\xB0 left",t=document.createElement("button");t.innerHTML='<i class="icon-left"></i>',t.title=o;const s=document.createElement("div");s.className="rotate-left ol-unselectable ol-control",s.appendChild(t),super({element:s,target:n.target}),t.addEventListener("click",this.handleRotateLeft.bind(this),!1)}handleRotateLeft(){var e=this.getMap().getView().getRotation();this.getMap().getView().setRotation(e+-90*Math.PI/180)}},Hc=class extends et{constructor(e){const n=e||{},o=n.tipLabel?n.tipLabel:"Rotate 90\xB0 right",t=document.createElement("button");t.innerHTML='<i class="icon-right"></i>',t.title=o;const s=document.createElement("div");s.className="rotate-right ol-unselectable ol-control",s.appendChild(t),super({element:s,target:n.target}),t.addEventListener("click",this.handleRotateRight.bind(this),!1)}handleRotateRight(){var e=this.getMap().getView().getRotation();this.getMap().getView().setRotation(e+90*Math.PI/180)}},window.addMap=function(e,t,n,s,o){if(r=0,n!==0[0]&&n!=0&&(r=n*Math.PI/180),o===0[0]&&(o=!1),i="en",document.documentElement.lang!==0[0]){const e=new Intl.Locale(document.documentElement.lang);i=e.language}a={de:{zoomIn:"Vergr\xF6\xDFern",zoomOut:"Verkleinern",fullscreen:"Vollbildansicht",rotate:"Rotation zur\xFCcksetzen",rotateLeft:"90\xB0 nach links drehen",rotateRight:"90\xB0 nach rechst drehen"},en:{zoomIn:"Zoom in",zoomOut:"Zoom out",fullscreen:"Toggle full-screen",rotate:"Reset rotation",rotateLeft:"Rotate 90\xB0 left",rotateRight:"Rotate 90\xB0 right"}},console.log("Setting up "+i),o&&g3()&&v3()&&(b3(),console.log("Enabled HDR Canvas"));var i,a,r,l=new Ko,c=new ei({controls:[new hc({zoomInTipLabel:a[i].zoomIn,zoomOutTipLabel:a[i].zoomOut}),new k0({tipLabel:a[i].fullscreen}),new lc({tipLabel:a[i].rotate}),new ll({tipLabel:a[i].rotateLeft}),new Hc({tipLabel:a[i].rotateRight})],layers:[l],target:e});return fetch(t).then(function(e){e.json().then(function(e){var n,t=new sa(e).getTileSourceOptions();if(t===0[0]||t.version===0[0]){console.log("Data seems to be no valid IIIF image information.");return}t.zDirection=-1,s!==0[0]&&s!=""&&(t.url=s),n=new Bi(t),l.setSource(n),c.setView(new se({resolutions:n.getTileGrid().getResolutions(),extent:n.getTileGrid().getExtent(),constrainOnlyCenter:!0,rotation:r})),c.getView().fit(n.getTileGrid().getExtent())}).catch(function(e){console.log("Could not read image info json. "+e)})}).catch(function(){console.log("Could not read data from URL.")}),c},window.animatedMap=function(e,t,n,s,o,i,a,r){d=0,n!==0[0]&&n!=0&&(d=n*Math.PI/180);var d,u=new Ko,l=new ei({controls:[],layers:[u],target:e}),c=new Al({constrainOnlyCenter:!0,rotation:d});return fetch(t).then(function(e){e.json().then(function(e){var n,t=new sa(e).getTileSourceOptions();if(t===0[0]||t.version===0[0]){console.log("Data seems to be no valid IIIF image information.");return}t.zDirection=-1,s!==0[0]&&s!=""&&(t.url=s),n=new Bi(t),u.setSource(n),c.setExtent(n.getTileGrid().getExtent()),c.setResolutions(n.getTileGrid().getResolutions()),l.setView(c),l.getView().fit(n.getTileGrid().getExtent()),o!==0[0]&&o!==""&&l.getView().setZoom(o),r!==0[0]&&r!==""&&l.getView().setCenter(r)}).catch(function(e){console.log(`Could not read image info json from "${t}".`+e)})}).catch(function(){console.log("Could not read data from URL.")}),i!==0[0]&&i!==""&&a!==0[0]&&(Array.isArray(i)?c.setPauseableAnimation(...i):c.setPauseableAnimation(i),l.once("rendercomplete",function(){a.addEventListener("mouseenter",function(){c.resumeAnimation()}),a.addEventListener("mouseleave",function(){c.pauseAnimation()})})),l}}}),window.$=window.jQuery=D8(),Cc()})(),(()=>{var m,Ce,B,lo,ft,Qt,S,Yt,bo,l,h,be,Gs,d,p,y,W,qs,Ks,Ve,Oo,Ws,xt,De,it,xo,R,Ao,ie,lt,yt,oe,st,wt,Ct,Lo,Xe,Po,Vo,Jo,oa,aa,Ls,s,Ns,nn,k,Ca,f,sn,Es,Cs,dt,ht,H,ps,Pe,Cl,Qe,$e,me,Jt,Re,q1,U1,qu,os,ts,es,eu,Yd,Ud,$d,Et,Ze,Ld,Nd,Dd,Pn,Ln,Nn,zd,x,et,gl,pl,Tc,Sr,Ar,gr,Ye,Ge,Ee,M,V,ke,re,Oe,dn,qe,Ae,w,pn,na,Qi,ye,An,Q,Pi,pt,Ri,zi,Ti,In,Fi,Mi,Ei,Un,qn,Dt,Be,Rt,ii,Pt,Yo,Io,ge,ks,As,Ss,Do,en,Zt,ko,Is,Bs,Vs,Eo,Co,D,oo,Kd,co,fo,po,Zs,c,ut,U,zt,Ne,N,Ie,Ms,rt,a,Qo,Zo,C,Le,Ht,rs,Se,ss,He,hi,_,ji,Gn,Yn,Kn,Oi,xi,K,$n,ki,Ai,nt,Bn,L,Di,Ni,Rn,Tn,gt,Mn,Cn,xn,St,Zi,Ji,yn,sa,mn,Xt,tt,da,ua,fe,ma,de,pa,ga,ba,i,wa,Oa,un,Ea,ka,Aa,Sa,Ma,Fa,Ta,za,Da,Na,La,Ra,Ha,Ia,Ba,Ut,Wa,Ua,Wt,Ya,Ga,Xa,Qa,Ja,er,tr,nr,sr,or,ir,ar,rr,lr,It,hr,mr,pr,hn,vr,br,je,_r,wr,fn,Cr,Er,gn,Tr,zr,Dr,Nr,Lr,Rr,Pr,Ir,Vr,$r,Wr,Ur,Kr,qr,Yr,Gr,Xr,Qr,Zr,Jr,ec,tc,nc,sc,oc,ic,ac,rc,cc,lc,dc,uc,hc,mc,fc,pc,gc,vc,bc,jc,to,wc,Oc,xc,Cc,Ec,kc,Ac,Sc,Mc,bn,zc,Dc,Lc,Rc,Pc,Ic,Bc,Vc,$c,Wc,Uc,Kc,qc,Yc,Gc,Xc,Qc,Zc,Jc,el,tl,nl,sl,ol,il,al,rl,cl,ll,dl,ul,ml,On,vl,bl,jl,yl,wl,Ol,xl,El,kl,Al,Sl,Ml,Fl,Tl,zl,Dl,Ll,Rl,Pl,Hl,Il,Bl,Vl,$l,Wl,Kl,ql,Yl,Xl,Ql,Zl,ed,td,nd,od,id,ad,cd,ld,dd,hd,md,fd,gd,_t,yd,Fn,ue,Od,kd,Dn,Hn,Wn,Xn,no,Gd,Xd,Qd,Zd,Ft,tu,nu,ou,iu,au,cu,lu,du,hu,mu,fu,gu,vu,bu,ju,yu,_u,wu,Ou,xu,Cu,Eu,ku,Au,Su,Mu,Fu,Tu,zu,Du,Nu,Lu,Ru,Hu,Iu,Bu,ns,Wu,Uu,is,Yu,Gu,Qu,Zu,Ju,t1,n1,s1,i1,a1,r1,l1,d1,u1,m1,f1,p1,v1,b1,j1,_1,w1,O1,x1,C1,k1,A1,S1,F1,T1,z1,N1,L1,R1,H1,Bt,B1,V1,W1,Vt,Kt,us,X1,Q1,Z1,J1,e4,t4,n4,s4,o4,i4,a4,r4,c4,l4,d4,u4,h4,f4,p4,g4,b4,j4,y4,w4,O4,x4,E4,k4,A4,M4,F4,T4,D4,N4,L4,P4,H4,I4,V4,$4,W4,K4,q4,Y4,X4,Q4,Z4,e0,t0,n0,o0,i0,a0,c0,l0,d0,h0,m0,f0,g0,v0,b0,j0,y0,p0,u0,r0,s0,J4,G4,U4,B4,R4,z4,S4,C4,_4,v4,m4,Y1,$1,P1,D1,M1,E1,y1,g1,h1,c1,o1,e1,Xu,Ku,$u,Vu,Pu,pu,uu,ru,su,Jd,qd,Wd,Vd,Bd,Id,Hd,Rd,Td,Md,Sd,Ad,Ed,Cd,xd,wd,_d,jd,pd,ud,rd,sd,Jl,Gl,Ul,Nl,hs,_l,hl,fs,Nc,Fc,vs,_c,yc,js,Hr,Fr,kr,xr,ys,_s,jr,fr,ur,cr,xs,Fs,qa,Ka,Ts,Va,Pa,Ds,xa,_a,ya,va,ha,Rs,Ps,ta,ea,Xi,Yi,qi,Ki,Ui,Vi,Bi,Hi,Li,Si,Ci,_i,bi,gi,pi,mi,li,ci,si,ni,qt,Wo,Bo,Ho,$s,jo,go,ao,Dh,$2={};function Js(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return e=>e in t}m={},Ce=[],B=()=>{},lo=()=>!1,ft=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Qt=e=>e.startsWith("onUpdate:"),S=Object.assign,Yt=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},bo=Object.prototype.hasOwnProperty,h=(e,t)=>bo.call(e,t),l=Array.isArray,be=e=>Ve(e)==="[object Map]",Gs=e=>Ve(e)==="[object Set]",d=e=>typeof e=="function",y=e=>typeof e=="string",W=e=>typeof e=="symbol",p=e=>e!==null&&typeof e=="object",qs=e=>(p(e)||d(e))&&d(e.then)&&d(e.catch),Ks=Object.prototype.toString,Ve=e=>Ks.call(e),Oo=e=>Ve(e).slice(8,-1),Ws=e=>Ve(e)==="[object Object]",xt=e=>y(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,De=Js(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),it=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},xo=/-(\w)/g,R=it(e=>e.replace(xo,(e,t)=>t?t.toUpperCase():"")),Ao=/\B([A-Z])/g,ie=it(e=>e.replace(Ao,"-$1").toLowerCase()),lt=it(e=>e.charAt(0).toUpperCase()+e.slice(1)),yt=it(e=>e?`on${lt(e)}`:""),oe=(e,t)=>!Object.is(e,t),st=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},wt=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},Ct=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Xe=()=>Lo||(Lo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pe(e){if(l(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],o=y(s)?V3(s):pe(s);if(o)for(const e in o)t[e]=o[e]}return t}if(y(e)||p(e))return e}Po=/;(?![^(]*\))/g,Vo=/:([^]+)/,Jo=/\/\*[^]*?\*\//g;function V3(e){const t={};return e.replace(Jo,"").split(Po).forEach(e=>{if(e){const n=e.split(Vo);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function j(e){let t="";if(y(e))t=e;else if(l(e))for(let n=0;n<e.length;n++){const s=j(e[n]);s&&(t+=s+" ")}else if(p(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}oa="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",aa=Js(oa);function ja(e){return!!e||e===""}Ls=e=>!!(e&&e.__v_isRef===!0),s=e=>y(e)?e:e==null?"":l(e)||p(e)&&(e.toString===Ks||!d(e.toString))?Ls(e)?s(e.value):JSON.stringify(e,Ns,2):String(e),Ns=(e,t)=>Ls(t)?Ns(e,t.value):be(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[t,n],s)=>(e[nn(t,s)+" =>"]=n,e),{})}:Gs(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>nn(e))}:W(t)?nn(t):p(t)&&!l(t)&&!Ws(t)?String(t):t,nn=(e,t="")=>{var n;return W(e)?`Symbol(${(n=e.description)!=null?n:t})`:e},Ca=class{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=k,!e&&k&&(this.index=(k.scopes||(k.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=k;try{return k=this,e()}finally{k=t}}}on(){++this._on===1&&(this.prevScope=k,k=this)}off(){this._on>0&&--this._on===0&&(k=this.prevScope,this.prevScope=0[0])}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=0[0]}}};function $a(){return k}function C2(e){k&&k.cleanups.push(e)}sn=new WeakSet,Es=class{constructor(e){this.fn=e,this.deps=0[0],this.depsTail=0[0],this.flags=5,this.next=0[0],this.cleanup=0[0],this.scheduler=0[0],k&&k.active&&k.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,sn.has(this)&&(sn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Za(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Hc(this),yr(this);const e=f,t=H;f=this,H=!0;try{return this.fn()}finally{Or(this),f=e,H=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)bs(e);this.deps=this.depsTail=0[0],Hc(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?sn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){rn(this)&&this.run()}get dirty(){return rn(this)}},Cs=0;function Za(e,t=!1){if(e.flags|=8,t){e.next=ht,ht=e;return}e.next=dt,dt=e}function Os(){Cs++}function ws(){if(--Cs>0)return;if(ht){let e=ht;for(ht=0[0];e;){const t=e.next;e.next=0[0],e.flags&=-9,e=t}}let e;for(;dt;){let t=dt;for(dt=0[0];t;){const n=t.next;if(t.next=0[0],t.flags&=-9,t.flags&1)try{t.trigger()}catch(t){e||(e=t)}t=n}}if(e)throw e}function yr(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Or(e){let s,n=e.depsTail,t=n;for(;t;){const e=t.prevDep;t.version===-1?(t===n&&(n=e),bs(t),V2(t)):s=t,t.dep.activeLink=t.prevActiveLink,t.prevActiveLink=0[0],t=e}e.deps=s,e.depsTail=n}function rn(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Br(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Br(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Pe)||(e.globalVersion=Pe,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!rn(e))))return;e.flags|=2;const t=e.dep,n=f,s=H;f=e,H=!0;try{yr(e);const n=e.fn(e._value);(t.version===0||oe(n,e._value))&&(e.flags|=128,e._value=n,t.version++)}catch(e){throw t.version++,e}finally{f=n,H=s,Or(e),e.flags&=-3}}function bs(e,t=!1){const{dep:n,prevSub:s,nextSub:o}=e;if(s&&(s.nextSub=o,e.prevSub=0[0]),o&&(o.prevSub=s,e.nextSub=0[0]),n.subs===e&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)bs(e,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function V2(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=0[0]),n&&(n.prevDep=t,e.nextDep=0[0])}H=!0,ps=[];function J(){ps.push(H),H=!1}function ee(){const e=ps.pop();H=e===0[0]||e}function Hc(e){const{cleanup:t}=e;if(e.cleanup=0[0],t){const e=f;f=0[0];try{t()}finally{f=e}}}Pe=0,Cl=class{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=0[0]}},Qe=class{constructor(e){this.computed=e,this.version=0,this.activeLink=0[0],this.subs=0[0],this.map=0[0],this.key=0[0],this.sc=0,this.__v_skip=!0}track(){if(!f||!H||f===this.computed)return;let t=this.activeLink;if(t===0[0]||t.sub!==f)t=this.activeLink=new Cl(f,this),f.deps?(t.prevDep=f.depsTail,f.depsTail.nextDep=t,f.depsTail=t):f.deps=f.depsTail=t,G1(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=f.depsTail,t.nextDep=0[0],f.depsTail.nextDep=t,f.depsTail=t,f.deps===t&&(f.deps=e)}return t}trigger(e){this.version++,Pe++,this.notify(e)}notify(){Os();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{ws()}}};function G1(e){if(e.dep.sc++,e.sub.flags&4){const n=e.dep.computed;if(n&&!e.dep.subs){n.flags|=20;for(let e=n.deps;e;e=e.nextDep)G1(e)}const t=e.dep.subs;t!==e&&(e.prevSub=t,t&&(t.nextSub=e)),e.dep.subs=e}}$e=new WeakMap,me=Symbol(""),Jt=Symbol(""),Re=Symbol("");function E(e,t,n){if(H&&f){let t=$e.get(e);t||$e.set(e,t=new Map);let s=t.get(n);s||(t.set(n,s=new Qe),s.map=t,s.key=n),s.track()}}function Z(e,t,n,s){const a=$e.get(e);if(!a){Pe++;return}const r=e=>{e&&e.trigger()};if(Os(),t==="clear")a.forEach(r);else{const o=l(e),i=o&&xt(n);if(o&&n==="length"){const e=Number(s);a.forEach((t,n)=>{(n==="length"||n===Re||!W(n)&&n>=e)&&r(t)})}else switch((n!==0[0]||a.has(0[0]))&&r(a.get(n)),i&&r(a.get(Re)),t){case"add":o?i&&r(a.get("length")):(r(a.get(me)),be(e)&&r(a.get(Jt)));break;case"delete":o||(r(a.get(me)),be(e)&&r(a.get(Jt)));break;case"set":be(e)&&r(a.get(me));break}}ws()}function H0(e,t){const n=$e.get(e);return n&&n.get(t)}function ze(e){const t=u(e);return t===e?t:(E(t,"iterate",Re),P(e)?t:t.map(x))}function $t(e){return E(e=u(e),"iterate",Re),e}q1={__proto__:null,[Symbol.iterator](){return ls(this,Symbol.iterator,x)},concat(...e){return ze(this).concat(...e.map(e=>l(e)?ze(e):e))},entries(){return ls(this,"entries",e=>(e[1]=x(e[1]),e))},every(e,t){return ne(this,"every",e,t,0[0],arguments)},filter(e,t){return ne(this,"filter",e,t,e=>e.map(x),arguments)},find(e,t){return ne(this,"find",e,t,x,arguments)},findIndex(e,t){return ne(this,"findIndex",e,t,0[0],arguments)},findLast(e,t){return ne(this,"findLast",e,t,x,arguments)},findLastIndex(e,t){return ne(this,"findLastIndex",e,t,0[0],arguments)},forEach(e,t){return ne(this,"forEach",e,t,0[0],arguments)},includes(...e){return cs(this,"includes",e)},indexOf(...e){return cs(this,"indexOf",e)},join(e){return ze(this).join(e)},lastIndexOf(...e){return cs(this,"lastIndexOf",e)},map(e,t){return ne(this,"map",e,t,0[0],arguments)},pop(){return Ue(this,"pop")},push(...e){return Ue(this,"push",e)},reduce(e,...t){return I1(this,"reduce",e,t)},reduceRight(e,...t){return I1(this,"reduceRight",e,t)},shift(){return Ue(this,"shift")},some(e,t){return ne(this,"some",e,t,0[0],arguments)},splice(...e){return Ue(this,"splice",e)},toReversed(){return ze(this).toReversed()},toSorted(e){return ze(this).toSorted(e)},toSpliced(...e){return ze(this).toSpliced(...e)},unshift(...e){return Ue(this,"unshift",e)},values(){return ls(this,"values",x)}};function ls(e,t,n){const o=$t(e),s=o[t]();return o!==e&&!P(e)&&(s._next=s.next,s.next=()=>{const e=s._next();return e.value&&(e.value=n(e.value)),e}),s}U1=Array.prototype;function ne(e,t,n,s,o,i){const a=$t(e),r=a!==e&&!P(e),c=a[t];if(c!==U1[t]){const t=c.apply(e,i);return r?x(t):t}let l=n;a!==e&&(r?l=function(t,s){return n.call(this,x(t),s,e)}:n.length>2&&(l=function(t,s){return n.call(this,t,s,e)}));const d=c.call(a,l,s);return r&&o?o(d):d}function I1(e,t,n,s){const i=$t(e);let o=n;return i!==e&&(P(e)?n.length>3&&(o=function(t,s,o){return n.call(this,t,s,o,e)}):o=function(t,s,o){return n.call(this,t,x(s),o,e)}),i[t](o,...s)}function cs(e,t,n){const s=u(e);E(s,"iterate",Re);const o=s[t](...n);return(o===-1||o===!1)&&En(n[0])?(n[0]=u(n[0]),s[t](...n)):o}function Ue(e,t,n=[]){J(),Os();const s=u(e)[t].apply(e,n);return ws(),ee(),s}qu=Js("__proto__,__v_isRef,__isVue"),os=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(W));function e2(e){W(e)||(e=String(e));const t=u(this);return E(t,"has",e),t.hasOwnProperty(e)}ts=class{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const o=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!o;if(t==="__v_isReadonly")return o;if(t==="__v_isShallow")return i;if(t==="__v_raw")return n===(o?i?zd:Nn:i?Ln:Pn).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:0[0];const a=l(e);if(!o){let e;if(a&&(e=q1[t]))return e;if(t==="hasOwnProperty")return e2}const s=Reflect.get(e,t,O(e)?e:n);return(W(t)?os.has(t):qu(t))||(o||E(e,"get",t),i)?s:O(s)?a&&xt(t)?s:s.value:p(s)?o?Sn(s):vt(s):s}},es=class extends ts{constructor(e=!1){super(!1,e)}set(e,t,n,s){let o=e[t];if(!this._isShallow){const t=ce(o);if(!P(n)&&!ce(n)&&(o=u(o),n=u(n)),!l(e)&&O(o)&&!O(n))return!t&&(o.value=n,!0)}const i=l(e)&&xt(t)?Number(t)<e.length:h(e,t),a=Reflect.set(e,t,n,O(e)?e:s);return e===u(s)&&(i?oe(n,o)&&Z(e,"set",t,n):Z(e,"add",t,n)),a}deleteProperty(e,t){const s=h(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&s&&Z(e,"delete",t,0[0]),n}has(e,t){const n=Reflect.has(e,t);return(!W(t)||!os.has(t))&&E(e,"has",t),n}ownKeys(e){return E(e,"iterate",l(e)?"length":me),Reflect.ownKeys(e)}},eu=class extends ts{constructor(e=!1){super(!0,e)}set(){return!0}deleteProperty(){return!0}},Yd=new es,Ud=new eu,$d=new es(!0),Et=e=>e,Ze=e=>Reflect.getPrototypeOf(e);function u2(e,t,n){return function(...r){const o=this.__v_raw,i=u(o),a=be(i),c=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,d=o[e](...r),s=n?Et:t?et:x;return!t&&E(i,"iterate",l?Jt:me),{next(){const{value:e,done:t}=d.next();return t?{value:e,done:t}:{value:c?[s(e[0]),s(e[1])]:s(e),done:t}},[Symbol.iterator](){return this}}}}function Ot(e){return function(...t){return e!=="delete"&&(e==="clear"?0[0]:this)}}function p2(e,t){const n={get(n){const o=this.__v_raw,s=u(o),i=u(n);e||(oe(n,i)&&E(s,"get",n),E(s,"get",i));const{has:a}=Ze(s),r=t?Et:e?et:x;if(a.call(s,n))return r(o.get(n));if(a.call(s,i))return r(o.get(i));o!==s&&o.get(n)},get size(){const t=this.__v_raw;return!e&&E(u(t),"iterate",me),Reflect.get(t,"size",t)},has(t){const n=this.__v_raw,o=u(n),s=u(t);return e||(oe(t,s)&&E(o,"has",t),E(o,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)},forEach(n,s){const o=this,i=o.__v_raw,r=u(i),a=t?Et:e?et:x;return!e&&E(r,"iterate",me),i.forEach((e,t)=>n.call(s,a(e),a(t),o))}};return S(n,e?{add:Ot("add"),set:Ot("set"),delete:Ot("delete"),clear:Ot("clear")}:{add(e){!t&&!P(e)&&!ce(e)&&(e=u(e));const n=u(this);return Ze(n).has.call(n,e)||(n.add(e),Z(n,"add",e,e)),this},set(e,n){!t&&!P(n)&&!ce(n)&&(n=u(n));const s=u(this),{has:i,get:a}=Ze(s);let o=i.call(s,e);o||(e=u(e),o=i.call(s,e));const r=a.call(s,e);return s.set(e,n),o?oe(n,r)&&Z(s,"set",e,n):Z(s,"add",e,n),this},delete(e){const t=u(this),{has:s,get:o}=Ze(t);let n=s.call(t,e);n||(e=u(e),n=s.call(t,e)),o&&o.call(t,e);const i=t.delete(e);return n&&Z(t,"delete",e,0[0]),i},clear(){const e=u(this),t=e.size!==0,n=e.clear();return t&&Z(e,"clear",0[0],0[0]),n}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=u2(s,e,t)}),n}function Vn(e,t){const n=p2(e,t);return(t,s,o)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?t:Reflect.get(h(n,s)&&s in t?n:t,s,o)}Ld={get:Vn(!1,!1)},Nd={get:Vn(!1,!0)},Dd={get:Vn(!0,!1)},Pn=new WeakMap,Ln=new WeakMap,Nn=new WeakMap,zd=new WeakMap;function j2(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function O2(e){return e.__v_skip||!Object.isExtensible(e)?0:j2(Oo(e))}function vt(e){return ce(e)?e:kn(e,!1,Yd,Ld,Pn)}function s3(e){return kn(e,!1,$d,Nd,Ln)}function Sn(e){return kn(e,!0,Ud,Dd,Nn)}function kn(e,t,n,s,o){if(!p(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=O2(e);if(i===0)return e;const a=o.get(e);if(a)return a;const r=new Proxy(e,i===2?s:n);return o.set(e,r),r}function Fe(e){return ce(e)?Fe(e.__v_raw):!!(e&&e.__v_isReactive)}function ce(e){return!!(e&&e.__v_isReadonly)}function P(e){return!!(e&&e.__v_isShallow)}function En(e){return!!e&&!!e.__v_raw}function u(e){const t=e&&e.__v_raw;return t?u(t):e}function E2(e){return!h(e,"__v_skip")&&Object.isExtensible(e)&&wt(e,"__v_skip",!0),e}x=e=>p(e)?vt(e):e,et=e=>p(e)?Sn(e):e;function O(e){return!!e&&e.__v_isRef===!0}function Je(e){return vd(e,!1)}function F(e){return vd(e,!0)}function vd(e,t){return O(e)?e:new gl(e,t)}gl=class{constructor(e,t){this.dep=new Qe,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:u(e),this._value=t?e:x(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,t=this.__v_isShallow||P(e)||ce(e);e=t?e:u(e),oe(e,n)&&(this._rawValue=e,this._value=t?e:x(e),this.dep.trigger())}};function _n(e){return O(e)?e.value:e}function b(e){return d(e)?e():_n(e)}pl={get:(e,t,n)=>t==="__v_raw"?e:_n(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const o=e[t];return O(o)&&!O(n)?(o.value=n,!0):Reflect.set(e,t,n,s)}};function fl(e){return Fe(e)?e:new Proxy(e,pl)}Tc=class{constructor(e){this.__v_isRef=!0,this._value=0[0];const t=this.dep=new Qe,{get:n,set:s}=e(t.track.bind(t),t.trigger.bind(t));this._get=n,this._set=s}get value(){return this._value=this._get()}set value(e){this._set(e)}};function q2(e){return new Tc(e)}Sr=class{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0,this._value=0[0]}get value(){const e=this._object[this._key];return this._value=e===0[0]?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return H0(u(this._object),this._key)}},Ar=class{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=0[0]}get value(){return this._value=this._getter()}};function G2(e,t,n){return O(e)?e:d(e)?new Ar(e):p(e)&&arguments.length>1?Q2(e,t,n):Je(e)}function Q2(e,t,n){const s=e[t];return O(s)?s:new Sr(e,t,n)}gr=class{constructor(e,t,n){this.fn=e,this.setter=t,this._value=0[0],this.dep=new Qe(this),this.__v_isRef=!0,this.deps=0[0],this.depsTail=0[0],this.flags=16,this.globalVersion=Pe-1,this.next=0[0],this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&f!==this)return Za(this,!0),!0}get value(){const e=this.dep.track();return Br(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}};function e3(e,t,n=!1){let s,o;return d(e)?s=e:(s=e.get,o=e.set),new gr(s,o,n)}Ye={},Ge=new WeakMap;function o3(e,t=!1,n=Ee){if(n){let t=Ge.get(n);t||Ge.set(n,t=[]),t.push(e)}}function a3(e,t,n=m){const{immediate:_,deep:a,once:w,scheduler:v,augmentJob:y,call:o}=n,j=e=>a?e:P(e)||a===!1||a===0?te(e,1):te(e);let s,i,h,p,g=!1,f=!1;if(O(e)?(i=()=>e.value,g=P(e)):Fe(e)?(i=()=>j(e),g=!0):l(e)?(f=!0,g=e.some(e=>Fe(e)||P(e)),i=()=>e.map(e=>{if(O(e))return e.value;if(Fe(e))return j(e);if(d(e))return o?o(e,2):e()})):d(e)?t?i=o?()=>o(e,2):e:i=()=>{if(h){J();try{h()}finally{ee()}}const t=Ee;Ee=s;try{return o?o(e,3,[p]):e(p)}finally{Ee=t}}:i=B,t&&a){const e=i,t=a===!0?1/0:a;i=()=>te(e(),t)}const b=$a(),c=()=>{s.stop(),b&&b.active&&Yt(b.effects,s)};if(w&&t){const e=t;t=(...t)=>{e(...t),c()}}let r=f?new Array(e.length).fill(Ye):Ye;const u=e=>{if(!(!(s.flags&1)||!s.dirty&&!e))if(t){{const e=s.run();if(a||g||(f?e.some((e,t)=>oe(e,r[t])):oe(e,r))){h&&h();const n=Ee;Ee=s;try{const n=[e,r===Ye?0[0]:f&&r[0]===Ye?[]:r,p];r=e,o?o(t,3,n):t(...n)}finally{Ee=n}}}}else s.run()};return y&&y(u),s=new Es(i),s.scheduler=v?()=>v(u,!1):u,p=e=>o3(e,!1,s),h=s.onStop=()=>{const e=Ge.get(s);if(e){if(o)o(e,4);else for(const t of e)t();Ge.delete(s)}},t?_?u(!0):r=s.run():v?v(u.bind(null,!0),!0):s.run(),c.pause=s.pause.bind(s),c.resume=s.resume.bind(s),c.stop=c,c}function te(e,t=1/0,n){if(t<=0||!p(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),t--,O(e))te(e.value,t,n);else if(l(e))for(let s=0;s<e.length;s++)te(e[s],t,n);else if(Gs(e)||be(e))e.forEach(e=>{te(e,t,n)});else if(Ws(e)){for(const s in e)te(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&te(e[s],t,n)}return e}function mt(e,t,n,s){try{return s?e(...s):e()}catch(e){Gt(e,t,n)}}function X(e,t,n,s){if(d(e)){const o=mt(e,t,n,s);return o&&qs(o)&&o.catch(e=>{Gt(e,t,n)}),o}if(l(e)){const o=[];for(let i=0;i<e.length;i++)o.push(X(e[i],t,n,s));return o}}function Gt(e,t,n,s=!0){const i=t?t.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||m;if(t){let s=t.parent;const i=t.proxy,a=`https://vuejs.org/error-reference/#runtime-${n}`;for(;s;){const t=s.ec;if(t)for(let n=0;n<t.length;n++)if(t[n](e,i,a)===!1)return;s=s.parent}if(o){J(),mt(o,null,10,[e,i,a]),ee();return}}l3(e,n,i,s,a)}function l3(e,t,n,s=!0,o=!1){if(o)throw e;console.error(e)}M=[],V=-1,ke=[],re=null,Oe=0,dn=Promise.resolve(),qe=null;function ln(e){const t=qe||dn;return e?t.then(this?e.bind(this):e):t}function u3(e){let t=V+1,n=M.length;for(;t<n;){const s=t+n>>>1,o=M[s],i=Ae(o);i<e||i===e&&o.flags&2?t=s+1:n=s}return t}function cn(e){if(!(e.flags&1)){const t=Ae(e),n=M[M.length-1];!n||!(e.flags&2)&&t>=Ae(n)?M.push(e):M.splice(u3(t),0,e),e.flags|=1,fa()}}function fa(){qe||(qe=dn.then(ia))}function g3(e){l(e)?ke.push(...e):re&&e.id===-1?re.splice(Oe+1,0,e):e.flags&1||(ke.push(e),e.flags|=1),fa()}function la(e,t,n=V+1){for(;n<M.length;n++){const t=M[n];if(t&&t.flags&2){if(e&&t.id!==e.uid)continue;M.splice(n,1),n--,t.flags&4&&(t.flags&=-2),t(),t.flags&4||(t.flags&=-2)}}}function ca(){if(ke.length){const e=[...new Set(ke)].sort((e,t)=>Ae(e)-Ae(t));if(ke.length=0,re){re.push(...e);return}for(re=e,Oe=0;Oe<re.length;Oe++){const t=re[Oe];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}re=null,Oe=0}}Ae=e=>e.id==null?e.flags&2?-1:1/0:e.id;function ia(){try{for(V=0;V<M.length;V++){const e=M[V];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),mt(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;V<M.length;V++){const e=M[V];e&&(e.flags&=-2)}V=-1,M.length=0,ca(),qe=null,(M.length||ke.length)&&ia()}}w=null,pn=null;function Lt(e){const t=w;return w=e,pn=e&&e.type.__scopeId||null,t}function I(e,t=w){if(!t||e._n)return e;const s=(...n)=>{s._d&&Fo(-1);const i=Lt(t);let o;try{o=e(...n)}finally{Lt(i),s._d&&Fo(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function A(e,t){if(w===null)return e;const n=Mt(w),s=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[e,i,a,r=m]=t[o];e&&(d(e)&&(e={mounted:e,updated:e}),e.deep&&te(i),s.push({dir:e,instance:n,value:i,oldValue:0[0],arg:a,modifiers:r}))}return e}function _e(e,t,n,s){const o=e.dirs,i=t&&t.dirs;for(let a=0;a<o.length;a++){const r=o[a];i&&(r.oldValue=i[a].value);let c=r.dir[s];c&&(J(),X(c,n,8,[e.el,r,e,t]),ee())}}na=Symbol("_vte"),Qi=e=>e.__isTeleport;function wn(e,t){e.shapeFlag&6&&e.component?(e.transition=t,wn(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function At(){const e=Le();return e?(e.appContext.config.idPrefix||"v")+"-"+e.ids[0]+e.ids[1]++:""}function Gi(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function x3(e){const t=Le(),n=F(null);if(t){const s=t.refs===m?t.refs={}:t.refs;Object.defineProperty(s,e,{enumerable:!0,get:()=>n.value,set:e=>n.value=e})}return n}function ct(e,t,n,s,o=!1){if(l(e)){e.forEach((e,i)=>ct(e,t&&(l(t)?t[i]:t),n,s,o));return}if(ye(s)&&!o){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&ct(e,t,n,s.component.subTree);return}const c=s.shapeFlag&4?Mt(s.component):s.el,f=o?null:c,{i:g,r:i}=e,a=t&&t.r,r=g.refs===m?g.refs={}:g.refs,p=g.setupState,b=u(p),v=p===m?()=>!1:e=>h(b,e);if(a!=null&&a!==i&&(y(a)?(r[a]=null,v(a)&&(p[a]=null)):O(a)&&(a.value=null)),d(i))mt(i,g,12,[f,r]);else{const t=y(i),s=O(i);if(t||s){const a=()=>{if(e.f){const n=t?v(i)?p[i]:r[i]:i.value;o?l(n)&&Yt(n,c):l(n)?n.includes(c)||n.push(c):t?(r[i]=[c],v(i)&&(p[i]=r[i])):(i.value=[c],e.k&&(r[e.k]=i.value))}else t?(r[i]=f,v(i)&&(p[i]=f)):s&&(i.value=f,e.k&&(r[e.k]=f))};f?(a.id=-1,D(a,n)):a()}}}Xe().requestIdleCallback,Xe().cancelIdleCallback,ye=e=>!!e.type.__asyncLoader,An=e=>e.type.__isKeepAlive;function E3(e,t){Ii(e,"a",t)}function k3(e,t){Ii(e,"da",t)}function Ii(e,t,n=C){const s=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(bt(t,s,n),n){let e=n.parent;for(;e&&e.parent;)An(e.parent.vnode)&&S3(s,t,n,e),e=e.parent}}function S3(e,t,n,s){const o=bt(t,e,s,!0);In(()=>{Yt(s[t],o)},n)}function bt(e,t,n=C,s=!1){if(n){const i=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...s)=>{J();const o=Se(n),i=X(t,n,e,s);return o(),ee(),i});return s?i.unshift(o):i.push(o),o}}Q=e=>(t,n=C)=>{(!He||e==="sp")&&bt(e,(...e)=>t(...e),n)},Pi=Q("bm"),pt=Q("m"),Ri=Q("bu"),zi=Q("u"),Ti=Q("bum"),In=Q("um"),Fi=Q("sp"),Mi=Q("rtg"),Ei=Q("rtc");function T3(e,t=C){bt("ec",e,t)}Un="components";function wi(e,t){return yi(Un,e,!0,t)||e}qn=Symbol.for("v-ndc");function z3(e){return y(e)?yi(Un,e,!1)||e:e||qn}function yi(e,t,n=!0,s=!1){const o=w||C;if(o){const n=o.type;{const e=L3(n,!1);if(e&&(e===t||e===R(t)||e===lt(R(t))))return n}const i=vi(o[e]||n[e],t)||vi(o.appContext[e],t);return!i&&s?n:i}}function vi(e,t){return e&&(e[t]||e[R(t)]||e[lt(R(t))])}function g(e,t,n){let o;const i=n,a=l(e);if(a||y(e)){const r=a&&Fe(e);let n=!1,s=!1;r&&(n=!P(e),s=ce(e),e=$t(e)),o=new Array(e.length);for(let a=0,r=e.length;a<r;a++)o[a]=t(n?s?et(x(e[a])):x(e[a]):e[a],a,0[0],i)}else if(typeof e=="number"){o=new Array(e);for(let n=0;n<e;n++)o[n]=t(n+1,n,0[0],i)}else if(p(e))if(e[Symbol.iterator])o=Array.from(e,(e,n)=>t(e,n,0[0],i));else{const n=Object.keys(e);o=new Array(n.length);for(let s=0,r=n.length;s<r;s++){const a=n[s];o[s]=t(e[a],a,s,i)}}else o=[];return o}function fi(t,n,s={},o){if(w.ce||w.parent&&ye(w.parent)&&w.parent.ce)return n!=="default"&&(s.name=n),e(),r(c,null,[a("slot",s,o)],64);let l=t[n];l&&l._c&&(l._d=!1),e();const d=l&&ri(l(s)),h=s.key||d&&d.key,u=r(c,{key:(h&&!W(h)?h:`_${n}`)+(!d&&o?"_fb":"")},d||[],d&&t._===1?64:-2);return u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),l&&l._c&&(l._d=!0),u}function ri(e){return e.some(e=>!We(e)||!(e.type===U||e.type===c&&!ri(e.children)))?e:null}Dt=e=>e?ai(e)?Mt(e):Dt(e.parent):null,Be=S(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Dt(e.parent),$root:e=>Dt(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Xo(e),$forceUpdate:e=>e.f||(e.f=()=>{cn(e.update)}),$nextTick:e=>e.n||(e.n=ln.bind(e.proxy)),$watch:e=>zh.bind(e)}),Rt=(e,t)=>e!==m&&!e.__isScriptSetup&&h(e,t),ii={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:a,data:o,props:c,accessCache:s,type:u,appContext:f}=e;let l;if(t[0]!=="$"){const i=s[t];if(i!==0[0])switch(i){case 1:return a[t];case 2:return o[t];case 4:return n[t];case 3:return c[t]}else{if(Rt(a,t))return s[t]=1,a[t];if(o!==m&&h(o,t))return s[t]=2,o[t];if((l=e.propsOptions[0])&&h(l,t))return s[t]=3,c[t];if(n!==m&&h(n,t))return s[t]=4,n[t];Pt&&(s[t]=0)}}const d=Be[t];let i,r;if(d)return t==="$attrs"&&E(e.attrs,"get",""),d(e);if((i=u.__cssModules)&&(i=i[t]))return i;if(n!==m&&h(n,t))return s[t]=4,n[t];if(r=f.config.globalProperties,h(r,t))return r[t]},set({_:e},t,n){const{data:s,setupState:o,ctx:i}=e;return Rt(o,t)?(o[t]=n,!0):s!==m&&h(s,t)?(s[t]=n,!0):!(h(e.props,t)||t[0]==="$"&&t.slice(1)in e)&&(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:o,propsOptions:i}},a){let r;return!!n[a]||e!==m&&h(e,a)||Rt(t,a)||(r=i[0])&&h(r,a)||h(s,a)||h(Be,a)||h(o.config.globalProperties,a)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:h(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function oi(e){return l(e)?e.reduce((e,t)=>(e[t]=null,e),{}):e}Pt=!0;function I3(e){const u=Xo(e),t=e.proxy,s=e.ctx;Pt=!1,u.beforeCreate&&ti(u.beforeCreate,e,"bc");const{data:j,computed:a,methods:r,watch:c,provide:o,inject:h,created:m,beforeMount:S,mounted:T,beforeUpdate:O,updated:F,activated:w,deactivated:M,beforeDestroy:N,beforeUnmount:C,destroyed:z,unmounted:x,render:b,renderTracked:E,renderTriggered:k,errorCaptured:A,serverPrefetch:y,expose:i,inheritAttrs:v,components:g,directives:f,filters:D}=u;if(h&&B3(h,s,null),r)for(const e in r){const n=r[e];d(n)&&(s[e]=n.bind(t))}if(j){const n=j.call(t,t);p(n)&&(e.data=vt(n))}if(Pt=!0,a)for(const n in a){const e=a[n],i=d(e)?e.bind(t,t):d(e.get)?e.get.bind(t,t):B,r=!d(e)&&d(e.set)?e.set.bind(t):B,o=_({get:i,set:r});Object.defineProperty(s,n,{enumerable:!0,configurable:!0,get:()=>o.value,set:e=>o.value=e})}if(c)for(const e in c)ei(c[e],s,t,e);if(o){const e=d(o)?o.call(t):o;Reflect.ownKeys(e).forEach(t=>{sh(t,e[t])})}m&&ti(m,e,"c");function n(e,n){l(n)?n.forEach(n=>e(n.bind(t))):n&&e(n.bind(t))}if(n(Pi,S),n(pt,T),n(Ri,O),n(zi,F),n(E3,w),n(k3,M),n(T3,A),n(Ei,E),n(Mi,k),n(Ti,C),n(In,x),n(Fi,y),l(i))if(i.length){const n=e.exposed||(e.exposed={});i.forEach(e=>{Object.defineProperty(n,e,{get:()=>t[e],set:n=>t[e]=n,enumerable:!0})})}else e.exposed||(e.exposed={});b&&e.render===B&&(e.render=b),v!=null&&(e.inheritAttrs=v),g&&(e.components=g),f&&(e.directives=f),y&&Gi(e)}function B3(e,t){l(e)&&(e=gs(e));for(const o in e){const s=e[o];let n;p(s)?"default"in s?n=on(s.from||o,s.default,!0):n=on(s.from||o):n=on(s),O(n)?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>n.value,set:e=>n.value=e}):t[o]=n}}function ti(e,t,n){X(l(e)?e.map(e=>e.bind(t.proxy)):e.bind(t.proxy),t,n)}function ei(e,t,n,s){let o=s.includes(".")?ro(n,s):()=>n[s];if(y(e)){const n=t[e];d(n)&&$(o,n)}else if(d(e))$(o,e.bind(n));else if(p(e))if(l(e))e.forEach(e=>ei(e,t,n,s));else{const s=d(e.handler)?e.handler.bind(n):t[e.handler];d(s)&&$(o,s,e)}}function Xo(e){const n=e.type,{mixins:r,extends:c}=n,{mixins:s,optionsCache:o,config:{optionMergeStrategies:i}}=e.appContext,a=o.get(n);let t;return a?t=a:!s.length&&!r&&!c?t=n:(t={},s.length&&s.forEach(e=>tn(t,e,i,!0)),tn(t,n,i)),p(n)&&o.set(n,t),t}function tn(e,t,n,s=!1){const{mixins:o,extends:i}=t;i&&tn(e,i,n,!0),o&&o.forEach(t=>tn(e,t,n,!0));for(const o in t)if(!s||o!=="expose"){const s=Yo[o]||n&&n[o];e[o]=s?s(e[o],t[o]):t[o]}return e}Yo={data:qo,props:Uo,emits:Uo,methods:ot,computed:ot,beforeCreate:T,created:T,beforeMount:T,mounted:T,beforeUpdate:T,updated:T,beforeDestroy:T,beforeUnmount:T,destroyed:T,unmounted:T,activated:T,deactivated:T,errorCaptured:T,serverPrefetch:T,components:ot,directives:ot,watch:G3,provide:qo,inject:Y3};function qo(e,t){return t?e?function(){return S(d(e)?e.call(this,this):e,d(t)?t.call(this,this):t)}:t:e}function Y3(e,t){return ot(gs(e),gs(t))}function gs(e){if(l(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function T(e,t){return e?[...new Set([].concat(e,t))]:t}function ot(e,t){return e?S(Object.create(null),e,t):t}function Uo(e,t){return e?l(e)&&l(t)?[...new Set([...e,...t])]:S(Object.create(null),oi(e),oi(t??{})):t}function G3(e,t){if(!e)return t;if(!t)return e;const n=S(Object.create(null),e);for(const s in t)n[s]=T(e[s],t[s]);return n}function $o(){return{app:null,config:{isNativeTag:lo,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:0[0],warnHandler:0[0],compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}Io=0;function eh(e){return function(t,n=null){d(t)||(t=S({},t)),n!=null&&!p(n)&&(n=null);const o=$o(),i=new WeakSet,c=[];let r=!1;const s=o.app={_uid:Io++,_component:t,_props:n,_container:null,_context:o,_instance:null,version:ji,get config(){return o.config},set config(e){},use(e,...t){return i.has(e)||(e&&d(e.install)?(i.add(e),e.install(s,...t)):d(e)&&(i.add(e),e(s,...t))),s},mixin(e){return o.mixins.includes(e)||o.mixins.push(e),s},component(e,t){return t?(o.components[e]=t,s):o.components[e]},directive(e,t){return t?(o.directives[e]=t,s):o.directives[e]},mount(i,c,l){if(!r){const c=s._ceVNode||a(t,n);return c.appContext=o,l===!0?l="svg":l===!1&&(l=0[0]),e(c,i,l),r=!0,s._container=i,i.__vue_app__=s,Mt(c.component)}},onUnmount(e){c.push(e)},unmount(){r&&(X(c,s._instance,16),e(null,s._container),delete s._container.__vue_app__)},provide(e,t){return o.provides[e]=t,s},runWithContext(e){const t=ge;ge=s;try{return e()}finally{ge=t}}};return s}}ge=null;function sh(e,t){if(C){let n=C.provides;const s=C.parent&&C.parent.provides;s===n&&(n=C.provides=Object.create(s)),n[e]=t}}function on(e,t,n=!1){const s=Le();if(s||ge){let o=ge?ge._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:0[0];if(o&&e in o)return o[e];if(arguments.length>1)return n&&d(t)?t.call(s&&s.proxy):t}}ks={},As=()=>Object.create(ks),Ss=e=>Object.getPrototypeOf(e)===ks;function oh(e,t,n,s=!1){const o={},i=As();e.propsDefaults=Object.create(null),No(e,t,o,i);for(const t in e.propsOptions[0])t in o||(o[t]=0[0]);n?e.props=s?o:s3(o):e.type.props?e.props=o:e.props=i,e.attrs=i}function ih(e,t,n,s){const{props:i,attrs:o,vnode:{patchFlag:l}}=e,r=u(i),[c]=e.propsOptions;let a=!1;if((s||l>0)&&!(l&16)){if(l&8){const n=e.vnode.dynamicProps;for(let d=0;d<n.length;d++){let s=n[d];if(an(e.emitsOptions,s))continue;const l=t[s];if(c)if(h(o,s))l!==o[s]&&(o[s]=l,a=!0);else{const t=R(s);i[t]=zs(c,r,t,l,e,!1)}else l!==o[s]&&(o[s]=l,a=!0)}}}else{No(e,t,i,o)&&(a=!0);let s;for(const o in r)(!t||!h(t,o)&&((s=ie(o))===o||!h(t,s)))&&(c?n&&(n[o]!==0[0]||n[s]!==0[0])&&(i[o]=zs(c,r,o,0[0],e,!0)):delete i[o]);if(o!==r)for(const e in o)(!t||!h(t,e))&&(delete o[e],a=!0)}a&&Z(e.attrs,"set","")}function No(e,t,n,s){const[i,o]=e.propsOptions;let r=!1,a;if(t)for(let c in t){if(De(c))continue;const l=t[c];let d;i&&h(i,d=R(c))?!o||!o.includes(d)?n[d]=l:(a||(a={}))[d]=l:an(e.emitsOptions,c)||(!(c in s)||l!==s[c])&&(s[c]=l,r=!0)}if(o){const s=u(n),t=a||m;for(let r=0;r<o.length;r++){const a=o[r];n[a]=zs(i,s,a,t[a],e,!h(t,a))}}return r}function zs(e,t,n,s,o,i){const a=e[n];if(a!=null){const e=h(a,"default");if(e&&s===0[0]){const e=a.default;if(a.type!==Function&&!a.skipFactory&&d(e)){const{propsDefaults:i}=o;if(n in i)s=i[n];else{const a=Se(o);s=i[n]=e.call(null,t),a()}}else s=e;o.ce&&o.ce._setProp(n,s)}a[0]&&(i&&!e?s=!1:a[1]&&(s===""||s===ie(n))&&(s=!0))}return s}Do=new WeakMap;function zo(e,t,n=!1){const i=n?Do:t.propsCache,r=i.get(e);if(r)return r;const s=e.props,o={},a=[];let c=!1;if(!d(e)){const s=e=>{c=!0;const[s,n]=zo(e,t,!0);S(o,s),n&&a.push(...n)};!n&&t.mixins.length&&t.mixins.forEach(s),e.extends&&s(e.extends),e.mixins&&e.mixins.forEach(s)}if(!s&&!c)return p(e)&&i.set(e,Ce),Ce;if(l(s))for(let e=0;e<s.length;e++){const t=R(s[e]);So(t)&&(o[t]=m)}else if(s)for(const t in s){const e=R(t);if(So(e)){const i=s[t],r=o[e]=l(i)||d(i)?{type:i}:S({},i),n=r.type;let c=!1,u=!0;if(l(n))for(let e=0;e<n.length;++e){const t=n[e],s=d(t)&&t.name;if(s==="Boolean"){c=!0;break}s==="String"&&(u=!1)}else c=d(n)&&n.name==="Boolean";r[0]=c,r[1]=u,(c||h(r,"default"))&&a.push(e)}}const u=[o,a];return p(e)&&i.set(e,u),u}function So(e){return e[0]!=="$"&&!De(e)}en=e=>e==="_"||e==="__"||e==="_ctx"||e==="$stable",Zt=e=>l(e)?e.map(G):[G(e)],ko=(e,t,n)=>{if(t._n)return t;const s=I((...e)=>Zt(t(...e)),n);return s._c=!1,s},Is=(e,t)=>{const s=e._ctx;for(const n in e){if(en(n))continue;const o=e[n];if(d(o))t[n]=ko(n,o,s);else if(o!=null){const e=Zt(o);t[n]=()=>e}}},Bs=(e,t)=>{const n=Zt(t);e.slots.default=()=>n},Vs=(e,t,n)=>{for(const s in t)(n||!en(s))&&(e[s]=t[s])},Eo=(e,t,n)=>{const s=e.slots=As();if(e.vnode.shapeFlag&32){const e=t.__;e&&wt(s,"__",e,!0);const o=t._;o?(Vs(s,t,n),n&&wt(s,"_",o,!0)):Is(t,s)}else t&&Bs(e,t)},Co=(e,t,n)=>{const{vnode:a,slots:s}=e;let o=!0,i=m;if(a.shapeFlag&32){const e=t._;e?n&&e===1?o=!1:Vs(s,t,n):(o=!t.$stable,Is(t,s)),i=t}else t&&(Bs(e,t),i={default:1});if(o)for(const e in s)!en(e)&&i[e]==null&&delete s[e]},D=wh;function lh(e){return uh(e)}function uh(e){const N=Xe();N.__VUE__=!0;const{insert:n,remove:r,patchProp:o,createElement:se,createText:j,createComment:te,setText:Z,setElementText:f,parentNode:E,nextSibling:h,setScopeId:O=B,insertStaticContent:$}=e,s=(e,t,n,s=null,o=null,a=null,r=0[0],l=null,d=!!t.dynamicChildren)=>{if(e===t)return;e&&!Ke(e,t)&&(s=g(e),i(e,o,a,!0),e=null),t.patchFlag===-2&&(d=!1,t.dynamicChildren=null);const{type:m,ref:h,shapeFlag:u}=t;switch(m){case ut:H(e,t,n,s);break;case U:M(e,t,n,s);break;case zt:e==null&&z(t,n,s,r);break;case c:R(e,t,n,s,o,a,r,l,d);break;default:u&1?ne(e,t,n,s,o,a,r,l,d):u&6?W(e,t,n,s,o,a,r,l,d):(u&64||u&128)&&m.process(e,t,n,s,o,a,r,l,d,p)}h!=null&&o?ct(h,e&&e.ref,a,t||e,!t):h==null&&e&&e.ref!=null&&ct(e.ref,null,a,e,!0)},H=(e,t,s,o)=>{if(e==null)n(t.el=j(t.children),s,o);else{const n=t.el=e.el;t.children!==e.children&&Z(n,t.children)}},M=(e,t,s,o)=>{e==null?n(t.el=te(t.children||""),s,o):t.el=e.el},z=(e,t,n,s)=>{[e.el,e.anchor]=$(e.children,t,n,s,e.el,e.anchor)},K=({el:e,anchor:t},s,o)=>{let i;for(;e&&e!==t;)i=h(e),n(e,s,o),e=i;n(t,s,o)},P=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=h(e),r(e),e=n;r(t)},ne=(e,t,n,s,o,i,a,r,c)=>{t.type==="svg"?a="svg":t.type==="math"&&(a="mathml"),e==null?Q(t,n,s,o,i,a,r,c):V(e,t,o,i,a,r,c)},Q=(e,t,s,i,a,r,c,l)=>{let h,m;const{props:d,shapeFlag:b,transition:g,dirs:p}=e;if(h=e.el=se(e.type,r,d&&d.is,d),b&8?f(h,e.children):b&16&&u(e.children,h,null,i,a,Ys(e,r),c,l),p&&_e(e,null,i,"created"),k(h,e,e.scopeId,c,i),d){for(const e in d)e!=="value"&&!De(e)&&o(h,e,null,d[e],r,i);"value"in d&&o(h,"value",null,d.value,r),(m=d.onVnodeBeforeMount)&&q(m,i,e)}p&&_e(e,null,i,"beforeMount");const v=_h(a,g);v&&g.beforeEnter(h),n(h,t,s),((m=d&&d.onVnodeMounted)||v||p)&&D(()=>{m&&q(m,i,e),v&&g.enter(h),p&&_e(e,null,i,"mounted")},a)},k=(e,t,n,s,o)=>{if(n&&O(e,n),s)for(let t=0;t<s.length;t++)O(e,s[t]);if(o){let n=o.subTree;if(t===n||Zs(n.type)&&(n.ssContent===t||n.ssFallback===t)){const t=o.vnode;k(e,t,t.scopeId,t.slotScopeIds,o.parent)}}},u=(e,t,n,o,i,a,r,c,l=0)=>{for(let d=l;d<e.length;d++){const u=e[d]=c?le(e[d]):G(e[d]);s(null,u,t,n,o,i,a,r,c)}},V=(e,t,n,s,i,a,r)=>{const l=t.el=e.el;let{patchFlag:d,dynamicChildren:p,dirs:g}=t;d|=e.patchFlag&16;const u=e.props||m,c=t.props||m;let h;if(n&&ve(n,!1),(h=c.onVnodeBeforeUpdate)&&q(h,n,t,e),g&&_e(t,e,n,"beforeUpdate"),n&&ve(n,!0),(u.innerHTML&&c.innerHTML==null||u.textContent&&c.textContent==null)&&f(l,""),p?w(e.dynamicChildren,p,l,n,s,Ys(t,i),a):r||y(e,t,l,null,n,s,Ys(t,i),a,!1),d>0){if(d&16)F(l,u,c,n,i);else if(d&2&&u.class!==c.class&&o(l,"class",null,c.class,i),d&4&&o(l,"style",u.style,c.style,i),d&8){const e=t.dynamicProps;for(let s=0;s<e.length;s++){const t=e[s],a=u[t],r=c[t];(r!==a||t==="value")&&o(l,t,a,r,i,n)}}d&1&&e.children!==t.children&&f(l,t.children)}else!r&&p==null&&F(l,u,c,n,i);((h=c.onVnodeUpdated)||g)&&D(()=>{h&&q(h,n,t,e),g&&_e(t,e,n,"updated")},s)},w=(e,t,n,o,i,a,r)=>{for(let d=0;d<t.length;d++){const l=e[d],u=t[d],h=l.el&&(l.type===c||!Ke(l,u)||l.shapeFlag&198)?E(l.el):n;s(l,u,h,null,o,i,a,r,!0)}},F=(e,t,n,s,i)=>{if(t!==n){if(t!==m)for(const a in t)!De(a)&&!(a in n)&&o(e,a,t[a],null,i,s);for(const a in n){if(De(a))continue;const r=n[a],c=t[a];r!==c&&a!=="value"&&o(e,a,c,r,i,s)}"value"in n&&o(e,"value",t.value,n.value,i)}},R=(e,t,s,o,i,a,r,c,l)=>{const p=t.el=e?e.el:j(""),d=t.anchor=e?e.anchor:j("");let{patchFlag:m,dynamicChildren:f,slotScopeIds:h}=t;h&&(c=c?c.concat(h):h),e==null?(n(p,s,o),n(d,s,o),u(t.children||[],s,d,i,a,r,c,l)):m>0&&m&64&&f&&e.dynamicChildren?(w(e.dynamicChildren,f,s,i,a,r,c),(t.key!=null||i&&t===i.subTree)&&_o(e,t,!0)):y(e,t,s,d,i,a,r,c,l)},W=(e,t,n,s,o,i,a,r,c)=>{t.slotScopeIds=r,e==null?t.shapeFlag&512?o.ctx.activate(t,n,s,a,c):x(t,n,s,o,i,a,c):L(e,t,c)},x=(e,t,n,s,o,i,r)=>{const c=e.component=W3(e,s,o);if(An(e)&&(c.ctx.renderer=p),H3(c,!1,r),c.asyncDep){if(o&&o.registerDep(c,T,r),!e.el){const s=c.subTree=a(U);M(null,s,t,n),e.placeholder=s.el}}else T(c,e,t,n,o,i,r)},L=(e,t,n)=>{const s=t.component=e.component;if(Mh(e,t,n))if(s.asyncDep&&!s.asyncResolved){_(s,t,n);return}else s.next=t,s.update();else t.el=e.el,s.vnode=t},T=(e,t,n,o,i,a,r)=>{const d=()=>{if(e.isMounted){let{next:t,bu:u,u:h,parent:m,vnode:n}=e;{const s=ho(e);if(s){t&&(t.el=n.el,_(e,t,r)),s.asyncDep.then(()=>{e.isUnmounted||d()});return}}let f=t,o;ve(e,!1),t?(t.el=n.el,_(e,t,r)):t=n,u&&st(u),(o=t.props&&t.props.onVnodeBeforeUpdate)&&q(o,m,t,n),ve(e,!0);const c=mo(e),l=e.subTree;e.subTree=c,s(l,c,E(l.el),g(l),e,i,a),t.el=c.el,f===null&&Sh(e,c.el),h&&D(h,i),(o=t.props&&t.props.onVnodeUpdated)&&D(()=>q(o,m,t,n),i)}else{let c;const{el:p,props:l}=t,{bm:u,m:h,parent:r,root:d,type:f}=e,m=ye(t);ve(e,!1),u&&st(u),!m&&(c=l&&l.onVnodeBeforeMount)&&q(c,r,t),ve(e,!0);{d.ce&&d.ce._def.shadowRoot!==!1&&d.ce._injectChildStyle(f);const r=e.subTree=mo(e);s(null,r,n,o,e,i,a),t.el=r.el}if(h&&D(h,i),!m&&(c=l&&l.onVnodeMounted)){const e=t;D(()=>q(c,r,e),i)}(t.shapeFlag&256||r&&ye(r.vnode)&&r.vnode.shapeFlag&256)&&e.a&&D(e.a,i),e.isMounted=!0,t=n=o=null}};e.scope.on();const c=e.effect=new Es(d);e.scope.off();const u=e.update=c.run.bind(c),l=e.job=c.runIfDirty.bind(c);l.i=e,l.id=e.uid,c.scheduler=()=>cn(l),ve(e,!0),u()},_=(e,t,n)=>{t.component=e;const s=e.vnode.props;e.vnode=t,e.next=null,ih(e,t.props,s,n),Co(e,t.children,n),J(),la(e),ee()},y=(e,t,n,s,o,i,a,r,c=!1)=>{const l=e&&e.children,m=e?e.shapeFlag:0,h=t.children,{patchFlag:p,shapeFlag:g}=t;if(p>0){if(p&128){S(l,h,n,s,o,i,a,r,c);return}if(p&256){I(l,h,n,s,o,i,a,r,c);return}}g&8?(m&16&&d(l,o,i),h!==l&&f(n,h)):m&16?g&16?S(l,h,n,s,o,i,a,r,c):d(l,o,i,!0):(m&8&&f(n,""),g&16&&u(h,n,s,o,i,a,r,c))},I=(e,t,n,o,i,a,r,c,l)=>{e=e||Ce,t=t||Ce;const f=e.length,p=t.length,m=Math.min(f,p);let h;for(h=0;h<m;h++){const o=t[h]=l?le(t[h]):G(t[h]);s(e[h],o,n,null,i,a,r,c,l)}f>p?d(e,i,a,!0,!1,m):u(t,n,o,i,a,r,c,l,m)},S=(e,t,n,o,a,r,c,l,d)=>{let u=0;const f=t.length;let m=e.length-1,h=f-1;for(;u<=m&&u<=h;){const o=e[u],i=t[u]=d?le(t[u]):G(t[u]);if(Ke(o,i))s(o,i,n,null,a,r,c,l,d);else break;u++}for(;u<=m&&u<=h;){const o=e[m],i=t[h]=d?le(t[h]):G(t[h]);if(Ke(o,i))s(o,i,n,null,a,r,c,l,d);else break;m--,h--}if(u>m){if(u<=h){const e=h+1,i=e<f?t[e].el:o;for(;u<=h;)s(null,t[u]=d?le(t[u]):G(t[u]),n,i,a,r,c,l,d),u++}}else if(u>h)for(;u<=m;)i(e[u],a,r,!0),u++;else{const C=u,g=u,_=new Map;for(u=g;u<=h;u++){const e=t[u]=d?le(t[u]):G(t[u]);e.key!=null&&_.set(e.key,u)}let p,w=0;const j=h-g+1;let y=!1,O=0;const b=new Array(j);for(u=0;u<j;u++)b[u]=0;for(u=C;u<=m;u++){const f=e[u];if(w>=j){i(f,a,r,!0);continue}let o;if(f.key!=null)o=_.get(f.key);else for(p=g;p<=h;p++)if(b[p-g]===0&&Ke(f,t[p])){o=p;break}o===0[0]?i(f,a,r,!0):(b[o-g]=u+1,o>=O?O=o:y=!0,s(f,t[o],n,null,a,r,c,l,d),w++)}const x=y?kh(b):Ce;for(p=x.length-1,u=j-1;u>=0;u--){const e=g+u,i=t[e],h=t[e+1],m=e+1<f?h.el||h.placeholder:o;b[u]===0?s(null,i,n,m,a,r,c,l,d):y&&(p<0||u!==x[p]?v(i,n,m,2):p--)}}},v=(e,t,s,o,i=null)=>{const{el:a,type:u,transition:l,children:h,shapeFlag:d}=e;if(d&6){v(e.component.subTree,t,s,o);return}if(d&128){e.suspense.move(t,s,o);return}if(d&64){u.move(e,t,s,p);return}if(u===c){n(a,t,s);for(let e=0;e<h.length;e++)v(h[e],t,s,o);n(e.anchor,t,s);return}if(u===zt){K(e,t,s);return}if(o!==2&&d&1&&l)if(o===0)l.beforeEnter(a),n(a,t,s),D(()=>l.enter(a),i);else{const{leave:u,delayLeave:o,afterLeave:i}=l,c=()=>{e.ctx.isUnmounted?r(a):n(a,t,s)},d=()=>{u(a,()=>{c(),i&&i()})};o?o(a,c,d):d()}else n(a,t,s)},i=(e,t,n,s=!1,o=!1)=>{const{type:m,props:r,ref:f,children:b,dynamicChildren:u,shapeFlag:i,patchFlag:l,dirs:j,cacheIndex:g}=e;if(l===-2&&(o=!1),f!=null&&(J(),ct(f,null,n,e,!0),ee()),g!=null&&(t.renderCache[g]=0[0]),i&256){t.ctx.deactivate(e);return}const h=i&1&&j,v=!ye(e);let a;if(v&&(a=r&&r.onVnodeBeforeUnmount)&&q(a,t,e),i&6)X(e.component,n,s);else{if(i&128){e.suspense.unmount(n,s);return}h&&_e(e,null,t,"beforeUnmount"),i&64?e.type.remove(e,t,n,p,s):u&&!u.hasOnce&&(m!==c||l>0&&l&64)?d(u,t,n,!1,!0):(m===c&&l&384||!o&&i&16)&&d(b,t,n),s&&A(e)}(v&&(a=r&&r.onVnodeUnmounted)||h)&&D(()=>{a&&q(a,t,e),h&&_e(e,null,t,"unmounted")},n)},A=e=>{const{type:o,el:n,anchor:i,transition:t}=e;if(o===c){Y(n,i);return}if(o===zt){P(e);return}const s=()=>{r(n),t&&!t.persisted&&t.afterLeave&&t.afterLeave()};if(e.shapeFlag&1&&t&&!t.persisted){const{leave:a,delayLeave:o}=t,i=()=>a(n,s);o?o(e.el,s,i):i()}else s()},Y=(e,t)=>{let n;for(;e!==t;)n=h(e),r(e),e=n;r(t)},X=(e,t,n)=>{const{bum:s,scope:d,job:o,subTree:u,um:a,m:h,a:m,parent:r,slots:{__:c}}=e;io(h),io(m),s&&st(s),r&&l(c)&&c.forEach(e=>{r.renderCache[e]=0[0]}),d.stop(),o&&(o.flags|=8,i(u,e,t,n)),a&&D(a,t),D(()=>{e.isUnmounted=!0},t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,t.deps===0&&t.resolve())},d=(e,t,n,s=!1,o=!1,a=0)=>{for(let r=a;r<e.length;r++)i(e[r],t,n,s,o)},g=e=>{if(e.shapeFlag&6)return g(e.component.subTree);if(e.shapeFlag&128)return e.suspense.next();const t=h(e.anchor||e.el),n=t&&t[na];return n?h(n):t};let b=!1;const C=(e,t,n)=>{e==null?t._vnode&&i(t._vnode,null,null,!0):s(t._vnode||null,e,t,null,null,null,n),t._vnode=e,b||(b=!0,la(),ca(),b=!1)},p={p:s,um:i,m:v,r:A,mt:x,mc:u,pc:y,pbc:w,n:g,o:e};return{render:C,hydrate:0[0],createApp:eh(C)}}function Ys({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?0[0]:n}function ve({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function _h(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function _o(e,t,n=!1){const o=e.children,s=t.children;if(l(o)&&l(s))for(let t=0;t<o.length;t++){const i=o[t];let e=s[t];e.shapeFlag&1&&!e.dynamicChildren&&((e.patchFlag<=0||e.patchFlag===32)&&(e=s[t]=le(s[t]),e.el=i.el),!n&&e.patchFlag!==-2&&_o(i,e)),e.type===ut&&(e.el=i.el),e.type===U&&!e.el&&(e.el=i.el)}}function kh(e){const a=e.slice(),t=[0];let s,r,n,o,i;const c=e.length;for(s=0;s<c;s++){const l=e[s];if(l!==0){if(r=t[t.length-1],e[r]<l){a[s]=r,t.push(s);continue}for(n=0,o=t.length-1;n<o;)i=n+o>>1,e[t[i]]<l?n=i+1:o=i;l<e[t[n]]&&(n>0&&(a[s]=t[n-1]),t[n]=s)}}for(n=t.length,o=t[n-1];n-- >0;)t[n]=o,o=a[o];return t}function ho(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:ho(t)}function io(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}oo=Symbol.for("v-scx"),Kd=()=>on(oo);function so(e,t){return eo(e,null,t)}function $(e,t,n){return eo(e,t,n)}function eo(e,t,n=m){const{immediate:d,deep:u,flush:i,once:h}=n,o=S({},n),c=t&&d||!t&&i!=="post";let a;if(He)if(i==="sync"){const e=Kd();a=e.__watcherHandles||(e.__watcherHandles=[])}else if(!c){const e=()=>{};return e.stop=B,e.resume=B,e.pause=B,e}const s=C;o.call=(e,t,n)=>X(e,s,t,n);let l=!1;i==="post"?o.scheduler=e=>{D(e,s&&s.suspense)}:i!=="sync"&&(l=!0,o.scheduler=(e,t)=>{t?e():cn(e)}),o.augmentJob=e=>{t&&(e.flags|=4),l&&(e.flags|=2,s&&(e.id=s.uid,e.i=s))};const r=a3(e,t,o);return He&&(a?a.push(r):c&&r()),r}function zh(e,t,n){const s=this.proxy,i=y(e)?e.includes(".")?ro(s,e):()=>s[e]:e.bind(s,s);let o;d(t)?o=t:(o=t.handler,n=t);const a=Se(this),r=eo(i,o.bind(s),n);return a(),r}function ro(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}co=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${R(t)}Modifiers`]||e[`${ie(t)}Modifiers`];function Fh(e,n,...a){if(e.isUnmounted)return;const s=e.vnode.props||m;let o=a;const c=n.startsWith("update:"),r=c&&co(s,n.slice(7));r&&(r.trim&&(o=a.map(e=>y(e)?e.trim():e)),r.number&&(o=a.map(Ct)));let t,i=s[t=yt(n)]||s[t=yt(R(n))];!i&&c&&(i=s[t=yt(ie(n))]),i&&X(i,e,6,o);const l=s[t+"Once"];if(l){if(e.emitted){if(e.emitted[t])return}else e.emitted={};e.emitted[t]=!0,X(l,e,6,o)}}function uo(e,t,n=!1){const i=t.emitsCache,a=i.get(e);if(a!==0[0])return a;const o=e.emits;let s={},r=!1;if(!d(e)){const o=e=>{const n=uo(e,t,!0);n&&(r=!0,S(s,n))};!n&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return!o&&!r?(p(e)&&i.set(e,null),null):(l(o)?o.forEach(e=>s[e]=null):S(s,o),p(e)&&i.set(e,s),s)}function an(e,t){return!!e&&!!ft(t)&&(t=t.slice(2).replace(/Once$/,""),h(e,t[0].toLowerCase()+t.slice(1))||h(e,ie(t))||h(e,t))}function mo(e){const{type:c,vnode:s,proxy:y,withProxy:j,propsOptions:[l],slots:b,attrs:i,emit:h,render:d,renderCache:u,props:r,data:m,setupState:f,ctx:p,inheritAttrs:g}=e,v=Lt(e);let o,n;try{if(s.shapeFlag&4){const e=j||y,t=e;o=G(d.call(t,e,u,r,f,m,p)),n=i}else{const e=c;o=G(e.length>1?e(r,{attrs:i,slots:b,emit:h}):e(r,null)),n=c.props?i:fo(i)}}catch(t){Ne.length=0,Gt(t,e,1),o=a(U)}let t=o;if(n&&g!==!1){const e=Object.keys(n),{shapeFlag:s}=t;e.length&&s&7&&(l&&e.some(Qt)&&(n=po(n,l)),t=Te(t,n,!1,!0))}return s.dirs&&(t=Te(t,null,!1,!0),t.dirs=t.dirs?t.dirs.concat(s.dirs):s.dirs),s.transition&&wn(t,s.transition),o=t,Lt(v),o}fo=e=>{let t;for(const n in e)(n==="class"||n==="style"||ft(n))&&((t||(t={}))[n]=e[n]);return t},po=(e,t)=>{const n={};for(const s in e)(!Qt(s)||!(s.slice(9)in t))&&(n[s]=e[s]);return n};function Mh(e,t,n){const{props:o,children:c,component:l}=e,{props:s,children:a,patchFlag:i}=t,r=l.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&i>=0){{if(i&1024)return!0;if(i&16)return o?vo(o,s,r):!!s;if(i&8){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(s[n]!==o[n]&&!an(r,n))return!0}}}}else return!(!c&&!a||!!a&&!!a.$stable)||o!==s&&(o?!s||vo(o,s,r):!!s);return!1}function vo(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let o=0;o<s.length;o++){const i=s[o];if(t[i]!==e[i]&&!an(n,i))return!0}return!1}function Sh({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=n,t=t.parent;else break}}Zs=e=>e.__isSuspense;function wh(e,t){t&&t.pendingBranch?l(e)?t.effects.push(...e):t.effects.push(e):g3(e)}c=Symbol.for("v-fgt"),ut=Symbol.for("v-txt"),U=Symbol.for("v-cmt"),zt=Symbol.for("v-stc"),Ne=[],N=null;function e(e=!1){Ne.push(N=e?null:[])}function ah(){Ne.pop(),N=Ne[Ne.length-1]||null}Ie=1;function Fo(e,t=!1){Ie+=e,e<0&&N&&t&&(N.hasOnce=!0)}function To(e){return e.dynamicChildren=Ie>0?N||Ce:null,ah(),Ie>0&&N&&N.push(e),e}function n(e,n,s,o,i,a){return To(t(e,n,s,o,i,a,!0))}function r(e,t,n,s,o){return To(a(e,t,n,s,o,!0))}function We(e){return!!e&&e.__v_isVNode===!0}function Ke(e,t){return e.type===t.type&&e.key===t.key}Ms=({key:e})=>e??null,rt=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?y(e)||O(e)||d(e)?{i:w,r:e,k:t,f:!!n}:e:null);function t(e,t=null,n=null,s=0,o=null,i=e===c?0:1,a=!1,r=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Ms(t),ref:t&&rt(t),scopeId:pn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:w};return r?(ms(l,n),i&128&&e.normalize(l)):n&&(l.shapeFlag|=y(n)?8:16),Ie>0&&!a&&N&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&N.push(l),l}a=Q3;function Q3(e,n=null,s=null,o=0,i=null,a=!1){if((!e||e===qn)&&(e=U),We(e)){const t=Te(e,n,!0);return s&&ms(t,s),Ie>0&&!a&&N&&(t.shapeFlag&6?N[N.indexOf(e)]=t:N.push(t)),t.patchFlag=-2,t}if(N3(e)&&(e=e.__vccOpts),n){n=X3(n);let{class:t,style:e}=n;t&&!y(t)&&(n.class=j(t)),p(e)&&(En(e)&&!l(e)&&(e=S({},e)),n.style=pe(e))}const r=y(e)?1:Zs(e)?128:Qi(e)?64:p(e)?4:d(e)?2:0;return t(e,n,s,o,i,r,a,!0)}function X3(e){return e?En(e)||Ss(e)?S({},e):e:null}function Te(e,t,n=!1,s=!1){const{props:u,ref:o,patchFlag:i,children:h,transition:a}=e,r=t?U3(u||{},t):u,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:r,key:r&&Ms(r),ref:t&&t.ref?n&&o?l(o)?o.concat(rt(t)):[o,rt(t)]:rt(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:h,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==c?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:a,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Te(e.ssContent),ssFallback:e.ssFallback&&Te(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return a&&s&&wn(d,a.clone(d)),d}function z(e=" ",t=0){return a(ut,null,e,t)}function o(t="",n=!1){return n?(e(),r(U,null,t)):a(U,null,t)}function G(e){return e==null||typeof e=="boolean"?a(U):l(e)?a(c,null,e.slice()):We(e)?le(e):a(ut,null,String(e))}function le(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Te(e)}function ms(e,t){let n=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(l(t))n=16;else if(typeof t=="object")if(s&65){const n=t.default;n&&(n._c&&(n._d=!1),ms(e,n()),n._c&&(n._d=!0));return}else{n=32;const s=t._;!s&&!Ss(t)?t._ctx=w:s===3&&w&&(w.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else d(t)?(t={default:t,_ctx:w},n=32):(t=String(t),s&64?(n=16,t=[z(t)]):n=8);e.children=t,e.shapeFlag|=n}function U3(...t){const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const t in n)if(t==="class")e.class!==n.class&&(e.class=j([e.class,n.class]));else if(t==="style")e.style=pe([e.style,n.style]);else if(ft(t)){const s=e[t],o=n[t];o&&s!==o&&!(l(s)&&s.includes(o))&&(e[t]=s?[].concat(s,o):o)}else t!==""&&(e[t]=n[t])}return e}function q(e,t,n,s=null){X(e,t,7,[n,s])}Qo=$o(),Zo=0;function W3(e,t,n){const o=e.type,i=(t?t.appContext:e.appContext)||Qo,s={uid:Zo++,vnode:e,type:o,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ca(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:zo(o,i),emitsOptions:uo(o,i),emit:null,emitted:null,propsDefaults:m,inheritAttrs:o.inheritAttrs,ctx:m,data:m,props:m,attrs:m,slots:m,refs:m,setupState:m,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=Fh.bind(null,s),e.ce&&e.ce(s),s}C=null,Le=()=>C||w;{const e=Xe(),t=(t,n)=>{let s;return(s=e[t])||(s=e[t]=[]),s.push(n),e=>{s.length>1?s.forEach(t=>t(e)):s[0](e)}};Ht=t("__VUE_INSTANCE_SETTERS__",e=>C=e),rs=t("__VUE_SSR_SETTERS__",e=>He=e)}Se=e=>{const t=C;return Ht(e),e.scope.on(),()=>{e.scope.off(),Ht(t)}},ss=()=>{C&&C.scope.off(),Ht(null)};function ai(e){return e.vnode.shapeFlag&4}He=!1;function H3(e,t=!1,n=!1){t&&rs(t);const{props:o,children:i}=e.vnode,s=ai(e);oh(e,o,s,t),Eo(e,i,n||t);const a=s?P3(e,t):0[0];return t&&rs(!1),a}function P3(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,ii);const{setup:n}=s;if(n){J();const i=e.setupContext=n.length>1?R3(e):null,a=Se(e),s=mt(n,e,0,[e.props,i]),o=qs(s);if(ee(),a(),(o||e.sp)&&!ye(e)&&Gi(e),o){if(s.then(ss,ss),t)return s.then(t=>{di(e,t)}).catch(t=>{Gt(t,e,0)});e.asyncDep=s}else di(e,s)}else ui(e)}function di(e,t){d(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:p(t)&&(e.setupState=fl(t)),ui(e)}function ui(e){const s=e.type;e.render||(e.render=s.render||B);{const t=Se(e);J();try{I3(e)}finally{ee(),t()}}}hi={get(e,t){return E(e,"get",""),e[t]}};function R3(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,hi),slots:e.slots,emit:e.emit,expose:t}}function Mt(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(fl(E2(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Be)return Be[n](e)},has(e,t){return t in e||t in Be}})):e.proxy}function L3(e,t=!0){return d(e)?e.displayName||e.name:e.name||t&&e.__name}function N3(e){return d(e)&&"__vccOpts"in e}_=(e,t)=>e3(e,t,He);function D3(e,t,n){const s=arguments.length;return s===2?p(t)&&!l(t)?We(t)?a(e,null,[t]):a(e,t):a(e,null,t):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&We(n)&&(n=[n]),a(e,t,n))}if(ji="3.5.18",Yn=typeof window<"u"&&window.trustedTypes,Yn)try{Gn=Yn.createPolicy("vue",{createHTML:e=>e})}catch{}Kn=Gn?e=>Gn.createHTML(e):e=>e,Oi="http://www.w3.org/2000/svg",xi="http://www.w3.org/1998/Math/MathML",K=typeof document<"u"?document:null,$n=K&&K.createElement("template"),ki={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const o=t==="svg"?K.createElementNS(Oi,e):t==="mathml"?K.createElementNS(xi,e):n?K.createElement(e,{is:n}):K.createElement(e);return e==="select"&&s&&s.multiple!=null&&o.setAttribute("multiple",s.multiple),o},createText:e=>K.createTextNode(e),createComment:e=>K.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>K.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,o,i){const a=n?n.previousSibling:t.lastChild;if(o&&(o===i||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),o!==i&&!!(o=o.nextSibling););else{$n.innerHTML=Kn(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const o=$n.content;if(s==="svg"||s==="mathml"){const e=o.firstChild;for(;e.firstChild;)o.appendChild(e.firstChild);o.removeChild(e)}t.insertBefore(o,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Ai=Symbol("_vtc");function F3(e,t,n){const s=e[Ai];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}nt=Symbol("_vod"),Bn=Symbol("_vsh"),L={beforeMount(e,{value:t},{transition:n}){e[nt]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):at(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!=!n&&(s?t?(s.beforeEnter(e),at(e,!0),s.enter(e)):s.leave(e,()=>{at(e,!1)}):at(e,t))},beforeUnmount(e,{value:t}){at(e,t)}};function at(e,t){e.style.display=t?e[nt]:"none",e[Bn]=!t}Di=Symbol(""),Ni=/(^|;)\s*display\s*:/;function M3(e,t,n){const s=e.style,i=y(n);let o=!1;if(n&&!i){if(t)if(y(t))for(const e of t.split(";")){const o=e.slice(0,e.indexOf(":")).trim();n[o]==null&&jt(s,o,"")}else for(const e in t)n[e]==null&&jt(s,e,"");for(const e in n)e==="display"&&(o=!0),jt(s,e,n[e])}else if(i){if(t!==n){const e=s[Di];e&&(n+=";"+e),s.cssText=n,o=Ni.test(n)}}else t&&e.removeAttribute("style");nt in e&&(e[nt]=o?s.display:"",e[Bn]&&(s.display="none"))}Rn=/\s*!important$/;function jt(e,t,n){if(l(n))n.forEach(n=>jt(e,t,n));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=A3(e,t);Rn.test(n)?e.setProperty(ie(s),n.replace(Rn,""),"important"):e[s]=n}}Tn=["Webkit","Moz","ms"],gt={};function A3(e,t){const s=gt[t];if(s)return s;let n=R(t);if(n!=="filter"&&n in e)return gt[t]=n;n=lt(n);for(let s=0;s<Tn.length;s++){const o=Tn[s]+n;if(o in e)return gt[t]=o}return t}Mn="http://www.w3.org/1999/xlink";function $i(e,t,n,s,o,i=aa(t)){s&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Mn,t.slice(6,t.length)):e.setAttributeNS(Mn,t,n):n==null||i&&!ja(n)?e.removeAttribute(t):e.setAttribute(t,i?"":W(n)?String(n):n)}function Wi(e,t,n,s,o){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Kn(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const o=i==="OPTION"?e.getAttribute("value")||"":e.value,s=n==null?e.type==="checkbox"?"on":"":String(n);(o!==s||!("_value"in e))&&(e.value=s),n==null&&e.removeAttribute(t),e._value=n;return}let a=!1;if(n===""||n==null){const s=typeof e[t];s==="boolean"?n=ja(n):n==null&&s==="string"?(n="",a=!0):s==="number"&&(n=0,a=!0)}try{e[t]=n}catch{}a&&e.removeAttribute(o||t)}function Me(e,t,n,s){e.addEventListener(t,n,s)}function C3(e,t,n,s){e.removeEventListener(t,n,s)}Cn=Symbol("_vei");function O3(e,t,n,s,o=null){const a=e[Cn]||(e[Cn]={}),i=a[t];if(s&&i)i.value=s;else{const[n,r]=w3(t);if(s){const i=a[t]=_3(s,o);Me(e,n,i,r)}else i&&(C3(e,n,i,r),a[t]=0[0])}}xn=/(?:Once|Passive|Capture)$/;function w3(e){let t;if(xn.test(e)){t={};let n;for(;n=e.match(xn);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ie(e.slice(2)),t]}St=0,Zi=Promise.resolve(),Ji=()=>St||(Zi.then(()=>St=0),St=Date.now());function _3(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();X(y3(e,n.value),t,5,[e])};return n.value=e,n.attached=Ji(),n}function y3(e,t){if(l(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(e=>t=>!t._stopped&&e&&e(t))}return t}yn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,sa=(e,t,n,s,o,i)=>{const a=o==="svg";t==="class"?F3(e,s,a):t==="style"?M3(e,n,s):ft(t)?Qt(t)||O3(e,t,n,s,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):b3(e,t,s,a))?(Wi(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&$i(e,t,s,a,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!y(s))?Wi(e,R(t),s,i,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),$i(e,t,s,a))};function b3(e,t,n,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&yn(t)&&d(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const t=e.tagName;if(t==="IMG"||t==="VIDEO"||t==="CANVAS"||t==="SOURCE")return!1}return!(yn(t)&&y(n))&&t in e}mn=e=>{const t=e.props["onUpdate:modelValue"]||!1;return l(t)?e=>st(t,e):t};function v3(e){e.target.composing=!0}function ra(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}Xt=Symbol("_assign"),tt={created(e,{modifiers:{lazy:t,trim:n,number:s}},o){e[Xt]=mn(o);const i=s||o.props&&o.props.type==="number";Me(e,t?"change":"input",t=>{if(t.target.composing)return;let s=e.value;n&&(s=s.trim()),i&&(s=Ct(s)),e[Xt](s)}),n&&Me(e,"change",()=>{e.value=e.value.trim()}),t||(Me(e,"compositionstart",v3),Me(e,"compositionend",ra),Me(e,"change",ra))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:o,number:i}},a){if(e[Xt]=mn(a),e.composing)return;const c=(i||e.type==="number")&&!/^0\d/.test(e.value)?Ct(e.value):e.value,r=t??"";c!==r&&(document.activeElement===e&&e.type!=="range"&&(s&&t===n||o&&e.value.trim()===r)||(e.value=r))}},da=["ctrl","shift","alt","meta"],ua={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>da.some(n=>e[`${n}Key`]&&!t.includes(n))},fe=(e,t)=>{const n=e._withMods||(e._withMods={}),s=t.join(".");return n[s]||(n[s]=(n,...s)=>{for(let e=0;e<t.length;e++){const s=ua[t[e]];if(s&&s(n,t))return}return e(n,...s)})},ma={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},de=(e,t)=>{const n=e._withKeys||(e._withKeys={}),s=t.join(".");return n[s]||(n[s]=n=>{if(!("key"in n))return;const s=ie(n.key);if(t.some(e=>e===s||ma[e]===s))return e(n)})},pa=S({patchProp:sa},ki);function p3(){return ga||(ga=lh(pa))}ba=(...e)=>{const t=p3().createApp(...e),{mount:n}=t;return t.mount=e=>{const s=h3(e);if(!s)return;const o=t._component;!d(o)&&!o.render&&!o.template&&(o.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const i=n(s,!1,m3(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),i},t};function m3(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function h3(e){return y(e)?document.querySelector(e):e}i=(e,t)=>{const n=e.__vccOpts||e;for(const[e,s]of t)n[e]=s;return n},wa={},Oa={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function d3(s,o){return e(),n("svg",Oa,o[0]||(o[0]=[t("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},null,-1)]))}un=i(wa,[["render",d3]]),Ea={blobBaseUrl:"https://github.com/tify-iiif-viewer/tify/blob/v0.34.5",bugsUrl:"https://github.com/tify-iiif-viewer/tify/issues",license:"AGPL-3.0",repositoryUrl:"https://github.com/tify-iiif-viewer/tify",version:"0.34.5"},ka={computed:{env:()=>Ea}},Aa={class:"tify-help",tabindex:"0"},Sa={class:"tify-sr-only"},Ma=["innerHTML"],Fa={class:"tify-list"},Ta=["href"],za=["href"],Da=["href"],Na=["href"],La={class:"tify-help-footer"},Ra=["innerHTML"];function c3(o,i,a,r,c,l){return e(),n("section",Aa,[t("h2",Sa,s(o.$translate("Help")),1),t("h3",null,s(o.$translate("About TIFY")),1),t("p",{innerHTML:o.$translate("$info")},null,8,Ma),t("ul",Fa,[t("li",null,[t("a",{href:l.env.repositoryUrl},s(o.$translate("Source code")),9,Ta)]),t("li",null,[t("a",{href:`${l.env.blobBaseUrl}/doc`},s(o.$translate("Documentation")),9,za)]),t("li",null,[t("a",{href:`${l.env.blobBaseUrl}/CONTRIBUTORS.md`},s(o.$translate("Contributors")),9,Da)]),t("li",null,[t("a",{href:l.env.bugsUrl},s(o.$translate("Report a bug")),9,Na)])]),t("footer",La,[t("p",{innerHTML:o.$translate("$copyright")},null,8,Ra),t("p",null,[z(s(o.$translate("Version"))+" ",1),t("b",null,s(l.env.version),1)])])])}Ha=i(ka,[["render",c3]]),Ia={},Ba={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function r3(s,o){return e(),n("svg",Ba,o[0]||(o[0]=[t("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"},null,-1)]))}Ut=i(Ia,[["render",r3]]),Wa={},Ua={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function i3(s,o){return e(),n("svg",Ua,o[0]||(o[0]=[t("path",{d:"M19,13H5V11H19V13Z"},null,-1)]))}Wt=i(Wa,[["render",i3]]),Ya={name:"CollectionNode",props:{item:{type:Object,default:()=>{}}},data(){return{children:null,expanded:!1}},computed:{id(){return this.$getId(At())}},methods:{toggleChildren(){if(this.expanded){this.expanded=!1;return}if(this.children){this.expanded=!0;return}if(this.item.children){this.children=this.item.children,this.expanded=!0;return}this.$store.fetchJson(this.item["@id"]||this.item.id).then(e=>{this.children=e.collections||e.items||e.manifests||[],this.expanded=!0},e=>{const t=e.response&&(e.response.statusText||e.response.data)||e.message;this.$store.addError(`Error loading IIIF manifest: ${t}`),this.children=!1})}}},Ga=["aria-controls","aria-expanded","aria-label"],Xa=["id"],Qa=["id"];function Ah(t,o,i,a,l,d){const u=Wt,h=Ut,m=wi("CollectionNode",!0);return e(),n("li",{class:j(["tify-collection-item",{"-current":t.$store.manifest&&t.$store.manifest.id===(i.item["@id"]||i.item.id)}])},[i.item.type==="Collection"?(e(),n("button",{key:0,type:"button",class:"tify-collection-link -has-children","aria-controls":d.id,"aria-expanded":l.expanded,"aria-label":t.$translate(l.expanded?"Collapse":"Expand"),onClick:o[0]||(o[0]=e=>d.toggleChildren())},[l.expanded?(e(),r(u,{key:0})):(e(),r(h,{key:1})),z(" "+s(t.$store.localize(i.item.label)),1)],8,Ga)):(e(),n("a",{key:1,href:"javascript:;",class:"tify-collection-link",onClick:o[1]||(o[1]=e=>t.$store.loadManifest(i.item["@id"]||i.item.id,{expectedType:i.item.type,reset:!0}))},s(t.$store.localize(i.item.label)),1)),l.children!==!1?A((e(),n("ol",{key:2,id:d.id,class:"tify-collection-list"},[(e(!0),n(c,null,g(l.children,t=>(e(),r(m,{key:t.id,item:t},null,8,["item"]))),128))],8,Xa)),[[L,l.expanded]]):A((e(),n("p",{key:3,id:d.id,class:"tify-collection-error"},s(t.$translate("Could not load child manifest")),9,Qa)),[[L,l.expanded]])],2)}Ja=i(Ya,[["render",Ah]]),er={data(){return{filter:""}},computed:{filteredItems(){const e=this.filter.trim().toLowerCase().split(/\s+/);return this.$store.collection.items.filter(t=>{const n=this.$store.localize(t.label).toLowerCase();return e.every(e=>n.includes(e))})}}},tr={class:"tify-collection",tabindex:"0"},nr={class:"tify-sr-only"},sr={key:0,class:"tify-collection-controls"},or=["aria-label","placeholder"],ir=["disabled"],ar={key:1,class:"tify-collection-list"},rr={key:2,class:"tify-collection-no-results"};function _0(i,a,l,d,u,h){const m=Ja;return e(),n("section",tr,[t("h2",nr,s(i.$translate("Collection")),1),i.$store.collection.items.length>5?(e(),n("p",sr,[A(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>u.filter=e),"aria-label":i.$translate("Filter collection"),class:"tify-collection-filter",placeholder:i.$translate("Filter collection"),type:"text",onKeydown:[a[1]||(a[1]=de(fe(e=>u.filter?u.filter="":e.target.blur(),["prevent"]),["esc"])),a[2]||(a[2]=fe(()=>{},["stop"]))]},null,40,or),[[tt,u.filter]]),t("button",{type:"button",class:"tify-collection-reset",disabled:!u.filter,onClick:a[3]||(a[3]=e=>u.filter="")},s(i.$translate("Reset")),9,ir)])):o("",!0),h.filteredItems.length?(e(),n("ol",ar,[(e(!0),n(c,null,g(h.filteredItems,t=>(e(),r(m,{key:t.id,item:t},null,8,["item"]))),128))])):(e(),n("p",rr,s(i.$translate("No results")),1))])}lr=i(er,[["render",_0]]);function dr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}It={exports:{}},hr=It.exports;function J2(){return mr||(mr=1,function(e){(function(t){if(typeof n!="function"){var n=function(e){return e};n.nonNative=!0}const s=n("plaintext"),i=n("html"),a=n("comment"),l=/<(\w*)>/g,d=/<\/?([^\s/>]+)/;function o(e,t,n){e=e||"",t=t||[],n=n||"";let s=r(t,n);return c(e,s)}function u(e,t){e=e||[],t=t||"";let n=r(e,t);return function(e){return c(e||"",n)}}o.init_streaming_mode=u;function r(e,t){return e=h(e),{allowable_tags:e,tag_replacement:t,state:s,tag_buffer:"",depth:0,in_quote_char:""}}function c(e,t){if(typeof e!="string")throw new TypeError("'html' parameter must be a string");let d=t.allowable_tags,u=t.tag_replacement,o=t.state,n=t.tag_buffer,l=t.depth,r=t.in_quote_char,c="";for(let h=0,f=e.length;h<f;h++){let t=e[h];if(o===s)switch(t){case"<":o=i,n+=t;break;default:c+=t;break}else if(o===i)switch(t){case"<":if(r)break;l++;break;case">":if(r)break;if(l){l--;break}r="",o=s,n+=">",d.has(m(n))?c+=n:c+=u,n="";break;case'"':case"'":t===r?r="":r=r||t,n+=t;break;case"-":n==="<!-"&&(o=a),n+=t;break;case" ":case`
`:if(n==="<"){o=s,c+="< ",n="";break}n+=t;break;default:n+=t;break}else if(o===a)switch(t){case">":n.slice(-2)=="--"&&(o=s),n="";break;default:n+=t;break}}return t.state=o,t.tag_buffer=n,t.depth=l,t.in_quote_char=r,c}function h(e){let t=new Set;if(typeof e=="string"){let n;for(;n=l.exec(e);)t.add(n[1])}else!n.nonNative&&typeof e[n.iterator]=="function"?t=new Set(e):typeof e.forEach=="function"&&e.forEach(t.add,t);return t}function m(e){let t=d.exec(e);return t?t[1].toLowerCase():null}e.exports?e.exports=o:t.striptags=o})(hr)}(It)),It.exports}pr=J2(),hn=dr(pr),vr={props:{number:{type:Number,required:!0},wrap:{type:Boolean,default:!1}},computed:{classes(){return{L:"tify-page-name-label",P:"tify-page-name-number"}},label(){return hn(this.$store.localize(this.$store.manifest.items[this.number-1].label))||this.$translate("$n/a")},html(){return`<span>${this.$store.options.pageLabelFormat}</span>`.replace("P",`${this.number}`).replace("L",`</span>${this.label}<span>`).replace("<span></span>","")}}},br=["innerHTML"];function Z2(t,s,o,i,a,r){return e(),n("span",{class:j(["tify-page-name",{"-wrap":o.wrap}]),innerHTML:r.html},null,10,br)}je=i(vr,[["render",Z2]]),_r={},wr={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function X2(s,o){return e(),n("svg",wr,o[0]||(o[0]=[t("path",{d:"M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"},null,-1)]))}fn=i(_r,[["render",X2]]),Cr={},Er={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function Y2(s,o){return e(),n("svg",Er,o[0]||(o[0]=[t("path",{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},null,-1)]))}gn=i(Cr,[["render",Y2]]);function Nt(e){const n=["a","b","br","i","img","p","span"],s={a:["href"],img:["alt","src"]};let t=hn(e,n);const o=/<(\w+)((\s+.+?(\s*=\s*(?:".*?"|'.*?'|.*?|[\^'">\s]+))?)+\s*|\s*)>/g;return t=t.replace(o,(e,t,n)=>{if(!n)return`<${t}>`;const i=/(?:([^\s"'=]+)(?:=(?:"(.*?)"|'(.*?)'|([^\s>]+)))?)/g,o=[];return n.replace(i,(e,n)=>{var i;(i=s[t])!=null&&i.includes(n)&&o.push(e)}),o.length>0?`<${t} ${o.join(" ")}>`:`<${t}>`}),t}function Mr(e,t){if(!(e instanceof Array)||!t||new Set(e).size!==e.length)return!1;for(let n=0,s=e.length;n<s;n+=1)if(!Number.isInteger(e[n])||n>0&&e[n]>0&&e[n]<=e[n-1]||e[n]<-1||e[n]>t)return!1;return!0}function vn(e,t=["https:","http:"]){let n;try{n=new URL(e)}catch{return!1}return t.includes(n.protocol)}Tr={props:{metadata:{type:Array,default:()=>[]}},data(){return{infoItems:[]}},watch:{metadata(){this.init()},"$store.options.view":{handler(e){e==="info"&&this.init()},immediate:!0}},methods:{init(){this.$nextTick(()=>{var e;(e=this.$refs.contents)==null||e.forEach((e,t)=>{const n=e.offsetHeight;this.infoItems[t]={collapsed:!0,exceedsHeight:!0},this.$nextTick(()=>{const o=e.offsetHeight,s=n>=o;this.infoItems[t]={collapsed:s,exceedsHeight:s}})})})},filterHtml:Nt,isValidUrl:vn}},zr={class:"tify-info-metadata"},Dr={key:0},Nr={class:"tify-info-value"},Lr=["href"],Rr=["innerHTML"],Pr=["onClick"];function K2(i,r,l,d,u,h){const m=gn,f=fn;return e(),n("div",zr,[(e(!0),n(c,null,g(l.metadata,(r,l)=>(e(),n("div",{key:l},[r.label?(e(),n("h4",Dr,s(i.$store.localize(r.label)),1)):o("",!0),t("div",{ref_for:!0,ref:"contents",class:j(["tify-info-content",{"-collapsed":u.infoItems[l]&&u.infoItems[l].collapsed}])},[t("div",Nr,[h.isValidUrl(r.value)?(e(),n("p",{key:`url-${l}`},[t("a",{href:r.value},s(r.value),9,Lr)])):(e(),n("div",{key:`html-${l}`,innerHTML:h.filterHtml(i.$store.localize(r.value))||i.$translate("$n/a")},null,8,Rr))]),u.infoItems[l]&&u.infoItems[l].exceedsHeight?(e(),n("button",{key:0,type:"button",class:"tify-info-toggle",onClick:e=>u.infoItems[l].collapsed=!u.infoItems[l].collapsed},[u.infoItems[l].collapsed?(e(),n(c,{key:0},[a(m),z(" "+s(i.$translate("Expand")),1)],64)):(e(),n(c,{key:1},[a(f),z(" "+s(i.$translate("Collapse")),1)],64))],8,Pr)):o("",!0)],2)]))),128))])}Ir=i(Tr,[["render",K2]]);function U2(e,t){try{return new Date(e).toLocaleDateString(t,{month:"long",day:"numeric",year:"numeric"})}catch{return e}}Vr={data(){return{collectionDataShown:!1}},computed:{hasProvider(){var e;return(e=this.manifestOrCollection.provider)==null?0[0]:e.some(e=>{var t;return this.$store.localize(e.label)||((t=e.homepage)==null?0[0]:t.length)})},homepages(){return[].concat(this.manifestOrCollection.homepage||[])},logos(){var t;let e=[].concat(this.manifestOrCollection.logo||[]);return(t=this.manifestOrCollection.provider)==null||t.forEach(t=>{t.logo&&(e=e.concat(t.logo))}),e=[...new Map(e.map(e=>[e.id,e])).values()],e=e.map(e=>{var t,n,s,o;return{id:e.id,link:((n=(t=e.service)==null?0[0]:t[0])==null?0[0]:n.id)||((o=(s=e.service)==null?0[0]:s[0])==null?0[0]:o["@id"])}}),e},manifestOrCollection(){return this.collectionDataShown?this.$store.collection:this.$store.manifest||this.$store.collection||{}},metadataItems(){return this.$store.manifest.items.map((e,t)=>({metadata:e.metadata,number:t+1})).filter(({metadata:e,number:t})=>e?.length&&this.$store.options.pages.includes(t))},pages(){return this.$store.options.pages.filter(e=>e>0).map(e=>{var t,n;const s={page:e,media:[]},o=(n=(t=this.$store.manifest.items[e-1].items)==null?0[0]:t[0])==null?0[0]:n.items;return o==null||o.forEach(e=>{var t;const n=((t=e.body)==null?0[0]:t.items)||[e.body];s.media.push(...n.filter(e=>e.label).map(e=>({label:e.label})))}),s})}},methods:{filterHtml:Nt,formatDate:U2,isValidUrl:vn}},$r={class:"tify-info",tabindex:"0"},Wr={class:"tify-sr-only"},Ur={key:0,class:"tify-info-header"},Kr=["aria-pressed"],qr=["aria-pressed"],Yr={key:1,class:"tify-info-section -title"},Gr={key:2,class:"tify-info-section -time"},Xr={key:3,class:"tify-info-section -place"},Qr={key:4,class:"tify-info-section -metadata"},Zr={key:5,class:"tify-info-section -description"},Jr={key:6,class:"tify-info-section -metadata -structure"},ec={key:0,class:"tify-info-structure"},tc={key:7,class:"tify-info-section -pages"},nc={class:"tify-list -unstyled"},sc={key:0,class:"tify-info-image-labels"},oc={key:8,class:"tify-info-section -related"},ic={class:"tify-list"},ac=["href"],rc=["href"],cc={key:9,class:"tify-info-section -attribution"},lc=["innerHTML"],dc={key:10,class:"tify-info-section -license"},uc=["href"],hc={key:11,class:"tify-info-section -provider"},mc={key:0},fc={key:1,class:"tify-list"},pc=["href"],gc={key:12,class:"tify-info-section -logo"},vc=["href"],bc=["src","alt"],jc=["src","alt"];function W2(i,l,d,u,h,m){var p,v,b,j;const f=Ir,y=je;return e(),n("section",$r,[t("h2",Wr,s(i.$translate("Info")),1),i.$store.collection&&i.$store.manifest?(e(),n("div",Ur,[t("button",{type:"button",class:"tify-info-button","aria-pressed":!h.collectionDataShown,onClick:l[0]||(l[0]=e=>h.collectionDataShown=!1)},s(i.$translate("Document")),9,Kr),t("button",{type:"button",class:"tify-info-button","aria-pressed":h.collectionDataShown,onClick:l[1]||(l[1]=e=>h.collectionDataShown=!0)},s(i.$translate("Collection")),9,qr)])):o("",!0),m.manifestOrCollection.label?(e(),n("div",Yr,[t("h3",null,s(i.$translate("Title")),1),t("p",null,s(i.$store.localize(m.manifestOrCollection.label)),1)])):o("",!0),m.manifestOrCollection.navDate?(e(),n("div",Gr,[t("h3",null,s(i.$translate("Date")),1),t("p",null,s(m.formatDate(m.manifestOrCollection.navDate,i.$store.options.language)),1)])):o("",!0),m.manifestOrCollection.navPlace?(e(),n("div",Xr,[t("h3",null,s(i.$translate("Place")),1),(e(!0),n(c,null,g(m.manifestOrCollection.navPlace.features,t=>(e(),n("p",{key:t.id},s(i.$store.localize(t.properties.label)),1))),128))])):o("",!0),m.manifestOrCollection.metadata&&m.manifestOrCollection.metadata.length?(e(),n("div",Qr,[t("h3",null,s(i.$translate("Metadata")),1),i.$store.options.view==="info"?(e(),r(f,{key:0,metadata:m.manifestOrCollection.metadata},null,8,["metadata"])):o("",!0)])):o("",!0),m.manifestOrCollection.summary?(e(),n("div",Zr,[t("h3",null,s(i.$translate("Description")),1),i.$store.options.view==="info"?(e(),r(f,{key:0,metadata:[{value:m.manifestOrCollection.summary}]},null,8,["metadata"])):o("",!0)])):o("",!0),m.manifestOrCollection.structures&&((p=i.$store.currentStructure)!=null&&p.label||(v=i.$store.currentStructure)!=null&&v.metadata)?(e(),n("div",Jr,[t("h3",null,s(i.$translate("Current Section")),1),(b=i.$store.currentStructure)!=null&&b.label?(e(),n("p",ec,s(i.$store.localize(i.$store.currentStructure.label)),1)):o("",!0),i.$store.options.view==="info"&&(j=i.$store.currentStructure)!=null&&j.metadata?(e(),r(f,{key:1,class:"tify-info-section -metadata",metadata:i.$store.currentStructure.metadata},null,8,["metadata"])):o("",!0)])):o("",!0),m.manifestOrCollection.type==="Manifest"?(e(),n("div",tc,[t("h3",null,s(i.$translate(m.pages.length>1?"Current Pages":"Current Page")),1),t("ol",nc,[(e(!0),n(c,null,g(m.pages,t=>(e(),n("li",{key:t},[a(y,{number:t.page,wrap:""},null,8,["number"]),t.media.length?(e(),n("ul",sc,[(e(!0),n(c,null,g(t.media,(t,o)=>(e(),n("li",{key:o},s(i.$store.localize(t.label)),1))),128))])):o("",!0),i.$store.manifest.items[t.page-1].metadata?(e(),r(f,{key:1,class:"tify-info-section -metadata",metadata:i.$store.manifest.items[t.page-1].metadata},null,8,["metadata"])):o("",!0)]))),128))])])):o("",!0),m.homepages.length?(e(),n("div",oc,[t("h3",null,s(i.$translate("Related Resources")),1),t("ul",ic,[(e(!0),n(c,null,g(m.homepages,(t,o)=>(e(),n("li",{key:o},[typeof t=="string"?(e(),n("a",{key:0,href:t},s(t),9,ac)):(e(),n("a",{key:1,href:t.id},s(t.label?i.$store.localize(t.label):t.id),9,rc))]))),128))])])):o("",!0),m.manifestOrCollection.requiredStatement?(e(),n("div",cc,[t("h3",null,s(i.$store.localize(m.manifestOrCollection.requiredStatement.label)),1),t("div",{innerHTML:m.filterHtml(i.$store.localize(m.manifestOrCollection.requiredStatement.value))},null,8,lc)])):o("",!0),m.manifestOrCollection.rights?(e(),n("div",dc,[t("h3",null,s(i.$translate("License")),1),t("p",null,[t("a",{href:m.manifestOrCollection.rights},s(m.manifestOrCollection.rights),9,uc)])])):o("",!0),m.hasProvider?(e(),n("div",hc,[t("h3",null,s(i.$translate("Provided by")),1),(e(!0),n(c,null,g(m.manifestOrCollection.provider,a=>{var r;return e(),n("div",{key:a.id},[a.label?(e(),n("p",mc,s(i.$store.localize(a.label)),1)):o("",!0),(r=a.homepage)!=null&&r.length?(e(),n("ul",fc,[(e(!0),n(c,null,g(a.homepage,o=>(e(),n("li",{key:o.id},[t("a",{href:o.id},s(o.label?i.$store.localize(o.label):o.id),9,pc)]))),128))])):o("",!0)])}),128))])):o("",!0),m.logos.length?(e(),n("div",gc,[(e(!0),n(c,null,g(m.logos,(s,o)=>(e(),n("p",{key:o},[s.link?(e(),n("a",{key:0,href:s.link},[t("img",{class:"tify-info-logo",src:s.id,alt:i.$translate("Logo")},null,8,bc)],8,vc)):(e(),n("img",{key:1,class:"tify-info-logo",src:s.id,alt:i.$translate("Logo")},null,8,jc))]))),128))])):o("",!0)])}to=i(Vr,[["render",W2]]),wc={name:"TocList",props:{level:{type:Number,default:0},structures:{type:Array,default:()=>[]},purpose:{type:String,default:""}},data(){var e;return{expandedStructures:this.level===0&&this.structures.length===1&&(e=this.structures[0].items)!=null&&e.some(e=>e.items)?[!0]:[]}},computed:{id(){return this.$getId(At())}},methods:{getFirstPage(e){if(e.items)return this.getFirstPage(e.items[0]);const t=this.$store.manifest.items.findIndex(t=>t.id===e.id);return t<0?1:t+1},getFirstPageLabel(e){var t;const n=this.getFirstPage(e);return this.$store.localize((t=this.$store.manifest.items[n-1])==null?0[0]:t.label)},getLastPage(e){if(e.items)return this.getLastPage(e.items.at(-1));const t=this.$store.manifest.items.findLastIndex(t=>t.id===e.id);return t<0?this.$store.manifest.items.length:t+1},isCurrentPageInStructure(e){if(this.$store.manifest.items.filter((e,t)=>this.$store.options.pages.includes(t+1)).map(e=>e.id).some(t=>{var n;return(n=e.items)==null?0[0]:n.some(e=>e.id===t)}))return!0;const t=e.firstPage||this.getFirstPage(e),n=e.lastPage||this.getLastPage(e);return this.$store.options.pages.some(e=>e>=t&&e<=n)},setPage(e){this.$store.setPage(e),this.$store.isContainerWidthAtLeast("medium")||this.$store.updateOptions({view:null})},toggleAllChildren(e=null){if(this.$refs.children){for(let t=this.structures.length-1;t>=0;t-=1)this.toggleChildren(t,e);this.$refs.children.forEach(t=>{t.toggleAllChildren(e)})}},toggleChildren(e,t=null){var n;(n=this.structures[e].items)!=null&&n.some(e=>e.items)&&(this.expandedStructures[e]=t!==null?t:!this.expandedStructures[e])}}},Oc={class:"tify-toc-list"},xc=["aria-controls","aria-expanded","aria-label","title","onClick"],Cc=["href"],Ec=["onClick"],kc={class:"tify-toc-label"},Ac={class:"tify-toc-page"},Sc=["onClick"],Mc={class:"tify-toc-label"};function B2(i,a,l,d,u,h){const m=Wt,f=Ut,p=wi("TocList",!0);return e(),n("ul",Oc,[(e(!0),n(c,null,g(l.structures,(a,c)=>{var d,g;return e(),n("li",{key:c,class:j(["tify-toc-structure",{"-current":h.isCurrentPageInStructure(a),"-expanded":u.expandedStructures[c]}])},[(d=a.items)!=null&&d.some(e=>e.items)?(e(),n("button",{key:0,type:"button",class:"tify-toc-toggle","aria-controls":`${h.id}-${c}`,"aria-expanded":!!u.expandedStructures[c],"aria-label":i.$translate(u.expandedStructures[c]?"Collapse":"Expand"),title:i.$translate(u.expandedStructures[c]?"Collapse":"Expand"),onClick:e=>h.toggleChildren(c)},[u.expandedStructures[c]?(e(),r(m,{key:0})):(e(),r(f,{key:1}))],8,xc)):o("",!0),l.purpose==="pdf"&&a.pageCount?(e(),n("a",{key:1,class:"tify-toc-link",href:a.rendering[0].id,download:""},s(i.$store.localize(a.label))+" ("+s(a.pageCount)+"\xA0"+s(i.$translate(a.pageCount===1?"page":"pages"))+") ",9,Cc)):a.label&&i.$store.localize(a.label)!==h.getFirstPageLabel(a)?(e(),n("a",{key:2,class:"tify-toc-link -dots",href:"javascript:;",onClick:e=>h.setPage(a.firstPage||h.getFirstPage(a))},[t("span",kc,s(i.$store.localize(a.label)),1),t("span",Ac,s(h.getFirstPageLabel(a)||"—"),1)],8,Ec)):(e(),n("a",{key:3,class:"tify-toc-link",href:"javascript:;",onClick:e=>h.setPage(a.firstPage||h.getFirstPage(a))},[t("span",Mc,s(i.$store.localize(a.label,"string")||h.getFirstPageLabel(a)||i.$translate("$n/a")),1)],8,Sc)),(g=a.items)!=null&&g.some(e=>e.items)?A((e(),r(p,{key:4,id:`${h.id}-${c}`,ref_for:!0,ref:"children",level:l.level+1,purpose:l.purpose,structures:a.items},null,8,["id","level","purpose","structures"])),[[L,u.expandedStructures[c]]]):o("",!0)],2)}),128))])}bn=i(wc,[["render",B2]]),zc={},Dc={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function I2(s,o){return e(),n("svg",Dc,o[0]||(o[0]=[t("path",{d:"M18,9H16V7H18M18,13H16V11H18M18,17H16V15H18M8,9H6V7H8M8,13H6V11H8M8,17H6V15H8M18,3V5H16V3H8V5H6V3H4V21H6V19H8V21H16V19H18V21H20V3H18Z"},null,-1)]))}Lc=i(zc,[["render",I2]]),Rc={},Pc={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function H2(s,o){return e(),n("svg",Pc,o[0]||(o[0]=[t("path",{d:"M22 12L20 13L19 14L18 13L17 16L16 13L15 21L14 13L13 15L12 13L11 17L10 13L9 22L8 13L7 19L6 13L5 14L4 13L2 12L4 11L5 10L6 11L7 5L8 11L9 2L10 11L11 7L12 11L13 9L14 11L15 3L16 11L17 8L18 11L19 10L20 11L22 12Z"},null,-1)]))}Ic=i(Rc,[["render",H2]]),Bc={data(){return{otherItems:[],perElementPdfLinksVisible:!1}},computed:{hasElementPdfLinks(){var e,t;return!!((t=(e=this.$store.manifest.structures)==null?0[0]:e[0])!=null&&t.rendering)&&this.$store.manifest.structures[0].rendering.some(e=>e.format&&e.format==="application/pdf")},media(){const e=[];return this.$store.options.pages.filter(e=>e>0).forEach(t=>{var n,s;const o=(s=(n=this.$store.manifest.items[t-1].items)==null?0[0]:n[0])==null?0[0]:s.items;o==null||o.forEach((n,s)=>{var o;(((o=n.body)==null?0[0]:o.items)||[n.body]).forEach((n,o)=>{var a;const i=(a=n.format)==null?0[0]:a.split("/")[1],r={fileName:n.id.split("/").at(-1),format:i?.toUpperCase(),label:n.label,type:n.type,url:n.id,page:t,itemIndex:s,layerIndex:o};if(n.service){const e=[].concat(n.service)[0],s=["ImageService2","ImageService3"].includes(e.type||e["@type"])?"default":"native",o=e.type==="ImageService3"?"max":"full",t=e.id||e["@id"],a=t.at(-1)==="/"?"":"/";r.url=`${t}${a}full/${o}/0/${s}.${i==="jpeg"?"jpg":i}`}e.push(r)})})}),e},pages(){return this.$store.options.pages.filter(e=>e>0)},renderings(){return[].concat(this.$store.manifest.rendering||[])}}},Vc={class:"tify-export",tabindex:"0"},$c={class:"tify-sr-only"},Wc={key:0,class:"tify-export-section -links"},Uc={class:"tify-export-list"},Kc=["href"],qc={class:"tify-export-link-media"},Yc=["src"],Gc={class:"tify-export-link-text"},Xc={key:0,class:"tify-export-link-hint"},Qc={class:"tify-export-link-format"},Zc={key:1,class:"tify-export-section -renderings"},Jc={class:"tify-list"},el=["href"],tl={key:0,class:"tify-export-container"},nl=["aria-controls","aria-expanded","aria-label"],sl=["id"],ol={class:"tify-export-section -iiif"},il={class:"tify-list"},al={key:0},rl=["href"],cl=["href"],ll={key:2,class:"tify-export-section -other"},dl={class:"tify-list"},ul=["href"];function P2(i,l,d,u,h,m){var f,p,v;const b=Ic,y=Lc,_=je,w=un,O=bn;return e(),n("section",Vc,[t("h2",$c,s(i.$translate("Export [noun]")),1),i.$store.manifest?(e(),n("div",Wc,[t("h3",null,s(i.$translate("Media Files")),1),t("ul",Uc,[(e(!0),n(c,null,g(m.media,l=>(e(),n("li",{key:l.url},[t("a",{href:l.url,class:"tify-export-link",download:"",rel:"noopener noreferrer",target:"_blank"},[t("span",qc,[i.$store.getThumbnailUrl(l.page,96,l.itemIndex,l.layerIndex)?(e(),n("img",{key:0,src:i.$store.getThumbnailUrl(l.page,96,l.itemIndex,l.layerIndex),alt:""},null,8,Yc)):l.type==="Sound"?(e(),r(b,{key:1})):l.type==="Video"?(e(),r(y,{key:2})):o("",!0)]),t("span",Gc,[a(_,{number:l.page,wrap:!0},null,8,["number"]),l.label?(e(),n("span",Xc,s(i.$store.localize(l.label)),1)):o("",!0),t("span",Qc,[l.type==="Sound"?(e(),n(c,{key:0},[z(s(i.$translate("Audio"))+" \xB7 ",1)],64)):l.type==="Video"?(e(),n(c,{key:1},[z(s(i.$translate("Video"))+" \xB7 ",1)],64)):l.type==="Image"?(e(),n(c,{key:2},[z(s(i.$translate("Image"))+" \xB7 ",1)],64)):o("",!0),z(" "+s(l.format),1)])])],8,Kc)]))),128))])])):o("",!0),(f=i.$store.manifest)!=null&&f.rendering?(e(),n("div",Zc,[t("h3",null,s(i.$translate("Renderings")),1),t("ul",Jc,[(e(!0),n(c,null,g(m.renderings,o=>(e(),n("li",{key:o.id},[t("a",{href:o.id},s(i.$store.localize(o.label)),9,el)]))),128))]),m.hasElementPdfLinks?(e(),n("div",tl,[t("button",{type:"button",class:j(["tify-export-toggle",{"-close":h.perElementPdfLinksVisible}]),"aria-controls":i.$getId("export-pdf-list"),"aria-expanded":h.perElementPdfLinksVisible,"aria-label":h.perElementPdfLinksVisible?i.$translate("Close PDF list"):null,onClick:l[0]||(l[0]=e=>h.perElementPdfLinksVisible=!h.perElementPdfLinksVisible)},[h.perElementPdfLinksVisible?(e(),r(w,{key:1})):(e(),n(c,{key:0},[z(s(i.$translate("PDFs for each element")),1)],64))],10,nl),A(t("div",{id:i.$getId("export-pdf-list"),class:"tify-export-toc"},[t("h4",null,s(i.$translate("PDFs for each element")),1),a(O,{ref:"children",purpose:"pdf",level:0,structures:i.$store.structures},null,8,["structures"])],8,sl),[[L,h.perElementPdfLinksVisible]])])):o("",!0)])):o("",!0),t("div",ol,[l[1]||(l[1]=t("h3",null,"IIIF",-1)),t("ul",il,[i.$store.options.childManifestUrl?(e(),n("li",al,[t("a",{href:i.$store.options.childManifestUrl,download:"manifest.json"},s(i.$translate("IIIF manifest (current document)")),9,rl)])):o("",!0),t("li",null,[t("a",{href:i.$store.options.manifestUrl,download:"manifest.json"},s(i.$translate(i.$store.collection?"IIIF manifest (collection)":"IIIF manifest")),9,cl)])])]),(v=(p=i.$store.manifest)==null?0[0]:p.seeAlso)!=null&&v.length?(e(),n("div",ll,[t("h3",null,s(i.$translate("Other Formats")),1),t("ul",dl,[(e(!0),n(c,null,g(i.$store.manifest.seeAlso,o=>(e(),n("li",{key:o.id},[t("a",{href:o.id,download:""},s(o.label?i.$store.localize(o.label):o.id),9,ul)]))),128))])])):o("",!0)])}ml=i(Bc,[["render",P2]]);function Tt(e,t,n=120){const s=e,o=n===!0?120:n;if(!o||o<0){s.scrollTop=t;return}const i=(t-e.scrollTop)/o/.1;setTimeout(()=>{s.scrollTop+=i,s.scrollTop!==t&&Tt(s,t,o-10)},10)}function jn(e,t,n=!0){const s=t.querySelectorAll(e);if(!s.length)return;let i=s[0];const c=s[s.length-1];Array.prototype.forEach.call(s,e=>{e.dataset.level>=i.dataset.level&&(i=e)});const o=t.getBoundingClientRect(),a=i.getBoundingClientRect(),r=c.getBoundingClientRect();if(a.top<o.top){const e=a.top-o.top+t.scrollTop;Tt(t,e-50,n)}else if(r.bottom>o.bottom){const e=r.bottom-o.bottom+t.scrollTop;Tt(t,e+50,n)}}On=".tify-toc-structure.-current",vl={data(){return{isInited:!1}},computed:{isNested(){return this.$store.structures.filter(e=>{var t;return(t=e.items)==null?0[0]:t.some(e=>e.items)}).length}},watch:{"$store.options.pages":function(){this.$nextTick(()=>jn(On,this.$el))},"$store.options.view":{handler(e){e==="toc"&&this.$nextTick(this.init)},immediate:!0}},methods:{init(){this.isInited=!0,this.$nextTick(()=>jn(On,this.$el,!1))}}},bl={class:"tify-toc",tabindex:"0"},jl={class:"tify-sr-only"},yl={key:0,class:"tify-toc-header"};function R2(i,a,c,l,d,u){const h=bn;return e(),n("section",bl,[t("h2",jl,s(i.$translate("Table of Contents")),1),u.isNested?(e(),n("div",yl,[t("button",{type:"button",class:"tify-toc-toggle-all",onClick:a[0]||(a[0]=e=>i.$refs.children.toggleAllChildren(!0))},s(i.$translate("Expand all")),1),t("button",{type:"button",class:"tify-toc-toggle-all",onClick:a[1]||(a[1]=e=>i.$refs.children.toggleAllChildren(!1))},s(i.$translate("Collapse all")),1)])):o("",!0),d.isInited?(e(),r(h,{key:1,ref:"children",level:0,structures:i.$store.structures},null,8,["structures"])):o("",!0)])}wl=i(vl,[["render",R2]]),Ol={},xl={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function L2(s,o){return e(),n("svg",xl,o[0]||(o[0]=[t("path",{d:"M21,5V11.59L18,8.58L14,12.59L10,8.59L6,12.59L3,9.58V5A2,2 0 0,1 5,3H19A2,2 0 0,1 21,5M18,11.42L21,14.43V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V12.42L6,15.41L10,11.41L14,15.41"},null,-1)]))}El=i(Ol,[["render",L2]]),kl=750,Al={data(){return{itemHeight:0,itemVMargin:0,items:[{}],itemsPerRow:0,lastScrollTop:0,resizeObserver:null,resizeTimeout:null,style:{},thumbnailWidth:0,touchTimeout:null}},watch:{"$store.options.pages":function(e){this.$nextTick(()=>{const t=".tify-thumbnails-item.-current";e.length>2||e.length>1&&e[1]!==e[0]+1||(this.$refs.container.querySelector(t)?jn(t,this.$el):this.scrollToCurrentPage())})},"$store.options.view":{handler(e){e==="thumbnails"&&this.$nextTick(this.init)},immediate:!0}},mounted(){this.style.flex=this.$el.style.flex},unmounted(){var e;(e=this.resizeObserver)==null||e.disconnect(),clearTimeout(this.resizeTimeout)},methods:{init(){this.updateDimensions(),this.scrollToCurrentPage(!1),this.resizeObserver=new ResizeObserver(this.onResize),this.resizeObserver.observe(this.$el)},onResize(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>{this.$store.options.view==="thumbnails"&&this.updateDimensions()},200)},updateDimensions(){if(!this.$refs.container)return;const e=this.$refs.container.querySelector(".tify-thumbnails-item"),t=e.currentStyle||window.getComputedStyle(e),n=parseInt(t.marginTop,10)+parseFloat(t.marginBottom,10);this.itemHeight=e.offsetHeight+n,this.itemVerticalMargin=n;const s=parseInt(t.marginLeft,10)+parseFloat(t.marginRight,10),o=e.offsetWidth+s;this.thumbnailWidth=e.offsetWidth,this.itemsPerRow=Math.floor(this.$refs.container.clientWidth/o);const i=Math.ceil(this.$store.manifest.items.length/this.itemsPerRow)*this.itemHeight;this.$refs.container.style.height=`${i}px`,this.redrawThumbnails(),this.scrollToCurrentPage(!1)},redrawThumbnails(){const n=this.$el.scrollTop,e=Math.floor(n/this.itemHeight)*this.itemsPerRow+1,s=Math.ceil(this.$el.offsetHeight/this.itemHeight)*this.itemsPerRow,o=e+this.itemsPerRow+s,i=Math.min(this.$store.manifest.items.length,o),t=[];for(let n=e;n<=i;n+=1)t.push({thumbnailUrl:this.$store.getThumbnailUrl(n,this.thumbnailWidth),page:n});this.items=t,this.$nextTick(()=>{const t=Math.floor(e/this.itemsPerRow);this.$refs.container.style.paddingTop=`${t*this.itemHeight}px`})},scrollToCurrentPage(e=!0){const t=Math.floor((this.$store.options.pages[0]-1)/this.itemsPerRow)*this.itemHeight+(this.itemVMargin-50);e?Tt(this.$el,t):this.$el.scrollTop=t},setPageAndSwitchView(e,t=!1){if(t){const t=this.$store.options.pages.slice(0),n=t.indexOf(e);n<0?(t.push(e),t.sort((e,t)=>e-t),t[0]===0&&t.shift()):t.length>1&&t.splice(n,1),this.$store.updateOptions({pages:t});return}this.$store.setPage(e),this.$store.isContainerWidthAtLeast("medium")||this.$store.updateOptions({view:null})},touchStartTogglePage(e){this.lastScrollTop=this.$el.scrollTop,this.touchTimeout=setTimeout(()=>{this.$el.scrollTop===this.lastScrollTop&&this.setPageAndSwitchView(e,!0)},kl)},touchEnd(){clearTimeout(this.touchTimeout)}}},Sl={class:"tify-sr-only"},Ml={ref:"container",class:"tify-thumbnails-list"},Fl=["onClick","onTouchstart"],Tl=["src"],zl={key:1,class:"tify-thumbnails-image"},Dl={class:"tify-sr-only"};function N2(o,i,r,l,d,u){const h=El,m=je;return e(),n("section",{class:"tify-thumbnails",tabindex:"0",onScroll:i[1]||(i[1]=(...e)=>u.redrawThumbnails&&u.redrawThumbnails(...e))},[t("h2",Sl,s(o.$translate("Pages")),1),t("ol",Ml,[(e(!0),n(c,null,g(d.items,r=>(e(),n("li",{key:r.page,class:j(["tify-thumbnails-item",{"-current":o.$store.options.pages.includes(r.page)}])},[t("button",{type:"button",class:"tify-thumbnails-button",onClick:fe(e=>u.setPageAndSwitchView(r.page,e.ctrlKey),["prevent"]),onTouchstart:e=>u.touchStartTogglePage(r.page),onTouchend:i[0]||(i[0]=(...e)=>u.touchEnd&&u.touchEnd(...e))},[r.thumbnailUrl?(e(),n("img",{key:0,class:"tify-thumbnails-image",alt:"",src:r.thumbnailUrl},null,8,Tl)):(e(),n("span",zl,[a(h),t("span",Dl,s(o.$translate("Image missing")),1)])),a(m,{number:r.page||1},null,8,["number"])],40,Fl)],2))),128))],512)],32)}Ll=i(Al,[["render",N2]]),Rl={computed:{pages(){return this.$store.options.pages.filter(e=>e>0)}},watch:{"$store.options.annotationId":function(){this.scrollToCurrentAnnotation()},"$store.annotationsAvailable":function(){this.$store.options.annotationId&&this.scrollToCurrentAnnotation()}},mounted(){this.$store.options.annotationId&&this.$store.annotationsAvailable&&this.scrollToCurrentAnnotation()},methods:{filterHtml:Nt,scrollToCurrentAnnotation(){this.$nextTick(()=>{var t;const e=(t=this.$refs.currentItem)==null?0[0]:t[0];e&&e.scrollIntoView({behavior:"smooth",block:e.offsetHeight<this.$refs.panel.offsetHeight/2?"center":"start"})})}}},Pl={ref:"panel",class:"tify-text",tabindex:"0"},Hl={class:"tify-sr-only"},Il={key:0,class:"tify-text-pages"},Bl={key:0},Vl={class:"tify-text-list"},$l=["onClick","onKeydown","innerHTML"],Wl={key:1,class:"tify-text-none"};function D2(i,r,l,d,u,h){const m=je;return e(),n("section",Pl,[t("h2",Hl,s(i.$translate("Text")),1),i.$store.annotationsAvailable!==!1?(e(),n("div",Il,[(e(!0),n(c,null,g(h.pages,s=>(e(),n("div",{key:s,class:"tify-text-page"},[i.$store.pageCount>1?(e(),n("h3",Bl,[a(m,{number:s},null,8,["number"])])):o("",!0),t("ul",Vl,[(e(!0),n(c,null,g(i.$store.annotations[s],(o,a)=>(e(),n("li",{key:`${s}-${a}`,ref_for:!0,ref:i.$store.options.annotationId===o.id?"currentItem":"",class:j(["tify-text-item",{"-current":i.$store.options.annotationId===o.id}])},[t("div",{role:"button",tabindex:"0",class:"tify-text-toggle",onClick:e=>i.$store.toggleAnnotationId(o.id),onKeydown:de(e=>i.$store.toggleAnnotationId(o.id),["enter","space"]),innerHTML:h.filterHtml(o.html)},null,40,$l)],2))),128))])]))),128))])):(e(),n("p",Wl,s(i.$translate("Text not available for this page")),1))],512)}Kl=i(Rl,[["render",D2]]),ql={},Yl={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function z2(s,o){return e(),n("svg",Yl,o[0]||(o[0]=[t("path",{d:"M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"},null,-1)]))}Xl=i(ql,[["render",z2]]),Ql={},Zl={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function T2(s,o){return e(),n("svg",Zl,o[0]||(o[0]=[t("path",{d:"M5,9V15H9L14,20V4L9,9M18.5,12C18.5,10.23 17.5,8.71 16,7.97V16C17.5,15.29 18.5,13.76 18.5,12Z"},null,-1)]))}ed=i(Ql,[["render",T2]]),td={},nd={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function F2(s,o){return e(),n("svg",nd,o[0]||(o[0]=[t("path",{d:"M7,9V15H11L16,20V4L11,9H7Z"},null,-1)]))}od=i(td,[["render",F2]]),id={},ad={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function M2(s,o){return e(),n("svg",ad,o[0]||(o[0]=[t("path",{d:"M5.64,3.64L21.36,19.36L19.95,20.78L16,16.83V20L11,15H7V9H8.17L4.22,5.05L5.64,3.64M16,4V11.17L12.41,7.58L16,4Z"},null,-1)]))}cd=i(id,[["render",M2]]),ld={},dd={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function S2(s,o){return e(),n("svg",dd,o[0]||(o[0]=[t("path",{d:"M5,4C4.45,4 4,4.18 3.59,4.57C3.2,4.96 3,5.44 3,6V18C3,18.56 3.2,19.04 3.59,19.43C4,19.82 4.45,20 5,20H19C19.5,20 20,19.81 20.39,19.41C20.8,19 21,18.53 21,18V6C21,5.47 20.8,5 20.39,4.59C20,4.19 19.5,4 19,4H5M4.5,5.5H19.5V18.5H4.5V5.5M7,9C6.7,9 6.47,9.09 6.28,9.28C6.09,9.47 6,9.7 6,10V14C6,14.3 6.09,14.53 6.28,14.72C6.47,14.91 6.7,15 7,15H10C10.27,15 10.5,14.91 10.71,14.72C10.91,14.53 11,14.3 11,14V13H9.5V13.5H7.5V10.5H9.5V11H11V10C11,9.7 10.91,9.47 10.71,9.28C10.5,9.09 10.27,9 10,9H7M14,9C13.73,9 13.5,9.09 13.29,9.28C13.09,9.47 13,9.7 13,10V14C13,14.3 13.09,14.53 13.29,14.72C13.5,14.91 13.73,15 14,15H17C17.3,15 17.53,14.91 17.72,14.72C17.91,14.53 18,14.3 18,14V13H16.5V13.5H14.5V10.5H16.5V11H18V10C18,9.7 17.91,9.47 17.72,9.28C17.53,9.09 17.3,9 17,9H14Z"},null,-1)]))}hd=i(ld,[["render",S2]]),md={},fd={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function A2(s,o){return e(),n("svg",fd,o[0]||(o[0]=[t("path",{d:"M18,11H16.5V10.5H14.5V13.5H16.5V13H18V14A1,1 0 0,1 17,15H14A1,1 0 0,1 13,14V10A1,1 0 0,1 14,9H17A1,1 0 0,1 18,10M11,11H9.5V10.5H7.5V13.5H9.5V13H11V14A1,1 0 0,1 10,15H7A1,1 0 0,1 6,14V10A1,1 0 0,1 7,9H10A1,1 0 0,1 11,10M19,4H5C3.89,4 3,4.89 3,6V18A2,2 0 0,0 5,20H19A2,2 0 0,0 21,18V6C21,4.89 20.1,4 19,4Z"},null,-1)]))}gd=i(md,[["render",A2]]);function kt(e){return!!$a()&&(C2(e),!0)}function bd(){const e=new Set,t=t=>{e.delete(t)};return{on:n=>{e.add(n);const s=()=>t(n);return kt(s),{off:s}},off:t,trigger:(...t)=>Promise.all(Array.from(e).map(e=>e(...t))),clear:()=>{e.clear()}}}_t=typeof window<"u"&&typeof document<"u",typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope,yd=Object.prototype.toString,Fn=e=>yd.call(e)==="[object Object]",ue=()=>{},Od=w2();function w2(){var e,t;return _t&&((e=window?.navigator)==null?0[0]:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window?.navigator)==null?0[0]:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window?.navigator.userAgent))}function _2(...e){if(e.length!==1)return G2(...e);const t=e[0];return typeof t=="function"?Sn(q2(()=>({get:t,set:ue}))):Je(t)}function y2(e,t){function n(...n){return new Promise((s,o)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(s).catch(o)})}return n}kd=e=>e();function zn(e){return Array.isArray(e)?e:[e]}function b2(){return Le()}function v2(e,t=!0,n){b2()?pt(e,n):t?e():ln(e)}function Fd(e,t,n={}){const{eventFilter:c=kd,...s}=n,r=y2(c,t);let o,i,a;if(s.flush==="sync"){let t=!1;i=()=>{},o=e=>{t=!0,e(),t=!1},a=$(e,(...e)=>{t||r(...e)},s)}else{const c=[];let n=0,t=0;i=()=>{n=t},c.push($(e,()=>{t++},{...s,flush:"sync"})),o=e=>{const s=t;e(),n+=t-s},c.push($(e,(...e)=>{const s=n>0&&n===t;n=0,t=0,!s&&r(...e)},s)),a=()=>{c.forEach(e=>e())}}return{stop:a,ignoreUpdates:o,ignorePrevAsyncUpdates:i}}function g2(e,t,n){return $(e,t,{...n,immediate:!0})}Dn=_t?window:0[0],Hn=_t?window.document:0[0];function we(e){var n;const t=b(e);return(n=t?.$el)!=null?n:t}function v(...e){const n=[],s=()=>{n.forEach(e=>e()),n.length=0},o=(e,t,n,s)=>(e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)),t=_(()=>{const t=zn(b(e[0])).filter(e=>e!=null);return t.every(e=>typeof e!="string")?t:0[0]}),i=g2(()=>{var n,s;return[(s=(n=t.value)==null?0[0]:n.map(e=>we(e)))!=null?s:[Dn].filter(e=>e!=null),zn(b(t.value?e[1]:e[0])),zn(_n(t.value?e[2]:e[1])),b(t.value?e[3]:e[2])]},([e,t,i,a])=>{if(s(),e==null||!e.length||t==null||!t.length||i==null||!i.length)return;const r=Fn(a)?{...a}:a;n.push(...e.flatMap(e=>t.flatMap(t=>i.map(n=>o(e,t,n,r)))))},{flush:"post"}),a=()=>{i(),s()};return kt(s),a}Wn=!1;function Pd(e,t,n={}){const{window:s=Dn,ignore:f=[],capture:m=!0,detectIframe:d=!1,controls:r=!1}=n;if(!s)return r?{stop:ue,cancel:ue,trigger:ue}:ue;if(Od&&!Wn){Wn=!0;const e={passive:!0};Array.from(s.document.body.children).forEach(t=>t.addEventListener("click",ue,e)),s.document.documentElement.addEventListener("click",ue,e)}let o=!0;const c=e=>b(f).some(t=>{if(typeof t=="string")return Array.from(s.document.querySelectorAll(t)).some(t=>t===e.target||e.composedPath().includes(t));{const n=we(t);return n&&(e.target===n||e.composedPath().includes(n))}});function u(e){const t=b(e);return t&&t.$.subTree.shapeFlag===16}function h(e,t){const s=b(e),n=s.$.subTree&&s.$.subTree.children;return n!=null&&!!Array.isArray(n)&&n.some(e=>e.el===t.target||t.composedPath().includes(e.el))}const a=n=>{const s=we(e);if(n.target!=null&&!(!(s instanceof Element)&&u(e)&&h(e,n))&&!(!s||s===n.target||n.composedPath().includes(s))){if("detail"in n&&n.detail===0&&(o=!c(n)),!o){o=!0;return}t(n)}};let i=!1;const p=[v(s,"click",e=>{i||(i=!0,setTimeout(()=>{i=!1},0),a(e))},{passive:!0,capture:m}),v(s,"pointerdown",t=>{const n=we(e);o=!c(t)&&!!(n&&!t.composedPath().includes(n))},{passive:!0}),d&&v(s,"blur",n=>{setTimeout(()=>{var o;const i=we(e);((o=s.document.activeElement)==null?0[0]:o.tagName)==="IFRAME"&&!(i!=null&&i.contains(s.document.activeElement))&&t(n)},0)},{passive:!0})].filter(Boolean),l=()=>p.forEach(e=>e());return r?{stop:l,cancel:()=>{o=!1},trigger:e=>{o=!0,a(e),o=!1}}:l}function m2(){const e=F(!1),t=Le();return t&&pt(()=>{e.value=!0},t),e}function h2(e){const t=m2();return _(()=>(t.value,!!e()))}Xn=["fullscreenchange","webkitfullscreenchange","webkitendfullscreen","mozfullscreenchange","MSFullscreenChange"];function d2(e,t={}){const{document:n=Hn,autoExit:g=!1}=t,s=_(()=>{var t;return(t=we(e))!=null?t:n?.documentElement}),o=F(!1),c=_(()=>["requestFullscreen","webkitRequestFullscreen","webkitEnterFullscreen","webkitEnterFullScreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"].find(e=>n&&e in n||s.value&&e in s.value)),i=_(()=>["exitFullscreen","webkitExitFullscreen","webkitExitFullScreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"].find(e=>n&&e in n||s.value&&e in s.value)),a=_(()=>["fullScreen","webkitIsFullScreen","webkitDisplayingFullscreen","mozFullScreen","msFullscreenElement"].find(e=>n&&e in n||s.value&&e in s.value)),u=["fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement"].find(e=>n&&e in n),l=h2(()=>s.value&&n&&c.value!==0[0]&&i.value!==0[0]&&a.value!==0[0]),p=()=>!!u&&n?.[u]===s.value,h=()=>{if(a.value){if(n&&n[a.value]!=null)return n[a.value];{const e=s.value;if(e?.[a.value]!=null)return!!e[a.value]}}return!1};async function r(){if(!!l.value&&!!o.value){if(i.value)if(n?.[i.value]!=null)await n[i.value]();else{const e=s.value;e?.[i.value]!=null&&await e[i.value]()}o.value=!1}}async function m(){if(!l.value||o.value)return;h()&&await r();const e=s.value;c.value&&e?.[c.value]!=null&&(await e[c.value](),o.value=!0)}async function b(){await(o.value?r():m())}const d=()=>{const e=h();(!e||e&&p())&&(o.value=e)},f={capture:!1,passive:!0};return v(n,Xn,d,f),v(()=>we(s),Xn,d,f),v2(d,!1),g&&kt(r),{isSupported:l,isFullscreen:o,enter:m,exit:r,toggle:b}}function Qn(e,t){b(e)&&t(b(e))}function l2(e){let t=[];for(let n=0;n<e.length;++n)t=[...t,[e.start(n),e.end(n)]];return t}function Zn(e){return Array.from(e).map(({label:e,kind:t,language:n,mode:s,activeCues:o,cues:i,inBandMetadataTrackDispatchType:a},r)=>({id:r,label:e,kind:t,language:n,mode:s,activeCues:o,cues:i,inBandMetadataTrackDispatchType:a}))}no={src:"",tracks:[]};function c2(e,t={}){e=_2(e),t={...no,...t};const{document:s=Hn}=t,n={passive:!0},f=F(0),x=F(0),g=F(!1),r=F(1),c=F(!1),p=F(!1),o=F(!1),u=F(1),w=F(!1),C=Je([]),i=Je([]),m=F(-1),a=F(!1),h=F(!1),y=s&&"pictureInPictureEnabled"in s,_=bd(),j=bd(),O=t=>{Qn(e,e=>{if(t){const n=typeof t=="number"?t:t.id;e.textTracks[n].mode="disabled"}else for(let t=0;t<e.textTracks.length;++t)e.textTracks[t].mode="disabled";m.value=-1})},E=(t,n=!0)=>{Qn(e,e=>{const s=typeof t=="number"?t:t.id;n&&O(),e.textTracks[s].mode="showing",m.value=s})},k=()=>new Promise((t,n)=>{Qn(e,async e=>{y&&(a.value?s.exitPictureInPicture().then(t).catch(n):e.requestPictureInPicture().then(t).catch(n))})});so(()=>{if(!s)return;const i=b(e);if(!i)return;const o=b(t.src);let a=[];o&&(typeof o=="string"?a=[{src:o}]:Array.isArray(o)?a=o:Fn(o)&&(a=[o]),i.querySelectorAll("source").forEach(e=>{e.remove()}),a.forEach(({src:e,type:t,media:o})=>{const a=s.createElement("source");a.setAttribute("src",e),a.setAttribute("type",t||""),a.setAttribute("media",o||""),v(a,"error",_.trigger,n),i.appendChild(a)}),i.load())}),$([e,r],()=>{const t=b(e);t&&(t.volume=r.value)}),$([e,h],()=>{const t=b(e);t&&(t.muted=h.value)}),$([e,u],()=>{const t=b(e);t&&(t.playbackRate=u.value)}),so(()=>{if(!s)return;const n=b(t.tracks),o=b(e);!n||!n.length||!o||(o.querySelectorAll("track").forEach(e=>e.remove()),n.forEach(({default:e,kind:t,label:n,src:i,srcLang:a},r)=>{const c=s.createElement("track");c.default=e||!1,c.kind=t,c.label=n,c.src=i,c.srclang=a,c.default&&(m.value=r),o.appendChild(c)}))});const{ignoreUpdates:A}=Fd(f,t=>{const n=b(e);n&&(n.currentTime=t)}),{ignoreUpdates:d}=Fd(o,t=>{const n=b(e);n&&(t?n.play().catch(e=>{throw j.trigger(e),e}):n.pause())});v(e,"timeupdate",()=>A(()=>f.value=b(e).currentTime),n),v(e,"durationchange",()=>x.value=b(e).duration,n),v(e,"progress",()=>C.value=l2(b(e).buffered),n),v(e,"seeking",()=>g.value=!0,n),v(e,"seeked",()=>g.value=!1,n),v(e,["waiting","loadstart"],()=>{c.value=!0,d(()=>o.value=!1)},n),v(e,"loadeddata",()=>c.value=!1,n),v(e,"playing",()=>{c.value=!1,p.value=!1,d(()=>o.value=!0)},n),v(e,"ratechange",()=>u.value=b(e).playbackRate,n),v(e,"stalled",()=>w.value=!0,n),v(e,"ended",()=>p.value=!0,n),v(e,"pause",()=>d(()=>o.value=!1),n),v(e,"play",()=>d(()=>o.value=!0),n),v(e,"enterpictureinpicture",()=>a.value=!0,n),v(e,"leavepictureinpicture",()=>a.value=!1,n),v(e,"volumechange",()=>{const t=b(e);t&&(r.value=t.volume,h.value=t.muted)},n);const l=[],S=$([e],()=>{const t=b(e);t&&(S(),l[0]=v(t.textTracks,"addtrack",()=>i.value=Zn(t.textTracks),n),l[1]=v(t.textTracks,"removetrack",()=>i.value=Zn(t.textTracks),n),l[2]=v(t.textTracks,"change",()=>i.value=Zn(t.textTracks),n))});return kt(()=>l.forEach(e=>e())),{currentTime:f,duration:x,waiting:c,seeking:g,ended:p,stalled:w,buffered:C,playing:o,rate:u,volume:r,muted:h,tracks:i,selectedTrack:m,enableTrack:E,disableTrack:O,supportsPictureInPicture:y,togglePictureInPicture:k,isPictureInPicture:a,onSourceError:_.on,onPlaybackError:j.on}}function Jn(e){return!!(e.altKey||e.ctrlKey||e.metaKey||["INPUT","SELECT","TEXTAREA"].includes(e.target.nodeName)&&e.target.type!=="range")}Gd={props:{label:{default:null,type:String},position:{default:"bottom",type:String},shortcut:{default:null,type:String}},emits:["open"],data(){return{open:!1}},computed:{id(){return this.$.appContext.config.globalProperties.$getId?this.$getId(At()):At()}},mounted(){var e;(((e=this.$store)==null?0[0]:e.rootElement)||document.documentElement).addEventListener("keydown",this.onKeydown),Pd(this.$el,()=>{this.open=!1})},beforeUnmount(){var e;(((e=this.$store)==null?0[0]:e.rootElement)||document.documentElement).removeEventListener("keydown",this.onKeydown)},methods:{onKeydown(e){if(!Jn(e)){if(e.key==="Escape"){this.open=!1;return}e.key===this.shortcut&&(this.open=!this.open,this.open&&this.$emit("open"),e.preventDefault())}}}},Xd={class:"tify-dropdown"},Qd=["aria-controls","aria-expanded","aria-label","title"],Zd=["id"];function r2(s,o,i,a,r,c){return e(),n("div",Xd,[t("button",{type:"button",class:"tify-dropdown-button","aria-controls":c.id,"aria-expanded":r.open,"aria-label":i.label,title:i.label,onClick:o[0]||(o[0]=e=>{r.open=!r.open,r.open&&s.$emit("open")})},[fi(s.$slots,"button")],8,Qd),A(t("div",{id:c.id,class:j(`tify-dropdown-content -${i.position}`),onClick:o[1]||(o[1]=e=>e.target.closest("a, button")&&(r.open=!1))},[fi(s.$slots,"default")],10,Zd),[[L,r.open]])])}Ft=i(Gd,[["render",r2]]),tu={},nu={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function a2(s,o){return e(),n("svg",nu,o[0]||(o[0]=[t("path",{d:"M13,2.05V4.05C17.39,4.59 20.5,8.58 19.96,12.97C19.5,16.61 16.64,19.5 13,19.93V21.93C18.5,21.38 22.5,16.5 21.95,11C21.5,6.25 17.73,2.5 13,2.03V2.05M5.67,19.74C7.18,21 9.04,21.79 11,22V20C9.58,19.82 8.23,19.25 7.1,18.37L5.67,19.74M7.1,5.74C8.22,4.84 9.57,4.26 11,4.06V2.06C9.05,2.25 7.19,3 5.67,4.26L7.1,5.74M5.69,7.1L4.26,5.67C3,7.19 2.25,9.04 2.05,11H4.05C4.24,9.58 4.8,8.23 5.69,7.1M4.06,13H2.06C2.26,14.96 3.03,16.81 4.27,18.33L5.69,16.9C4.81,15.77 4.24,14.42 4.06,13M10,16.5L16,12L10,7.5V16.5Z"},null,-1)]))}ou=i(tu,[["render",a2]]),iu={},au={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function i2(s,o){return e(),n("svg",au,o[0]||(o[0]=[t("path",{d:"M14,19H18V5H14M6,19H10V5H6V19Z"},null,-1)]))}cu=i(iu,[["render",i2]]),lu={},du={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function o2(s,o){return e(),n("svg",du,o[0]||(o[0]=[t("path",{d:"M8,5.14V19.14L19,12.14L8,5.14Z"},null,-1)]))}hu=i(lu,[["render",o2]]),mu={},fu={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function s2(s,o){return e(),n("svg",fu,o[0]||(o[0]=[t("path",{d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"},null,-1)]))}gu=i(mu,[["render",s2]]),vu={props:{src:{required:!0,type:String},format:{required:!0,type:String},hasImage:{type:Boolean,default:!1}},data(){return{currentSubtitle:null,media:c2(x3("av")),mouseInterval:null,mouseMoving:!0,rates:[.5,.75,1,1.25,1.5,2]}},computed:{type(){var e;return(e=this.format)==null?0[0]:e.split("/")[0]},subtitles(){var t,n;const e=(n=(t=this.$store.manifest.items[this.$store.options.pages[0]-1].annotations)==null?0[0]:t[0].items)==null?0[0]:n[0].body;return e?e.items||[e]:[]}},watch:{currentSubtitle(e){Object.values(this.$refs.av.textTracks).forEach(t=>{t.mode=t.language===e?.language?"showing":"disabled"})}},beforeUnmount(){clearInterval(this.mouseInterval)},mounted(){window.addEventListener("mousemove",this.onMouseMove)},unmounted(){window.removeEventListener("mousemove",this.onMouseMove)},methods:{formatTime(e){const t=Math.floor(e/3600),n=Math.floor(e%3600/60),s=Math.floor(e%60);return[...this.media.duration>3600?[t.toString().padStart(2,"0")]:[],n.toString().padStart(2,"0"),s.toString().padStart(2,"0")].join(":")},onMouseMove(){clearTimeout(this.mouseInterval),this.mouseMoving=!0,this.mouseInterval=setInterval(()=>{this.mouseMoving=this.$store.options.view||this.media.paused},2e3)}}},bu=["src","type"],ju=["srclang","src"],yu={class:"tify-player-controls"},_u=["aria-label"],wu=["max","aria-label"],Ou={class:"tify-player-time"},xu={class:"tify-player-elapsed"},Cu={class:"tify-player-duration"},Eu={class:"tify-sr-only"},ku={key:0,class:"tify-player-select-badge"},Au={class:"tify-player-select-title"},Su={class:"tify-button-list"},Mu=["aria-pressed","onClick"],Fu={class:"tify-sr-only"},Tu={class:"tify-player-select-title"},zu={class:"tify-button-list"},Du=["aria-pressed","onClick"],Nu=["aria-pressed"],Lu=["aria-label","disabled"],Ru=["aria-label"];function n2(i,l,d,u,h,m){const v=gu,f=hu,b=cu,y=ou,p=Ft,_=gd,w=hd,O=cd,x=od,C=ed,E=Xl;return e(),n("div",{class:j(["tify-player",`
			-${m.type}
			${h.mouseMoving||h.media.paused?"-mousing":""}
			${h.media.playing||h.media.waiting?"-playing":""}
			${d.hasImage&&(m.type==="audio"||!h.media.currentTime)?"-bottom":""}
		`]),onKeydown:l[7]||(l[7]=de(fe(e=>h.media.playing=!h.media.playing,["prevent"]),["space"]))},[(e(),r(z3(m.type),{ref:"av",class:"tify-player-av",poster:i.$store.getThumbnailUrl(i.$store.options.pages[0],0),preload:"metadata",crossorigin:"anonymous",onClick:l[0]||(l[0]=e=>{h.media.playing=!h.media.playing,m.onMouseMove()})},{default:I(()=>[t("source",{src:d.src,type:d.format},null,8,bu),(e(!0),n(c,null,g(m.subtitles,t=>(e(),n("track",{key:t.id,kind:"captions",srclang:t.language,src:t.id},null,8,ju))),128))]),_:1},8,["poster"])),m.type==="video"?(e(),n("div",{key:0,class:j(["tify-player-overlay",{"-hidden":h.media.playing||d.hasImage&&!h.media.currentTime}])},[h.media.waiting?(e(),r(v,{key:0,class:"-spin"})):h.media.currentTime?o("",!0):(e(),r(f,{key:1}))],2)):o("",!0),t("div",yu,[t("div",null,[t("button",{type:"button",class:"tify-player-play-pause","aria-label":i.$translate(h.media.paused?"Play [verb]":"Pause [verb]"),onClick:l[1]||(l[1]=e=>h.media.playing=!h.media.playing)},[h.media.playing||h.media.seeking&&h.media.waiting?(e(),r(b,{key:0})):(e(),r(f,{key:1}))],8,_u),A(t("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>h.media.currentTime=e),type:"range",class:"tify-player-seekbar",min:"0",max:h.media.duration,step:"any","aria-label":i.$translate("Current time"),style:pe(`--value: ${h.media.currentTime/h.media.duration*100}%`)},null,12,wu),[[tt,h.media.currentTime,0[0],{number:!0}]]),t("span",Ou,[t("span",xu,s(m.formatTime(h.media.currentTime)),1),t("span",Cu," / "+s(m.formatTime(h.media.duration)),1)]),a(p,{class:"tify-player-select -rate",alignment:"center",position:"top",shortcut:"r"},{button:I(()=>[t("span",Eu,s(i.$translate("Playback rate")),1),a(y),h.media.rate!==1?(e(),n("span",ku,s(h.media.rate.toLocaleString(i.$store.options.language))+"x ",1)):o("",!0)]),default:I(()=>[t("h3",Au,s(i.$translate("Playback rate")),1),t("ol",Su,[(e(!0),n(c,null,g(h.rates,o=>(e(),n("li",{key:o},[t("button",{type:"button","aria-pressed":o===h.media.rate,onClick:e=>h.media.rate=o},s(o===1?i.$translate("Normal"):`${o.toLocaleString(i.$store.options.language)}x`),9,Mu)]))),128))])]),_:1}),m.subtitles.length?(e(),r(p,{key:0,class:"tify-player-select -captions",alignment:"center",position:"top",shortcut:"c"},{button:I(()=>[t("span",Fu,s(i.$translate("Closed Captions")),1),h.currentSubtitle?(e(),r(_,{key:0})):(e(),r(w,{key:1}))]),default:I(()=>[t("h3",Tu,s(i.$translate("Closed Captions")),1),t("ol",zu,[(e(!0),n(c,null,g(m.subtitles,o=>(e(),n("li",{key:o.id},[t("button",{type:"button","aria-pressed":o===h.currentSubtitle,onClick:e=>h.currentSubtitle=o},s(i.$store.localize(o.label)||o.language),9,Du)]))),128)),t("li",null,[t("button",{type:"button","aria-pressed":!h.currentSubtitle,onClick:l[3]||(l[3]=e=>h.currentSubtitle=null)},s(i.$translate("None")),9,Nu)])])]),_:1})):o("",!0)]),t("div",null,[t("button",{type:"button",class:"tify-player-mute","aria-label":i.$translate("Toggle mute"),disabled:h.media.volume===0,onClick:l[4]||(l[4]=e=>h.media.muted=!h.media.muted)},[h.media.muted?(e(),r(O,{key:0})):h.media.volume<.34?(e(),r(x,{key:1})):h.media.volume<.67?(e(),r(C,{key:2})):(e(),r(E,{key:3}))],8,Lu),A(t("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>h.media.volume=e),type:"range",class:"tify-player-volume",min:"0",max:"1",step:"0.01","aria-label":i.$translate("Volume"),style:pe(`--value: ${h.media.volume*100}%`),onInput:l[6]||(l[6]=e=>h.media.muted=h.media.volume===0)},null,44,Ru),[[tt,h.media.volume,0[0],{number:!0}]])])])],34)}Hu=i(vu,[["render",n2]]),Iu={},Bu={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function t2(s,o){return e(),n("svg",Bu,o[0]||(o[0]=[t("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},null,-1)]))}ns=i(Iu,[["render",t2]]),Wu={},Uu={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function J0(s,o){return e(),n("svg",Uu,o[0]||(o[0]=[t("path",{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"},null,-1)]))}is=i(Wu,[["render",J0]]),Yu={},Gu={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function Z0(s,o){return e(),n("svg",Gu,o[0]||(o[0]=[t("path",{d:"M12,18.54L19.37,12.8L21,14.07L12,21.07L3,14.07L4.62,12.81L12,18.54M12,16L3,9L12,2L21,9L12,16M12,4.53L6.26,9L12,13.47L17.74,9L12,4.53Z"},null,-1)]))}Qu=i(Yu,[["render",Z0]]),Zu={},Ju={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function Q0(s,o){return e(),n("svg",Ju,o[0]||(o[0]=[t("path",{d:"M7.2 4L5.2 2H20C21.11 2 22 2.9 22 4V16C22 16.76 21.57 17.41 20.95 17.75L19.2 16H20V4H7.2M22.11 21.46L20.84 22.73L16.11 18H13.9L10.2 21.71C10 21.9 9.75 22 9.5 22H9C8.45 22 8 21.55 8 21V18H4C2.9 18 2 17.11 2 16V4C2 3.97 2 3.93 2 3.9L1.11 3L2.39 1.73L22.11 21.46M14.11 16L4 5.89V16H10V19.08L13.08 16H14.11Z"},null,-1)]))}t1=i(Zu,[["render",Q0]]),n1={},s1={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function X0(s,o){return e(),n("svg",s1,o[0]||(o[0]=[t("path",{d:"M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22V22H9M10,16V19.08L13.08,16H20V4H4V16H10M6,7H18V9H6V7M6,11H15V13H6V11Z"},null,-1)]))}i1=i(n1,[["render",X0]]),a1={},r1={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function G0(s,o){return e(),n("svg",r1,o[0]||(o[0]=[t("path",{d:"M12,3A9,9 0 0,0 3,12H0L4,16L8,12H5A7,7 0 0,1 12,5A7,7 0 0,1 19,12A7,7 0 0,1 12,19C10.5,19 9.09,18.5 7.94,17.7L6.5,19.14C8.04,20.3 9.94,21 12,21A9,9 0 0,0 21,12A9,9 0 0,0 12,3M14,12A2,2 0 0,0 12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12Z"},null,-1)]))}l1=i(a1,[["render",G0]]),d1={},u1={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function Y0(s,o){return e(),n("svg",u1,o[0]||(o[0]=[t("path",{d:"M12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2C17.5,2 22,6 22,11A6,6 0 0,1 16,17H14.2C13.9,17 13.7,17.2 13.7,17.5C13.7,17.6 13.8,17.7 13.8,17.8C14.2,18.3 14.4,18.9 14.4,19.5C14.5,20.9 13.4,22 12,22M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C12.3,20 12.5,19.8 12.5,19.5C12.5,19.3 12.4,19.2 12.4,19.1C12,18.6 11.8,18.1 11.8,17.5C11.8,16.1 12.9,15 14.3,15H16A4,4 0 0,0 20,11C20,7.1 16.4,4 12,4M6.5,10C7.3,10 8,10.7 8,11.5C8,12.3 7.3,13 6.5,13C5.7,13 5,12.3 5,11.5C5,10.7 5.7,10 6.5,10M9.5,6C10.3,6 11,6.7 11,7.5C11,8.3 10.3,9 9.5,9C8.7,9 8,8.3 8,7.5C8,6.7 8.7,6 9.5,6M14.5,6C15.3,6 16,6.7 16,7.5C16,8.3 15.3,9 14.5,9C13.7,9 13,8.3 13,7.5C13,6.7 13.7,6 14.5,6M17.5,10C18.3,10 19,10.7 19,11.5C19,12.3 18.3,13 17.5,13C16.7,13 16,12.3 16,11.5C16,10.7 16.7,10 17.5,10Z"},null,-1)]))}m1=i(d1,[["render",Y0]]),f1={},p1={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function q0(s,o){return e(),n("svg",p1,o[0]||(o[0]=[t("path",{d:"M12 2A10 10 0 0 0 2 12A10 10 0 0 0 12 22A10 10 0 0 0 22 12A10 10 0 0 0 12 2M12 4A8 8 0 0 1 20 12A8 8 0 0 1 12 20V4Z"},null,-1)]))}v1=i(f1,[["render",q0]]),b1={},j1={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function K0(s,o){return e(),n("svg",j1,o[0]||(o[0]=[t("path",{d:"M20,11H23V13H20V11M1,11H4V13H1V11M13,1V4H11V1H13M4.92,3.5L7.05,5.64L5.63,7.05L3.5,4.93L4.92,3.5M16.95,5.63L19.07,3.5L20.5,4.93L18.37,7.05L16.95,5.63M12,6A6,6 0 0,1 18,12C18,14.22 16.79,16.16 15,17.2V19A1,1 0 0,1 14,20H10A1,1 0 0,1 9,19V17.2C7.21,16.16 6,14.22 6,12A6,6 0 0,1 12,6M14,21V22A1,1 0 0,1 13,23H11A1,1 0 0,1 10,22V21H14M11,18H13V15.87C14.73,15.43 16,13.86 16,12A4,4 0 0,0 12,8A4,4 0 0,0 8,12C8,13.86 9.27,15.43 11,15.87V18Z"},null,-1)]))}_1=i(b1,[["render",K0]]),w1={emits:["update"],computed:{saturation(){const e=this.$store.options.filters.saturate;return typeof e=="number"?e:1}}},O1=["value"],x1=["value"],C1=["value"];function U0(o,i,r,l,d,u){const h=_1,m=v1,f=m1;return e(),n(c,null,[t("p",null,[t("label",null,[a(h),z(" "+s(o.$translate("Brightness"))+" ",1),t("b",null,s(Math.round((o.$store.options.filters.brightness||1)*100))+"\xA0%",1),t("input",{ref:"firstSlider",max:"2",min:".5",step:".01",type:"range",value:o.$store.options.filters.brightness||1,style:pe(`--value: ${((o.$store.options.filters.brightness||1)-.5)*.66667*100}%`),onInput:i[0]||(i[0]=e=>o.$emit("update","brightness",e))},null,44,O1)])]),t("p",null,[t("label",null,[a(m),z(" "+s(o.$translate("Contrast"))+" ",1),t("b",null,s(Math.round((o.$store.options.filters.contrast||1)*100))+"\xA0%",1),t("input",{max:"2",min:".5",step:".01",type:"range",value:o.$store.options.filters.contrast||1,style:pe(`--value: ${((o.$store.options.filters.contrast||1)-.5)*.66667*100}%`),onInput:i[1]||(i[1]=e=>o.$emit("update","contrast",e))},null,44,x1)])]),t("p",null,[t("label",null,[a(f),z(" "+s(o.$translate("Saturation"))+" ",1),t("b",null,s(Math.round(u.saturation*100))+"\xA0%",1),t("input",{max:"3",min:"0",step:".01",type:"range",value:u.saturation,style:pe(`--value: ${u.saturation/3*100}%`),onInput:i[2]||(i[2]=e=>o.$emit("update","saturate",e))},null,44,C1)])])],64)}k1=i(w1,[["render",U0]]),A1={},S1={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function W0(s,o){return e(),n("svg",S1,o[0]||(o[0]=[t("path",{d:"M3,17V19H9V17H3M3,5V7H13V5H3M13,21V19H21V17H13V15H11V21H13M7,9V11H3V13H7V15H9V9H7M21,13V11H11V13H21M15,9H17V7H21V5H17V3H15V9Z"},null,-1)]))}F1=i(A1,[["render",W0]]),T1={},z1={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function $0(s,o){return e(),n("svg",z1,o[0]||(o[0]=[t("path",{d:"M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10L15.55,5.55Z"},null,-1)]))}N1=i(T1,[["render",$0]]),L1={},R1={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function V0(s,o){return e(),n("svg",R1,o[0]||(o[0]=[t("path",{d:"M19,12H17V15H14V17H19V12M7,9H10V7H5V12H7V9M21,3H3A2,2 0 0,0 1,5V19A2,2 0 0,0 3,21H21A2,2 0 0,0 23,19V5A2,2 0 0,0 21,3M21,19H3V5H21V19Z"},null,-1)]))}H1=i(L1,[["render",V0]]),Bt={exports:{}},B1=Bt.exports;function I0(){return V1||(V1=1,function(e){function t(e){return new t.Viewer(e)}(function(e){e.version={versionStr:"5.0.1",major:parseInt("5",10),minor:parseInt("0",10),revision:parseInt("1",10)};var s={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object AsyncFunction]":"function","[object Promise]":"promise","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},o=Object.prototype.toString,n=Object.prototype.hasOwnProperty;e.isFunction=function(t){return e.type(t)==="function"},e.isArray=Array.isArray||function(t){return e.type(t)==="array"},e.isWindow=function(e){return e&&typeof e=="object"&&"setInterval"in e},e.type=function(e){return e==null?String(e):s[o.call(e)]||"object"},e.isPlainObject=function(s){if(!s||t.type(s)!=="object"||s.nodeType||e.isWindow(s)||s.constructor&&!n.call(s,"constructor")&&!n.call(s.constructor.prototype,"isPrototypeOf"))return!1;var o,i;for(i in s)o=i;return o===0[0]||n.call(s,o)},e.isEmptyObject=function(e){for(var t in e)return!1;return!0},e.freezeObject=function(t){return Object.freeze?e.freezeObject=Object.freeze:e.freezeObject=function(e){return e},e.freezeObject(t)},e.supportsCanvas=function(){var t=document.createElement("canvas");return!!(e.isFunction(t.getContext)&&t.getContext("2d"))}(),e.isCanvasTainted=function(e){var t=!1;try{e.getContext("2d").getImageData(0,0,1,1)}catch{t=!0}return t},e.supportsAddEventListener=function(){return!!(document.documentElement.addEventListener&&document.addEventListener)}(),e.supportsRemoveEventListener=function(){return!!(document.documentElement.removeEventListener&&document.removeEventListener)}(),e.supportsEventListenerOptions=function(){var n,t=0;if(e.supportsAddEventListener)try{n={get capture(){return t++,!1},get once(){return t++,!1},get passive(){return t++,!1}},window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch{t=0}return t>=3}(),e.getCurrentPixelDensityRatio=function(){if(e.supportsCanvas){var t=document.createElement("canvas").getContext("2d"),n=window.devicePixelRatio||1,s=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return Math.max(n,1)/s}return 1},e.pixelDensityRatio=e.getCurrentPixelDensityRatio()})(t),function(e){e.extend=function(){var s,o,i,r,c,l,d,n=arguments[0]||{},h=arguments.length,u=!1,a=1;for(typeof n=="boolean"&&(u=n,n=arguments[1]||{},a=2),typeof n!="object"&&!t.isFunction(n)&&(n={}),h===a&&(n=this,--a);a<h;a++)if(c=arguments[a],c!==null||c!==0[0])for(o in c){if(r=Object.getOwnPropertyDescriptor(c,o),r!==0[0]){if(r.get||r.set){Object.defineProperty(n,o,r);continue}s=r.value}else{e.console.warn('Could not copy inherited property "'+o+'".');continue}n!==s&&(u&&s&&(t.isPlainObject(s)||(l=t.isArray(s)))?(i=n[o],l?(l=!1,d=i&&t.isArray(i)?i:[]):d=i&&t.isPlainObject(i)?i:{},n[o]=t.extend(u,d,s)):s!==0[0]&&(n[o]=s))}return n},s=function(){if(typeof navigator!="object")return!1;var e=navigator.userAgent;return typeof e=="string"&&(e.indexOf("iPhone")!==-1||e.indexOf("iPad")!==-1||e.indexOf("iPod")!==-1)},e.extend(e,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},splitHashDataForPost:!1,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{dragToPan:!0,scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,dblClickDragToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{dragToPan:!0,scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,dblClickDragToZoom:!1,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerDblClickDrag:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:s(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,maxTilesPerFrame:1,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorElement:null,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,overlayPreserveContentDirection:!0,opacity:1,compositeOperation:null,drawer:["webgl","canvas","html"],drawerOptions:{webgl:{},canvas:{},html:{},custom:{}},preload:!1,imageSmoothingEnabled:!0,placeholderFillStyle:null,subPixelRoundingForTransparency:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,tileRetryMax:0,tileRetryDelay:2500,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"],silenceMultiImageWarnings:!1},delegate:function(e,t){return function(){var n=arguments;return n===0[0]&&(n=[]),t.apply(e,n)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6,CHROMEEDGE:7},SUBPIXEL_ROUNDING_OCCURRENCES:{NEVER:0,ONLY_AT_REST:1,ALWAYS:2},_viewers:new Map,getViewer:function(t){return e._viewers.get(this.getElement(t))},getElement:function(e){return typeof e=="string"&&(e=document.getElementById(e)),e},getElementPosition:function(t){var s,o,n=new e.Point;for(t=e.getElement(t),s=e.getElementStyle(t).position==="fixed",o=a(t,s);o;)n.x+=t.offsetLeft,n.y+=t.offsetTop,s&&(n=n.plus(e.getPageScroll())),t=o,s=e.getElementStyle(t).position==="fixed",o=a(t,s);return n},getElementOffset:function(t){t=e.getElement(t);var s,o,n=t&&t.ownerDocument,i={top:0,left:0};return n?(s=n.documentElement,typeof t.getBoundingClientRect<"u"&&(i=t.getBoundingClientRect()),o=n===n.window?n:n.nodeType===9&&(n.defaultView||n.parentWindow),new e.Point(i.left+(o.pageXOffset||s.scrollLeft)-(s.clientLeft||0),i.top+(o.pageYOffset||s.scrollTop)-(s.clientTop||0))):new e.Point},getElementSize:function(t){return t=e.getElement(t),new e.Point(t.clientWidth,t.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(t){return t=e.getElement(t),t.currentStyle}:function(t){return t=e.getElement(t),window.getComputedStyle(t,"")},getCssPropertyWithVendorPrefix:function(t){var n={};return e.getCssPropertyWithVendorPrefix=function(t){if(n[t]!==0[0])return n[t];if(o=document.createElement("div").style,s=null,o[t]!==0[0])s=t;else for(var s,o,a,r=["Webkit","Moz","MS","O","webkit","moz","ms","o"],c=e.capitalizeFirstLetter(t),i=0;i<r.length;i++)if(a=r[i]+c,o[a]!==0[0]){s=a;break}return n[t]=s,s},e.getCssPropertyWithVendorPrefix(t)},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},positiveModulo:function(e,t){var n=e%t;return n<0&&(n+=t),n},pointInElement:function(t,n){t=e.getElement(t);var s=e.getElementOffset(t),o=e.getElementSize(t);return n.x>=s.x&&n.x<s.x+o.x&&n.y<s.y+o.y&&n.y>=s.y},getMousePosition:function(t){if(typeof t.pageX=="number")e.getMousePosition=function(t){var n=new e.Point;return n.x=t.pageX,n.y=t.pageY,n};else if(typeof t.clientX=="number")e.getMousePosition=function(t){var n=new e.Point;return n.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop,n};else throw new Error("Unknown event mouse position, no known technique.");return e.getMousePosition(t)},getPageScroll:function(){var t=document.documentElement||{},n=document.body||{};if(typeof window.pageXOffset=="number")e.getPageScroll=function(){return new e.Point(window.pageXOffset,window.pageYOffset)};else if(n.scrollLeft||n.scrollTop)e.getPageScroll=function(){return new e.Point(document.body.scrollLeft,document.body.scrollTop)};else if(t.scrollLeft||t.scrollTop)e.getPageScroll=function(){return new e.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new e.Point(0,0);return e.getPageScroll()},setPageScroll:function(t){if(typeof window.scrollTo<"u")e.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var s,n=e.getPageScroll();if(n.x===t.x&&n.y===t.y)return;if(document.body.scrollLeft=t.x,document.body.scrollTop=t.y,s=e.getPageScroll(),s.x!==n.x&&s.y!==n.y){e.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y};return}if(document.documentElement.scrollLeft=t.x,document.documentElement.scrollTop=t.y,s=e.getPageScroll(),s.x!==n.x&&s.y!==n.y){e.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y};return}e.setPageScroll=function(){}}e.setPageScroll(t)},getWindowSize:function(){var t=document.documentElement||{},n=document.body||{};if(typeof window.innerWidth=="number")e.getWindowSize=function(){return new e.Point(window.innerWidth,window.innerHeight)};else if(t.clientWidth||t.clientHeight)e.getWindowSize=function(){return new e.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(n.clientWidth||n.clientHeight)e.getWindowSize=function(){return new e.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return e.getWindowSize()},makeCenteredNode:function(t){t=e.getElement(t);var n=[e.makeNeutralElement("div"),e.makeNeutralElement("div"),e.makeNeutralElement("div")];return e.extend(n[0].style,{display:"table",height:"100%",width:"100%"}),e.extend(n[1].style,{display:"table-row"}),e.extend(n[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),n[0].appendChild(n[1]),n[1].appendChild(n[2]),n[2].appendChild(t),n[0]},makeNeutralElement:function(e){var n=document.createElement(e),t=n.style;return t.background="transparent none",t.border="none",t.margin="0px",t.padding="0px",t.position="static",n},now:function(){return Date.now?e.now=Date.now:e.now=function(){return(new Date).getTime()},e.now()},makeTransparentImage:function(t){var n=e.makeNeutralElement("img");return n.src=t,n},setElementOpacity:function(t,n,s){var o,i;t=e.getElement(t),s&&!e.Browser.alpha&&(n=Math.round(n)),e.Browser.opacity?t.style.opacity=n<1?n:"":n<1?(o=Math.round(100*n),i="alpha(opacity="+o+")",t.style.filter=i):t.style.filter=""},setElementTouchActionNone:function(t){t=e.getElement(t),typeof t.style.touchAction<"u"?t.style.touchAction="none":typeof t.style.msTouchAction<"u"&&(t.style.msTouchAction="none")},setElementPointerEvents:function(t,n){t=e.getElement(t),typeof t.style<"u"&&typeof t.style.pointerEvents<"u"&&(t.style.pointerEvents=n)},setElementPointerEventsNone:function(t){e.setElementPointerEvents(t,"none")},addClass:function(t,n){t=e.getElement(t),t.className?(" "+t.className+" ").indexOf(" "+n+" ")===-1&&(t.className+=" "+n):t.className=n},indexOf:function(e,t,n){return Array.prototype.indexOf?this.indexOf=function(e,t,n){return e.indexOf(t,n)}:this.indexOf=function(e,t,n){var s,i,o=n||0;if(!e)throw new TypeError;if(i=e.length,i===0||o>=i)return-1;for(o<0&&(o=i-(o<0?-o:o)),s=o;s<i;s++)if(e[s]===t)return s;return-1},this.indexOf(e,t,n)},removeClass:function(t,n){var s,o,i=[];for(t=e.getElement(t),o=t.className.split(/\s+/),s=0;s<o.length;s++)o[s]&&o[s]!==n&&i.push(o[s]);t.className=i.join(" ")},normalizeEventListenerOptions:function(t){var n;return typeof t<"u"?typeof t=="boolean"?n=e.supportsEventListenerOptions?{capture:t}:t:n=e.supportsEventListenerOptions?t:typeof t.capture<"u"&&t.capture:n=!!e.supportsEventListenerOptions&&{capture:!1},n},addEvent:function(){if(e.supportsAddEventListener)return function(t,n,s,o){o=e.normalizeEventListenerOptions(o),t=e.getElement(t),t.addEventListener(n,s,o)};if(document.documentElement.attachEvent&&document.attachEvent)return function(t,n,s){t=e.getElement(t),t.attachEvent("on"+n,s)};throw new Error("No known event model.")}(),removeEvent:function(){if(e.supportsRemoveEventListener)return function(t,n,s,o){o=e.normalizeEventListenerOptions(o),t=e.getElement(t),t.removeEventListener(n,s,o)};if(document.documentElement.detachEvent&&document.detachEvent)return function(t,n,s){t=e.getElement(t),t.detachEvent("on"+n,s)};throw new Error("No known event model.")}(),cancelEvent:function(e){e.preventDefault()},eventIsCanceled:function(e){return e.defaultPrevented},stopEvent:function(e){e.stopPropagation()},createCallback:function(e,t){console.error("The createCallback function is deprecated and will be removed in future versions. Please use alternativeFunction instead.");var n,s=[];for(n=2;n<arguments.length;n++)s.push(arguments[n]);return function(){var n,o=s.concat([]);for(n=0;n<arguments.length;n++)o.push(arguments[n]);return t.apply(e,o)}},getUrlParameter:function(e){var t=i[e];return t||null},getUrlProtocol:function(e){var t=e.match(/^([a-z]+:)\/\//i);return t===null?window.location.protocol:t[1].toLowerCase()},createAjaxRequest:function(){if(window.XMLHttpRequest)return e.createAjaxRequest=function(){return new XMLHttpRequest},new XMLHttpRequest;throw new Error("Browser doesn't support XMLHttpRequest.")},makeAjaxRequest:function(t,n,s){e.isPlainObject(t)&&(n=t.success,s=t.error,l=t.withCredentials,i=t.headers,r=t.responseType||null,c=t.postData||null,t=t.url);var i,a,r,c,l,u,d=e.getUrlProtocol(t),o=e.createAjaxRequest();if(!e.isFunction(n))throw new Error("makeAjaxRequest requires a success callback");o.onreadystatechange=function(){o.readyState===4&&(o.onreadystatechange=function(){},o.status>=200&&o.status<300||o.status===0&&d!=="http:"&&d!=="https:"?n(o):e.isFunction(s)?s(o):e.console.error("AJAX request returned %d: %s",o.status,t))},u=c?"POST":"GET";try{if(o.open(u,t,!0),r&&(o.responseType=r),i)for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&o.setRequestHeader(a,i[a]);l&&(o.withCredentials=!0),o.send(c)}catch(t){e.console.error("%s while making AJAX request: %s",t.name,t.message),o.onreadystatechange=function(){},e.isFunction(s)&&s(o,t)}return o},jsonp:function(t){var n,o=t.url,i=document.head||document.getElementsByTagName("head")[0]||document.documentElement,s=t.callbackName||"openseadragon"+e.now(),r=window[s],c="$1"+s+"$2",l=t.param||"callback",a=t.callback,o=o.replace(/(=)\?(&|$)|\?\?/i,c);o+=(/\?/.test(o)?"&":"?")+l+"="+s,window[s]=function(t){if(r)window[s]=r;else try{delete window[s]}catch{}a&&e.isFunction(a)&&a(t)},n=document.createElement("script"),(t.async!==0[0]||t.async!==!1)&&(n.async="async"),t.scriptCharset&&(n.charset=t.scriptCharset),n.src=o,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n=0[0])},i.insertBefore(n,i.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(t){if(window.DOMParser)e.parseXml=function(e){var n,t=null;return n=new DOMParser,t=n.parseFromString(e,"text/xml"),t};else throw new Error("Browser doesn't support XML DOM.");return e.parseXml(t)},parseJSON:function(t){return e.parseJSON=window.JSON.parse,e.parseJSON(t)},imageFormatSupported:function(e){return e=e||"",!!o[e.toLowerCase()]},setImageFormatsSupported:function(t){e.extend(o,t)}}),n=function(){},e.console=window.console||{log:n,debug:n,info:n,warn:n,error:n,assert:n},e.Browser={vendor:e.BROWSERS.UNKNOWN,version:0,alpha:!0};var n,s,o={avif:!0,bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1,webp:!0},i={};(function(){var n,s,o,a,r,c,l,d,u=navigator.appVersion,t=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(t.substring(t.indexOf("MSIE")+5,t.indexOf(";",t.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(t.indexOf("Edge")>=0?(e.Browser.vendor=e.BROWSERS.EDGE,e.Browser.version=parseFloat(t.substring(t.indexOf("Edge")+5))):t.indexOf("Edg")>=0?(e.Browser.vendor=e.BROWSERS.CHROMEEDGE,e.Browser.version=parseFloat(t.substring(t.indexOf("Edg")+4))):t.indexOf("Firefox")>=0?(e.Browser.vendor=e.BROWSERS.FIREFOX,e.Browser.version=parseFloat(t.substring(t.indexOf("Firefox")+8))):t.indexOf("Safari")>=0?(e.Browser.vendor=t.indexOf("Chrome")>=0?e.BROWSERS.CHROME:e.BROWSERS.SAFARI,e.Browser.version=parseFloat(t.substring(t.substring(0,t.indexOf("Safari")).lastIndexOf("/")+1,t.indexOf("Safari")))):(l=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),l.exec(t)!==null&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":e.Browser.vendor=e.BROWSERS.OPERA,e.Browser.version=parseFloat(u);break}d=window.location.search.substring(1),a=d.split("&");for(o=0;o<a.length;o++)if(n=a[o],s=n.indexOf("="),s>0){r=n.substring(0,s),c=n.substring(s+1);try{i[r]=decodeURIComponent(c)}catch{e.console.error("Ignoring malformed URL parameter: %s=%s",r,c)}}e.Browser.alpha=!(e.Browser.vendor===e.BROWSERS.CHROME&&e.Browser.version<2),e.Browser.opacity=!0,e.Browser.vendor===e.BROWSERS.IE&&e.console.error("Internet Explorer is not supported by OpenSeadragon")})(),function(t){if(i=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,a=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.msCancelAnimationFrame,i&&a)e.requestAnimationFrame=function(){return i.apply(t,arguments)},e.cancelAnimationFrame=function(){return a.apply(t,arguments)};else{var o,i,a,n=[],s=[],r=0;e.requestAnimationFrame=function(t){return n.push([++r,t]),o||(o=setInterval(function(){if(n.length){var t=e.now(),i=s;for(s=n,n=i;s.length;)s.shift()[1](t)}else clearInterval(o),o=0[0]},1e3/50)),r},e.cancelAnimationFrame=function(e){var t,o;for(t=0,o=n.length;t<o;t+=1)if(n[t][0]===e){n.splice(t,1);return}for(t=0,o=s.length;t<o;t+=1)if(s[t][0]===e){s.splice(t,1);return}}}}(window);function a(e,t){return t&&e!==document.body?document.body:e.offsetParent}}(t),function(t,n){e.exports?e.exports=n():t.OpenSeadragon=n()}(B1,function(){return t}),function(e){class t{constructor(e){e||(e=[0,0,0,0,0,0,0,0,0]),this.values=e}static makeIdentity(){return new t([1,0,0,0,1,0,0,0,1])}static makeTranslation(e,n){return new t([1,0,0,0,1,0,e,n,1])}static makeRotation(e){var n=Math.cos(e),s=Math.sin(e);return new t([n,-s,0,s,n,0,0,0,1])}static makeScaling(e,n){return new t([e,0,0,0,n,0,0,0,1])}multiply(e){let n=this.values,s=e.values;var o=n[0],i=n[1],a=n[2],r=n[3],c=n[4],l=n[5],d=n[6],u=n[7],h=n[8],m=s[0],f=s[1],p=s[2],g=s[3],v=s[4],b=s[5],j=s[6],y=s[7],_=s[8];return new t([m*o+f*r+p*d,m*i+f*c+p*u,m*a+f*l+p*h,g*o+v*r+b*d,g*i+v*c+b*u,g*a+v*l+b*h,j*o+y*r+_*d,j*i+y*c+_*u,j*a+y*l+_*h])}}e.Mat3=t}(t),function(e){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.fullscreenElement},t.requestFullScreen=function(t){return t.requestFullscreen().catch(function(t){e.console.error("Fullscreen request failed: ",t)})},t.exitFullScreen=function(){document.exitFullscreen().catch(function(t){e.console.error("Error while exiting fullscreen: ",t)})},t.fullScreenEventName="fullscreenchange",t.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.msFullscreenElement},t.requestFullScreen=function(e){return e.msRequestFullscreen()},t.exitFullScreen=function(){document.msExitFullscreen()},t.fullScreenEventName="MSFullscreenChange",t.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitFullscreenElement},t.requestFullScreen=function(e){return e.webkitRequestFullscreen()},t.exitFullScreen=function(){document.webkitExitFullscreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},t.requestFullScreen=function(e){return e.webkitRequestFullScreen()},t.exitFullScreen=function(){document.webkitCancelFullScreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.mozFullScreenElement},t.requestFullScreen=function(e){return e.mozRequestFullScreen()},t.exitFullScreen=function(){document.mozCancelFullScreen()},t.fullScreenEventName="mozfullscreenchange",t.fullScreenErrorEventName="mozfullscreenerror"),t.isFullScreen=function(){return t.getFullScreenElement()!==null},t.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),t.exitFullScreen()},e.extend(e,t)}(t),function(e){e.EventSource=function(){this.events={},this._rejectedEventList={}},e.EventSource.prototype={addOnceHandler:function(e,t,n,s,o){i=this,s=s||1;var i,a=0,r=function(n){return a++,a===s&&i.removeHandler(e,r),t(n)};return this.addHandler(e,r,n,o)},addHandler:function(t,n,s,o){if(Object.prototype.hasOwnProperty.call(this._rejectedEventList,t))return e.console.error(`Error adding handler for ${t}. ${this._rejectedEventList[t]}`),!1;if(i=this.events[t],i||(this.events[t]=i=[]),n&&e.isFunction(n)){var i,a=i.length,r={handler:n,userData:s||null,priority:o||0};for(i[a]=r;a>0&&i[a-1].priority<i[a].priority;)i[a]=i[a-1],i[a-1]=r,a--}return!0},removeHandler:function(t,n){var o,s=this.events[t],i=[];if(s&&e.isArray(s)){for(o=0;o<s.length;o++)s[o].handler!==n&&i.push(s[o]);this.events[t]=i}},numberOfHandlers:function(e){var t=this.events[e];return t?t.length:0},removeAllHandlers:function(e){if(e)this.events[e]=[];else for(var t in this.events)this.events[t]=[]},getHandler:function(e){var t=this.events[e];return!t||!t.length?null:(t=t.length===1?[t[0]]:Array.apply(null,t),function(e,n){var s,o=t.length;for(s=0;s<o;s++)t[s]&&(n.eventSource=e,n.userData=t[s].userData,t[s].handler(n))})},raiseEvent:function(t,n){if(Object.prototype.hasOwnProperty.call(this._rejectedEventList,t))return e.console.error(`Error adding handler for ${t}. ${this._rejectedEventList[t]}`),!1;var s=this.getHandler(t);return s&&s(this,n||{}),!0},rejectEventHandler(e,t=""){this._rejectedEventList[e]=t},allowEventHandler(e){delete this._rejectedEventList[e]}}}(t),function(e){var m,o={};e.MouseTracker=function(t){var n,s=arguments;e.isPlainObject(t)||(t={element:s[0],clickTimeThreshold:s[1],clickDistThreshold:s[2]}),this.hash=Math.random(),this.element=e.getElement(t.element),this.clickTimeThreshold=t.clickTimeThreshold||e.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=t.clickDistThreshold||e.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=t.dblClickTimeThreshold||e.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=t.dblClickDistThreshold||e.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=t.userData||null,this.stopDelay=t.stopDelay||50,this.preProcessEventHandler=t.preProcessEventHandler||null,this.contextMenuHandler=t.contextMenuHandler||null,this.enterHandler=t.enterHandler||null,this.leaveHandler=t.leaveHandler||null,this.exitHandler=t.exitHandler||null,this.overHandler=t.overHandler||null,this.outHandler=t.outHandler||null,this.pressHandler=t.pressHandler||null,this.nonPrimaryPressHandler=t.nonPrimaryPressHandler||null,this.releaseHandler=t.releaseHandler||null,this.nonPrimaryReleaseHandler=t.nonPrimaryReleaseHandler||null,this.moveHandler=t.moveHandler||null,this.scrollHandler=t.scrollHandler||null,this.clickHandler=t.clickHandler||null,this.dblClickHandler=t.dblClickHandler||null,this.dragHandler=t.dragHandler||null,this.dragEndHandler=t.dragEndHandler||null,this.pinchHandler=t.pinchHandler||null,this.stopHandler=t.stopHandler||null,this.keyDownHandler=t.keyDownHandler||null,this.keyUpHandler=t.keyUpHandler||null,this.keyHandler=t.keyHandler||null,this.focusHandler=t.focusHandler||null,this.blurHandler=t.blurHandler||null,n=this,o[this.hash]={click:function(e){re(n,e)},dblclick:function(e){R(n,e)},keydown:function(e){ie(n,e)},keyup:function(e){oe(n,e)},keypress:function(e){te(n,e)},focus:function(e){ee(n,e)},blur:function(e){J(n,e)},contextmenu:function(e){Z(n,e)},wheel:function(e){ae(n,e)},mousewheel:function(e){h(n,e)},DOMMouseScroll:function(e){h(n,e)},MozMousePixelScroll:function(e){h(n,e)},losecapture:function(e){U(n,e)},mouseenter:function(e){N(n,e)},mouseleave:function(e){D(n,e)},mouseover:function(e){p(n,e)},mouseout:function(e){T(n,e)},mousedown:function(e){F(n,e)},mouseup:function(e){M(n,e)},mousemove:function(e){A(n,e)},touchstart:function(e){W(n,e)},touchend:function(e){V(n,e)},touchmove:function(e){B(n,e)},touchcancel:function(e){I(n,e)},gesturestart:function(e){H(n,e)},gesturechange:function(e){P(n,e)},gotpointercapture:function(e){Y(n,e)},lostpointercapture:function(e){G(n,e)},pointerenter:function(e){N(n,e)},pointerleave:function(e){D(n,e)},pointerover:function(e){p(n,e)},pointerout:function(e){T(n,e)},pointerdown:function(e){F(n,e)},pointerup:function(e){M(n,e)},pointermove:function(e){A(n,e)},pointercancel:function(e){L(n,e)},pointerupcaptured:function(e){$(n,e)},pointermovecaptured:function(e){K(n,e)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null,sentDragEvent:!1},this.hasGestureHandlers=!!(this.pressHandler||this.nonPrimaryPressHandler||this.releaseHandler||this.nonPrimaryReleaseHandler||this.clickHandler||this.dblClickHandler||this.dragHandler||this.dragEndHandler||this.pinchHandler),this.hasScrollHandler=!!this.scrollHandler,e.MouseTracker.havePointerEvents&&e.setElementPointerEvents(this.element,"auto"),this.exitHandler&&e.console.error("MouseTracker.exitHandler is deprecated. Use MouseTracker.leaveHandler instead."),t.startDisabled||this.setTracking(!0)},e.MouseTracker.prototype={destroy:function(){C(this),this.element=null,o[this.hash]=null,delete o[this.hash]},isTracking:function(){return o[this.hash].tracking},setTracking:function(e){return e?q(this):C(this),this},getActivePointersListByType:function(t){var s,i,n=o[this.hash],a=n?n.activePointersLists.length:0;for(s=0;s<a;s++)if(n.activePointersLists[s].type===t)return n.activePointersLists[s];return i=new e.MouseTracker.GesturePointList(t),n&&n.activePointersLists.push(i),i},getActivePointerCount:function(){var e,t=o[this.hash],s=t.activePointersLists.length,n=0;for(e=0;e<s;e++)n+=t.activePointersLists[e].getLength();return n},preProcessEventHandler:function(){},contextMenuHandler:function(){},enterHandler:function(){},leaveHandler:function(){},exitHandler:function(){},overHandler:function(){},outHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},m=function(){try{return window.self!==window.top}catch{return!0}}();function O(e){try{return e.addEventListener&&e.removeEventListener}catch{return!1}}e.MouseTracker.gesturePointVelocityTracker=function(){var t=[],s=0,n=0,o=function(e,t){return e.hash.toString()+t.type+t.id.toString()},i=function(){var s,o,i,r,c,l,d=t.length,a=e.now();for(r=a-n,n=a,i=0;i<d;i++)o=t[i],s=o.gPoint,s.direction=Math.atan2(s.currentPos.y-o.lastPos.y,s.currentPos.x-o.lastPos.x),c=o.lastPos.distanceTo(s.currentPos),o.lastPos=s.currentPos,l=1e3*c/(r+1),s.speed=.75*l+.25*s.speed},a=function(a,r){var c=o(a,r);t.push({guid:c,gPoint:r,lastPos:r.currentPos}),t.length===1&&(n=e.now(),s=window.setInterval(i,50))},r=function(e,n){var i,r=o(e,n),a=t.length;for(i=0;i<a;i++)if(t[i].guid===r){t.splice(i,1),a--,a===0&&window.clearInterval(s);break}};return{addPoint:a,removePoint:r}}(),e.MouseTracker.captureElement=document,e.MouseTracker.wheelEventName="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==0[0]?"mousewheel":"DOMMouseScroll",e.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur","contextmenu",e.MouseTracker.wheelEventName],e.MouseTracker.wheelEventName==="DOMMouseScroll"&&e.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("pointerenter","pointerleave","pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),e.MouseTracker.havePointerCapture=function(){var t=document.createElement("div");return e.isFunction(t.setPointerCapture)&&e.isFunction(t.releasePointerCapture)}(),e.MouseTracker.havePointerCapture&&e.MouseTracker.subscribeEvents.push("gotpointercapture","lostpointercapture")):(e.MouseTracker.havePointerEvents=!1,e.MouseTracker.subscribeEvents.push("mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","mousemove"),e.MouseTracker.mousePointerId="legacy-mouse",e.MouseTracker.havePointerCapture=function(){var t=document.createElement("div");return e.isFunction(t.setCapture)&&e.isFunction(t.releaseCapture)}(),e.MouseTracker.havePointerCapture&&e.MouseTracker.subscribeEvents.push("losecapture"),"ontouchstart"in window&&e.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&e.MouseTracker.subscribeEvents.push("gesturestart","gesturechange")),e.MouseTracker.GesturePointList=function(e){this._gPoints=[],this.type=e,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},e.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(e){return this._gPoints.push(e)},removeById:function(e){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].id===e){this._gPoints.splice(t,1);break}return this._gPoints.length},getByIndex:function(e){return e<this._gPoints.length?this._gPoints[e]:null},getById:function(e){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].id===e)return this._gPoints[t];return null},getPrimary:function(){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].isPrimary)return this._gPoints[t];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(e.console.warn("GesturePointList.addContact() Implausible contacts value"),this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function x(e){var t,n,i,a,r,s=o[e.hash],c=s.activePointersLists.length;for(n=0;n<c;n++)if(i=s.activePointersLists[n],i.getLength()>0){for(a=[],r=i.asArray(),t=0;t<r.length;t++)a.push(r[t]);for(t=0;t<a.length;t++)l(e,i,a[t])}for(n=0;n<c;n++)s.activePointersLists.pop();s.sentDragEvent=!1}function q(t){var n,s,i=o[t.hash];if(!i.tracking){for(s=0;s<e.MouseTracker.subscribeEvents.length;s++)n=e.MouseTracker.subscribeEvents[s],e.addEvent(t.element,n,i[n],n===e.MouseTracker.wheelEventName&&{passive:!1,capture:!1});x(t),i.tracking=!0}}function C(t){var n,i,s=o[t.hash];if(s.tracking){for(n=0;n<e.MouseTracker.subscribeEvents.length;n++)i=e.MouseTracker.subscribeEvents[n],e.removeEvent(t.element,i,s[i],!1);x(t),s.tracking=!1}}function E(e,t){var n=o[e.hash];if(t==="pointerevent")return{upName:"pointerup",upHandler:n.pointerupcaptured,moveName:"pointermove",moveHandler:n.pointermovecaptured};if(t==="mouse")return{upName:"pointerup",upHandler:n.pointerupcaptured,moveName:"pointermove",moveHandler:n.pointermovecaptured};if(t==="touch")return{upName:"touchend",upHandler:n.touchendcaptured,moveName:"touchmove",moveHandler:n.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function X(t,n){var s;if(e.MouseTracker.havePointerCapture)if(e.MouseTracker.havePointerEvents)try{t.element.setPointerCapture(n.id)}catch{e.console.warn("setPointerCapture() called on invalid pointer ID");return}else t.element.setCapture(!0);else s=E(t,e.MouseTracker.havePointerEvents?"pointerevent":n.type),m&&O(window.top)&&e.addEvent(window.top,s.upName,s.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,s.upName,s.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,s.moveName,s.moveHandler,!0);a(t,n,!0)}function g(t,n){var s,o,i;if(e.MouseTracker.havePointerCapture)if(e.MouseTracker.havePointerEvents){if(i=t.getActivePointersListByType(n.type),o=i.getById(n.id),!o||!o.captured)return;try{t.element.releasePointerCapture(n.id)}catch{}}else t.element.releaseCapture();else s=E(t,e.MouseTracker.havePointerEvents?"pointerevent":n.type),m&&O(window.top)&&e.removeEvent(window.top,s.upName,s.upHandler,!0),e.removeEvent(e.MouseTracker.captureElement,s.moveName,s.moveHandler,!0),e.removeEvent(e.MouseTracker.captureElement,s.upName,s.upHandler,!0);a(t,n,!1)}function r(t){return e.MouseTracker.havePointerEvents?t.pointerId:e.MouseTracker.mousePointerId}function s(t){return e.MouseTracker.havePointerEvents&&t.pointerType?t.pointerType:"mouse"}function c(t){return!e.MouseTracker.havePointerEvents||t.isPrimary}function i(t){return e.getMousePosition(t)}function z(e,t){return n(i(e),t)}function n(t,n){var s=e.getElementOffset(n);return t.minus(s)}function d(t,n){return new e.Point((t.x+n.x)/2,(t.y+n.y)/2)}function re(n,s){var o={originalEvent:s,eventType:"click",pointerType:"mouse",isEmulated:!1};t(n,o),o.preventDefault&&!o.defaultPrevented&&e.cancelEvent(s),o.stopPropagation&&e.stopEvent(s)}function R(n,s){var o={originalEvent:s,eventType:"dblclick",pointerType:"mouse",isEmulated:!1};t(n,o),o.preventDefault&&!o.defaultPrevented&&e.cancelEvent(s),o.stopPropagation&&e.stopEvent(s)}function ie(n,s){var i=null,o={originalEvent:s,eventType:"keydown",pointerType:"",isEmulated:!1};t(n,o),n.keyDownHandler&&!o.preventGesture&&!o.defaultPrevented&&(i={eventSource:n,keyCode:s.keyCode?s.keyCode:s.charCode,ctrl:s.ctrlKey,shift:s.shiftKey,alt:s.altKey,meta:s.metaKey,originalEvent:s,preventDefault:o.preventDefault||o.defaultPrevented,userData:n.userData},n.keyDownHandler(i)),(i&&i.preventDefault||o.preventDefault&&!o.defaultPrevented)&&e.cancelEvent(s),o.stopPropagation&&e.stopEvent(s)}function oe(n,s){var i=null,o={originalEvent:s,eventType:"keyup",pointerType:"",isEmulated:!1};t(n,o),n.keyUpHandler&&!o.preventGesture&&!o.defaultPrevented&&(i={eventSource:n,keyCode:s.keyCode?s.keyCode:s.charCode,ctrl:s.ctrlKey,shift:s.shiftKey,alt:s.altKey,meta:s.metaKey,originalEvent:s,preventDefault:o.preventDefault||o.defaultPrevented,userData:n.userData},n.keyUpHandler(i)),(i&&i.preventDefault||o.preventDefault&&!o.defaultPrevented)&&e.cancelEvent(s),o.stopPropagation&&e.stopEvent(s)}function te(n,s){var i=null,o={originalEvent:s,eventType:"keypress",pointerType:"",isEmulated:!1};t(n,o),n.keyHandler&&!o.preventGesture&&!o.defaultPrevented&&(i={eventSource:n,keyCode:s.keyCode?s.keyCode:s.charCode,ctrl:s.ctrlKey,shift:s.shiftKey,alt:s.altKey,meta:s.metaKey,originalEvent:s,preventDefault:o.preventDefault||o.defaultPrevented,userData:n.userData},n.keyHandler(i)),(i&&i.preventDefault||o.preventDefault&&!o.defaultPrevented)&&e.cancelEvent(s),o.stopPropagation&&e.stopEvent(s)}function ee(e,n){var s={originalEvent:n,eventType:"focus",pointerType:"",isEmulated:!1};t(e,s),e.focusHandler&&!s.preventGesture&&e.focusHandler({eventSource:e,originalEvent:n,userData:e.userData})}function J(e,n){var s={originalEvent:n,eventType:"blur",pointerType:"",isEmulated:!1};t(e,s),e.blurHandler&&!s.preventGesture&&e.blurHandler({eventSource:e,originalEvent:n,userData:e.userData})}function Z(s,o){var r=null,a={originalEvent:o,eventType:"contextmenu",pointerType:"mouse",isEmulated:!1};t(s,a),s.contextMenuHandler&&!a.preventGesture&&!a.defaultPrevented&&(r={eventSource:s,position:n(i(o),s.element),originalEvent:a.originalEvent,preventDefault:a.preventDefault||a.defaultPrevented,userData:s.userData},s.contextMenuHandler(r)),(r&&r.preventDefault||a.preventDefault&&!a.defaultPrevented)&&e.cancelEvent(o),a.stopPropagation&&e.stopEvent(o)}function ae(e,t){k(e,t,t)}function h(t,n){var s={target:n.target||n.srcElement,type:"wheel",shiftKey:n.shiftKey||!1,clientX:n.clientX,clientY:n.clientY,pageX:n.pageX?n.pageX:n.clientX,pageY:n.pageY?n.pageY:n.clientY,deltaMode:n.type==="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};e.MouseTracker.wheelEventName==="mousewheel"?s.deltaY=-n.wheelDelta/e.DEFAULT_SETTINGS.pixelsPerWheelLine:s.deltaY=n.detail,k(t,s,n)}function k(n,s,o){var r=0,a=null,r=s.deltaY?s.deltaY<0?1:-1:0,i={originalEvent:s,eventType:"wheel",pointerType:"mouse",isEmulated:s!==o};t(n,i),n.scrollHandler&&!i.preventGesture&&!i.defaultPrevented&&(a={eventSource:n,pointerType:"mouse",position:z(s,n.element),scroll:r,shift:s.shiftKey,isTouchEvent:!1,originalEvent:o,preventDefault:i.preventDefault||i.defaultPrevented,userData:n.userData},n.scrollHandler(a)),i.stopPropagation&&e.stopEvent(o),(a&&a.preventDefault||i.preventDefault&&!i.defaultPrevented)&&e.cancelEvent(o)}function U(n,s){var i={id:e.MouseTracker.mousePointerId,type:"mouse"},o={originalEvent:s,eventType:"lostpointercapture",pointerType:"mouse",isEmulated:!1};t(n,o),s.target===n.element&&a(n,i,!1),o.stopPropagation&&e.stopEvent(s)}function W(n,s){var o,r,c,l=s.changedTouches.length,d=n.getActivePointersListByType("touch"),u=e.now();d.getLength()>s.touches.length-l&&e.console.warn("Tracked touch contact count doesn't match event.touches.length"),o={originalEvent:s,eventType:"pointerdown",pointerType:"touch",isEmulated:!1};for(t(n,o),r=0;r<l;r++)c={id:s.changedTouches[r].identifier,type:"touch",isPrimary:d.getLength()===0,currentPos:i(s.changedTouches[r]),currentTime:u},w(n,o,c),y(n,o,c,0),a(n,c,!0);o.preventDefault&&!o.defaultPrevented&&e.cancelEvent(s),o.stopPropagation&&e.stopEvent(s)}function V(n,s){var r,c,d=s.changedTouches.length,l=e.now(),o={originalEvent:s,eventType:"pointerup",pointerType:"touch",isEmulated:!1};for(t(n,o),r=0;r<d;r++)c={id:s.changedTouches[r].identifier,type:"touch",currentPos:i(s.changedTouches[r]),currentTime:l},j(n,o,c,0),a(n,c,!1),_(n,o,c);o.preventDefault&&!o.defaultPrevented&&e.cancelEvent(s),o.stopPropagation&&e.stopEvent(s)}function B(n,s){var o,r,l=s.changedTouches.length,c=e.now(),a={originalEvent:s,eventType:"pointermove",pointerType:"touch",isEmulated:!1};for(t(n,a),o=0;o<l;o++)r={id:s.changedTouches[o].identifier,type:"touch",currentPos:i(s.changedTouches[o]),currentTime:c},b(n,a,r);a.preventDefault&&!a.defaultPrevented&&e.cancelEvent(s),a.stopPropagation&&e.stopEvent(s)}function I(n,s){var o,a,r=s.changedTouches.length,i={originalEvent:s,eventType:"pointercancel",pointerType:"touch",isEmulated:!1};for(t(n,i),o=0;o<r;o++)a={id:s.changedTouches[o].identifier,type:"touch"},v(n,i,a);i.stopPropagation&&e.stopEvent(s)}function H(t,n){return e.eventIsCanceled(n)||n.preventDefault(),!1}function P(t,n){return e.eventIsCanceled(n)||n.preventDefault(),!1}function Y(n,o){var i={originalEvent:o,eventType:"gotpointercapture",pointerType:s(o),isEmulated:!1};t(n,i),o.target===n.element&&a(n,{id:o.pointerId,type:s(o)},!0),i.stopPropagation&&e.stopEvent(o)}function G(n,o){var i={originalEvent:o,eventType:"lostpointercapture",pointerType:s(o),isEmulated:!1};t(n,i),o.target===n.element&&a(n,{id:o.pointerId,type:s(o)},!1),i.stopPropagation&&e.stopEvent(o)}function N(n,o){var a={id:r(o),type:s(o),isPrimary:c(o),currentPos:i(o),currentTime:e.now()},l={originalEvent:o,eventType:"pointerenter",pointerType:a.type,isEmulated:!1};t(n,l),w(n,l,a)}function D(n,o){var a={id:r(o),type:s(o),isPrimary:c(o),currentPos:i(o),currentTime:e.now()},l={originalEvent:o,eventType:"pointerleave",pointerType:a.type,isEmulated:!1};t(n,l),_(n,l,a)}function p(n,o){var l={id:r(o),type:s(o),isPrimary:c(o),currentPos:i(o),currentTime:e.now()},a={originalEvent:o,eventType:"pointerover",pointerType:l.type,isEmulated:!1};t(n,a),ne(n,a,l),a.preventDefault&&!a.defaultPrevented&&e.cancelEvent(o),a.stopPropagation&&e.stopEvent(o)}function T(n,o){var l={id:r(o),type:s(o),isPrimary:c(o),currentPos:i(o),currentTime:e.now()},a={originalEvent:o,eventType:"pointerout",pointerType:l.type,isEmulated:!1};t(n,a),se(n,a,l),a.preventDefault&&!a.defaultPrevented&&e.cancelEvent(o),a.stopPropagation&&e.stopEvent(o)}function F(n,o){var d={id:r(o),type:s(o),isPrimary:c(o),currentPos:i(o),currentTime:e.now()},u=e.MouseTracker.havePointerEvents&&d.type==="touch",l={originalEvent:o,eventType:"pointerdown",pointerType:d.type,isEmulated:!1};t(n,l),y(n,l,d,o.button),l.preventDefault&&!l.defaultPrevented&&e.cancelEvent(o),l.stopPropagation&&e.stopEvent(o),l.shouldCapture&&(u?a(n,d,!0):X(n,d))}function M(e,t){S(e,t)}function $(t,n){var o=t.getActivePointersListByType(s(n));o.getById(n.pointerId)&&S(t,n),e.stopEvent(n)}function S(n,o){var d={id:r(o),type:s(o),isPrimary:c(o),currentPos:i(o),currentTime:e.now()},l={originalEvent:o,eventType:"pointerup",pointerType:d.type,isEmulated:!1};t(n,l),j(n,l,d,o.button),l.preventDefault&&!l.defaultPrevented&&e.cancelEvent(o),l.stopPropagation&&e.stopEvent(o),l.shouldReleaseCapture&&(o.target===n.element?g(n,d):a(n,d,!1))}function A(e,t){f(e,t)}function K(t,n){var o=t.getActivePointersListByType(s(n));o.getById(n.pointerId)&&f(t,n),e.stopEvent(n)}function f(n,o){var l={id:r(o),type:s(o),isPrimary:c(o),currentPos:i(o),currentTime:e.now()},a={originalEvent:o,eventType:"pointermove",pointerType:l.type,isEmulated:!1};t(n,a),b(n,a,l),a.preventDefault&&!a.defaultPrevented&&e.cancelEvent(o),a.stopPropagation&&e.stopEvent(o)}function L(n,o){var a={id:o.pointerId,type:s(o)},i={originalEvent:o,eventType:"pointercancel",pointerType:a.type,isEmulated:!1};t(n,i),v(n,i,a),i.stopPropagation&&e.stopEvent(o)}function u(e,t){return t.speed=0,t.direction=0,t.contactPos=t.currentPos,t.contactTime=t.currentTime,t.lastPos=t.currentPos,t.lastTime=t.currentTime,e.add(t)}function l(t,n,s){var o,i=n.getById(s.id);return i?(i.captured&&(e.console.warn("stopTrackingPointer() called on captured pointer"),g(t,i)),n.removeContact(),o=n.removeById(s.id)):o=n.getLength(),o}function Q(e,t){switch(t.eventType){case"pointermove":t.isStoppable=!0,t.isCancelable=!0,t.preventDefault=!1,t.preventGesture=!e.hasGestureHandlers,t.stopPropagation=!1;break;case"pointerover":case"pointerout":case"contextmenu":case"keydown":case"keyup":case"keypress":t.isStoppable=!0,t.isCancelable=!0,t.preventDefault=!1,t.preventGesture=!1,t.stopPropagation=!1;break;case"pointerdown":t.isStoppable=!0,t.isCancelable=!0,t.preventDefault=!1,t.preventGesture=!e.hasGestureHandlers,t.stopPropagation=!1;break;case"pointerup":t.isStoppable=!0,t.isCancelable=!0,t.preventDefault=!1,t.preventGesture=!e.hasGestureHandlers,t.stopPropagation=!1;break;case"wheel":t.isStoppable=!0,t.isCancelable=!0,t.preventDefault=!1,t.preventGesture=!e.hasScrollHandler,t.stopPropagation=!1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":t.isStoppable=!0,t.isCancelable=!1,t.preventDefault=!1,t.preventGesture=!1,t.stopPropagation=!1;break;case"click":t.isStoppable=!0,t.isCancelable=!0,t.preventDefault=!!e.clickHandler,t.preventGesture=!1,t.stopPropagation=!1;break;case"dblclick":t.isStoppable=!0,t.isCancelable=!0,t.preventDefault=!!e.dblClickHandler,t.preventGesture=!1,t.stopPropagation=!1;break;case"focus":case"blur":case"pointerenter":case"pointerleave":default:t.isStoppable=!1,t.isCancelable=!1,t.preventDefault=!1,t.preventGesture=!1,t.stopPropagation=!1;break}}function t(t,n){n.eventSource=t,n.eventPhase=n.originalEvent&&typeof n.originalEvent.eventPhase<"u"?n.originalEvent.eventPhase:0,n.defaultPrevented=e.eventIsCanceled(n.originalEvent),n.shouldCapture=!1,n.shouldReleaseCapture=!1,n.userData=t.userData,Q(t,n),t.preProcessEventHandler&&t.preProcessEventHandler(n)}function a(t,n,s){var o=t.getActivePointersListByType(n.type),i=o.getById(n.id);i?s&&!i.captured?(i.captured=!0,o.captureCount++):!s&&i.captured&&(i.captured=!1,o.captureCount--,o.captureCount<0&&(o.captureCount=0,e.console.warn("updatePointerCaptured() - pointsList.captureCount went negative"))):e.console.warn("updatePointerCaptured() called on untracked pointer")}function w(e,t,s){var i=e.getActivePointersListByType(s.type),o=i.getById(s.id);o?(o.insideElement=!0,o.lastPos=o.currentPos,o.lastTime=o.currentTime,o.currentPos=s.currentPos,o.currentTime=s.currentTime,s=o):(s.captured=!1,s.insideElementPressed=!1,s.insideElement=!0,u(i,s)),e.enterHandler&&e.enterHandler({eventSource:e,pointerType:s.type,position:n(s.currentPos,e.element),buttons:i.buttons,pointers:e.getActivePointerCount(),insideElementPressed:s.insideElementPressed,buttonDownAny:i.buttons!==0,isTouchEvent:s.type==="touch",originalEvent:t.originalEvent,userData:e.userData})}function _(e,t,s){var a,i=e.getActivePointersListByType(s.type),o=i.getById(s.id);o?(o.captured?(o.insideElement=!1,o.lastPos=o.currentPos,o.lastTime=o.currentTime,o.currentPos=s.currentPos,o.currentTime=s.currentTime):l(e,i,o),s=o):(s.captured=!1,s.insideElementPressed=!1),(e.leaveHandler||e.exitHandler)&&(a={eventSource:e,pointerType:s.type,position:s.currentPos&&n(s.currentPos,e.element),buttons:i.buttons,pointers:e.getActivePointerCount(),insideElementPressed:s.insideElementPressed,buttonDownAny:i.buttons!==0,isTouchEvent:s.type==="touch",originalEvent:t.originalEvent,userData:e.userData},e.leaveHandler&&e.leaveHandler(a),e.exitHandler&&e.exitHandler(a))}function ne(e,t,s){var o=e.getActivePointersListByType(s.type),i=o.getById(s.id);i?s=i:(s.captured=!1,s.insideElementPressed=!1),e.overHandler&&e.overHandler({eventSource:e,pointerType:s.type,position:n(s.currentPos,e.element),buttons:o.buttons,pointers:e.getActivePointerCount(),insideElementPressed:s.insideElementPressed,buttonDownAny:o.buttons!==0,isTouchEvent:s.type==="touch",originalEvent:t.originalEvent,userData:e.userData})}function se(e,t,s){var o=e.getActivePointersListByType(s.type),i=o.getById(s.id);i?s=i:(s.captured=!1,s.insideElementPressed=!1),e.outHandler&&e.outHandler({eventSource:e,pointerType:s.type,position:s.currentPos&&n(s.currentPos,e.element),buttons:o.buttons,pointers:e.getActivePointerCount(),insideElementPressed:s.insideElementPressed,buttonDownAny:o.buttons!==0,isTouchEvent:s.type==="touch",originalEvent:t.originalEvent,userData:e.userData})}function y(t,s,i,a){var c,l=o[t.hash],r=t.getActivePointersListByType(i.type);if(typeof s.originalEvent.buttons<"u"?r.buttons=s.originalEvent.buttons:a===0?r.buttons|=1:a===1?r.buttons|=4:a===2?r.buttons|=2:a===3?r.buttons|=8:a===4?r.buttons|=16:a===5&&(r.buttons|=32),a!==0){s.shouldCapture=!1,s.shouldReleaseCapture=!1,t.nonPrimaryPressHandler&&!s.preventGesture&&!s.defaultPrevented&&(s.preventDefault=!0,t.nonPrimaryPressHandler({eventSource:t,pointerType:i.type,position:n(i.currentPos,t.element),button:a,buttons:r.buttons,isTouchEvent:i.type==="touch",originalEvent:s.originalEvent,userData:t.userData}));return}c=r.getById(i.id),c?(c.insideElementPressed=!0,c.insideElement=!0,c.originalTarget=s.originalEvent.target,c.contactPos=i.currentPos,c.contactTime=i.currentTime,c.lastPos=c.currentPos,c.lastTime=c.currentTime,c.currentPos=i.currentPos,c.currentTime=i.currentTime,i=c):(i.captured=!1,i.insideElementPressed=!0,i.insideElement=!0,i.originalTarget=s.originalEvent.target,u(r,i)),r.addContact(),!s.preventGesture&&!s.defaultPrevented?(s.shouldCapture=!0,s.shouldReleaseCapture=!1,s.preventDefault=!0,(t.dragHandler||t.dragEndHandler||t.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.addPoint(t,i),r.contacts===1?t.pressHandler&&!s.preventGesture&&t.pressHandler({eventSource:t,pointerType:i.type,position:n(i.contactPos,t.element),buttons:r.buttons,isTouchEvent:i.type==="touch",originalEvent:s.originalEvent,userData:t.userData}):r.contacts===2&&t.pinchHandler&&i.type==="touch"&&(l.pinchGPoints=r.asArray(),l.lastPinchDist=l.currentPinchDist=l.pinchGPoints[0].currentPos.distanceTo(l.pinchGPoints[1].currentPos),l.lastPinchCenter=l.currentPinchCenter=d(l.pinchGPoints[0].currentPos,l.pinchGPoints[1].currentPos))):(s.shouldCapture=!1,s.shouldReleaseCapture=!1)}function j(t,s,i,a){var r,m,f,p,h=o[t.hash],c=t.getActivePointersListByType(i.type),g=!1;if(typeof s.originalEvent.buttons<"u"?c.buttons=s.originalEvent.buttons:a===0?c.buttons^=-2:a===1?c.buttons^=-5:a===2?c.buttons^=-3:a===3?c.buttons^=-9:a===4?c.buttons^=-17:a===5&&(c.buttons^=-33),s.shouldCapture=!1,a!==0){s.shouldReleaseCapture=!1,t.nonPrimaryReleaseHandler&&!s.preventGesture&&!s.defaultPrevented&&(s.preventDefault=!0,t.nonPrimaryReleaseHandler({eventSource:t,pointerType:i.type,position:n(i.currentPos,t.element),button:a,buttons:c.buttons,isTouchEvent:i.type==="touch",originalEvent:s.originalEvent,userData:t.userData}));return}r=c.getById(i.id),r?(c.removeContact(),r.captured&&(g=!0),r.lastPos=r.currentPos,r.lastTime=r.currentTime,r.currentPos=i.currentPos,r.currentTime=i.currentTime,r.insideElement||l(t,c,r),m=r.currentPos,p=r.currentTime):(i.captured=!1,i.insideElementPressed=!1,i.insideElement=!0,u(c,i),r=i),!s.preventGesture&&!s.defaultPrevented&&(g?(s.shouldReleaseCapture=!0,s.preventDefault=!0,(t.dragHandler||t.dragEndHandler||t.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.removePoint(t,r),c.contacts===0?(t.releaseHandler&&m&&t.releaseHandler({eventSource:t,pointerType:r.type,position:n(m,t.element),buttons:c.buttons,insideElementPressed:r.insideElementPressed,insideElementReleased:r.insideElement,isTouchEvent:r.type==="touch",originalEvent:s.originalEvent,userData:t.userData}),t.dragEndHandler&&h.sentDragEvent&&t.dragEndHandler({eventSource:t,pointerType:r.type,position:n(r.currentPos,t.element),speed:r.speed,direction:r.direction,shift:s.originalEvent.shiftKey,isTouchEvent:r.type==="touch",originalEvent:s.originalEvent,userData:t.userData}),h.sentDragEvent=!1,(t.clickHandler||t.dblClickHandler)&&r.insideElement&&(f=p-r.contactTime<=t.clickTimeThreshold&&r.contactPos.distanceTo(m)<=t.clickDistThreshold,t.clickHandler&&t.clickHandler({eventSource:t,pointerType:r.type,position:n(r.currentPos,t.element),quick:f,shift:s.originalEvent.shiftKey,isTouchEvent:r.type==="touch",originalEvent:s.originalEvent,originalTarget:r.originalTarget,userData:t.userData}),t.dblClickHandler&&f&&(c.clicks++,c.clicks===1?(h.lastClickPos=m,h.dblClickTimeOut=setTimeout(function(){c.clicks=0},t.dblClickTimeThreshold)):c.clicks===2&&(clearTimeout(h.dblClickTimeOut),c.clicks=0,h.lastClickPos.distanceTo(m)<=t.dblClickDistThreshold&&t.dblClickHandler({eventSource:t,pointerType:r.type,position:n(r.currentPos,t.element),shift:s.originalEvent.shiftKey,isTouchEvent:r.type==="touch",originalEvent:s.originalEvent,userData:t.userData}),h.lastClickPos=null)))):c.contacts===2&&t.pinchHandler&&r.type==="touch"&&(h.pinchGPoints=c.asArray(),h.lastPinchDist=h.currentPinchDist=h.pinchGPoints[0].currentPos.distanceTo(h.pinchGPoints[1].currentPos),h.lastPinchCenter=h.currentPinchCenter=d(h.pinchGPoints[0].currentPos,h.pinchGPoints[1].currentPos))):(s.shouldReleaseCapture=!1,t.releaseHandler&&m&&(t.releaseHandler({eventSource:t,pointerType:r.type,position:n(m,t.element),buttons:c.buttons,insideElementPressed:r.insideElementPressed,insideElementReleased:r.insideElement,isTouchEvent:r.type==="touch",originalEvent:s.originalEvent,userData:t.userData}),s.preventDefault=!0)))}function b(e,t,s){var i,c,l,a=o[e.hash],r=e.getActivePointersListByType(s.type);if(typeof t.originalEvent.buttons<"u"&&(r.buttons=t.originalEvent.buttons),i=r.getById(s.id),i)i.lastPos=i.currentPos,i.lastTime=i.currentTime,i.currentPos=s.currentPos,i.currentTime=s.currentTime;else return;t.shouldCapture=!1,t.shouldReleaseCapture=!1,e.stopHandler&&s.type==="mouse"&&(clearTimeout(e.stopTimeOut),e.stopTimeOut=setTimeout(function(){ce(e,t.originalEvent,s.type)},e.stopDelay)),r.contacts===0?e.moveHandler&&e.moveHandler({eventSource:e,pointerType:s.type,position:n(s.currentPos,e.element),buttons:r.buttons,isTouchEvent:s.type==="touch",originalEvent:t.originalEvent,userData:e.userData}):r.contacts===1?(e.moveHandler&&(i=r.asArray()[0],e.moveHandler({eventSource:e,pointerType:i.type,position:n(i.currentPos,e.element),buttons:r.buttons,isTouchEvent:i.type==="touch",originalEvent:t.originalEvent,userData:e.userData})),e.dragHandler&&!t.preventGesture&&!t.defaultPrevented&&(i=r.asArray()[0],l=i.currentPos.minus(i.lastPos),e.dragHandler({eventSource:e,pointerType:i.type,position:n(i.currentPos,e.element),buttons:r.buttons,delta:l,speed:i.speed,direction:i.direction,shift:t.originalEvent.shiftKey,isTouchEvent:i.type==="touch",originalEvent:t.originalEvent,userData:e.userData}),t.preventDefault=!0,a.sentDragEvent=!0)):r.contacts===2&&(e.moveHandler&&(c=r.asArray(),e.moveHandler({eventSource:e,pointerType:c[0].type,position:n(d(c[0].currentPos,c[1].currentPos),e.element),buttons:r.buttons,isTouchEvent:c[0].type==="touch",originalEvent:t.originalEvent,userData:e.userData})),e.pinchHandler&&s.type==="touch"&&!t.preventGesture&&!t.defaultPrevented&&(l=a.pinchGPoints[0].currentPos.distanceTo(a.pinchGPoints[1].currentPos),l!==a.currentPinchDist&&(a.lastPinchDist=a.currentPinchDist,a.currentPinchDist=l,a.lastPinchCenter=a.currentPinchCenter,a.currentPinchCenter=d(a.pinchGPoints[0].currentPos,a.pinchGPoints[1].currentPos),e.pinchHandler({eventSource:e,pointerType:"touch",gesturePoints:a.pinchGPoints,lastCenter:n(a.lastPinchCenter,e.element),center:n(a.currentPinchCenter,e.element),lastDistance:a.lastPinchDist,distance:a.currentPinchDist,shift:t.originalEvent.shiftKey,originalEvent:t.originalEvent,userData:e.userData}),t.preventDefault=!0)))}function v(e,t,n){var s=e.getActivePointersListByType(n.type),o=s.getById(n.id);o&&l(e,s,o)}function ce(e,t,n){e.stopHandler&&e.stopHandler({eventSource:e,pointerType:n,position:z(t,e.element),buttons:e.getActivePointersListByType(n).buttons,isTouchEvent:n==="touch",originalEvent:t,userData:e.userData})}}(t),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},e.Control=function(t,n,s){var o=t.parentNode;typeof n=="number"&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),n={anchor:n}),n.attachToViewer=typeof n.attachToViewer>"u"||n.attachToViewer,this.autoFade=typeof n.autoFade>"u"||n.autoFade,this.element=t,this.anchor=n.anchor,this.container=s,this.anchor===e.ControlAnchor.ABSOLUTE?(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof n.top=="number"?n.top+"px":n.top,this.wrapper.style.left=typeof n.left=="number"?n.left+"px":n.left,this.wrapper.style.height=typeof n.height=="number"?n.height+"px":n.height,this.wrapper.style.width=typeof n.width=="number"?n.width+"px":n.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor===e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),n.attachToViewer?this.anchor===e.ControlAnchor.TOP_RIGHT||this.anchor===e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):o.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.anchor!==e.ControlAnchor.NONE&&this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!=="none"},setVisible:function(t){this.wrapper.style.display=t?this.anchor===e.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(t){e.setElementOpacity(this.wrapper,t,!0)}}}(t),function(e){e.ControlDock=function(t){var n,s,o=["topleft","topright","bottomright","bottomleft"];for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(Math.random()*1e6),container:e.makeNeutralElement("div"),controls:[]},t),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),e.getElementStyle(this.element).position==="static"&&(this.element.style.position="relative"),this.container.style.width="100%",this.container.style.height="100%"),s=0;s<o.length;s++)n=o[s],this.controls[n]=e.makeNeutralElement("div"),this.controls[n].style.position="absolute",n.match("left")&&(this.controls[n].style.left="0px"),n.match("right")&&(this.controls[n].style.right="0px"),n.match("top")&&(this.controls[n].style.top="0px"),n.match("bottom")&&(this.controls[n].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(n,s){n=e.getElement(n);var o=null;if(!(t(this,n)>=0)){switch(s.anchor){case e.ControlAnchor.TOP_RIGHT:o=this.controls.topright,n.style.position="relative",n.style.paddingRight="0px",n.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:o=this.controls.bottomright,n.style.position="relative",n.style.paddingRight="0px",n.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:o=this.controls.bottomleft,n.style.position="relative",n.style.paddingLeft="0px",n.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:o=this.controls.topleft,n.style.position="relative",n.style.paddingLeft="0px",n.style.paddingTop="0px";break;case e.ControlAnchor.ABSOLUTE:o=this.container,n.style.margin="0px",n.style.padding="0px";break;default:case e.ControlAnchor.NONE:o=this.container,n.style.margin="0px",n.style.padding="0px";break}this.controls.push(new e.Control(n,s,o)),n.style.display="inline-block"}},removeControl:function(n){n=e.getElement(n);var s=t(this,n);return s>=0&&(this.controls[s].destroy(),this.controls.splice(s,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var e;for(e=this.controls.length-1;e>=0;e--)if(this.controls[e].isVisible())return!0;return!1},setControlsEnabled:function(e){var t;for(t=this.controls.length-1;t>=0;t--)this.controls[t].setVisible(e);return this}};function t(e,t){var n,s=e.controls;for(n=s.length-1;n>=0;n--)if(s[n].element===t)return n;return-1}}(t),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(t),function(e){var n={},V=1;e.Viewer=function(t){var a,i=arguments,s=this;e.isPlainObject(t)||(t={id:i[0],xmlPath:i.length>1?i[1]:0[0],prefixUrl:i.length>2?i[2]:0[0],controls:i.length>3?i[3]:0[0],overlays:i.length>4?i[4]:0[0]}),t.config&&(e.extend(!0,t,t.config),delete t.config);let d=["useCanvas"];if(t.drawerOptions=Object.assign({},d.reduce((e,n)=>(e[n]=t[n],delete t[n],e),{}),t.drawerOptions),e.extend(!0,this,{id:t.id,hash:t.hash||V++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttonGroup:null,profiler:null},e.DEFAULT_SETTINGS,t),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");typeof n[this.hash]<"u"&&e.console.warn("Hash "+this.hash+" has already been used."),n[this.hash]={fsBoundsDelta:new e.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,needsResize:!1,forceResize:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null,lastClickTime:null,draggingToZoom:!1},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._updatePixelDensityRatioBind=null,this._lastScrollTime=e.now(),e.EventSource.call(this),this.addHandler("open-failed",function(t){var n=e.getString("Errors.OpenFailed",t.eventSource,t.message);s._showMessage(n)}),e.ControlDock.call(this,t),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=e.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(e){e.width="100%",e.height="100%",e.overflow="hidden",e.position="absolute",e.top="0px",e.left="0px"}(this.canvas.style),e.setElementTouchActionNone(this.canvas),t.tabIndex!==""&&(this.canvas.tabIndex=t.tabIndex===0[0]?0:t.tabIndex),this.container.className="openseadragon-container",function(e){e.width="100%",e.height="100%",e.position="relative",e.overflow="hidden",e.left="0px",e.top="0px",e.textAlign="left"}(this.container.style),e.setElementTouchActionNone(this.container),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new e.MouseTracker({userData:"Viewer.innerTracker",element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,contextMenuHandler:e.delegate(this,z),keyDownHandler:e.delegate(this,T),keyHandler:e.delegate(this,E),clickHandler:e.delegate(this,D),dblClickHandler:e.delegate(this,j),dragHandler:e.delegate(this,y),dragEndHandler:e.delegate(this,_),enterHandler:e.delegate(this,w),leaveHandler:e.delegate(this,O),pressHandler:e.delegate(this,x),releaseHandler:e.delegate(this,C),nonPrimaryPressHandler:e.delegate(this,v),nonPrimaryReleaseHandler:e.delegate(this,k),scrollHandler:e.delegate(this,F),pinchHandler:e.delegate(this,A),focusHandler:e.delegate(this,S),blurHandler:e.delegate(this,M)}),this.outerTracker=new e.MouseTracker({userData:"Viewer.outerTracker",element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:e.delegate(this,g),leaveHandler:e.delegate(this,p)}),this.toolbar&&(this.toolbar=new e.ControlDock({element:this.toolbar})),this.bindStandardControls(),n[this.hash].prevContainerSize=c(this.container),window.ResizeObserver?(this._autoResizePolling=!1,this._resizeObserver=new ResizeObserver(function(){n[s.hash].needsResize=!0}),this._resizeObserver.observe(this.container,{})):this._autoResizePolling=!0,this.world=new e.World({viewer:this}),this.world.addHandler("add-item",function(){s.source=s.world.getItemAt(0).source,n[s.hash].forceRedraw=!0,s._updateRequestId||(s._updateRequestId=l(s,u))}),this.world.addHandler("remove-item",function(){s.world.getItemCount()?s.source=s.world.getItemAt(0).source:s.source=null,n[s.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(){s.viewport&&s.viewport._setContentBounds(s.world.getHomeBounds(),s.world.getContentFactor())}),this.world.addHandler("item-index-change",function(){s.source=s.world.getItemAt(0).source}),this.viewport=new e.Viewport({containerSize:n[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,overlayPreserveContentDirection:this.overlayPreserveContentDirection,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins,silenceMultiImageWarnings:this.silenceMultiImageWarnings}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new e.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:t.timeout,tileRetryMax:this.tileRetryMax,tileRetryDelay:this.tileRetryDelay}),this.tileCache=new e.TileCache({maxImageCacheCount:this.maxImageCacheCount}),Object.prototype.hasOwnProperty.call(this.drawerOptions,"useCanvas")&&(e.console.error('useCanvas is deprecated, use the "drawer" option to indicate preferred drawer(s)'),this.drawerOptions.useCanvas||(this.drawer=e.HTMLDrawer),delete this.drawerOptions.useCanvas);let r=Array.isArray(this.drawer)?this.drawer:[this.drawer];r.length===0&&(r=[e.DEFAULT_SETTINGS.drawer].flat(),e.console.warn("No valid drawers were selected. Using the default value.")),this.drawer=null;for(const e of r)if(this.requestDrawer(e,{mainDrawer:!0,redrawImmediately:!1}))break;if(!this.drawer)throw e.console.error("No drawer could be created!"),"Error with creating the selected drawer(s)";for(this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled),this.overlaysContainer=e.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(a=this.buttonGroup.buttons.indexOf(this.rotateLeft),this.buttonGroup.buttons.splice(a,1),this.buttonGroup.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(a=this.buttonGroup.buttons.indexOf(this.rotateRight),this.buttonGroup.buttons.splice(a,1),this.buttonGroup.element.removeChild(this.rotateRight.element))),this._addUpdatePixelDensityRatioEvent(),this.showNavigator&&(this.navigator=new e.Navigator({element:this.navigatorElement,id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy,animationTime:this.animationTime,drawer:this.drawer.getType(),loadTilesWithAjax:this.loadTilesWithAjax,ajaxHeaders:this.ajaxHeaders,ajaxWithCredentials:this.ajaxWithCredentials})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),a=0;a<this.customControls.length;a++)this.addControl(this.customControls[a].id,{anchor:this.customControls[a].anchor});e.requestAnimationFrame(function(){o(s)}),e._viewers.set(this.element,this)},e.extend(e.Viewer.prototype,e.EventSource.prototype,e.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(t){return e.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(t)},openTileSource:function(t){return e.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(t)},get buttons(){return e.console.warn("Viewer.buttons is deprecated; Please use Viewer.buttonGroup"),this.buttonGroup},open:function(t,n){if(s=this,this.close(),!t)return this;if(this.sequenceMode&&e.isArray(t))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof n<"u"&&!isNaN(n)&&(this.initialPage=n),this.tileSources=t,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex),this;if(e.isArray(t)||(t=[t]),!t.length)return this;this._opening=!0;for(var s,i,l=t.length,o=0,r=0,c=function(){if(o+r===l)if(o){(s._firstOpen||!s.preserveViewport)&&(s.viewport.goHome(!0),s.viewport.update()),s._firstOpen=!1;var e,n=t[0];if(n.tileSource&&(n=n.tileSource),s.overlays&&!s.preserveOverlays)for(e=0;e<s.overlays.length;e++)s.currentOverlays[e]=h(s,s.overlays[e]);s._drawOverlays(),s._opening=!1,s.raiseEvent("open",{source:n})}else s._opening=!1,s.raiseEvent("open-failed",i)},d=function(t){(!e.isPlainObject(t)||!t.tileSource)&&(t={tileSource:t}),t.index!==0[0]&&(e.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete t.index),t.collectionImmediately===0[0]&&(t.collectionImmediately=!0);var n,a=t.success;t.success=function(e){if(o++,t.tileSource.overlays)for(var n=0;n<t.tileSource.overlays.length;n++)s.addOverlay(t.tileSource.overlays[n]);a&&a(e),c()},n=t.error,t.error=function(e){r++,i||(i=e),n&&n(e),c()},s.addTiledImage(t)},a=0;a<t.length;a++)d(t[a]);return this},close:function(){return n[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),n[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(n[this.hash]){if(this.raiseEvent("before-destroy"),this._removeUpdatePixelDensityRatioEvent(),this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this._resizeObserver&&this._resizeObserver.disconnect(),this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(e.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.navigator&&(this.navigator.destroy(),n[this.navigator.hash]=null,delete n[this.navigator.hash],this.navigator=null),this.buttonGroup)this.buttonGroup.destroy();else if(this.customButtons)for(;this.customButtons.length;)this.customButtons.pop().destroy();if(this.paging&&this.paging.destroy(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.container.onsubmit=null,this.clearControls(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),n[this.hash]=null,delete n[this.hash],this.canvas=null,this.container=null,e._viewers.delete(this.element),this.element=null,this.raiseEvent("destroy"),this.removeAllHandlers()}},requestDrawer(t,n){const a={mainDrawer:!0,redrawImmediately:!0,drawerOptions:null};n=e.extend(!0,a,n);const o=n.mainDrawer,r=n.redrawImmediately,c=n.drawerOptions,i=this.drawer;let s=null;if(t&&t.prototype instanceof e.DrawerBase?(s=t,t="custom"):typeof t=="string"&&(s=e.determineDrawer(t)),s||e.console.warn("Unsupported drawer! Drawer must be an existing string type, or a class that extends OpenSeadragon.DrawerBase."),s&&s.isSupported()){i&&o&&i.destroy();const e=new s({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor,options:c||this.drawerOptions[t]});return o&&(this.drawer=e,r&&this.forceRedraw()),e}return!1},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(e){return this.innerTracker.setTracking(e),this.outerTracker.setTracking(e),this.raiseEvent("mouse-enabled",{enabled:e}),this},areControlsEnabled:function(){var e,t=this.controls.length;for(e=0;e<this.controls.length;e++)t=t&&this.controls[e].isVisible();return t},setControlsEnabled:function(e){return e?i(this):o(this),this.raiseEvent("controls-enabled",{enabled:e}),this},setDebugMode:function(e){for(var t=0;t<this.world.getItemCount();t++)this.world.getItemAt(t).debugMode=e;this.debugMode=e,this.forceRedraw()},setAjaxHeaders:function(t,n){if(t===null&&(t={}),!e.isPlainObject(t)){console.error("[Viewer.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}if(n===0[0]&&(n=!0),this.ajaxHeaders=t,n){for(var o,s=0;s<this.world.getItemCount();s++)this.world.getItemAt(s)._updateAjaxHeaders(!0);if(this.navigator&&this.navigator.setAjaxHeaders(this.ajaxHeaders,!0),this.referenceStrip&&this.referenceStrip.miniViewers)for(o in this.referenceStrip.miniViewers)this.referenceStrip.miniViewers[o].setAjaxHeaders(this.ajaxHeaders,!0)}},addButton:function(e){this.buttonGroup.addButton(e)},isFullPage:function(){return n[this.hash]&&n[this.hash].fullPage},setFullPage:function(t){var a,r,l,d,u,i=document.body,s=i.style,o=document.documentElement.style,c=this;if(t===this.isFullPage())return this;if(l={fullPage:t,preventDefaultAction:!1},this.raiseEvent("pre-full-page",l),l.preventDefaultAction)return this;if(t&&this.element){for(this.elementSize=e.getElementSize(this.element),this.pageScroll=e.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=s.margin,this.docMargin=o.margin,s.margin="0",o.margin="0",this.bodyPadding=s.padding,this.docPadding=o.padding,s.padding="0",o.padding="0",this.bodyWidth=s.width,this.docWidth=o.width,s.width="100%",o.width="100%",this.bodyHeight=s.height,this.docHeight=o.height,s.height="100%",o.height="100%",this.bodyDisplay=s.display,s.display="block",this.previousBody=[],n[this.hash].prevElementParent=this.element.parentNode,n[this.hash].prevNextSibling=this.element.nextSibling,n[this.hash].prevElementWidth=this.element.style.width,n[this.hash].prevElementHeight=this.element.style.height,r=i.childNodes.length,a=0;a<r;a++)this.previousBody.push(i.childNodes[0]),i.removeChild(i.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,i.appendChild(this.toolbar.element),e.addClass(this.toolbar.element,"fullpage")),e.addClass(this.element,"fullpage"),i.appendChild(this.element),this.element.style.height="100vh",this.element.style.width="100vw",this.toolbar&&this.toolbar.element&&(this.element.style.height=e.getElementSize(this.element).y-e.getElementSize(this.toolbar.element).y+"px"),n[this.hash].fullPage=!0,e.delegate(this,g)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,s.margin=this.bodyMargin,o.margin=this.docMargin,s.padding=this.bodyPadding,o.padding=this.docPadding,s.width=this.bodyWidth,o.width=this.docWidth,s.height=this.bodyHeight,o.height=this.docHeight,s.display=this.bodyDisplay,i.removeChild(this.element),r=this.previousBody.length,a=0;a<r;a++)i.appendChild(this.previousBody.shift());e.removeClass(this.element,"fullpage"),n[this.hash].prevElementParent.insertBefore(this.element,n[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(i.removeChild(this.toolbar.element),e.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=n[this.hash].prevElementWidth,this.element.style.height=n[this.hash].prevElementHeight,d=0,u=function(){e.setPageScroll(c.pageScroll);var t=e.getPageScroll();d++,d<10&&(t.x!==c.pageScroll.x||t.y!==c.pageScroll.y)&&e.requestAnimationFrame(u)},e.requestAnimationFrame(u),n[this.hash].fullPage=!1,e.delegate(this,p)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:t}),this},setFullScreen:function(t){var s,o,n=this;if(!e.supportsFullScreen)return this.setFullPage(t);if(e.isFullScreen()===t)return this;if(o={fullScreen:t,preventDefaultAction:!1},this.raiseEvent("pre-full-screen",o),o.preventDefaultAction)return this;if(t){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%",s=function(){var t=e.isFullScreen();t||(e.removeEvent(document,e.fullScreenEventName,s),e.removeEvent(document,e.fullScreenErrorEventName,s),n.setFullPage(!1),n.isFullPage()&&(n.element.style.width=n.fullPageStyleWidth,n.element.style.height=n.fullPageStyleHeight)),n.navigator&&n.viewport&&setTimeout(function(){n.navigator.update(n.viewport)}),n.raiseEvent("full-screen",{fullScreen:t})},e.addEvent(document,e.fullScreenEventName,s),e.addEvent(document,e.fullScreenErrorEventName,s),e.requestFullScreen(document.body)}else e.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!=="hidden"},isFullScreen:function(){return e.isFullScreen()&&this.isFullPage()},setVisible:function(e){return this.container.style.visibility=e?"":"hidden",this.raiseEvent("visible",{visible:e}),this},addTiledImage:function(t){e.console.assert(t,"[Viewer.addTiledImage] options is required"),e.console.assert(t.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),e.console.assert(!t.replace||t.index>-1&&t.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var s,n=this;t.replace&&(t.replaceItem=n.world.getItemAt(t.index)),this._hideMessage(),t.placeholderFillStyle===0[0]&&(t.placeholderFillStyle=this.placeholderFillStyle),t.opacity===0[0]&&(t.opacity=this.opacity),t.preload===0[0]&&(t.preload=this.preload),t.compositeOperation===0[0]&&(t.compositeOperation=this.compositeOperation),t.crossOriginPolicy===0[0]&&(t.crossOriginPolicy=t.tileSource.crossOriginPolicy!==0[0]?t.tileSource.crossOriginPolicy:this.crossOriginPolicy),t.ajaxWithCredentials===0[0]&&(t.ajaxWithCredentials=this.ajaxWithCredentials),t.loadTilesWithAjax===0[0]&&(t.loadTilesWithAjax=this.loadTilesWithAjax),e.isPlainObject(t.ajaxHeaders)||(t.ajaxHeaders={}),s={options:t};function o(e){for(var o=0;o<n._loadQueue.length;o++)if(n._loadQueue[o]===s){n._loadQueue.splice(o,1);break}n._loadQueue.length===0&&i(s),n.raiseEvent("add-item-failed",e),t.error&&t.error(e)}function i(e){n.collectionMode&&(n.world.arrange({immediately:e.options.collectionImmediately,rows:n.collectionRows,columns:n.collectionColumns,layout:n.collectionLayout,tileSize:n.collectionTileSize,tileMargin:n.collectionTileMargin}),n.world.setAutoRefigureSizes(!0))}if(e.isArray(t.tileSource)){setTimeout(function(){o({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:t.tileSource,options:t})});return}this._loadQueue.push(s);function a(){for(;n._loadQueue.length&&(t=n._loadQueue[0],!!t.tileSource);){if(n._loadQueue.splice(0,1),t.options.replace){var t,s,o,a=n.world.getIndexOfItem(t.options.replaceItem);a!==-1&&(t.options.index=a),n.world.removeItem(t.options.replaceItem)}s=new e.TiledImage({viewer:n,source:t.tileSource,viewport:n.viewport,drawer:n.drawer,tileCache:n.tileCache,imageLoader:n.imageLoader,x:t.options.x,y:t.options.y,width:t.options.width,height:t.options.height,fitBounds:t.options.fitBounds,fitBoundsPlacement:t.options.fitBoundsPlacement,clip:t.options.clip,placeholderFillStyle:t.options.placeholderFillStyle,opacity:t.options.opacity,preload:t.options.preload,degrees:t.options.degrees,flipped:t.options.flipped,compositeOperation:t.options.compositeOperation,springStiffness:n.springStiffness,animationTime:n.animationTime,minZoomImageRatio:n.minZoomImageRatio,wrapHorizontal:n.wrapHorizontal,wrapVertical:n.wrapVertical,maxTilesPerFrame:n.maxTilesPerFrame,immediateRender:n.immediateRender,blendTime:n.blendTime,alwaysBlend:n.alwaysBlend,minPixelRatio:n.minPixelRatio,smoothTileEdgesMinZoom:n.smoothTileEdgesMinZoom,iOSDevice:n.iOSDevice,crossOriginPolicy:t.options.crossOriginPolicy,ajaxWithCredentials:t.options.ajaxWithCredentials,loadTilesWithAjax:t.options.loadTilesWithAjax,ajaxHeaders:t.options.ajaxHeaders,debugMode:n.debugMode,subPixelRoundingForTransparency:n.subPixelRoundingForTransparency}),n.collectionMode&&n.world.setAutoRefigureSizes(!1),n.navigator&&(o=e.extend({},t.options,{replace:!1,originalTiledImage:s,tileSource:t.tileSource}),n.navigator.addTiledImage(o)),n.world.addItem(s,{index:t.options.index}),n._loadQueue.length===0&&i(t),n.world.getItemCount()===1&&!n.preserveViewport&&n.viewport.goHome(!0),t.options.success&&t.options.success({item:s})}}P(this,t.tileSource,t,function(e){s.tileSource=e,a()},function(e){e.options=t,o(e),a()})},addSimpleImage:function(t){e.console.assert(t,"[Viewer.addSimpleImage] options is required"),e.console.assert(t.url,"[Viewer.addSimpleImage] options.url is required");var n=e.extend({},t,{tileSource:{type:"image",url:t.url}});delete n.url,this.addTiledImage(n)},addLayer:function(t){var s,n=this;return e.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead."),s=e.extend({},t,{success:function(e){n.raiseEvent("add-layer",{options:t,drawer:e.item})},error:function(e){n.raiseEvent("add-layer-failed",e)}}),this.addTiledImage(s),this},getLayerAtLevel:function(t){return e.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(t)},getLevelOfLayer:function(t){return e.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(t)},getLayersCount:function(){return e.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(t,n){return e.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(t,n)},removeLayer:function(t){return e.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(t)},forceRedraw:function(){return n[this.hash].forceRedraw=!0,this},forceResize:function(){n[this.hash].needsResize=!0,n[this.hash].forceResize=!0},bindSequenceControls:function(){var n=e.delegate(this,m),o=e.delegate(this,f),a=e.delegate(this,this.goToNextPage),r=e.delegate(this,this.goToPreviousPage),t=this.navImages,i=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(i=!1),this.previousButton=new e.Button({element:this.previousButton?e.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.PreviousPage"),srcRest:s(this.prefixUrl,t.previous.REST),srcGroup:s(this.prefixUrl,t.previous.GROUP),srcHover:s(this.prefixUrl,t.previous.HOVER),srcDown:s(this.prefixUrl,t.previous.DOWN),onRelease:r,onFocus:n,onBlur:o}),this.nextButton=new e.Button({element:this.nextButton?e.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.NextPage"),srcRest:s(this.prefixUrl,t.next.REST),srcGroup:s(this.prefixUrl,t.next.GROUP),srcHover:s(this.prefixUrl,t.next.HOVER),srcDown:s(this.prefixUrl,t.next.DOWN),onRelease:a,onFocus:n,onBlur:o}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),i&&(this.paging=new e.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:e.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var l=e.delegate(this,H),a=e.delegate(this,B),b=e.delegate(this,W),c=e.delegate(this,I),v=e.delegate(this,U),g=e.delegate(this,q),d=e.delegate(this,Y),p=e.delegate(this,G),h=e.delegate(this,X),u=e.delegate(this,Q),o=e.delegate(this,m),i=e.delegate(this,f),t=this.navImages,n=[],r=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(r=!1),this.showZoomControl&&(n.push(this.zoomInButton=new e.Button({element:this.zoomInButton?e.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomIn"),srcRest:s(this.prefixUrl,t.zoomIn.REST),srcGroup:s(this.prefixUrl,t.zoomIn.GROUP),srcHover:s(this.prefixUrl,t.zoomIn.HOVER),srcDown:s(this.prefixUrl,t.zoomIn.DOWN),onPress:l,onRelease:a,onClick:b,onEnter:l,onExit:a,onFocus:o,onBlur:i})),n.push(this.zoomOutButton=new e.Button({element:this.zoomOutButton?e.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomOut"),srcRest:s(this.prefixUrl,t.zoomOut.REST),srcGroup:s(this.prefixUrl,t.zoomOut.GROUP),srcHover:s(this.prefixUrl,t.zoomOut.HOVER),srcDown:s(this.prefixUrl,t.zoomOut.DOWN),onPress:c,onRelease:a,onClick:v,onEnter:c,onExit:a,onFocus:o,onBlur:i}))),this.showHomeControl&&n.push(this.homeButton=new e.Button({element:this.homeButton?e.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Home"),srcRest:s(this.prefixUrl,t.home.REST),srcGroup:s(this.prefixUrl,t.home.GROUP),srcHover:s(this.prefixUrl,t.home.HOVER),srcDown:s(this.prefixUrl,t.home.DOWN),onRelease:g,onFocus:o,onBlur:i})),this.showFullPageControl&&n.push(this.fullPageButton=new e.Button({element:this.fullPageButton?e.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.FullPage"),srcRest:s(this.prefixUrl,t.fullpage.REST),srcGroup:s(this.prefixUrl,t.fullpage.GROUP),srcHover:s(this.prefixUrl,t.fullpage.HOVER),srcDown:s(this.prefixUrl,t.fullpage.DOWN),onRelease:d,onFocus:o,onBlur:i})),this.showRotationControl&&(n.push(this.rotateLeftButton=new e.Button({element:this.rotateLeftButton?e.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateLeft"),srcRest:s(this.prefixUrl,t.rotateleft.REST),srcGroup:s(this.prefixUrl,t.rotateleft.GROUP),srcHover:s(this.prefixUrl,t.rotateleft.HOVER),srcDown:s(this.prefixUrl,t.rotateleft.DOWN),onRelease:p,onFocus:o,onBlur:i})),n.push(this.rotateRightButton=new e.Button({element:this.rotateRightButton?e.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateRight"),srcRest:s(this.prefixUrl,t.rotateright.REST),srcGroup:s(this.prefixUrl,t.rotateright.GROUP),srcHover:s(this.prefixUrl,t.rotateright.HOVER),srcDown:s(this.prefixUrl,t.rotateright.DOWN),onRelease:h,onFocus:o,onBlur:i}))),this.showFlipControl&&n.push(this.flipButton=new e.Button({element:this.flipButton?e.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Flip"),srcRest:s(this.prefixUrl,t.flip.REST),srcGroup:s(this.prefixUrl,t.flip.GROUP),srcHover:s(this.prefixUrl,t.flip.HOVER),srcDown:s(this.prefixUrl,t.flip.DOWN),onRelease:u,onFocus:o,onBlur:i})),r?(this.buttonGroup=new e.ButtonGroup({buttons:n,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttonGroup.element,this.addHandler("open",e.delegate(this,K)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT})):this.customButtons=n),this},currentPage:function(){return this._sequenceIndex},goToPage:function(e){return this.tileSources&&e>=0&&e<this.tileSources.length&&(this._sequenceIndex=e,this._updateSequenceButtons(e),this.open(this.tileSources[e]),this.referenceStrip&&this.referenceStrip.setFocus(e),this.raiseEvent("page",{page:e})),this},addOverlay:function(t,n,s,o){if(e.isPlainObject(t)?i=t:i={element:t,location:n,placement:s,onDraw:o},t=e.getElement(i.element),a(this.currentOverlays,t)>=0)return this;var i,r=h(this,i);return this.currentOverlays.push(r),r.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:t,location:i.location,placement:i.placement}),this},updateOverlay:function(t,s,o){var i;return t=e.getElement(t),i=a(this.currentOverlays,t),i>=0&&(this.currentOverlays[i].update(s,o),n[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:t,location:s,placement:o})),this},removeOverlay:function(t){var s;return t=e.getElement(t),s=a(this.currentOverlays,t),s>=0&&(this.currentOverlays[s].destroy(),this.currentOverlays.splice(s,1),n[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:t})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return n[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(t){var n;return t=e.getElement(t),n=a(this.currentOverlays,t),n>=0?this.currentOverlays[n]:null},_updateSequenceButtons:function(e){this.nextButton&&(!this.tileSources||this.tileSources.length-1===e?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(e>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(t){this._hideMessage();var n=e.makeNeutralElement("div");n.appendChild(document.createTextNode(t)),this.messageDiv=e.makeCenteredNode(n),e.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var e=this.messageDiv;e&&(e.parentNode.removeChild(e),delete this.messageDiv)},gestureSettingsByDeviceType:function(e){switch(e){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var e,t=this.currentOverlays.length;for(e=0;e<t;e++)this.currentOverlays[e].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new e.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else e.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')},_addUpdatePixelDensityRatioEvent:function(){this._updatePixelDensityRatioBind=this._updatePixelDensityRatio.bind(this),e.addEvent(window,"resize",this._updatePixelDensityRatioBind)},_removeUpdatePixelDensityRatioEvent:function(){e.removeEvent(window,"resize",this._updatePixelDensityRatioBind)},_updatePixelDensityRatio:function(){var n=e.pixelDensityRatio,t=e.getCurrentPixelDensityRatio();n!==t&&(e.pixelDensityRatio=t,this.forceResize())},goToPreviousPage:function(){var e=this._sequenceIndex-1;this.navPrevNextWrap&&e<0&&(e+=this.tileSources.length),this.goToPage(e)},goToNextPage:function(){var e=this._sequenceIndex+1;this.navPrevNextWrap&&e>=this.tileSources.length&&(e=0),this.goToPage(e)},isAnimating:function(){return n[this.hash].animating}});function c(t){return t=e.getElement(t),new e.Point(t.clientWidth===0?1:t.clientWidth,t.clientHeight===0?1:t.clientHeight)}function P(t,n,s,o,i){var r,a=t;if(e.type(n)==="string")if(n.match(/^\s*<.*>\s*$/))n=e.parseXml(n);else if(n.match(/^\s*[{[].*[}\]]\s*$/))try{r=e.parseJSON(n),n=r}catch{}function c(e,t){e.ready?o(e):(e.addHandler("ready",function(){o(e)}),e.addHandler("open-failed",function(e){i({message:e.message,source:t})}))}setTimeout(function(){if(e.type(n)==="string")n=new e.TileSource({url:n,crossOriginPolicy:s.crossOriginPolicy!==0[0]?s.crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,ajaxHeaders:s.ajaxHeaders?s.ajaxHeaders:t.ajaxHeaders,splitHashDataForPost:t.splitHashDataForPost,success:function(e){o(e.tileSource)}}),n.addHandler("open-failed",function(e){i(e)});else if(e.isPlainObject(n)||n.nodeType)if(n.crossOriginPolicy===0[0]&&(s.crossOriginPolicy!==0[0]||t.crossOriginPolicy!==0[0])&&(n.crossOriginPolicy=s.crossOriginPolicy!==0[0]?s.crossOriginPolicy:t.crossOriginPolicy),n.ajaxWithCredentials===0[0]&&(n.ajaxWithCredentials=t.ajaxWithCredentials),e.isFunction(n.getTileUrl)){var r,d,l=new e.TileSource(n);l.getTileUrl=n.getTileUrl,o(l)}else{if(r=e.TileSource.determineType(a,n),!r){i({message:"Unable to load TileSource",source:n});return}d=r.prototype.configure.apply(a,[n]),c(new r(d),n)}else c(n,n)})}function h(t,n){if(n instanceof e.Overlay)return n;s=null,n.element?s=e.getElement(n.element):(c=n.id?n.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7),s=e.getElement(n.id),s||(s=document.createElement("a"),s.href="#/overlay/"+c),s.id=c,e.addClass(s,n.className?n.className:"openseadragon-overlay"));var s,o,i,c,d,u,l=n.location,a=n.width,r=n.height;return l||(d=n.x,u=n.y,n.px!==0[0]&&(o=t.viewport.imageToViewportRectangle(new e.Rect(n.px,n.py,a||0,r||0)),d=o.x,u=o.y,a=a!==0[0]?o.width:0[0],r=r!==0[0]?o.height:0[0]),l=new e.Point(d,u)),i=n.placement,i&&e.type(i)==="string"&&(i=e.Placement[n.placement.toUpperCase()]),new e.Overlay({element:s,location:l,placement:i,onDraw:n.onDraw,checkResize:n.checkResize,width:a,height:r,rotationMode:n.rotationMode})}function a(e,t){var n;for(n=e.length-1;n>=0;n--)if(e[n].element===t)return n;return-1}function l(t,n){return e.requestAnimationFrame(function(){n(t)})}function d(t){e.requestAnimationFrame(function(){b(t)})}function o(t){t.autoHideControls&&(t.controlsShouldFade=!0,t.controlsFadeBeginTime=e.now()+t.controlsFadeDelay,window.setTimeout(function(){d(t)},t.controlsFadeDelay))}function b(t){var n,s,o,i;if(t.controlsShouldFade){for(o=e.now(),i=o-t.controlsFadeBeginTime,n=1-i/t.controlsFadeLength,n=Math.min(1,n),n=Math.max(0,n),s=t.controls.length-1;s>=0;s--)t.controls[s].autoFade&&t.controls[s].setOpacity(n);n>0&&d(t)}}function i(e){var t;for(e.controlsShouldFade=!1,t=e.controls.length-1;t>=0;t--)e.controls[t].setOpacity(1)}function m(){i(this)}function f(){o(this)}function z(e){var t={tracker:e.eventSource,position:e.position,originalEvent:e.originalEvent,preventDefault:e.preventDefault};this.raiseEvent("canvas-contextmenu",t),e.preventDefault=t.preventDefault}function T(t){var n={originalEvent:t.originalEvent,preventDefaultAction:!1,preventVerticalPan:t.preventVerticalPan||!this.panVertical,preventHorizontalPan:t.preventHorizontalPan||!this.panHorizontal};if(this.raiseEvent("canvas-key",n),!n.preventDefaultAction&&!t.ctrl&&!t.alt&&!t.meta)switch(t.keyCode){case 38:n.preventVerticalPan||(t.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),t.preventDefault=!0;break;case 40:n.preventVerticalPan||(t.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),t.preventDefault=!0;break;case 37:n.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),t.preventDefault=!0;break;case 39:n.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),t.preventDefault=!0;break;case 187:this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),t.preventDefault=!0;break;case 189:this.viewport.zoomBy(.9),this.viewport.applyConstraints(),t.preventDefault=!0;break;case 48:this.viewport.goHome(),this.viewport.applyConstraints(),t.preventDefault=!0;break;case 87:n.preventVerticalPan||(t.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-40))),this.viewport.applyConstraints()),t.preventDefault=!0;break;case 83:n.preventVerticalPan||(t.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,40))),this.viewport.applyConstraints()),t.preventDefault=!0;break;case 65:n.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-40,0))),this.viewport.applyConstraints()),t.preventDefault=!0;break;case 68:n.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(40,0))),this.viewport.applyConstraints()),t.preventDefault=!0;break;case 82:t.shift?this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.flipped?this.viewport.setRotation(this.viewport.getRotation()-this.rotationIncrement):this.viewport.setRotation(this.viewport.getRotation()+this.rotationIncrement),this.viewport.applyConstraints(),t.preventDefault=!0;break;case 70:this.viewport.toggleFlip(),t.preventDefault=!0;break;case 74:this.goToPreviousPage();break;case 75:this.goToNextPage();break;default:t.preventDefault=!1;break}else t.preventDefault=!1}function E(e){var t={originalEvent:e.originalEvent};this.raiseEvent("canvas-key-press",t)}function D(t){var s,o,i=document.activeElement===this.canvas;i||this.canvas.focus(),this.viewport.flipped&&(t.position.x=this.viewport.getContainerSize().x-t.position.x),o={tracker:t.eventSource,position:t.position,quick:t.quick,shift:t.shift,originalEvent:t.originalEvent,originalTarget:t.originalTarget,preventDefaultAction:!1},this.raiseEvent("canvas-click",o),!o.preventDefaultAction&&this.viewport&&t.quick&&(s=this.gestureSettingsByDeviceType(t.pointerType),s.clickToZoom===!0&&(this.viewport.zoomBy(t.shift?1/this.zoomPerClick:this.zoomPerClick,s.zoomToRefPoint?this.viewport.pointFromPixel(t.position,!0):null),this.viewport.applyConstraints()),s.dblClickDragToZoom&&(n[this.hash].draggingToZoom===!0?(n[this.hash].lastClickTime=null,n[this.hash].draggingToZoom=!1):n[this.hash].lastClickTime=e.now()))}function j(e){var t,n={tracker:e.eventSource,position:e.position,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-double-click",n),!n.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType),t.dblClickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()))}function y(e){var t,s,o,a,i={tracker:e.eventSource,pointerType:e.pointerType,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.raiseEvent("canvas-drag",i),s=this.gestureSettingsByDeviceType(e.pointerType),!i.preventDefaultAction&&this.viewport&&(s.dblClickDragToZoom&&n[this.hash].draggingToZoom?(a=this.zoomPerDblClickDrag**(e.delta.y/50),this.viewport.zoomBy(a)):s.dragToPan&&!n[this.hash].draggingToZoom&&((this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewport.flipped&&(e.delta.x=-e.delta.x),this.constrainDuringPan)&&(t=this.viewport.deltaPointsFromPixels(e.delta.negate()),this.viewport.centerSpringX.target.value+=t.x,this.viewport.centerSpringY.target.value+=t.y,o=this.viewport.getConstrainedBounds(),this.viewport.centerSpringX.target.value-=t.x,this.viewport.centerSpringY.target.value-=t.y,o.xConstrained&&(e.delta.x=0),o.yConstrained&&(e.delta.y=0)),this.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta.negate()),s.flickEnabled&&!this.constrainDuringPan)))}function _(t){if(o={tracker:t.eventSource,pointerType:t.pointerType,position:t.position,speed:t.speed,direction:t.direction,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:!1},this.raiseEvent("canvas-drag-end",o),s=this.gestureSettingsByDeviceType(t.pointerType),!o.preventDefaultAction&&this.viewport){if(!n[this.hash].draggingToZoom&&s.dragToPan&&s.flickEnabled&&t.speed>=s.flickMinSpeed){i=0,this.panHorizontal&&(i=s.flickMomentum*t.speed*Math.cos(t.direction)),a=0,this.panVertical&&(a=s.flickMomentum*t.speed*Math.sin(t.direction));var s,o,i,a,r=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),c=this.viewport.pointFromPixel(new e.Point(r.x-i,r.y-a));this.viewport.panTo(c,!1)}this.viewport.applyConstraints()}s.dblClickDragToZoom&&n[this.hash].draggingToZoom===!0&&(n[this.hash].draggingToZoom=!1)}function w(e){this.raiseEvent("canvas-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function O(e){this.raiseEvent("canvas-exit",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function x(t){if(this.raiseEvent("canvas-press",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,insideElementPressed:t.insideElementPressed,insideElementReleased:t.insideElementReleased,originalEvent:t.originalEvent}),s=this.gestureSettingsByDeviceType(t.pointerType),s.dblClickDragToZoom){var s,o=n[this.hash].lastClickTime,i=e.now();if(o===null)return;i-o<this.dblClickTimeThreshold&&(n[this.hash].draggingToZoom=!0),n[this.hash].lastClickTime=null}}function C(e){this.raiseEvent("canvas-release",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function v(e){this.raiseEvent("canvas-nonprimary-press",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function k(e){this.raiseEvent("canvas-nonprimary-release",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function A(e){if(t={tracker:e.eventSource,pointerType:e.pointerType,gesturePoints:e.gesturePoints,lastCenter:e.lastCenter,center:e.center,lastDistance:e.lastDistance,distance:e.distance,shift:e.shift,originalEvent:e.originalEvent,preventDefaultPanAction:!1,preventDefaultZoomAction:!1,preventDefaultRotateAction:!1},this.raiseEvent("canvas-pinch",t),this.viewport&&(s=this.gestureSettingsByDeviceType(e.pointerType),s.pinchToZoom&&(!t.preventDefaultPanAction||!t.preventDefaultZoomAction)&&(n=this.viewport.pointFromPixel(e.center,!0),s.zoomToRefPoint&&!t.preventDefaultPanAction&&(i=this.viewport.pointFromPixel(e.lastCenter,!0),o=i.minus(n),this.panHorizontal||(o.x=0),this.panVertical||(o.y=0),this.viewport.panBy(o,!0)),t.preventDefaultZoomAction||this.viewport.zoomBy(e.distance/e.lastDistance,n,!0),this.viewport.applyConstraints()),s.pinchRotate&&!t.preventDefaultRotateAction)){var t,n,s,o,i,a=Math.atan2(e.gesturePoints[0].currentPos.y-e.gesturePoints[1].currentPos.y,e.gesturePoints[0].currentPos.x-e.gesturePoints[1].currentPos.x),r=Math.atan2(e.gesturePoints[0].lastPos.y-e.gesturePoints[1].lastPos.y,e.gesturePoints[0].lastPos.x-e.gesturePoints[1].lastPos.x);n=this.viewport.pointFromPixel(e.center,!0),this.viewport.rotateTo(this.viewport.getRotation(!0)+(a-r)*(180/Math.PI),n,!0)}}function S(e){this.raiseEvent("canvas-focus",{tracker:e.eventSource,originalEvent:e.originalEvent})}function M(e){this.raiseEvent("canvas-blur",{tracker:e.eventSource,originalEvent:e.originalEvent})}function F(t){var n,s,o,i=e.now(),a=i-this._lastScrollTime;a>this.minScrollDeltaTime?(this._lastScrollTime=i,n={tracker:t.eventSource,position:t.position,scroll:t.scroll,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:!1,preventDefault:!0},this.raiseEvent("canvas-scroll",n),!n.preventDefaultAction&&this.viewport&&(this.viewport.flipped&&(t.position.x=this.viewport.getContainerSize().x-t.position.x),s=this.gestureSettingsByDeviceType(t.pointerType),s.scrollToZoom&&(o=this.zoomPerScroll**t.scroll,this.viewport.zoomBy(o,s.zoomToRefPoint?this.viewport.pointFromPixel(t.position,!0):null),this.viewport.applyConstraints())),t.preventDefault=n.preventDefault):t.preventDefault=!0}function g(e){n[this.hash].mouseInside=!0,i(this),this.raiseEvent("container-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function p(e){e.pointers<1&&(n[this.hash].mouseInside=!1,n[this.hash].animating||o(this)),this.raiseEvent("container-exit",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function u(e){L(e),e.isOpen()?e._updateRequestId=l(e,u):e._updateRequestId=!1}function N(t,s){var i,o=t.viewport,r=o.getZoom(),c=o.getCenter();if(o.resize(s,t.preserveImageSizeOnResize),o.panTo(c,!0),t.preserveImageSizeOnResize)i=n[t.hash].prevContainerSize.x/s.x;else{var a=new e.Point(0,0),l=new e.Point(n[t.hash].prevContainerSize.x,n[t.hash].prevContainerSize.y).distanceTo(a),d=new e.Point(s.x,s.y).distanceTo(a);i=d/l*n[t.hash].prevContainerSize.x/s.x}o.zoomTo(r*i,null,!0),n[t.hash].prevContainerSize=s,n[t.hash].forceRedraw=!0,n[t.hash].needsResize=!1,n[t.hash].forceResize=!1}function L(e){if(!e._opening&&!!n[e.hash]){(e.autoResize||n[e.hash].forceResize)&&(e._autoResizePolling&&(a=c(e.container),d=n[e.hash].prevContainerSize,a.equals(d)||(n[e.hash].needsResize=!0)),n[e.hash].needsResize&&N(e,a||c(e.container)));var s,a,l,d,r=e.viewport.update(),t=e.world.update(r)||r;r&&e.raiseEvent("viewport-change"),e.referenceStrip&&(t=e.referenceStrip.update(e.viewport)||t),l=n[e.hash].animating,!l&&t&&(e.raiseEvent("animation-start"),i(e)),s=l&&!t,s&&(n[e.hash].animating=!1),(t||s||n[e.hash].forceRedraw||e.world.needsDraw())&&(R(e),e._drawOverlays(),e.navigator&&e.navigator.update(e.viewport),n[e.hash].forceRedraw=!1,t&&e.raiseEvent("animation")),s&&(e.raiseEvent("animation-finish"),n[e.hash].mouseInside||o(e)),n[e.hash].animating=t}}function R(e){e.imageLoader.clear(),e.world.draw(),e.raiseEvent("update-viewport",{})}function s(e,t){return e?e+t:t}function H(){n[this.hash].lastZoomTime=e.now(),n[this.hash].zoomFactor=this.zoomPerSecond,n[this.hash].zooming=!0,r(this)}function I(){n[this.hash].lastZoomTime=e.now(),n[this.hash].zoomFactor=1/this.zoomPerSecond,n[this.hash].zooming=!0,r(this)}function B(){n[this.hash].zooming=!1}function r(t){e.requestAnimationFrame(e.delegate(t,$))}function $(){var t,s,o;n[this.hash].zooming&&this.viewport&&(t=e.now(),s=t-n[this.hash].lastZoomTime,o=n[this.hash].zoomFactor**(s/1e3),this.viewport.zoomBy(o),this.viewport.applyConstraints(),n[this.hash].lastZoomTime=t,r(this))}function W(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function U(){this.viewport&&(n[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function K(){this.buttonGroup&&(this.buttonGroup.emulateEnter(),this.buttonGroup.emulateLeave())}function q(){this.viewport&&this.viewport.goHome()}function Y(){this.isFullPage()&&!e.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttonGroup&&this.buttonGroup.emulateLeave(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function G(){if(this.viewport){var e=this.viewport.getRotation();this.viewport.flipped?e+=this.rotationIncrement:e-=this.rotationIncrement,this.viewport.setRotation(e)}}function X(){if(this.viewport){var e=this.viewport.getRotation();this.viewport.flipped?e-=this.rotationIncrement:e+=this.rotationIncrement,this.viewport.setRotation(e)}}function Q(){this.viewport.toggleFlip()}e.determineDrawer=function(n){for(let i in t){const o=t[i],s=o.prototype;if(s&&s instanceof t.DrawerBase&&e.isFunction(s.getType)&&s.getType.call(o)===n)return o}return null}}(t),function(e){e.Navigator=function(n){var l,d,h,c=n.viewer,r=this;n.element||n.id?(n.element?(n.id&&e.console.warn("Given option.id for Navigator was ignored since option.element was provided and is being used instead."),n.element.id?n.id=n.element.id:n.id="navigator-"+e.now(),this.element=n.element):this.element=document.getElementById(n.id),n.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(n.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),n.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:n.autoFade},n.position&&(n.position==="BOTTOM_RIGHT"?n.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:n.position==="BOTTOM_LEFT"?n.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:n.position==="TOP_RIGHT"?n.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:n.position==="TOP_LEFT"?n.controlOptions.anchor=e.ControlAnchor.TOP_LEFT:n.position==="ABSOLUTE"&&(n.controlOptions.anchor=e.ControlAnchor.ABSOLUTE,n.controlOptions.top=n.top,n.controlOptions.left=n.left,n.controlOptions.height=n.height,n.controlOptions.width=n.width))),this.element.id=n.id,this.element.className+=" navigator",n=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},n,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:n.animationTime,autoResize:!1,minZoomImageRatio:1,background:n.background,opacity:n.opacity,borderColor:n.borderColor,displayRegionColor:n.displayRegionColor}),n.minPixelRatio=this.minPixelRatio=c.minPixelRatio,e.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),n.controlOptions.anchor!==e.ControlAnchor.NONE&&function(e,t){e.margin="0px",e.border=t+"px solid "+n.borderColor,e.padding="0px",e.background=n.background,e.opacity=n.opacity,e.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(e,t){e.position="relative",e.top="0px",e.left="0px",e.fontSize="0px",e.overflow="hidden",e.border=t+"px solid "+n.displayRegionColor,e.margin="0px",e.padding="0px",e.background="transparent",e.float="left",e.cssFloat="left",e.zIndex=999999999,e.cursor="default",e.boxSizing="content-box"}(this.displayRegion.style,this.borderWidth),e.setElementPointerEventsNone(this.displayRegion),e.setElementTouchActionNone(this.displayRegion),this.displayRegionContainer=e.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",e.setElementPointerEventsNone(this.displayRegionContainer),e.setElementTouchActionNone(this.displayRegionContainer),c.addControl(this.element,n.controlOptions),this._resizeWithViewer=n.controlOptions.anchor!==e.ControlAnchor.ABSOLUTE&&n.controlOptions.anchor!==e.ControlAnchor.NONE,n.width&&n.height?(this.setWidth(n.width),this.setHeight(n.height)):this._resizeWithViewer&&(l=e.getElementSize(c.element),this.element.style.height=Math.round(l.y*n.sizeRatio)+"px",this.element.style.width=Math.round(l.x*n.sizeRatio)+"px",this.oldViewerSize=l,d=e.getElementSize(this.element),this.elementArea=d.x*d.y),this.oldContainerSize=new e.Point(0,0),e.Viewer.apply(this,[n]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function u(e,n){t(r.displayRegionContainer,e),t(r.displayRegion,-e),r.viewport.setRotation(e,n)}n.navigatorRotate&&(h=n.viewer.viewport?n.viewer.viewport.getRotation():n.viewer.degrees||0,u(h,!0),n.viewer.addHandler("rotate",function(e){u(e.degrees,e.immediately)})),this.innerTracker.destroy(),this.innerTracker=new e.MouseTracker({userData:"Navigator.innerTracker",element:this.element,dragHandler:e.delegate(this,o),clickHandler:e.delegate(this,s),releaseHandler:e.delegate(this,i),scrollHandler:e.delegate(this,a),preProcessEventHandler:function(e){e.eventType==="wheel"&&(e.preventDefault=!0)}}),this.outerTracker.userData="Navigator.outerTracker",e.setElementPointerEventsNone(this.canvas),e.setElementPointerEventsNone(this.container),this.addHandler("reset-size",function(){r.viewport&&r.viewport.goHome(!0)}),c.world.addHandler("item-index-change",function(e){window.setTimeout(function(){var t=r.world.getItemAt(e.previousIndex);r.world.setItemIndex(t,e.newIndex)},1)}),c.world.addHandler("remove-item",function(e){var n=e.item,t=r._getMatchingItem(n);t&&r.world.removeItem(t)}),this.update(c.viewport)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{updateSize:function(){if(this.viewport){var t=new e.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);t.equals(this.oldContainerSize)||(this.viewport.resize(t,!0),this.viewport.goHome(!0),this.oldContainerSize=t,this.world.update(),this.world.draw(),this.update(this.viewer.viewport))}},setWidth:function(e){this.width=e,this.element.style.width=typeof e=="number"?e+"px":e,this._resizeWithViewer=!1,this.updateSize()},setHeight:function(e){this.height=e,this.element.style.height=typeof e=="number"?e+"px":e,this._resizeWithViewer=!1,this.updateSize()},setFlip:function(e){return this.viewport.setFlip(e),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(e){n(this.canvas,e),n(this.element,e)},update:function(n){if(n||(n=this.viewer.viewport),s=e.getElementSize(this.viewer.element),this._resizeWithViewer&&s.x&&s.y&&!s.equals(this.oldViewerSize)&&(this.oldViewerSize=s,this.maintainSizeRatio||!this.elementArea?(i=s.x*this.sizeRatio,r=s.y*this.sizeRatio):(i=(this.elementArea*(s.x/s.y))**.5,r=this.elementArea/i),this.element.style.width=Math.round(i)+"px",this.element.style.height=Math.round(r)+"px",this.elementArea||(this.elementArea=i*r),this.updateSize()),n&&this.viewport){(c=n.getBoundsNoRotate(!0),a=this.viewport.pixelFromPointNoRotate(c.getTopLeft(),!1),l=this.viewport.pixelFromPointNoRotate(c.getBottomRight(),!1).minus(this.totalBorderWidths),!this.navigatorRotate)&&(d=n.getRotation(!0),t(this.displayRegion,-d)),o=this.displayRegion.style,o.display=this.world.getItemCount()?"block":"none",o.top=a.y.toFixed(2)+"px",o.left=a.x.toFixed(2)+"px";var s,o,i,a,r,c,l,d,u=l.x-a.x,h=l.y-a.y;o.width=Math.round(Math.max(u,0))+"px",o.height=Math.round(Math.max(h,0))+"px"}},addTiledImage:function(t){var o,s=this,n=t.originalTiledImage;return delete t.original,o=e.extend({},t,{success:function(e){var t=e.item;t._originalForNavigator=n,s._matchBounds(t,n,!0),s._matchOpacity(t,n),s._matchCompositeOperation(t,n);function o(){s._matchBounds(t,n)}function i(){s._matchOpacity(t,n)}function a(){s._matchCompositeOperation(t,n)}n.addHandler("bounds-change",o),n.addHandler("clip-change",o),n.addHandler("opacity-change",i),n.addHandler("composite-operation-change",a)}}),e.Viewer.prototype.addTiledImage.apply(this,[o])},destroy:function(){return e.Viewer.prototype.destroy.apply(this)},_getMatchingItem:function(e){for(var t,s=this.world.getItemCount(),n=0;n<s;n++)if(t=this.world.getItemAt(n),t._originalForNavigator===e)return t;return null},_matchBounds:function(e,t,n){var s=t.getBoundsNoRotate();e.setPosition(s.getTopLeft(),n),e.setWidth(s.width,n),e.setRotation(t.getRotation(),n),e.setClip(t.getClip()),e.setFlip(t.getFlip())},_matchOpacity:function(e,t){e.setOpacity(t.opacity)},_matchCompositeOperation:function(e,t){e.setCompositeOperation(t.compositeOperation)}});function s(e){var t,n={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-click",n),!n.preventDefaultAction&&e.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)&&(this.viewer.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x),t=this.viewport.pointFromPixel(e.position),this.panVertical?this.panHorizontal||(t.x=this.viewer.viewport.getCenter(!0).x):t.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(t),this.viewer.viewport.applyConstraints())}function o(e){var t={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:!1};this.viewer.raiseEvent("navigator-drag",t),!t.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewer.viewport.flipped&&(e.delta.x=-e.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function i(e){e.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function a(e){var t={tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent,preventDefault:e.preventDefault};this.viewer.raiseEvent("navigator-scroll",t),e.preventDefault=t.preventDefault}function t(e,t){n(e,"rotate("+t+"deg)")}function n(e,t){e.style.webkitTransform=t,e.style.mozTransform=t,e.style.msTransform=t,e.style.oTransform=t,e.style.transform=t}}(t),function(e){var t={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};e.extend(e,{getString:function(n){var s,i=n.split("."),o=null,r=arguments,a=t;for(s=0;s<i.length-1;s++)a=a[i[s]]||{};return o=a[i[s]],typeof o!="string"&&(e.console.error("Untranslated source string:",n),o=""),o.replace(/\{\d+\}/g,function(e){var t=parseInt(e.match(/\d+/),10)+1;return t<r.length?r[t]:""})},setString:function(e,n){var s,o=e.split("."),i=t;for(s=0;s<o.length-1;s++)i[o[s]]||(i[o[s]]={}),i=i[o[s]];i[o[s]]=n}})}(t),function(e){e.Point=function(e,t){this.x=typeof e=="number"?e:0,this.y=typeof t=="number"?t:0},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},plus:function(t){return new e.Point(this.x+t.x,this.y+t.y)},minus:function(t){return new e.Point(this.x-t.x,this.y-t.y)},times:function(t){return new e.Point(this.x*t,this.y*t)},divide:function(t){return new e.Point(this.x/t,this.y/t)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(e){return((this.x-e.x)**2+(this.y-e.y)**2)**.5},squaredDistanceTo:function(e){return(this.x-e.x)**2+(this.y-e.y)**2},apply:function(t){return new e.Point(t(this.x),t(this.y))},equals:function(t){return t instanceof e.Point&&this.x===t.x&&this.y===t.y},rotate:function(t,n){if(n=n||new e.Point(0,0),t%90===0)switch(a=e.positiveModulo(t,360),a){case 0:s=1,o=0;break;case 90:s=0,o=1;break;case 180:s=-1,o=0;break;case 270:s=0,o=-1;break}else i=t*Math.PI/180,s=Math.cos(i),o=Math.sin(i);var s,o,i,a,r=s*(this.x-n.x)-o*(this.y-n.y)+n.x,c=o*(this.x-n.x)+s*(this.y-n.y)+n.y;return new e.Point(r,c)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(t),function(e){e.TileSource=function(t){var r,l,d=this,c=arguments;if(e.isPlainObject(t)?r=t:r={width:c[0],height:c[1],tileSize:c[2],tileOverlap:c[3],minLevel:c[4],maxLevel:c[5]},e.EventSource.call(this),e.extend(!0,this,r),!this.success)for(l=0;l<arguments.length;l++)if(e.isFunction(arguments[l])){this.success=arguments[l];break}this.success&&this.addHandler("ready",function(e){d.success(e)}),e.type(arguments[0])==="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new e.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=r.width&&r.height?r.width/r.height:1,this.dimensions=new e.Point(r.width,r.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=r.tileOverlap?r.tileOverlap:0,this.minLevel=r.minLevel?r.minLevel:0,this.maxLevel=r.maxLevel!==0[0]&&r.maxLevel!==null?r.maxLevel:r.width&&r.height?Math.ceil(Math.log(Math.max(r.width,r.height))/Math.log(2)):0,this.success&&e.isFunction(this.success)&&this.success(this))},e.TileSource.prototype={getTileSize:function(){return e.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(e){return this._tileWidth?this._tileWidth:this.getTileSize(e)},getTileHeight:function(e){return this._tileHeight?this._tileHeight:this.getTileSize(e)},setMaxLevel:function(e){this.maxLevel=e,this._memoizeLevelScale()},getLevelScale:function(e){return this._memoizeLevelScale(),this.getLevelScale(e)},_memoizeLevelScale:function(){var e,t={};for(e=0;e<=this.maxLevel;e++)t[e]=1/2**(this.maxLevel-e);this.getLevelScale=function(e){return t[e]}},getNumTiles:function(t){var n=this.getLevelScale(t),s=Math.ceil(n*this.dimensions.x/this.getTileWidth(t)),o=Math.ceil(n*this.dimensions.y/this.getTileHeight(t));return new e.Point(s,o)},getPixelRatio:function(t){var n=this.dimensions.times(this.getLevelScale(t)),s=1/n.x*e.pixelDensityRatio,o=1/n.y*e.pixelDensityRatio;return new e.Point(s,o)},getClosestLevel:function(){var e,t;for(e=this.minLevel+1;e<=this.maxLevel&&(t=this.getNumTiles(e),!(t.x>1||t.y>1));e++);return e-1},getTileAtPoint:function(t,n){s=n.x>=0&&n.x<=1&&n.y>=0&&n.y<=1/this.aspectRatio,e.console.assert(s,"[TileSource.getTileAtPoint] must be called with a valid point.");var s,r,o=this.dimensions.x*this.getLevelScale(t),c=n.x*o,l=n.y*o,i=Math.floor(c/this.getTileWidth(t)),a=Math.floor(l/this.getTileHeight(t));return n.x>=1&&(i=this.getNumTiles(t).x-1),r=1e-15,n.y>=1/this.aspectRatio-r&&(a=this.getNumTiles(t).y-1),new e.Point(i,a)},getTileBounds:function(t,n,s,o){var c=this.dimensions.times(this.getLevelScale(t)),l=this.getTileWidth(t),d=this.getTileHeight(t),u=n===0?0:l*n-this.tileOverlap,h=s===0?0:d*s-this.tileOverlap,i=l+(n===0?1:2)*this.tileOverlap,a=d+(s===0?1:2)*this.tileOverlap,r=1/c.x;return i=Math.min(i,c.x-u),a=Math.min(a,c.y-h),o?new e.Rect(0,0,i,a):new e.Rect(u*r,h*r,i*r,a*r)},getImageInfo:function(t){var o,i,a,r,c,l,d,u,h,s=this;t&&(o=t.split("/"),l=o[o.length-1],d=l.lastIndexOf("."),d>-1&&(o[o.length-1]=l.slice(0,d))),i=null,this.splitHashDataForPost&&(r=t.indexOf("#"),r!==-1&&(i=t.substring(r+1),t=t.substr(0,r))),c=function(n){typeof n=="string"&&(n=e.parseXml(n));var o=e.TileSource.determineType(s,n,t);if(!o){s.raiseEvent("open-failed",{message:"Unable to load TileSource",source:t});return}a=o.prototype.configure.apply(s,[n,t,i]),a.ajaxWithCredentials===0[0]&&(a.ajaxWithCredentials=s.ajaxWithCredentials),h=new o(a),s.ready=!0,s.raiseEvent("ready",{tileSource:h})},t.match(/\.js$/)?(u=t.split("/").pop().replace(".js",""),e.jsonp({url:t,async:!1,callbackName:u,callback:c})):e.makeAjaxRequest({url:t,postData:i,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(e){var t=n(e);c(t)},error:function(n,o){var a,r;try{a="HTTP "+n.status+" attempting to load TileSource: "+t}catch{typeof o>"u"||!o.toString?r="Unknown error":r=o.toString(),a=r+" attempting to load TileSource: "+t}e.console.error(a),s.raiseEvent("open-failed",{message:a,source:t,postData:i})}})},supports:function(){return!1},configure:function(){throw new Error("Method not implemented.")},getTileUrl:function(){throw new Error("Method not implemented.")},getTilePostData:function(){return null},getTileAjaxHeaders:function(){return{}},getTileHashKey:function(e,t,n,s,o){function a(e){return o?e+"+"+JSON.stringify(o):e}return a(typeof s!="string"?e+"/"+t+"_"+n:s)},tileExists:function(e,t,n){var s=this.getNumTiles(e);return e>=this.minLevel&&e<=this.maxLevel&&t>=0&&n>=0&&t<s.x&&n<s.y},hasTransparency:function(e,t){return!!e||t.match(".png")},downloadTileStart:function(t){var o,s=t.userData,n=new Image;s.image=n,s.request=null,o=function(e){if(!n){t.finish(null,s.request,"Image load failed: undefined Image instance.");return}n.onload=n.onerror=n.onabort=null,t.finish(e?null:n,s.request,e)},n.onload=function(){o()},n.onabort=n.onerror=function(){o("Image load aborted.")},t.loadWithAjax?s.request=e.makeAjaxRequest({url:t.src,withCredentials:t.ajaxWithCredentials,headers:t.ajaxHeaders,responseType:"arraybuffer",postData:t.postData,success:function(e){try{t=new window.Blob([e.response])}catch(n){var t,s,i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;n.name==="TypeError"&&i&&(s=new i,s.append(e.response),t=s.getBlob())}t.size===0?o("Empty image response."):n.src=(window.URL||window.webkitURL).createObjectURL(t)},error:function(){o("Image load aborted - XHR error")}}):(t.crossOriginPolicy!==!1&&(n.crossOrigin=t.crossOriginPolicy),n.src=t.src)},downloadTileAbort:function(e){e.userData.request&&e.userData.request.abort();var t=e.userData.image;e.userData.image&&(t.onload=t.onerror=t.onabort=null)},createTileCache:function(e,t){e._data=t},destroyTileCache:function(e){e._data=null,e._renderedContext=null},getTileCacheData:function(e){return e._data},getTileCacheDataAsImage:function(e){return e._data},getTileCacheDataAsContext2D:function(e){if(!e._renderedContext){var t=document.createElement("canvas");t.width=e._data.width,t.height=e._data.height,e._renderedContext=t.getContext("2d"),e._renderedContext.drawImage(e._data,0,0),e._data=null}return e._renderedContext}},e.extend(!0,e.TileSource.prototype,e.EventSource.prototype);function n(t){var s,i,n=t.responseText,o=t.status;if(t){if(t.status!==200&&t.status!==0)throw o=t.status,i=o===404?"Not Found":t.statusText,new Error(e.getString("Errors.Status",o,i))}else throw new Error(e.getString("Errors.Security"));if(n.match(/^\s*<.*/))try{s=t.responseXML&&t.responseXML.documentElement?t.responseXML:e.parseXml(n)}catch{s=t.responseText}else if(n.match(/\s*[{[].*/))try{s=e.parseJSON(n)}catch{s=n}else s=n;return s}e.TileSource.determineType=function(n,s,o){var i;for(i in t)if(i.match(/.+TileSource$/)&&e.isFunction(t[i])&&e.isFunction(t[i].prototype.supports)&&t[i].prototype.supports.call(n,s,o))return t[i];return e.console.error("No TileSource was able to open %s %s",o,s),null}}(t),function(e){e.DziTileSource=function(t){var d,u,h,m;if(e.isPlainObject(t)?u=t:u={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=u.tilesUrl,this.fileFormat=u.fileFormat,this.displayRects=u.displayRects,this.displayRects)for(h=this.displayRects.length-1;h>=0;h--)for(m=this.displayRects[h],d=m.minLevel;d<=m.maxLevel;d++)this._levelRects[d]||(this._levelRects[d]=[]),this._levelRects[d].push(m);e.TileSource.apply(this,[u])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(e){var n;return e.Image?n=e.Image.xmlns:e.documentElement&&(e.documentElement.localName==="Image"||e.documentElement.tagName==="Image")&&(n=e.documentElement.namespaceURI),n=(n||"").toLowerCase(),n.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||n.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(s,o){var a;return e.isPlainObject(s)?a=t(this,s):a=n(this,s),o&&!a.tilesUrl&&(a.tilesUrl=o.replace(/([^/]+?)(\.(dzi|xml|js)?(\?[^/]*)?)?\/?$/,"$1_files/"),o.search(/\.(dzi|xml|js)\?/)!==-1?a.queryParams=o.match(/\?.*/):a.queryParams=""),a},getTileUrl:function(e,t,n){return[this.tilesUrl,e,"/",t,"_",n,".",this.fileFormat,this.queryParams].join("")},tileExists:function(e,t,n){var s,o,i,a,c,l,d,r=this._levelRects[e];if(this.minLevel&&e<this.minLevel||this.maxLevel&&e>this.maxLevel)return!1;if(!r||!r.length)return!0;for(d=r.length-1;d>=0;d--)if(s=r[d],!(e<s.minLevel||e>s.maxLevel)&&(o=this.getLevelScale(e),i=s.x*o,a=s.y*o,c=i+s.width*o,l=a+s.height*o,i=Math.floor(i/this._tileWidth),a=Math.floor(a/this._tileWidth),c=Math.ceil(c/this._tileWidth),l=Math.ceil(l/this._tileWidth),i<=t&&t<c&&a<=n&&n<l))return!0;return!1}});function n(n,s){if(!s||!s.documentElement)throw new Error(e.getString("Errors.Xml"));var i,r,c,l,d,f,p,o=s.documentElement,u=o.localName||o.tagName,h=s.documentElement.namespaceURI,a=null,m=[];if(u==="Image")try{if(l=o.getElementsByTagName("Size")[0],l===0[0]&&(l=o.getElementsByTagNameNS(h,"Size")[0]),a={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:o.getAttribute("Url"),Format:o.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(o.getAttribute("Overlap"),10),TileSize:parseInt(o.getAttribute("TileSize"),10),Size:{Height:parseInt(l.getAttribute("Height"),10),Width:parseInt(l.getAttribute("Width"),10)}}},!e.imageFormatSupported(a.Image.Format))throw new Error(e.getString("Errors.ImageFormat",a.Image.Format.toUpperCase()));for(r=o.getElementsByTagName("DisplayRect"),r===0[0]&&(r=o.getElementsByTagNameNS(h,"DisplayRect")[0]),d=0;d<r.length;d++)c=r[d],i=c.getElementsByTagName("Rect")[0],i===0[0]&&(i=c.getElementsByTagNameNS(h,"Rect")[0]),m.push({Rect:{X:parseInt(i.getAttribute("X"),10),Y:parseInt(i.getAttribute("Y"),10),Width:parseInt(i.getAttribute("Width"),10),Height:parseInt(i.getAttribute("Height"),10),MinLevel:parseInt(c.getAttribute("MinLevel"),10),MaxLevel:parseInt(c.getAttribute("MaxLevel"),10)}});return m.length&&(a.Image.DisplayRect=m),t(n,a)}catch(t){throw t instanceof Error?t:new Error(e.getString("Errors.Dzi"))}else{if(u==="Collection")throw new Error(e.getString("Errors.Dzc"));if(u==="Error")throw f=o.getElementsByTagName("Message")[0],p=f.firstChild.nodeValue,new Error(p)}throw new Error(e.getString("Errors.Dzi"))}function t(t,n){var s,i,o=n.Image,l=o.Url,d=o.Format,a=o.Size,r=o.DisplayRect||[],u=parseInt(a.Width,10),h=parseInt(a.Height,10),m=parseInt(o.TileSize,10),f=parseInt(o.Overlap,10),c=[];for(i=0;i<r.length;i++)s=r[i].Rect,c.push(new e.DisplayRect(parseInt(s.X,10),parseInt(s.Y,10),parseInt(s.Width,10),parseInt(s.Height,10),parseInt(s.MinLevel,10),parseInt(s.MaxLevel,10)));return e.extend(!0,{width:u,height:h,tileSize:m,tileOverlap:f,minLevel:null,maxLevel:null,tilesUrl:l,fileFormat:d,displayRects:c},n)}}(t),function(e){e.IIIFTileSource=function(t){if(e.extend(!0,this,t),this._id=this["@id"]||this.id||this.identifier||null,!(this.height&&this.width&&this._id))throw new Error("IIIF required parameters (width, height, or id) not provided.");if(t.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=t.version,this.tile_width&&this.tile_height)t.tileWidth=this.tile_width,t.tileHeight=this.tile_height;else if(this.tile_width)t.tileSize=this.tile_width;else if(this.tile_height)t.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length===1)t.tileWidth=this.tiles[0].width,t.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(o=0;o<this.tiles.length;o++)for(i=0;i<this.tiles[o].scaleFactors.length;i++)c=this.tiles[o].scaleFactors[i],this.scale_factors.push(c),t.tileSizePerScaleFactor[c]={width:this.tiles[o].width,height:this.tiles[o].height||this.tiles[o].width}}else if(n(t)){for(var o,i,r,c,h,u=Math.min(this.height,this.width),l=[256,512,1024],d=[],a=0;a<l.length;a++)l[a]<=u&&d.push(l[a]);d.length>0?t.tileSize=Math.max.apply(null,d):t.tileSize=u}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,t.levels=s(this),e.extend(!0,t,{width:t.levels[t.levels.length-1].width,height:t.levels[t.levels.length-1].height,tileSize:Math.max(t.height,t.width),tileOverlap:0,minLevel:0,maxLevel:t.levels.length-1}),this.levels=t.levels):e.console.error("Nothing in the info.json to construct image pyramids from");!t.maxLevel&&!this.emulateLegacyImagePyramid&&(this.scale_factors?(h=Math.max.apply(null,this.scale_factors),t.maxLevel=Math.round(Math.log(h)*Math.LOG2E)):t.maxLevel=Number(Math.round(Math.log(Math.max(this.width,this.height),2)))),this.sizes&&(r=this.sizes.length,(r===t.maxLevel||r===t.maxLevel+1)&&(this.levelSizes=this.sizes.slice().sort((e,t)=>e.width-t.width),r===t.maxLevel&&this.levelSizes.push({width:this.width,height:this.height}))),e.TileSource.apply(this,[t])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(e){return!!(e.protocol&&e.protocol==="http://iiif.io/api/image"||e["@context"]&&(e["@context"]==="http://library.stanford.edu/iiif/image-api/1.1/context.json"||e["@context"]==="http://iiif.io/api/image/1/context.json")||e.profile&&e.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||e.identifier&&e.width&&e.height)||!!(e.documentElement&&e.documentElement.tagName==="info"&&e.documentElement.namespaceURI==="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(n,s){if(e.isPlainObject(n)){if(n["@context"]){var r,c,l,a=n["@context"];if(Array.isArray(a))for(r=0;r<a.length;r++)if(typeof a[r]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(a[r])||a[r]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){a=a[r];break}switch(a){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":n.version=1;break;case"http://iiif.io/api/image/2/context.json":n.version=2;break;case"http://iiif.io/api/image/3/context.json":n.version=3;break;default:e.console.error("Data has a @context property which contains no known IIIF context URI.")}}else n["@context"]="http://iiif.io/api/image/1.0/context.json",n["@id"]=s.replace("/info.json",""),n.version=1;if(n.preferredFormats)for(c=0;c<n.preferredFormats.length;c++)if(t.imageFormatSupported(n.preferredFormats[c])){n.tileFormat=n.preferredFormats[c];break}return n}return l=i(n),l["@context"]="http://iiif.io/api/image/1.0/context.json",l["@id"]=s.replace("/info.xml",""),l.version=1,l},getTileWidth:function(t){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileWidth.call(this,t);var n=2**(this.maxLevel-t);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[n]?this.tileSizePerScaleFactor[n].width:this._tileWidth},getTileHeight:function(t){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileHeight.call(this,t);var n=2**(this.maxLevel-t);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[n]?this.tileSizePerScaleFactor[n].height:this._tileHeight},getLevelScale:function(t){if(this.emulateLegacyImagePyramid){var n=NaN;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(n=this.levels[t].width/this.levels[this.maxLevel].width),n}return e.TileSource.prototype.getLevelScale.call(this,t)},getNumTiles:function(t){if(this.emulateLegacyImagePyramid)return n=this.getLevelScale(t),n?new e.Point(1,1):new e.Point(0,0);if(this.levelSizes){var n,s=this.levelSizes[t],o=Math.ceil(s.width/this.getTileWidth(t)),i=Math.ceil(s.height/this.getTileHeight(t));return new e.Point(o,i)}return e.TileSource.prototype.getNumTiles.call(this,t)},getTileAtPoint:function(t,n){if(this.emulateLegacyImagePyramid)return new e.Point(0,0);if(this.levelSizes){s=n.x>=0&&n.x<=1&&n.y>=0&&n.y<=1/this.aspectRatio,e.console.assert(s,"[TileSource.getTileAtPoint] must be called with a valid point.");var s,r,o=this.levelSizes[t].width,c=n.x*o,l=n.y*o,i=Math.floor(c/this.getTileWidth(t)),a=Math.floor(l/this.getTileHeight(t));return n.x>=1&&(i=this.getNumTiles(t).x-1),r=1e-15,n.y>=1/this.aspectRatio-r&&(a=this.getNumTiles(t).y-1),new e.Point(i,a)}return e.TileSource.prototype.getTileAtPoint.call(this,t,n)},getTileUrl:function(e,t,n){if(this.emulateLegacyImagePyramid)return h=null,this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(h=this.levels[e].url),h;var s,o,i,a,r,c,l,u,h,m,f,p,g,v,b,j,y,_="0",d=.5**(this.maxLevel-e);return this.levelSizes?(o=this.levelSizes[e].width,i=this.levelSizes[e].height):(o=Math.ceil(this.width*d),i=Math.ceil(this.height*d)),r=this.getTileWidth(e),c=this.getTileHeight(e),v=Math.round(r/d),u=Math.round(c/d),this.version===1?j="native."+this.tileFormat:j="default."+this.tileFormat,o<r&&i<c?(this.version===2&&o===this.width?s="full":this.version===3&&o===this.width&&i===this.height?s="max":this.version===3?s=o+","+i:s=o+",",l="full"):(m=t*v,f=n*u,p=Math.min(v,this.width-m),g=Math.min(u,this.height-f),t===0&&n===0&&p===this.width&&g===this.height?l="full":l=[m,f,p,g].join(","),a=Math.min(r,o-t*r),b=Math.min(c,i-n*c),this.version===2&&a===this.width?s="full":this.version===3&&a===this.width&&b===this.height?s="max":this.version===3?s=a+","+b:s=a+","),y=[this._id,l,s,_,j].join("/"),y},__testonly__:{canBeTiled:n,constructLevels:s}});function n(e){var n=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],s=Array.isArray(e.profile)?e.profile[0]:e.profile,o=n.indexOf(s)!==-1,t=!1;return e.version===2&&e.profile.length>1&&e.profile[1].supports&&(t=e.profile[1].supports.indexOf("sizeByW")!==-1),e.version===3&&e.extraFeatures&&(t=e.extraFeatures.indexOf("sizeByWh")!==-1),!o||t}function s(e){for(var n=[],t=0;t<e.sizes.length;t++)n.push({url:e._id+"/full/"+e.sizes[t].width+","+(e.version===3?e.sizes[t].height:"")+"/0/default."+e.tileFormat,width:e.sizes[t].width,height:e.sizes[t].height});return n.sort(function(e,t){return e.width-t.width})}function i(t){if(!t||!t.documentElement)throw new Error(e.getString("Errors.Xml"));var s=t.documentElement,i=s.tagName,n=null;if(i==="info")try{return n={},o(s,n),n}catch(t){throw t instanceof Error?t:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}function o(t,n,s){var i,a;if(t.nodeType===3&&s)i=t.nodeValue.trim(),i.match(/^\d*$/)&&(i=Number(i)),n[s]?(e.isArray(n[s])||(n[s]=[n[s]]),n[s].push(i)):n[s]=i;else if(t.nodeType===1)for(a=0;a<t.childNodes.length;a++)o(t.childNodes[a],n,t.nodeName)}}(t),function(e){e.OsmTileSource=function(t){var a;e.isPlainObject(t)?a=t:a={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!a.width||!a.height)&&(a.width=65572864,a.height=65572864),a.tileSize||(a.tileSize=256,a.tileOverlap=0),a.tilesUrl||(a.tilesUrl="http://tile.openstreetmap.org/"),a.minLevel=8,e.TileSource.apply(this,[a])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.type&&e.type==="openstreetmaps"},configure:function(e){return e},getTileUrl:function(e,t,n){return this.tilesUrl+(e-8)+"/"+t+"/"+n+".png"}})}(t),function(e){e.TmsTileSource=function(t){e.isPlainObject(t)?a=t:a={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var a,l,r=Math.ceil(a.width/256)*256,c=Math.ceil(a.height/256)*256;r>c?l=r/256:l=c/256,a.maxLevel=Math.ceil(Math.log(l)/Math.log(2))-1,a.tileSize=256,a.width=r,a.height=c,e.TileSource.apply(this,[a])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.type&&e.type==="tiledmapservice"},configure:function(e){return e},getTileUrl:function(e,t,n){var s=this.getNumTiles(e).y-1;return this.tilesUrl+e+"/"+t+"/"+(s-n)+".png"}})}(t),function(e){e.ZoomifyTileSource=function(e){typeof e.tileSize>"u"&&(e.tileSize=256),typeof e.fileFormat>"u"&&(e.fileFormat="jpg",this.fileFormat=e.fileFormat);var n={x:e.width,y:e.height};for(e.imageSizes=[{x:e.width,y:e.height}],e.gridSize=[this._getGridSize(e.width,e.height,e.tileSize)];parseInt(n.x,10)>e.tileSize||parseInt(n.y,10)>e.tileSize;)n.x=Math.floor(n.x/2),n.y=Math.floor(n.y/2),e.imageSizes.push({x:n.x,y:n.y}),e.gridSize.push(this._getGridSize(n.x,n.y,e.tileSize));e.imageSizes.reverse(),e.gridSize.reverse(),e.minLevel=0,e.maxLevel=e.gridSize.length-1,t.TileSource.apply(this,[e])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(e,t,n){return{x:Math.ceil(e/n),y:Math.ceil(t/n)}},_calculateAbsoluteTileNumber:function(e,t,n){for(var o=0,s={},i=0;i<e;i++)s=this.gridSize[i],o+=s.x*s.y;return s=this.gridSize[e],o+=s.x*n+t,o},supports:function(e){return e.type&&e.type==="zoomifytileservice"},configure:function(e){return e},getTileUrl:function(e,t,n){var s=0,o=this._calculateAbsoluteTileNumber(e,t,n);return s=Math.floor(o/256),this.tilesUrl+"TileGroup"+s+"/"+e+"-"+t+"-"+n+"."+this.fileFormat}})}(t),function(e){e.LegacyTileSource=function(t){var s,o,i;e.isArray(t)&&(s={type:"legacy-image-pyramid",levels:t}),s.levels=n(s.levels),s.levels.length>0?(o=s.levels[s.levels.length-1].width,i=s.levels[s.levels.length-1].height):(o=0,i=0,e.console.error("No supported image formats found")),e.extend(!0,s,{width:o,height:i,tileSize:Math.max(i,o),tileOverlap:0,minLevel:0,maxLevel:s.levels.length>0?s.levels.length-1:0}),e.TileSource.apply(this,[s]),this.levels=s.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.type&&e.type==="legacy-image-pyramid"||e.documentElement&&e.documentElement.getAttribute("type")==="legacy-image-pyramid"},configure:function(n){var a;return e.isPlainObject(n)?a=t(this,n):a=s(this,n),a},getLevelScale:function(e){var t=NaN;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(t){var n=this.getLevelScale(t);return n?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(e){var s=null;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(s=this.levels[e].url),s}});function n(t){var n,s,o=[];for(s=0;s<t.length;s++)n=t[s],n.height&&n.width&&n.url?o.push({url:n.url,width:Number(n.width),height:Number(n.height)}):e.console.error("Unsupported image format: %s",n.url?n.url:"<no URL>");return o.sort(function(e,t){return e.height-t.height})}function s(n,s){if(!s||!s.documentElement)throw new Error(e.getString("Errors.Xml"));var i,a,r=s.documentElement,o=r.tagName,c=null,l=[];if(o==="image")try{for(c={type:r.getAttribute("type"),levels:[]},l=r.getElementsByTagName("level"),a=0;a<l.length;a++)i=l[a],c.levels.push({url:i.getAttribute("url"),width:parseInt(i.getAttribute("width"),10),height:parseInt(i.getAttribute("height"),10)});return t(n,c)}catch(e){throw e instanceof Error?e:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(o==="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(o==="error")throw new Error("Error: "+s)}throw new Error("Unknown element "+o)}function t(e,t){return t.levels}}(t),function(e){e.ImageTileSource=function(t){t=e.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1},t),e.TileSource.apply(this,[t])},e.extend(e.ImageTileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.type&&e.type==="image"},configure:function(e){return e},getImageInfo:function(t){var s=this._image=new Image,n=this;this.crossOriginPolicy&&(s.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(s.useCredentials=this.ajaxWithCredentials),e.addEvent(s,"load",function(){n.width=s.naturalWidth,n.height=s.naturalHeight,n.aspectRatio=n.width/n.height,n.dimensions=new e.Point(n.width,n.height),n._tileWidth=n.width,n._tileHeight=n.height,n.tileOverlap=0,n.minLevel=0,n.levels=n._buildLevels(),n.maxLevel=n.levels.length-1,n.ready=!0,n.raiseEvent("ready",{tileSource:n})}),e.addEvent(s,"error",function(){n.raiseEvent("open-failed",{message:"Error loading image at "+t,source:t})}),s.src=t},getLevelScale:function(e){var t=NaN;return e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(t){var n=this.getLevelScale(t);return n?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(e){var s=null;return e>=this.minLevel&&e<=this.maxLevel&&(s=this.levels[e].url),s},getContext2D:function(e){var s=null;return e>=this.minLevel&&e<=this.maxLevel&&(s=this.levels[e].context2D),s},destroy:function(e){this._freeupCanvasMemory(e)},_buildLevels:function(){if(s=[{url:this._image.src,width:this._image.naturalWidth,height:this._image.naturalHeight}],!this.buildPyramid||!e.supportsCanvas)return delete this._image,s;var s,i,a,t=this._image.naturalWidth,n=this._image.naturalHeight,o=document.createElement("canvas"),r=o.getContext("2d");if(o.width=t,o.height=n,r.drawImage(this._image,0,0,t,n),s[0].context2D=r,delete this._image,e.isCanvasTainted(o))return s;for(;t>=2&&n>=2;)t=Math.floor(t/2),n=Math.floor(n/2),i=document.createElement("canvas"),a=i.getContext("2d"),i.width=t,i.height=n,a.drawImage(o,0,0,t,n),s.splice(0,0,{context2D:a,width:t,height:n}),o=i,r=a;return s},_freeupCanvasMemory:function(e){for(var t=0;t<this.levels.length;t++)this.levels[t].context2D&&(this.levels[t].context2D.canvas.height=0,this.levels[t].context2D.canvas.width=0,e&&e.raiseEvent("image-unloaded",{context2D:this.levels[t].context2D}))}})}(t),function(e){e.TileSourceCollection=function(){e.console.error("TileSourceCollection is deprecated; use World instead")}}(t),function(e){e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(s){var o=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null,userData:null},s),this.element=s.element||e.makeNeutralElement("div"),s.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,e.setElementPointerEventsNone(this.imgRest),e.setElementPointerEventsNone(this.imgGroup),e.setElementPointerEventsNone(this.imgHover),e.setElementPointerEventsNone(this.imgDown),this.element.style.position="relative",e.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({userData:"Button.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(n){n.insideElementPressed?(t(o,e.ButtonState.DOWN),o.raiseEvent("enter",{originalEvent:n.originalEvent})):n.buttonDownAny||t(o,e.ButtonState.HOVER)},focusHandler:function(e){o.tracker.enterHandler(e),o.raiseEvent("focus",{originalEvent:e.originalEvent})},leaveHandler:function(t){n(o,e.ButtonState.GROUP),t.insideElementPressed&&o.raiseEvent("exit",{originalEvent:t.originalEvent})},blurHandler:function(e){o.tracker.leaveHandler(e),o.raiseEvent("blur",{originalEvent:e.originalEvent})},pressHandler:function(n){t(o,e.ButtonState.DOWN),o.raiseEvent("press",{originalEvent:n.originalEvent})},releaseHandler:function(s){s.insideElementPressed&&s.insideElementReleased?(n(o,e.ButtonState.HOVER),o.raiseEvent("release",{originalEvent:s.originalEvent})):s.insideElementPressed?n(o,e.ButtonState.GROUP):t(o,e.ButtonState.HOVER)},clickHandler:function(e){e.quick&&o.raiseEvent("click",{originalEvent:e.originalEvent})},keyHandler:function(e){e.keyCode===13?(o.raiseEvent("click",{originalEvent:e.originalEvent}),o.raiseEvent("release",{originalEvent:e.originalEvent}),e.preventDefault=!0):e.preventDefault=!1}}),n(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){t(this,e.ButtonState.GROUP)},notifyGroupExit:function(){n(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,this.tracker.setTracking(!1),e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,this.tracker.setTracking(!0),e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()},destroy:function(){this.imgRest&&(this.element.removeChild(this.imgRest),this.imgRest=null),this.imgGroup&&(this.element.removeChild(this.imgGroup),this.imgGroup=null),this.imgHover&&(this.element.removeChild(this.imgHover),this.imgHover=null),this.imgDown&&(this.element.removeChild(this.imgDown),this.imgDown=null),this.removeAllHandlers(),this.tracker.destroy(),this.element=null}});function s(t){e.requestAnimationFrame(function(){o(t)})}function o(t){var n,o,i;t.shouldFade&&(o=e.now(),i=o-t.fadeBeginTime,n=1-i/t.fadeLength,n=Math.min(1,n),n=Math.max(0,n),t.imgGroup&&e.setElementOpacity(t.imgGroup,n,!0),n>0&&s(t))}function i(t){t.shouldFade=!0,t.fadeBeginTime=e.now()+t.fadeDelay,window.setTimeout(function(){s(t)},t.fadeDelay)}function a(t){t.shouldFade=!1,t.imgGroup&&e.setElementOpacity(t.imgGroup,1,!0)}function t(t,n){t.element.disabled||(n>=e.ButtonState.GROUP&&t.currentState===e.ButtonState.REST&&(a(t),t.currentState=e.ButtonState.GROUP),n>=e.ButtonState.HOVER&&t.currentState===e.ButtonState.GROUP&&(t.imgHover&&(t.imgHover.style.visibility=""),t.currentState=e.ButtonState.HOVER),n>=e.ButtonState.DOWN&&t.currentState===e.ButtonState.HOVER&&(t.imgDown&&(t.imgDown.style.visibility=""),t.currentState=e.ButtonState.DOWN))}function n(t,n){t.element.disabled||(n<=e.ButtonState.HOVER&&t.currentState===e.ButtonState.DOWN&&(t.imgDown&&(t.imgDown.style.visibility="hidden"),t.currentState=e.ButtonState.HOVER),n<=e.ButtonState.GROUP&&t.currentState===e.ButtonState.HOVER&&(t.imgHover&&(t.imgHover.style.visibility="hidden"),t.currentState=e.ButtonState.GROUP),n<=e.ButtonState.REST&&t.currentState===e.ButtonState.GROUP&&(i(t),t.currentState=e.ButtonState.REST))}}(t),function(e){e.ButtonGroup=function(t){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},t);var s,o=this.buttons.concat([]),n=this;if(this.element=t.element||e.makeNeutralElement("div"),!t.group)for(this.element.style.display="inline-block",s=0;s<o.length;s++)this.element.appendChild(o[s].element);e.setElementTouchActionNone(this.element),this.tracker=new e.MouseTracker({userData:"ButtonGroup.tracker",element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(){var t;for(t=0;t<n.buttons.length;t++)n.buttons[t].notifyGroupEnter()},leaveHandler:function(e){var t;if(!e.insideElementPressed)for(t=0;t<n.buttons.length;t++)n.buttons[t].notifyGroupExit()}})},e.ButtonGroup.prototype={addButton:function(e){this.buttons.push(e),this.element.appendChild(e.element)},emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateLeave:function(){this.tracker.leaveHandler({eventSource:this.tracker})},destroy:function(){for(;this.buttons.length;){var e=this.buttons.pop();this.element.removeChild(e.element),e.destroy()}this.tracker.destroy(),this.element=null}}}(t),function(e){e.Rect=function(t,n,s,o,i){this.x=typeof t=="number"?t:0,this.y=typeof n=="number"?n:0,this.width=typeof s=="number"?s:0,this.height=typeof o=="number"?o:0,this.degrees=typeof i=="number"?i:0,this.degrees=e.positiveModulo(this.degrees,360);var a,r;this.degrees>=270?(a=this.getTopRight(),this.x=a.x,this.y=a.y,r=this.height,this.height=this.width,this.width=r,this.degrees-=270):this.degrees>=180?(a=this.getBottomRight(),this.x=a.x,this.y=a.y,this.degrees-=180):this.degrees>=90&&(a=this.getBottomLeft(),this.x=a.x,this.y=a.y,r=this.height,this.height=this.width,this.width=r,this.degrees-=90)},e.Rect.fromSummits=function(t,n,s){var a=t.distanceTo(n),r=t.distanceTo(s),o=n.minus(t),i=Math.atan(o.y/o.x);return o.x<0?i+=Math.PI:o.y<0&&(i+=2*Math.PI),new e.Rect(t.x,t.y,a,r,i/Math.PI*180)},e.Rect.prototype={clone:function(){return new e.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new e.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new e.Point(this.width,this.height)},equals:function(t){return t instanceof e.Rect&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height&&this.degrees===t.degrees},times:function(t){return new e.Rect(this.x*t,this.y*t,this.width*t,this.height*t,this.degrees)},translate:function(t){return new e.Rect(this.x+t.x,this.y+t.y,this.width,this.height,this.degrees)},union:function(t){var n=this.getBoundingBox(),s=t.getBoundingBox(),o=Math.min(n.x,s.x),i=Math.min(n.y,s.y),a=Math.max(n.x+n.width,s.x+s.width),r=Math.max(n.y+n.height,s.y+s.height);return new e.Rect(o,i,a-o,r-i)},intersection:function(t){var s=1e-10,n=[],x=this.getTopLeft();t.containsPoint(x,s)&&n.push(x),j=this.getTopRight(),t.containsPoint(j,s)&&n.push(j),y=this.getBottomLeft(),t.containsPoint(y,s)&&n.push(y),g=this.getBottomRight(),t.containsPoint(g,s)&&n.push(g),c=t.getTopLeft(),this.containsPoint(c,s)&&n.push(c),_=t.getTopRight(),this.containsPoint(_,s)&&n.push(_),d=t.getBottomLeft(),this.containsPoint(d,s)&&n.push(d),u=t.getBottomRight(),this.containsPoint(u,s)&&n.push(u);for(var O=this._getSegments(),w=t._getSegments(),f=0;f<O.length;f++)for(p=O[f],r=0;r<w.length;r++)v=w[r],b=C(p[0],p[1],v[0],v[1]),b&&n.push(b);function C(t,n,o,i){var r,d,a=n.minus(t),c=i.minus(o),l=-c.x*a.y+a.x*c.y;return l===0?null:(d=(a.x*(t.y-o.y)-a.y*(t.x-o.x))/l,r=(c.x*(t.y-o.y)-c.y*(t.x-o.x))/l,-s<=d&&d<=1-s&&-s<=r&&r<=1-s?new e.Point(t.x+r*a.x,t.y+r*a.y):null)}if(n.length===0)return null;for(var o,r,c,d,u,p,g,v,b,j,y,_,a=n[0].x,l=n[0].x,i=n[0].y,m=n[0].y,h=1;h<n.length;h++)o=n[h],o.x<a&&(a=o.x),o.x>l&&(l=o.x),o.y<i&&(i=o.y),o.y>m&&(m=o.y);return new e.Rect(a,i,l-a,m-i)},_getSegments:function(){var e=this.getTopLeft(),t=this.getTopRight(),n=this.getBottomLeft(),s=this.getBottomRight();return[[e,t],[t,s],[s,n],[n,e]]},rotate:function(t,n){if(t=e.positiveModulo(t,360),t===0)return this.clone();n=n||this.getCenter();var o=this.getTopLeft().rotate(t,n),a=this.getTopRight().rotate(t,n),s=a.minus(o),s=s.apply(function(e){var t=1e-15;return(e<0?-e:e)<t?0:e}),i=Math.atan(s.y/s.x);return s.x<0?i+=Math.PI:s.y<0&&(i+=2*Math.PI),new e.Rect(o.x,o.y,this.width,this.height,i/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var t=this.getTopLeft(),n=this.getTopRight(),s=this.getBottomLeft(),o=this.getBottomRight(),i=Math.min(t.x,n.x,s.x,o.x),r=Math.max(t.x,n.x,s.x,o.x),a=Math.min(t.y,n.y,s.y,o.y),c=Math.max(t.y,n.y,s.y,o.y);return new e.Rect(i,a,r-i,c-a)},getIntegerBoundingBox:function(){var t=this.getBoundingBox(),n=Math.floor(t.x),s=Math.floor(t.y),o=Math.ceil(t.width+t.x-n),i=Math.ceil(t.height+t.y-s);return new e.Rect(n,s,o,i)},containsPoint:function(e,t){t=t||0;var n=this.getTopLeft(),i=this.getTopRight(),a=this.getBottomLeft(),s=i.minus(n),o=a.minus(n);return(e.x-n.x)*s.x+(e.y-n.y)*s.y>=-t&&(e.x-i.x)*s.x+(e.y-i.y)*s.y<=t&&(e.x-n.x)*o.x+(e.y-n.y)*o.y>=-t&&(e.x-a.x)*o.x+(e.y-a.y)*o.y<=t},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(t),function(e){var s={};e.ReferenceStrip=function(d){var u,m,p,g=this,h=d.viewer,f=e.getElementSize(h.element);for(d.id||(d.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=d.id,this.element.className="referencestrip"),d=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},d,{element:this.element}),e.extend(this,d),s[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,this.element.tabIndex=0,m=this.element.style,m.marginTop="0px",m.marginRight="0px",m.marginBottom="0px",m.marginLeft="0px",m.left="0px",m.bottom="0px",m.border="0px",m.background="#000",m.position="relative",e.setElementTouchActionNone(this.element),e.setElementOpacity(this.element,.8),this.viewer=h,this.tracker=new e.MouseTracker({userData:"ReferenceStrip.tracker",element:this.element,clickHandler:e.delegate(this,i),dragHandler:e.delegate(this,a),scrollHandler:e.delegate(this,n),enterHandler:e.delegate(this,o),leaveHandler:e.delegate(this,r),keyDownHandler:e.delegate(this,c),keyHandler:e.delegate(this,l),preProcessEventHandler:function(e){e.eventType==="wheel"&&(e.preventDefault=!0)}}),d.width&&d.height?(this.element.style.width=d.width+"px",this.element.style.height=d.height+"px",h.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):d.scroll==="horizontal"?(this.element.style.width=f.x*d.sizeRatio*h.tileSources.length+12*h.tileSources.length+"px",this.element.style.height=f.y*d.sizeRatio+"px",h.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=f.y*d.sizeRatio*h.tileSources.length+12*h.tileSources.length+"px",this.element.style.width=f.x*d.sizeRatio+"px",h.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=f.x*this.sizeRatio+8,this.panelHeight=f.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},p=0;p<h.tileSources.length;p++)u=e.makeNeutralElement("div"),u.id=this.element.id+"-"+p,u.style.width=g.panelWidth+"px",u.style.height=g.panelHeight+"px",u.style.display="inline",u.style.float="left",u.style.cssFloat="left",u.style.padding="2px",e.setElementTouchActionNone(u),e.setElementPointerEventsNone(u),this.element.appendChild(u),u.activePanel=!1,this.panels.push(u);t(this,this.scroll==="vertical"?f.y:f.x,0),this.setFocus(0)},e.ReferenceStrip.prototype={setFocus:function(n){var s,a=this.element.querySelector("#"+this.element.id+"-"+n),i=e.getElementSize(this.viewer.canvas),l=Number(this.element.style.width.replace("px","")),d=Number(this.element.style.height.replace("px","")),r=-Number(this.element.style.marginLeft.replace("px","")),c=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==a&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=a,this.currentSelected.style.background="#999",this.scroll==="horizontal"?(s=Number(n)*(this.panelWidth+3),s>r+i.x-this.panelWidth?(s=Math.min(s,l-i.x),this.element.style.marginLeft=-s+"px",t(this,i.x,-s)):s<r&&(s=Math.max(0,s-i.x/2),this.element.style.marginLeft=-s+"px",t(this,i.x,-s))):(s=Number(n)*(this.panelHeight+3),s>c+i.y-this.panelHeight?(s=Math.min(s,d-i.y),this.element.style.marginTop=-s+"px",t(this,i.y,-s)):s<c&&(s=Math.max(0,s-i.y/2),this.element.style.marginTop=-s+"px",t(this,i.y,-s))),this.currentPage=n,o.call(this,{eventSource:this.tracker}))},update:function(){return!!s[this.id].animating},destroy:function(){if(this.miniViewers)for(var e in this.miniViewers)this.miniViewers[e].destroy();this.tracker.destroy(),this.element&&this.viewer.removeControl(this.element)}};function i(e){if(e.quick){var t;this.scroll==="horizontal"?t=Math.floor(e.position.x/(this.panelWidth+4)):t=Math.floor(e.position.y/this.panelHeight),this.viewer.goToPage(t)}this.element.focus()}function a(n){if(this.dragging=!0,this.element){var s=Number(this.element.style.marginLeft.replace("px","")),o=Number(this.element.style.marginTop.replace("px","")),a=Number(this.element.style.width.replace("px","")),r=Number(this.element.style.height.replace("px","")),i=e.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?-n.delta.x>0?s>-(a-i.x)&&(this.element.style.marginLeft=s+n.delta.x*2+"px",t(this,i.x,s+n.delta.x*2)):-n.delta.x<0&&s<0&&(this.element.style.marginLeft=s+n.delta.x*2+"px",t(this,i.x,s+n.delta.x*2)):-n.delta.y>0?o>-(r-i.y)&&(this.element.style.marginTop=o+n.delta.y*2+"px",t(this,i.y,o+n.delta.y*2)):-n.delta.y<0&&o<0&&(this.element.style.marginTop=o+n.delta.y*2+"px",t(this,i.y,o+n.delta.y*2))}}function n(n){if(this.element){var s=Number(this.element.style.marginLeft.replace("px","")),o=Number(this.element.style.marginTop.replace("px","")),a=Number(this.element.style.width.replace("px","")),r=Number(this.element.style.height.replace("px","")),i=e.getElementSize(this.viewer.canvas);this.scroll==="horizontal"?n.scroll>0?s>-(a-i.x)&&(this.element.style.marginLeft=s-n.scroll*60+"px",t(this,i.x,s-n.scroll*60)):n.scroll<0&&s<0&&(this.element.style.marginLeft=s-n.scroll*60+"px",t(this,i.x,s-n.scroll*60)):n.scroll<0?o>i.y-r&&(this.element.style.marginTop=o+n.scroll*60+"px",t(this,i.y,o+n.scroll*60)):n.scroll>0&&o<0&&(this.element.style.marginTop=o+n.scroll*60+"px",t(this,i.y,o+n.scroll*60)),n.preventDefault=!0}}function t(t,n,s){for(t.scroll==="horizontal"?c=t.panelWidth:c=t.panelHeight,o=Math.ceil(n/c)+5,l=Math.ceil(((s<0?-s:s)+n)/c)+1,o=l-o,o=o<0?0:o,a=o;a<l&&a<t.panels.length;a++)if(r=t.panels[a],!r.activePanel){var o,i,a,r,c,l,d,u=t.viewer.tileSources[a];u.referenceStripThumbnailUrl?d={type:"image",url:u.referenceStripThumbnailUrl}:d=u,i=new e.Viewer({id:r.id,tileSources:[d],element:r,navigatorSizeRatio:t.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:t.viewer.loadTilesWithAjax,ajaxHeaders:t.viewer.ajaxHeaders,drawer:"canvas"}),e.setElementPointerEventsNone(i.canvas),e.setElementPointerEventsNone(i.container),i.innerTracker.setTracking(!1),i.outerTracker.setTracking(!1),t.miniViewers[r.id]=i,r.activePanel=!0}}function o(e){var t=e.eventSource.element;this.scroll==="horizontal"?t.style.marginBottom="0px":t.style.marginLeft="0px"}function r(t){var n=t.eventSource.element;this.scroll==="horizontal"?n.style.marginBottom="-"+e.getElementSize(n).y/2+"px":n.style.marginLeft="-"+e.getElementSize(n).x/2+"px"}function c(e){if(!e.ctrl&&!e.alt&&!e.meta)switch(e.keyCode){case 38:n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;case 40:n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),e.preventDefault=!0;break;case 37:n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),e.preventDefault=!0;break;case 39:n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;default:e.preventDefault=!1;break}else e.preventDefault=!1}function l(e){if(!e.ctrl&&!e.alt&&!e.meta)switch(e.keyCode){case 61:n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;case 45:n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),e.preventDefault=!0;break;case 48:case 119:case 87:n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;case 115:case 83:n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),e.preventDefault=!0;break;case 97:n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),e.preventDefault=!0;break;case 100:n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),e.preventDefault=!0;break;default:e.preventDefault=!1;break}else e.preventDefault=!1}}(t),function(e){e.DisplayRect=function(t,n,s,o,i,a){e.Rect.apply(this,[t,n,s,o]),this.minLevel=i,this.maxLevel=a},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(t),function(e){e.Spring=function(t){var n=arguments;typeof t!="object"&&(t={initial:n.length&&typeof n[0]=="number"?n[0]:0[0],springStiffness:n.length>1?n[1].springStiffness:5,animationTime:n.length>1?n[1].animationTime:1.5}),e.console.assert(typeof t.springStiffness=="number"&&t.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),e.console.assert(typeof t.animationTime=="number"&&t.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),t.exponential&&(this._exponential=!0,delete t.exponential),e.extend(!0,this,t),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:e.now()},e.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},e.Spring.prototype={resetTo:function(t){e.console.assert(!this._exponential||t!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=t,this.start.time=this.target.time=this.current.time=e.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(t){e.console.assert(!this._exponential||t!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=t,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(t){this.start.value+=t,this.target.value+=t,this._exponential&&(e.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(t){this._exponential=t,this._exponential&&(e.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=e.now();let n,s;if(this._exponential?(n=this.start._logValue,s=this.target._logValue):(n=this.start.value,s=this.target.value),this.current.time>=this.target.time)this.current.value=this.target.value;else{let e=n+(s-n)*t(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time));this._exponential?this.current.value=Math.exp(e):this.current.value=e}return this.current.value!==this.target.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function t(e,t){return(1-Math.exp(e*-t))/(1-Math.exp(-e))}}(t),function(e){e.ImageJob=function(t){e.extend(!0,this,{timeout:e.DEFAULT_SETTINGS.timeout,jobId:null,tries:0},t),this.data=null,this.userData={},this.errorMsg=null},e.ImageJob.prototype={start:function(){this.tries++;var e=this,t=this.abort;this.jobId=window.setTimeout(function(){e.finish(null,null,"Image load exceeded timeout ("+e.timeout+" ms)")},this.timeout),this.abort=function(){e.source.downloadTileAbort(e),typeof t=="function"&&t()},this.source.downloadTileStart(this)},finish:function(e,t,n){this.data=e,this.request=t,this.errorMsg=n,this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},e.ImageLoader=function(t){e.extend(!0,this,{jobLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,timeout:e.DEFAULT_SETTINGS.timeout,jobQueue:[],failedTiles:[],jobsInProgress:0},t)},e.ImageLoader.prototype={addJob:function(n){n.source||(e.console.error("ImageLoader.prototype.addJob() requires [options.source]. TileSource since new API defines how images are fetched. Creating a dummy TileSource."),s=e.TileSource.prototype,n.source={downloadTileStart:s.downloadTileStart,downloadTileAbort:s.downloadTileAbort});var s,i=this,a=function(e){t(i,e,n.callback)},r={src:n.src,tile:n.tile||{},source:n.source,loadWithAjax:n.loadWithAjax,ajaxHeaders:n.loadWithAjax?n.ajaxHeaders:null,crossOriginPolicy:n.crossOriginPolicy,ajaxWithCredentials:n.ajaxWithCredentials,postData:n.postData,callback:a,abort:n.abort,timeout:this.timeout},o=new e.ImageJob(r);!this.jobLimit||this.jobsInProgress<this.jobLimit?(o.start(),this.jobsInProgress++):this.jobQueue.push(o)},clear:function(){for(var t,e=0;e<this.jobQueue.length;e++)t=this.jobQueue[e],typeof t.abort=="function"&&t.abort();this.jobQueue=[]}};function t(e,t,n){t.errorMsg!==""&&(t.data===null||t.data===0[0])&&t.tries<1+e.tileRetryMax&&e.failedTiles.push(t);var s;e.jobsInProgress--,(!e.jobLimit||e.jobsInProgress<e.jobLimit)&&e.jobQueue.length>0&&(s=e.jobQueue.shift(),s.start(),e.jobsInProgress++),e.tileRetryMax>0&&e.jobQueue.length===0&&(!e.jobLimit||e.jobsInProgress<e.jobLimit)&&e.failedTiles.length>0&&(s=e.failedTiles.shift(),setTimeout(function(){s.start()},e.tileRetryDelay),e.jobsInProgress++),n(t.data,t.errorMsg,t.request)}}(t),function(e){e.Tile=function(n,s,o,i,a,r,c,l,d,u,h,m){this.level=n,this.x=s,this.y=o,this.bounds=i,this.positionedBounds=new t.Rect(i.x,i.y,i.width,i.height),this.sourceBounds=u,this.exists=a,this._url=r,this.postData=h,this.context2D=c,this.loadWithAjax=l,this.ajaxHeaders=d,m===0[0]&&(e.console.warn("Tile constructor needs 'cacheKey' variable: creation tile cache in Tile class is deprecated. TileSource.prototype.getTileHashKey will be used."),m=e.TileSource.prototype.getTileHashKey(n,s,o,r,d,h)),this.cacheKey=m,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.style=null,this.position=null,this.size=null,this.flipped=!1,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.hasTransparency=!1,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return console.warn("Tile.prototype._hasTransparencyChannel() has been deprecated and will be removed in the future. Use TileSource.prototype.hasTransparency() instead."),!!this.context2D||this.getUrl().match(".png")},get image(){return e.console.error("[Tile.image] property has been deprecated. Use [Tile.prototype.getImage] instead."),this.getImage()},get url(){return e.console.error("[Tile.url] property has been deprecated. Use [Tile.prototype.getUrl] instead."),this.getUrl()},getImage:function(){return this.cacheImageRecord.getImage()},getUrl:function(){return typeof this._url=="function"?this._url():this._url},getCanvasContext:function(){return this.context2D||this.cacheImageRecord&&this.cacheImageRecord.getRenderedContext()},getScaleForEdgeSmoothing:function(){var t;if(this.cacheImageRecord)t=this.cacheImageRecord.getRenderedContext();else if(this.context2D)t=this.context2D;else return e.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return t.canvas.width/(this.size.x*e.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(t,n,s){var o=Math.max(1,Math.ceil((s.x-n.x)/2)),i=Math.max(1,Math.ceil((s.y-n.y)/2));return new e.Point(o,i).minus(this.position.times(e.pixelDensityRatio).times(t||1).apply(function(e){return e%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(t),function(e){e.OverlayPlacement=e.Placement,e.OverlayRotationMode=e.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),e.Overlay=function(t,n,s){var o;e.isPlainObject(t)?o=t:o={element:t,location:n,placement:s},this.elementWrapper=document.createElement("div"),this.element=o.element,this.elementWrapper.appendChild(this.element),this.element.id?this.elementWrapper.id="overlay-wrapper-"+this.element.id:this.elementWrapper.id="overlay-wrapper",this.style=this.elementWrapper.style,this._init(o)},e.Overlay.prototype={_init:function(t){this.location=t.location,this.placement=t.placement===0[0]?e.Placement.TOP_LEFT:t.placement,this.onDraw=t.onDraw,this.checkResize=t.checkResize===0[0]||t.checkResize,this.width=t.width===0[0]?null:t.width,this.height=t.height===0[0]?null:t.height,this.rotationMode=t.rotationMode||e.OverlayRotationMode.EXACT,this.location instanceof e.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=e.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new e.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(t,n){var s=e.Placement.properties[this.placement];s&&(s.isHorizontallyCentered?t.x-=n.x/2:s.isRight&&(t.x-=n.x),s.isVerticallyCentered?t.y-=n.y/2:s.isBottom&&(t.y-=n.y))},destroy:function(){var s,o,n=this.elementWrapper,t=this.style;n.parentNode&&(n.parentNode.removeChild(n),n.prevElementParent&&(t.display="none",document.body.appendChild(n))),this.onDraw=null,t.top="",t.left="",t.position="",this.width!==null&&(t.width=""),this.height!==null&&(t.height=""),s=e.getCssPropertyWithVendorPrefix("transformOrigin"),o=e.getCssPropertyWithVendorPrefix("transform"),s&&o&&(t[s]="",t[o]="")},drawHTML:function(t,n){a=this.elementWrapper,a.parentNode!==t&&(a.prevElementParent=a.parentNode,a.prevNextSibling=a.nextSibling,t.appendChild(a),this.style.position="absolute",this.size=e.getElementSize(this.elementWrapper));var s,o,i,a,r,c,m,l=this._getOverlayPositionAndSize(n),d=l.position,u=this.size=l.size,h="";n.overlayPreserveContentDirection&&(h=n.flipped?" scaleX(-1)":" scaleX(1)"),r=n.flipped?-l.rotate:l.rotate,m=n.flipped?" scaleX(-1)":"",this.onDraw?this.onDraw(d,u,this.element):(s=this.style,i=this.element.style,i.display="block",s.left=d.x+"px",s.top=d.y+"px",this.width!==null&&(i.width=u.x+"px"),this.height!==null&&(i.height=u.y+"px"),c=e.getCssPropertyWithVendorPrefix("transformOrigin"),o=e.getCssPropertyWithVendorPrefix("transform"),c&&o&&(r&&!n.flipped?(i[o]="",s[c]=this._getTransformOrigin(),s[o]="rotate("+r+"deg)"):!r&&n.flipped?(i[o]=h,s[c]=this._getTransformOrigin(),s[o]=m):r&&n.flipped?(i[o]=h,s[c]=this._getTransformOrigin(),s[o]="rotate("+r+"deg)"+m):(i[o]="",s[c]="",s[o]="")),s.display="flex")},_getOverlayPositionAndSize:function(t){var o,i,a,n=t.pixelFromPoint(this.location,!0),s=this._getSizeInPixels(t);return this.adjust(n,s),o=0,t.getRotation(!0)&&this.rotationMode!==e.OverlayRotationMode.NO_ROTATION&&(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null?(a=new e.Rect(n.x,n.y,s.x,s.y),i=this._getBoundingBox(a,t.getRotation(!0)),n=i.getTopLeft(),s=i.getSize()):o=t.getRotation(!0)),t.flipped&&(n.x=t.getContainerSize().x-n.x),{position:n,size:s,rotate:o}},_getSizeInPixels:function(t){var o,i,n=this.size.x,s=this.size.y;return(this.width!==null||this.height!==null)&&(o=t.deltaPixelsFromPointsNoRotate(new e.Point(this.width||0,this.height||0),!0),this.width!==null&&(n=o.x),this.height!==null&&(s=o.y)),this.checkResize&&(this.width===null||this.height===null)&&(i=this.size=e.getElementSize(this.elementWrapper),this.width===null&&(n=i.x),this.height===null&&(s=i.y)),new e.Point(n,s)},_getBoundingBox:function(e,t){var n=this._getPlacementPoint(e);return e.rotate(t,n).getBoundingBox()},_getPlacementPoint:function(t){var n=new e.Point(t.x,t.y),s=e.Placement.properties[this.placement];return s&&(s.isHorizontallyCentered?n.x+=t.width/2:s.isRight&&(n.x+=t.width),s.isVerticallyCentered?n.y+=t.height/2:s.isBottom&&(n.y+=t.height)),n},_getTransformOrigin:function(){var t="",n=e.Placement.properties[this.placement];return n&&(n.isLeft?t="left":n.isRight&&(t="right"),n.isTop?t+=" top":n.isBottom&&(t+=" bottom")),t},update:function(t,n){var s=e.isPlainObject(t)?t:{location:t,placement:n};this._init({location:s.location||this.location,placement:s.placement!==0[0]?s.placement:this.placement,onDraw:s.onDraw||this.onDraw,checkResize:s.checkResize||this.checkResize,width:s.width!==0[0]?s.width:this.width,height:s.height!==0[0]?s.height:this.height,rotationMode:s.rotationMode||this.rotationMode})},getBounds:function(t){e.console.assert(t,"A viewport must now be passed to Overlay.getBounds.");var o,i,n=this.width,s=this.height;return(n===null||s===null)&&(i=t.deltaPointsFromPixelsNoRotate(this.size,!0),n===null&&(n=i.x),s===null&&(s=i.y)),o=this.location.clone(),this.adjust(o,new e.Point(n,s)),this._adjustBoundsForRotation(t,new e.Rect(o.x,o.y,n,s))},_adjustBoundsForRotation:function(t,n){if(!t||t.getRotation(!0)===0||this.rotationMode===e.OverlayRotationMode.EXACT)return n;if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return n;var s=this._getOverlayPositionAndSize(t);return t.viewerElementToViewportRectangle(new e.Rect(s.position.x,s.position.y,s.size.x,s.size.y))}return n.rotate(-t.getRotation(!0),this._getPlacementPoint(n))}}}(t),function(e){const t=e;t.DrawerBase=class{constructor(t){e.console.assert(t.viewer,"[Drawer] options.viewer is required"),e.console.assert(t.viewport,"[Drawer] options.viewport is required"),e.console.assert(t.element,"[Drawer] options.element is required"),this.viewer=t.viewer,this.viewport=t.viewport,this.debugGridColor=typeof t.debugGridColor=="string"?[t.debugGridColor]:t.debugGridColor||e.DEFAULT_SETTINGS.debugGridColor,this.options=t.options||{},this.container=e.getElement(t.element),this._renderingTarget=this._createDrawingElement(),this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",this.canvas.style.left="0",e.setElementOpacity(this.canvas,this.viewer.opacity,!0),e.setElementPointerEventsNone(this.canvas),e.setElementTouchActionNone(this.canvas),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._checkForAPIOverrides()}get canvas(){return this._renderingTarget}get element(){return e.console.error("Drawer.element is deprecated. Use Drawer.container instead."),this.container}getType(){e.console.error("Drawer.getType must be implemented by child class")}static isSupported(){e.console.error("Drawer.isSupported must be implemented by child class")}_createDrawingElement(){return e.console.error("Drawer._createDrawingElement must be implemented by child class"),null}draw(){e.console.error("Drawer.draw must be implemented by child class")}canRotate(){e.console.error("Drawer.canRotate must be implemented by child class")}destroy(){e.console.error("Drawer.destroy must be implemented by child class")}minimumOverlapRequired(){return!1}setImageSmoothingEnabled(){e.console.error("Drawer.setImageSmoothingEnabled must be implemented by child class")}drawDebuggingRect(){e.console.warn("[drawer].drawDebuggingRect is not implemented by this drawer")}clear(){e.console.warn("[drawer].clear() is deprecated. The drawer is responsible for clearing itself as needed before drawing tiles.")}_checkForAPIOverrides(){if(this._createDrawingElement===e.DrawerBase.prototype._createDrawingElement)throw new Error("[drawer]._createDrawingElement must be implemented by child class");if(this.draw===e.DrawerBase.prototype.draw)throw new Error("[drawer].draw must be implemented by child class");if(this.canRotate===e.DrawerBase.prototype.canRotate)throw new Error("[drawer].canRotate must be implemented by child class");if(this.destroy===e.DrawerBase.prototype.destroy)throw new Error("[drawer].destroy must be implemented by child class");if(this.setImageSmoothingEnabled===e.DrawerBase.prototype.setImageSmoothingEnabled)throw new Error("[drawer].setImageSmoothingEnabled must be implemented by child class")}viewportToDrawerRectangle(t){var n=this.viewport.pixelFromPointNoRotate(t.getTopLeft(),!0),s=this.viewport.deltaPixelsFromPointsNoRotate(t.getSize(),!0);return new e.Rect(n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio,s.x*e.pixelDensityRatio,s.y*e.pixelDensityRatio)}viewportCoordToDrawerCoord(t){var n=this.viewport.pixelFromPointNoRotate(t,!0);return new e.Point(n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio)}_calculateCanvasSize(){var n=e.pixelDensityRatio,s=this.viewport.getContainerSize();return new t.Point(Math.round(s.x*n),Math.round(s.y*n))}_raiseTiledImageDrawnEvent(e,t){this.viewer&&this.viewer.raiseEvent("tiled-image-drawn",{tiledImage:e,tiles:t})}_raiseDrawerErrorEvent(e,t){this.viewer&&this.viewer.raiseEvent("drawer-error",{tiledImage:e,drawer:this,error:t})}}}(t),function(e){const t=e;class n extends t.DrawerBase{constructor(e){super(e),this.viewer.rejectEventHandler("tile-drawing","The HTMLDrawer does not raise the tile-drawing event"),this.viewer.allowEventHandler("tile-drawn")}static isSupported(){return!0}getType(){return"html"}minimumOverlapRequired(){return!0}_createDrawingElement(){return e.makeNeutralElement("div")}draw(e){var t=this;this._prepareNewFrame(),e.forEach(function(e){e.opacity!==0&&t._drawTiles(e)})}canRotate(){return!1}destroy(){this.container.removeChild(this.canvas)}setImageSmoothingEnabled(){}_prepareNewFrame(){this.canvas.innerHTML=""}_drawTiles(e){var t,s,n=e.getTilesToDraw().map(e=>e.tile);if(!(e.opacity===0||n.length===0&&!e.placeholderFillStyle))for(t=n.length-1;t>=0;t--)s=n[t],this._drawTile(s),this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:e,tile:s})}_drawTile(t){e.console.assert(t,"[Drawer._drawTile] tile is required");let n=this.canvas;if(!t.cacheImageRecord){e.console.warn("[Drawer._drawTileToHTML] attempting to draw tile %s when it's not cached",t.toString());return}if(!t.loaded){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",t.toString());return}if(!t.element){var s=t.getImage();if(!s)return;t.element=e.makeNeutralElement("div"),t.imgElement=s.cloneNode(),t.imgElement.style.msInterpolationMode="nearest-neighbor",t.imgElement.style.width="100%",t.imgElement.style.height="100%",t.style=t.element.style,t.style.position="absolute"}t.element.parentNode!==n&&n.appendChild(t.element),t.imgElement.parentNode!==t.element&&t.element.appendChild(t.imgElement),t.style.top=t.position.y+"px",t.style.left=t.position.x+"px",t.style.height=t.size.y+"px",t.style.width=t.size.x+"px",t.flipped&&(t.style.transform="scaleX(-1)"),e.setElementOpacity(t.element,t.opacity)}}e.HTMLDrawer=n}(t),function(e){const o=e;class i extends o.DrawerBase{constructor(e){super(e),this.context=this.canvas.getContext("2d"),this.sketchCanvas=null,this.sketchContext=null,this._imageSmoothingEnabled=!0,this.viewer.allowEventHandler("tile-drawn"),this.viewer.allowEventHandler("tile-drawing")}static isSupported(){return e.supportsCanvas}getType(){return"canvas"}_createDrawingElement(){let t=e.makeNeutralElement("canvas"),n=this._calculateCanvasSize();return t.width=n.x,t.height=n.y,t}draw(e){this._prepareNewFrame(),this.viewer.viewport.getFlip()!==this._viewportFlipped&&this._flip();for(const t of e)t.opacity!==0&&this._drawTiles(t)}canRotate(){return!0}destroy(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null,this.container.removeChild(this.canvas)}minimumOverlapRequired(){return!0}setImageSmoothingEnabled(e){this._imageSmoothingEnabled=!!e,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw()}drawDebuggingRect(t){var n=this.context;n.save(),n.lineWidth=2*e.pixelDensityRatio,n.strokeStyle=this.debugGridColor[0],n.fillStyle=this.debugGridColor[0],n.strokeRect(t.x*e.pixelDensityRatio,t.y*e.pixelDensityRatio,t.width*e.pixelDensityRatio,t.height*e.pixelDensityRatio),n.restore()}get _viewportFlipped(){return this.context.getTransform().a<0}_raiseTileDrawingEvent(e,t,n,s){this.viewer.raiseEvent("tile-drawing",{tiledImage:e,context:t,tile:n,rendered:s})}_prepareNewFrame(){var t,e=this._calculateCanvasSize();(this.canvas.width!==e.x||this.canvas.height!==e.y)&&(this.canvas.width=e.x,this.canvas.height=e.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)&&(t=this._calculateSketchCanvasSize(),this.sketchCanvas.width=t.x,this.sketchCanvas.height=t.y,this._updateImageSmoothingEnabled(this.sketchContext)),this._clear()}_clear(e,t){var s,n=this._getContext(e);t?n.clearRect(t.x,t.y,t.width,t.height):(s=n.canvas,n.clearRect(0,0,s.width,s.height))}_drawTiles(t){if(r=t.getTilesToDraw().map(e=>e.tile),!(t.opacity===0||r.length===0&&!t.placeholderFillStyle)){o=r[0],o&&(s=t.opacity<1||t.compositeOperation&&t.compositeOperation!=="source-over"||!t._isBottomItem()&&t.source.hasTransparency(o.context2D,o.getUrl(),o.ajaxHeaders,o.postData));var n,s,o,i,r,c,l,d,u,h,m,f,p,g,v,j=this.viewport.getZoom(!0),b=t.viewportToImageZoom(j);if(r.length>1&&b>t.smoothTileEdgesMinZoom&&!t.iOSDevice&&t.getRotation(!0)%360===0&&(s=!0,n=o.getScaleForEdgeSmoothing(),i=o.getTranslationForEdgeSmoothing(n,this._getCanvasSize(!1),this._getCanvasSize(!0))),s&&(n||(d=this.viewport.viewportToViewerElementRectangle(t.getClippedBounds(!0)).getIntegerBoundingBox(),d=d.times(e.pixelDensityRatio)),this._clear(!0,d)),n||this._setRotations(t,s),l=!1,t._clip&&(this._saveContext(s),u=t.imageToViewportRectangle(t._clip,!0),u=u.rotate(-t.getRotation(!0),t._getRotationPoint(!0)),c=this.viewportToDrawerRectangle(u),n&&(c=c.times(n)),i&&(c=c.translate(i)),this._setClip(c,s),l=!0),t._croppingPolygons){p=this,l||this._saveContext(s);try{g=t._croppingPolygons.map(function(e){return e.map(function(e){var o=t.imageToViewportCoordinates(e.x,e.y,!0).rotate(-t.getRotation(!0),t._getRotationPoint(!0)),s=p.viewportCoordToDrawerCoord(o);return n&&(s=s.times(n)),i&&(s=s.plus(i)),s})}),this._clipWithPolygons(g,s)}catch(t){e.console.error(t)}l=!0}if(t._hasOpaqueTile=!1,t.placeholderFillStyle&&t._hasOpaqueTile===!1){let e=this.viewportToDrawerRectangle(t.getBoundsNoRotate(!0));n&&(e=e.times(n)),i&&(e=e.translate(i));let o=null;typeof t.placeholderFillStyle=="function"?o=t.placeholderFillStyle(t,this.context):o=t.placeholderFillStyle,this._drawRectangle(e,o,s)}f=a(t.subPixelRoundingForTransparency),h=!1,f===e.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS?h=!0:f===e.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&(v=this.viewer&&this.viewer.isAnimating(),h=!v);for(m=0;m<r.length;m++)o=r[m],this._drawTile(o,t,s,n,i,h,t.source),this.viewer&&this.viewer.raiseEvent("tile-drawn",{tiledImage:t,tile:o});l&&this._restoreContext(s),n||(t.getRotation(!0)%360!==0&&this._restoreRotationChanges(s),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(s)),s&&(n&&this._setRotations(t),this.blendSketch({opacity:t.opacity,scale:n,translate:i,compositeOperation:t.compositeOperation,bounds:d}),n&&(t.getRotation(!0)%360!==0&&this._restoreRotationChanges(!1),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(!1))),this._drawDebugInfo(t,r),this._raiseTiledImageDrawnEvent(t,r)}}_drawDebugInfo(t,n){if(t.debugMode)for(var o,s=n.length-1;s>=0;s--){o=n[s];try{this._drawDebugInfoOnTile(o,n.length,s,t)}catch(t){e.console.error(t)}}}_clipWithPolygons(e,t){var n=this._getContext(t);n.beginPath();for(const t of e)for(const[s,e]of t.entries())n[s===0?"moveTo":"lineTo"](e.x,e.y);n.clip()}_drawTile(t,n,s,o,i,a,r){e.console.assert(t,"[Drawer._drawTile] tile is required"),e.console.assert(n,"[Drawer._drawTile] drawingHandler is required");var c=this._getContext(s);o=o||1,this._drawTileToCanvas(t,c,n,o,i,a,r)}_drawTileToCanvas(t,n,s,o,i,a){var d,u,h,c=t.position.times(e.pixelDensityRatio),l=t.size.times(e.pixelDensityRatio);if(!t.context2D&&!t.cacheImageRecord){e.console.warn("[Drawer._drawTileToCanvas] attempting to draw tile %s when it's not cached",t.toString());return}if(d=t.getCanvasContext(),!t.loaded||!d){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",t.toString());return}n.save(),typeof o=="number"&&o!==1&&(c=c.times(o),l=l.times(o)),i instanceof e.Point&&(c=c.plus(i)),n.globalAlpha===1&&t.hasTransparency&&(a&&(c.x=Math.round(c.x),c.y=Math.round(c.y),l.x=Math.round(l.x),l.y=Math.round(l.y)),n.clearRect(c.x,c.y,l.x,l.y)),this._raiseTileDrawingEvent(s,n,t,d),t.sourceBounds?(u=Math.min(t.sourceBounds.width,d.canvas.width),h=Math.min(t.sourceBounds.height,d.canvas.height)):(u=d.canvas.width,h=d.canvas.height),n.translate(c.x+l.x/2,0),t.flipped&&n.scale(-1,1),n.drawImage(d.canvas,0,0,u,h,-l.x/2,c.y,l.x,l.y),n.restore()}_getContext(e){var t,n,s=this.context;return e&&(this.sketchCanvas===null&&(this.sketchCanvas=document.createElement("canvas"),n=this._calculateSketchCanvasSize(),(this.sketchCanvas.width=n.x,this.sketchCanvas.height=n.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0)&&(t=this,this.viewer.addHandler("rotate",function e(){if(t.viewport.getRotation()!==0){t.viewer.removeHandler("rotate",e);var n=t._calculateSketchCanvasSize();t.sketchCanvas.width=n.x,t.sketchCanvas.height=n.y}})),this._updateImageSmoothingEnabled(this.sketchContext)),s=this.sketchContext),s}_saveContext(e){this._getContext(e).save()}_restoreContext(e){this._getContext(e).restore()}_setClip(e,t){var n=this._getContext(t);n.beginPath(),n.rect(e.x,e.y,e.width,e.height),n.clip()}_drawRectangle(e,t,n){var s=this._getContext(n);s.save(),s.fillStyle=t,s.fillRect(e.x,e.y,e.width,e.height),s.restore()}blendSketch(t,n,s,o){if(a=t,e.isPlainObject(a)||(a={opacity:t,scale:n,translate:s,compositeOperation:o}),t=a.opacity,o=a.compositeOperation,i=a.bounds,this.context.save(),this.context.globalAlpha=t,o&&(this.context.globalCompositeOperation=o),i)i.x<0&&(i.width+=i.x,i.x=0),i.x+i.width>this.canvas.width&&(i.width=this.canvas.width-i.x),i.y<0&&(i.height+=i.y,i.y=0),i.y+i.height>this.canvas.height&&(i.height=this.canvas.height-i.y),this.context.drawImage(this.sketchCanvas,i.x,i.y,i.width,i.height,i.x,i.y,i.width,i.height);else{n=a.scale||1,s=a.translate;var i,a,d,u,l=s instanceof e.Point?s:new e.Point(0,0),r=0,c=0;s&&(d=this.sketchCanvas.width-this.canvas.width,u=this.sketchCanvas.height-this.canvas.height,r=Math.round(d/2),c=Math.round(u/2)),this.context.drawImage(this.sketchCanvas,l.x-r*n,l.y-c*n,(this.canvas.width+2*r)*n,(this.canvas.height+2*c)*n,-r,-c,this.canvas.width+2*r,this.canvas.height+2*c)}this.context.restore()}_drawDebugInfoOnTile(t,n,s,o){var a,r,c=this.viewer.world.getIndexOfItem(o)%this.debugGridColor.length,i=this.context;i.save(),i.lineWidth=2*e.pixelDensityRatio,i.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",i.strokeStyle=this.debugGridColor[c],i.fillStyle=this.debugGridColor[c],this._setRotations(o),this._viewportFlipped&&this._flip({point:t.position.plus(t.size.divide(2))}),i.strokeRect(t.position.x*e.pixelDensityRatio,t.position.y*e.pixelDensityRatio,t.size.x*e.pixelDensityRatio,t.size.y*e.pixelDensityRatio),a=(t.position.x+t.size.x/2)*e.pixelDensityRatio,r=(t.position.y+t.size.y/2)*e.pixelDensityRatio,i.translate(a,r);const l=this.viewport.getRotation(!0);i.rotate(Math.PI/180*-l),i.translate(-a,-r),t.x===0&&t.y===0&&(i.fillText("Zoom: "+this.viewport.getZoom(),t.position.x*e.pixelDensityRatio,(t.position.y-30)*e.pixelDensityRatio),i.fillText("Pan: "+this.viewport.getBounds().toString(),t.position.x*e.pixelDensityRatio,(t.position.y-20)*e.pixelDensityRatio)),i.fillText("Level: "+t.level,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+20)*e.pixelDensityRatio),i.fillText("Column: "+t.x,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+30)*e.pixelDensityRatio),i.fillText("Row: "+t.y,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+40)*e.pixelDensityRatio),i.fillText("Order: "+s+" of "+n,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+50)*e.pixelDensityRatio),i.fillText("Size: "+t.size.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+60)*e.pixelDensityRatio),i.fillText("Position: "+t.position.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+70)*e.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),o.getRotation(!0)%360!==0&&this._restoreRotationChanges(),i.restore()}_updateImageSmoothingEnabled(e){e.msImageSmoothingEnabled=this._imageSmoothingEnabled,e.imageSmoothingEnabled=this._imageSmoothingEnabled}_getCanvasSize(t){var n=this._getContext(t).canvas;return new e.Point(n.width,n.height)}_getCanvasCenter(){return new e.Point(this.canvas.width/2,this.canvas.height/2)}_setRotations(e,t=!1){var n=!1;this.viewport.getRotation(!0)%360!==0&&(this._offsetForRotation({degrees:this.viewport.getRotation(!0),useSketch:t,saveContext:n}),n=!1),e.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:e.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:t,saveContext:n})}_offsetForRotation(t){var n=t.point?t.point.times(e.pixelDensityRatio):this._getCanvasCenter(),s=this._getContext(t.useSketch);s.save(),s.translate(n.x,n.y),s.rotate(Math.PI/180*t.degrees),s.translate(-n.x,-n.y)}_flip(t){t=t||{};var s=t.point?t.point.times(e.pixelDensityRatio):this._getCanvasCenter(),n=this._getContext(t.useSketch);n.translate(s.x,0),n.scale(-1,1),n.translate(-s.x,0)}_restoreRotationChanges(e){var t=this._getContext(e);t.restore()}_calculateCanvasSize(){var t=e.pixelDensityRatio,n=this.viewport.getContainerSize();return{x:Math.round(n.x*t),y:Math.round(n.y*t)}}_calculateSketchCanvasSize(){var t,e=this._calculateCanvasSize();return this.viewport.getRotation()===0?e:(t=Math.ceil((e.x*e.x+e.y*e.y)**.5),{x:t,y:t})}}e.CanvasDrawer=i;var t=e.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER;function n(t){return t!==e.SUBPIXEL_ROUNDING_OCCURRENCES.ALWAYS&&t!==e.SUBPIXEL_ROUNDING_OCCURRENCES.ONLY_AT_REST&&t!==e.SUBPIXEL_ROUNDING_OCCURRENCES.NEVER}function s(e){return n(e)?t:e}function a(o){if(typeof o=="number")return s(o);if(!o||!e.Browser)return t;var i=o[e.Browser.vendor];return n(i)&&(i=o["*"]),s(i)}}(t),function(e){const t=e;t.WebGLDrawer=class extends t.DrawerBase{constructor(e){super(e),this._destroyed=!1,this._TextureMap=new Map,this._TileMap=new Map,this._gl=null,this._firstPass=null,this._secondPass=null,this._glFrameBuffer=null,this._renderToTexture=null,this._glFramebufferToCanvasTransform=null,this._outputCanvas=null,this._outputContext=null,this._clippingCanvas=null,this._clippingContext=null,this._renderingCanvas=null,this._backupCanvasDrawer=null,this._imageSmoothingEnabled=!0,this._boundToTileReady=e=>this._tileReadyHandler(e),this._boundToImageUnloaded=e=>this._imageUnloadedHandler(e),this.viewer.addHandler("tile-ready",this._boundToTileReady),this.viewer.addHandler("image-unloaded",this._boundToImageUnloaded),this.viewer.rejectEventHandler("tile-drawn","The WebGLDrawer does not raise the tile-drawn event"),this.viewer.rejectEventHandler("tile-drawing","The WebGLDrawer does not raise the tile-drawing event"),this._setupCanvases(),this._setupRenderer(),this.context=this._outputContext}destroy(){if(this._destroyed)return;let e=this._gl;var n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(let t=0;t<n;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null);e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),this._unloadTextures(),e.deleteBuffer(this._secondPass.bufferOutputPosition),e.deleteFramebuffer(this._glFrameBuffer),this._renderingCanvas.width=this._renderingCanvas.height=1,this._clippingCanvas.width=this._clippingCanvas.height=1,this._outputCanvas.width=this._outputCanvas.height=1,this._renderingCanvas=null,this._clippingCanvas=this._clippingContext=null,this._outputCanvas=this._outputContext=null;let t=e.getExtension("WEBGL_lose_context");t&&t.loseContext(),this.viewer.removeHandler("tile-ready",this._boundToTileReady),this.viewer.removeHandler("image-unloaded",this._boundToImageUnloaded),this.viewer.removeHandler("resize",this._resizeHandler),this._gl=null,this._backupCanvasDrawer&&(this._backupCanvasDrawer.destroy(),this._backupCanvasDrawer=null),this.container.removeChild(this.canvas),this.viewer.drawer===this&&(this.viewer.drawer=null),this._destroyed=!0}canRotate(){return!0}static isSupported(){let n=document.createElement("canvas"),t=e.isFunction(n.getContext)&&n.getContext("webgl"),s=t&&t.getExtension("WEBGL_lose_context");return s&&s.loseContext(),!!t}getType(){return"webgl"}minimumOverlapRequired(e){return e.isTainted()}_createDrawingElement(){let t=e.makeNeutralElement("canvas"),n=this._calculateCanvasSize();return t.width=n.x,t.height=n.y,t}_getBackupCanvasDrawer(){return this._backupCanvasDrawer||(this._backupCanvasDrawer=this.viewer.requestDrawer("canvas",{mainDrawer:!1}),this._backupCanvasDrawer.canvas.style.setProperty("visibility","hidden")),this._backupCanvasDrawer}draw(n){let s=this._gl;const i=this.viewport.getBoundsNoRotateWithMargins(!0);let a={bounds:i,center:new t.Point(i.x+i.width/2,i.y+i.height/2),rotation:this.viewport.getRotation(!0)*Math.PI/180},c=this.viewport.flipped?-1:1,l=e.Mat3.makeTranslation(-a.center.x,-a.center.y),d=e.Mat3.makeScaling(2/a.bounds.width*c,-2/a.bounds.height),u=e.Mat3.makeRotation(-a.rotation),r=d.multiply(u).multiply(l);s.bindFramebuffer(s.FRAMEBUFFER,null),s.clear(s.COLOR_BUFFER_BIT),this._outputContext.clearRect(0,0,this._outputCanvas.width,this._outputCanvas.height);let o=!1;n.forEach((t,n)=>{if(t.isTainted()){o&&(this._outputContext.drawImage(this._renderingCanvas,0,0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.clear(s.COLOR_BUFFER_BIT),o=!1);const e=this._getBackupCanvasDrawer();e.draw([t]),this._outputContext.drawImage(e.canvas,0,0)}else{let a=t.getTilesToDraw();if(t.placeholderFillStyle&&t._hasOpaqueTile===!1&&this._drawPlaceholder(t),a.length===0||t.getOpacity()===0)return;let g=a[0],c=t.compositeOperation||this.viewer.compositeOperation||t._clip||t._croppingPolygons||t.debugMode,l=c||t.opacity<1||g.hasTransparency;c&&(o&&this._outputContext.drawImage(this._renderingCanvas,0,0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.clear(s.COLOR_BUFFER_BIT)),s.useProgram(this._firstPass.shaderProgram),l?(s.bindFramebuffer(s.FRAMEBUFFER,this._glFrameBuffer),s.clear(s.COLOR_BUFFER_BIT)):s.bindFramebuffer(s.FRAMEBUFFER,null);let d=r,u=t.getRotation(!0);if(u%360!==0){let s=e.Mat3.makeRotation(-u*Math.PI/180),n=t.getBoundsNoRotate(!0).getCenter(),o=e.Mat3.makeTranslation(n.x,n.y),i=e.Mat3.makeTranslation(-n.x,-n.y),a=o.multiply(s).multiply(i);d=r.multiply(a)}let i=this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS);if(i<=0)throw new Error(`WegGL error: bad value for gl parameter MAX_TEXTURE_IMAGE_UNITS (${i}). This could happen
                        if too many contexts have been created and not released, or there is another problem with the graphics card.`);let h=new Float32Array(i*12),m=new Array(i),f=new Array(i),p=new Array(i);for(let e=0;e<a.length;e++){let r=a[e].tile,l=e%i,c=l+1,n=r.getCanvasContext(),o=n?this._TextureMap.get(n.canvas):null;if(o||(this._tileReadyHandler({tile:r,tiledImage:t}),o=n?this._TextureMap.get(n.canvas):null),o&&this._getTileData(r,t,o,d,l,h,m,f,p),c===i||e===a.length-1){for(let e=0;e<=c;e++)s.activeTexture(s.TEXTURE0+e),s.bindTexture(s.TEXTURE_2D,m[e]);s.bindBuffer(s.ARRAY_BUFFER,this._firstPass.bufferTexturePosition),s.bufferData(s.ARRAY_BUFFER,h,s.DYNAMIC_DRAW),f.forEach((e,t)=>{s.uniformMatrix3fv(this._firstPass.uTransformMatrices[t],!1,e)}),s.uniform1fv(this._firstPass.uOpacities,new Float32Array(p)),s.bindBuffer(s.ARRAY_BUFFER,this._firstPass.bufferOutputPosition),s.vertexAttribPointer(this._firstPass.aOutputPosition,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this._firstPass.bufferTexturePosition),s.vertexAttribPointer(this._firstPass.aTexturePosition,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this._firstPass.bufferIndex),s.vertexAttribPointer(this._firstPass.aIndex,1,s.FLOAT,!1,0,0),s.drawArrays(s.TRIANGLES,0,6*c)}}l&&(s.useProgram(this._secondPass.shaderProgram),s.bindFramebuffer(s.FRAMEBUFFER,null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this._renderToTexture),this._gl.uniform1f(this._secondPass.uOpacityMultiplier,t.opacity),s.bindBuffer(s.ARRAY_BUFFER,this._secondPass.bufferTexturePosition),s.vertexAttribPointer(this._secondPass.aTexturePosition,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this._secondPass.bufferOutputPosition),s.vertexAttribPointer(this._secondPass.aOutputPosition,2,s.FLOAT,!1,0,0),s.drawArrays(s.TRIANGLES,0,6)),o=!0,c&&(this._applyContext2dPipeline(t,a,n),o=!1,s.bindFramebuffer(s.FRAMEBUFFER,null),s.clear(s.COLOR_BUFFER_BIT)),n===0&&this._raiseTiledImageDrawnEvent(t,a.map(e=>e.tile))}}),o&&this._outputContext.drawImage(this._renderingCanvas,0,0)}setImageSmoothingEnabled(e){this._imageSmoothingEnabled!==e&&(this._imageSmoothingEnabled=e,this._unloadTextures(),this.viewer.world.draw())}drawDebuggingRect(t){let n=this._outputContext;n.save(),n.lineWidth=2*e.pixelDensityRatio,n.strokeStyle=this.debugGridColor[0],n.fillStyle=this.debugGridColor[0],n.strokeRect(t.x*e.pixelDensityRatio,t.y*e.pixelDensityRatio,t.width*e.pixelDensityRatio,t.height*e.pixelDensityRatio),n.restore()}_getTextureDataFromTile(e){return e.getCanvasContext().canvas}_applyContext2dPipeline(e,t,n){if(this._outputContext.save(),this._outputContext.globalCompositeOperation=n===0?null:e.compositeOperation||this.viewer.compositeOperation,e._croppingPolygons||e._clip?(this._renderToClippingCanvas(e),this._outputContext.drawImage(this._clippingCanvas,0,0)):this._outputContext.drawImage(this._renderingCanvas,0,0),this._outputContext.restore(),e.debugMode){const n=this.viewer.viewport.getFlip();n&&this._flip(),this._drawDebugInfo(t,e,n),n&&this._flip()}}_getTileData(t,n,s,o,i,a,r,c,l){let g=s.texture,_=s.position;a.set(_,i*12);let h=this._calculateOverlapFraction(t,n),m=t.positionedBounds.width*h.x,f=t.positionedBounds.height*h.y,p=t.positionedBounds.x+(t.x===0?0:m),u=t.positionedBounds.y+(t.y===0?0:f),v=t.positionedBounds.x+t.positionedBounds.width-(t.isRightMost?0:m),b=t.positionedBounds.y+t.positionedBounds.height-(t.isBottomMost?0:f),j=v-p,y=b-u,d=new e.Mat3([j,0,0,0,y,0,p,u,1]);if(t.flipped){let t=e.Mat3.makeTranslation(.5,0),n=e.Mat3.makeTranslation(-.5,0),s=t.multiply(e.Mat3.makeScaling(-1,1)).multiply(n);d=d.multiply(s)}let w=o.multiply(d);l[i]=t.opacity,r[i]=g,c[i]=w.values}_textureFilter(){return this._imageSmoothingEnabled?this._gl.LINEAR:this._gl.NEAREST}_setupRenderer(){let t=this._gl;t||e.console.error("_setupCanvases must be called before _setupRenderer"),this._unitQuad=this._makeQuadVertexBuffer(0,1,0,1),this._makeFirstPassShaderProgram(),this._makeSecondPassShaderProgram(),this._renderToTexture=t.createTexture(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this._renderToTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._renderingCanvas.width,this._renderingCanvas.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this._textureFilter()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this._glFrameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._glFrameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._renderToTexture,0),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)}_makeFirstPassShaderProgram(){let t=this._glNumTextures=this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),o=()=>[...Array(t).keys()].map(e=>`uniform mat3 u_matrix_${e};`).join(`
`),i=()=>[...Array(t).keys()].map(e=>`${e>0?"else ":""}if(int(a_index) == ${e}) { transform_matrix = u_matrix_${e}; }`).join(`
`);const a=`
            attribute vec2 a_output_position;
            attribute vec2 a_texture_position;
            attribute float a_index;

            ${o()} // create a uniform mat3 for each potential tile to draw

            varying vec2 v_texture_position;
            varying float v_image_index;

            void main() {

                mat3 transform_matrix; // value will be set by the if/elses in makeConditional()

                ${i()}

                gl_Position = vec4(transform_matrix * vec3(a_output_position, 1), 1);

                v_texture_position = a_texture_position;
                v_image_index = a_index;
            }
            `,r=`
            precision mediump float;

            // our textures
            uniform sampler2D u_images[${t}];
            // our opacities
            uniform float u_opacities[${t}];

            // the varyings passed in from the vertex shader.
            varying vec2 v_texture_position;
            varying float v_image_index;

            void main() {
                // can't index directly with a variable, need to use a loop iterator hack
                for(int i = 0; i < ${t}; ++i){
                    if(i == int(v_image_index)){
                        gl_FragColor = texture2D(u_images[i], v_texture_position) * u_opacities[i];
                    }
                }
            }
            `;let e=this._gl,n=this.constructor.initShaderProgram(e,a,r);e.useProgram(n),this._firstPass={shaderProgram:n,aOutputPosition:e.getAttribLocation(n,"a_output_position"),aTexturePosition:e.getAttribLocation(n,"a_texture_position"),aIndex:e.getAttribLocation(n,"a_index"),uTransformMatrices:[...Array(this._glNumTextures).keys()].map(t=>e.getUniformLocation(n,`u_matrix_${t}`)),uImages:e.getUniformLocation(n,"u_images"),uOpacities:e.getUniformLocation(n,"u_opacities"),bufferOutputPosition:e.createBuffer(),bufferTexturePosition:e.createBuffer(),bufferIndex:e.createBuffer()},e.uniform1iv(this._firstPass.uImages,[...Array(t).keys()]);let s=new Float32Array(t*12);for(let e=0;e<t;++e)s.set(Float32Array.from(this._unitQuad),e*12);e.bindBuffer(e.ARRAY_BUFFER,this._firstPass.bufferOutputPosition),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),e.enableVertexAttribArray(this._firstPass.aOutputPosition),e.bindBuffer(e.ARRAY_BUFFER,this._firstPass.bufferTexturePosition),e.enableVertexAttribArray(this._firstPass.aTexturePosition),e.bindBuffer(e.ARRAY_BUFFER,this._firstPass.bufferIndex);let c=[...Array(this._glNumTextures).keys()].map(e=>Array(6).fill(e)).flat();e.bufferData(e.ARRAY_BUFFER,new Float32Array(c),e.STATIC_DRAW),e.enableVertexAttribArray(this._firstPass.aIndex)}_makeSecondPassShaderProgram(){const s=`
            attribute vec2 a_output_position;
            attribute vec2 a_texture_position;

            uniform mat3 u_matrix;

            varying vec2 v_texture_position;

            void main() {
                gl_Position = vec4(u_matrix * vec3(a_output_position, 1), 1);

                v_texture_position = a_texture_position;
            }
            `,o=`
            precision mediump float;

            // our texture
            uniform sampler2D u_image;

            // the texCoords passed in from the vertex shader.
            varying vec2 v_texture_position;

            // the opacity multiplier for the image
            uniform float u_opacity_multiplier;

            void main() {
                gl_FragColor = texture2D(u_image, v_texture_position);
                gl_FragColor *= u_opacity_multiplier;
            }
            `;let t=this._gl,n=this.constructor.initShaderProgram(t,s,o);t.useProgram(n),this._secondPass={shaderProgram:n,aOutputPosition:t.getAttribLocation(n,"a_output_position"),aTexturePosition:t.getAttribLocation(n,"a_texture_position"),uMatrix:t.getUniformLocation(n,"u_matrix"),uImage:t.getUniformLocation(n,"u_image"),uOpacityMultiplier:t.getUniformLocation(n,"u_opacity_multiplier"),bufferOutputPosition:t.createBuffer(),bufferTexturePosition:t.createBuffer()},t.bindBuffer(t.ARRAY_BUFFER,this._secondPass.bufferOutputPosition),t.bufferData(t.ARRAY_BUFFER,this._unitQuad,t.STATIC_DRAW),t.enableVertexAttribArray(this._secondPass.aOutputPosition),t.bindBuffer(t.ARRAY_BUFFER,this._secondPass.bufferTexturePosition),t.bufferData(t.ARRAY_BUFFER,this._unitQuad,t.DYNAMIC_DRAW),t.enableVertexAttribArray(this._secondPass.aTexturePosition);let i=e.Mat3.makeScaling(2,2).multiply(e.Mat3.makeTranslation(-.5,-.5));t.uniformMatrix3fv(this._secondPass.uMatrix,!1,i.values)}_resizeRenderer(){let e=this._gl,t=this._renderingCanvas.width,n=this._renderingCanvas.height;e.viewport(0,0,t,n),e.deleteTexture(this._renderToTexture),this._renderToTexture=e.createTexture(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._renderToTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this._textureFilter()),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindFramebuffer(e.FRAMEBUFFER,this._glFrameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._renderToTexture,0)}_setupCanvases(){let e=this;this._outputCanvas=this.canvas,this._outputContext=this._outputCanvas.getContext("2d"),this._renderingCanvas=document.createElement("canvas"),this._clippingCanvas=document.createElement("canvas"),this._clippingContext=this._clippingCanvas.getContext("2d"),this._renderingCanvas.width=this._clippingCanvas.width=this._outputCanvas.width,this._renderingCanvas.height=this._clippingCanvas.height=this._outputCanvas.height,this._gl=this._renderingCanvas.getContext("webgl"),this._resizeHandler=function(){e._outputCanvas!==e.viewer.drawer.canvas&&(e._outputCanvas.style.width=e.viewer.drawer.canvas.clientWidth+"px",e._outputCanvas.style.height=e.viewer.drawer.canvas.clientHeight+"px");let t=e._calculateCanvasSize();(e._outputCanvas.width!==t.x||e._outputCanvas.height!==t.y)&&(e._outputCanvas.width=t.x,e._outputCanvas.height=t.y),e._renderingCanvas.style.width=e._outputCanvas.clientWidth+"px",e._renderingCanvas.style.height=e._outputCanvas.clientHeight+"px",e._renderingCanvas.width=e._clippingCanvas.width=e._outputCanvas.width,e._renderingCanvas.height=e._clippingCanvas.height=e._outputCanvas.height,e._resizeRenderer()},this.viewer.addHandler("resize",this._resizeHandler)}_makeQuadVertexBuffer(e,t,n,s){return new Float32Array([e,s,t,s,e,n,e,n,t,s,t,n])}_tileReadyHandler(t){let n=t.tile,o=t.tiledImage;if(o.isTainted())return;let i=n.getCanvasContext(),s=i&&i.canvas;if(!s||e.isCanvasTainted(s)){o.isTainted()||(o.setTainted(!0),e.console.warn("WebGL cannot be used to draw this TiledImage because it has tainted data. Does crossOriginPolicy need to be set?"),this._raiseDrawerErrorEvent(o,"Tainted data cannot be used by the WebGLDrawer. Falling back to CanvasDrawer for this TiledImage."));return}if(!this._TextureMap.get(s)){let e=this._gl,c=e.createTexture(),r,l=o.source.tileOverlap,t,a;if(n.sourceBounds?(t=Math.min(n.sourceBounds.width,s.width)/s.width,a=Math.min(n.sourceBounds.height,s.height)/s.height):(t=1,a=1),l>0){let e=this._calculateOverlapFraction(n,o),s=(n.x===0?0:e.x)*t,i=(n.y===0?0:e.y)*a,c=(n.isRightMost?1:1-e.x)*t,l=(n.isBottomMost?1:1-e.y)*a;r=this._makeQuadVertexBuffer(s,c,i,l)}else t===1&&a===1?r=this._unitQuad:r=this._makeQuadVertexBuffer(0,t,0,a);let d={texture:c,position:r};this._TextureMap.set(s,d),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,c),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this._textureFilter()),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this._textureFilter()),this._uploadImageData(i)}}_calculateOverlapFraction(e,t){let n=t.source.tileOverlap,s=e.sourceBounds.width,o=e.sourceBounds.height,i=(e.x===0?0:n)+(e.isRightMost?0:n),a=(e.y===0?0:n)+(e.isBottomMost?0:n),r=n/(s+i),c=n/(o+a);return{x:r,y:c}}_unloadTextures(){Array.from(this._TextureMap.keys()).forEach(e=>{this._cleanupImageData(e)})}_uploadImageData(t){let n=this._gl,s=t.canvas;try{if(!s)throw t;n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,s)}catch(t){e.console.error("Error uploading image data to WebGL",t)}}_imageUnloadedHandler(e){let t=e.context2D.canvas;this._cleanupImageData(t)}_cleanupImageData(e){let t=this._TextureMap.get(e);this._TextureMap.delete(e),t&&this._gl.deleteTexture(t.texture)}_setClip(){}_renderToClippingCanvas(t){if(this._clippingContext.clearRect(0,0,this._clippingCanvas.width,this._clippingCanvas.height),this._clippingContext.save(),this.viewer.viewport.getFlip()){const t=new e.Point(this.canvas.width/2,this.canvas.height/2);this._clippingContext.translate(t.x,0),this._clippingContext.scale(-1,1),this._clippingContext.translate(-t.x,0)}if(t._clip){let e=[{x:t._clip.x,y:t._clip.y},{x:t._clip.x+t._clip.width,y:t._clip.y},{x:t._clip.x+t._clip.width,y:t._clip.y+t._clip.height},{x:t._clip.x,y:t._clip.y+t._clip.height}].map(e=>{let n=t.imageToViewportCoordinates(e.x,e.y,!0).rotate(this.viewer.viewport.getRotation(!0),this.viewer.viewport.getCenter(!0));return this.viewportCoordToDrawerCoord(n)});this._clippingContext.beginPath(),e.forEach((e,t)=>{this._clippingContext[t===0?"moveTo":"lineTo"](e.x,e.y)}),this._clippingContext.clip(),this._setClip()}if(t._croppingPolygons){let e=t._croppingPolygons.map(e=>e.map(e=>{let n=t.imageToViewportCoordinates(e.x,e.y,!0).rotate(this.viewer.viewport.getRotation(!0),this.viewer.viewport.getCenter(!0));return this.viewportCoordToDrawerCoord(n)}));this._clippingContext.beginPath(),e.forEach(e=>{e.forEach((e,t)=>{this._clippingContext[t===0?"moveTo":"lineTo"](e.x,e.y)})}),this._clippingContext.clip()}if(this.viewer.viewport.getFlip()){const t=new e.Point(this.canvas.width/2,this.canvas.height/2);this._clippingContext.translate(t.x,0),this._clippingContext.scale(-1,1),this._clippingContext.translate(-t.x,0)}this._clippingContext.drawImage(this._renderingCanvas,0,0),this._clippingContext.restore()}_setRotations(e){var t=!1;this.viewport.getRotation(!0)%360!==0&&(this._offsetForRotation({degrees:this.viewport.getRotation(!0),saveContext:t}),t=!1),e.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:e.getRotation(!0),point:this.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),saveContext:t})}_offsetForRotation(t){var n=t.point?t.point.times(e.pixelDensityRatio):this._getCanvasCenter(),s=this._outputContext;s.save(),s.translate(n.x,n.y),s.rotate(Math.PI/180*t.degrees),s.translate(-n.x,-n.y)}_flip(t){t=t||{};var s=t.point?t.point.times(e.pixelDensityRatio):this._getCanvasCenter(),n=this._outputContext;n.translate(s.x,0),n.scale(-1,1),n.translate(-s.x,0)}_drawDebugInfo(t,n,s){for(var i,o=t.length-1;o>=0;o--){i=t[o].tile;try{this._drawDebugInfoOnTile(i,t.length,o,n,s)}catch(t){e.console.error(t)}}}_drawDebugInfoOnTile(t,n,s,o,i){var r,c,l=this.viewer.world.getIndexOfItem(o)%this.debugGridColor.length,a=this.context;a.save(),a.lineWidth=2*e.pixelDensityRatio,a.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",a.strokeStyle=this.debugGridColor[l],a.fillStyle=this.debugGridColor[l],this._setRotations(o),i&&this._flip({point:t.position.plus(t.size.divide(2))}),a.strokeRect(t.position.x*e.pixelDensityRatio,t.position.y*e.pixelDensityRatio,t.size.x*e.pixelDensityRatio,t.size.y*e.pixelDensityRatio),r=(t.position.x+t.size.x/2)*e.pixelDensityRatio,c=(t.position.y+t.size.y/2)*e.pixelDensityRatio,a.translate(r,c);const d=this.viewport.getRotation(!0);a.rotate(Math.PI/180*-d),a.translate(-r,-c),t.x===0&&t.y===0&&(a.fillText("Zoom: "+this.viewport.getZoom(),t.position.x*e.pixelDensityRatio,(t.position.y-30)*e.pixelDensityRatio),a.fillText("Pan: "+this.viewport.getBounds().toString(),t.position.x*e.pixelDensityRatio,(t.position.y-20)*e.pixelDensityRatio)),a.fillText("Level: "+t.level,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+20)*e.pixelDensityRatio),a.fillText("Column: "+t.x,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+30)*e.pixelDensityRatio),a.fillText("Row: "+t.y,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+40)*e.pixelDensityRatio),a.fillText("Order: "+s+" of "+n,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+50)*e.pixelDensityRatio),a.fillText("Size: "+t.size.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+60)*e.pixelDensityRatio),a.fillText("Position: "+t.position.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+70)*e.pixelDensityRatio),this.viewport.getRotation(!0)%360!==0&&this._restoreRotationChanges(),o.getRotation(!0)%360!==0&&this._restoreRotationChanges(),a.restore()}_drawPlaceholder(e){const o=e.getBounds(!0),t=this.viewportToDrawerRectangle(e.getBounds(!0)),n=this._outputContext;let s;typeof e.placeholderFillStyle=="function"?s=e.placeholderFillStyle(e,n):s=e.placeholderFillStyle,this._offsetForRotation({degrees:this.viewer.viewport.getRotation(!0)}),n.fillStyle=s,n.translate(t.x,t.y),n.rotate(Math.PI/180*o.degrees),n.translate(-t.x,-t.y),n.fillRect(t.x,t.y,t.width,t.height),this._restoreRotationChanges()}_getCanvasCenter(){return new e.Point(this.canvas.width/2,this.canvas.height/2)}_restoreRotationChanges(){var e=this._outputContext;e.restore()}static initShaderProgram(t,n,s){function i(t,n,s){const o=t.createShader(n);return t.shaderSource(o,s),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?o:(e.console.error(`An error occurred compiling the shaders: ${t.getShaderInfoLog(o)}`),t.deleteShader(o),null)}const a=i(t,t.VERTEX_SHADER,n),r=i(t,t.FRAGMENT_SHADER,s),o=t.createProgram();return t.attachShader(o,a),t.attachShader(o,r),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)?o:(e.console.error(`Unable to initialize the shader program: ${t.getProgramInfoLog(o)}`),null)}}}(t),function(e){e.Viewport=function(t){var n=arguments;n.length&&n[0]instanceof e.Point&&(t={containerSize:n[0],contentSize:n[1],config:n[2]}),t.config&&(e.extend(!0,t,t.config),delete t.config),this._margins=e.extend({left:0,top:0,right:0,bottom:0},t.margins||{}),delete t.margins,t.initialDegrees=t.degrees,delete t.degrees,e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,rotationPivot:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,initialDegrees:e.DEFAULT_SETTINGS.degrees,flipped:e.DEFAULT_SETTINGS.flipped,homeFillsViewer:e.DEFAULT_SETTINGS.homeFillsViewer,silenceMultiImageWarnings:e.DEFAULT_SETTINGS.silenceMultiImageWarnings},t),this._updateContainerInnerSize(),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.degreesSpring=new e.Spring({initial:t.initialDegrees,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,this._setContentBounds(new e.Rect(0,0,1,1),1),this.goHome(!0),this.update()},e.Viewport.prototype={get degrees(){return e.console.warn("Accessing [Viewport.degrees] is deprecated. Use viewport.getRotation instead."),this.getRotation()},set degrees(t){e.console.warn("Setting [Viewport.degrees] is deprecated. Use viewport.rotateTo, viewport.rotateBy, or viewport.setRotation instead."),this.rotateTo(t)},resetContentSize:function(t){return e.console.assert(t,"[Viewport.resetContentSize] contentSize is required"),e.console.assert(t instanceof e.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),e.console.assert(t.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),e.console.assert(t.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new e.Rect(0,0,1,t.y/t.x),t.x),this},setHomeBounds:function(t,n){e.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(t,n)},_setContentBounds:function(t,n){e.console.assert(t,"[Viewport._setContentBounds] bounds is required"),e.console.assert(t instanceof e.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),e.console.assert(t.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),e.console.assert(t.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=t.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(n),this._contentBounds=t.rotate(this.getRotation()).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(n),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:n,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var t,e=this._contentAspectRatio/this.getAspectRatio();return this.homeFillsViewer?t=e>=1?e:1:t=e>=1?1:e,t/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var n=this._contentBounds.getCenter(),t=1/this.getHomeZoom(),s=t/this.getAspectRatio();return new e.Rect(n.x-t/2,n.y-s/2,t,s)},goHome:function(e){return this.viewer&&this.viewer.raiseEvent("home",{immediately:e}),this.fitBounds(this.getHomeBounds(),e)},getMinZoom:function(){var e=this.getHomeZoom(),t=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*e;return t},getMaxZoom:function(){var e=this.maxZoomLevel;return e||(e=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,e/=this._contentBounds.width),Math.max(e,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return e.extend({},this._margins)},setMargins:function(t){e.console.assert(e.type(t)==="object","[Viewport.setMargins] margins must be an object"),this._margins=e.extend({left:0,top:0,right:0,bottom:0},t),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(-this.getRotation(e))},getBoundsNoRotate:function(t){var s=this.getCenter(t),n=1/this.getZoom(t),o=n/this.getAspectRatio();return new e.Rect(s.x-n/2,s.y-o/2,n,o)},getBoundsWithMargins:function(e){return this.getBoundsNoRotateWithMargins(e).rotate(-this.getRotation(e),this.getCenter(e))},getBoundsNoRotateWithMargins:function(e){var t=this.getBoundsNoRotate(e),n=this._containerInnerSize.x*this.getZoom(e);return t.x-=this._margins.left/n,t.y-=this._margins.top/n,t.width+=(this._margins.left+this._margins.right)/n,t.height+=(this._margins.top+this._margins.bottom)/n,t},getCenter:function(t){var n,o,i,r,c,l,d,u,s=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),a=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return t?s:this.zoomPoint?(r=this.pixelFromPoint(this.zoomPoint,!0),o=this.getZoom(),n=1/o,i=n/this.getAspectRatio(),c=new e.Rect(s.x-n/2,s.y-i/2,n,i),l=this._pixelFromPoint(this.zoomPoint,c),d=l.minus(r).rotate(-this.getRotation(!0)),u=d.divide(this._containerInnerSize.x*o),a.plus(u)):a},getZoom:function(e){return e?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(e){return Math.max(Math.min(e,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(e){var s,a,r,c,l,d,u,h,m,f,p,g,t=this.viewportToViewerElementRectangle(e).getBoundingBox(),n=this.viewportToViewerElementRectangle(this._contentBoundsNoRotate).getBoundingBox(),o=!1,i=!1;return this.wrapHorizontal||(g=t.x+t.width,p=n.x+n.width,t.width>n.width?r=this.visibilityRatio*n.width:r=this.visibilityRatio*t.width,d=n.x-g+r,l=p-t.x-r,r>n.width?(t.x+=(d+l)/2,o=!0):l<0?(t.x+=l,o=!0):d>0&&(t.x+=d,o=!0)),this.wrapVertical||(m=t.y+t.height,f=n.y+n.height,t.height>n.height?s=this.visibilityRatio*n.height:s=this.visibilityRatio*t.height,c=n.y-m+s,u=f-t.y-s,s>n.height?(t.y+=(c+u)/2,i=!0):u<0?(t.y+=u,i=!0):c>0&&(t.y+=c,i=!0)),h=o||i,a=h?this.viewerElementToViewportRectangle(t):e.clone(),a.xConstrained=o,a.yConstrained=i,a.constraintApplied=h,a},_raiseConstraintsEvent:function(e){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:e})},applyConstraints:function(e){var t,n=this.getZoom(),s=this._applyZoomConstraints(n);return n!==s&&this.zoomTo(s,this.zoomPoint,e),t=this.getConstrainedBounds(!1),t.constraintApplied&&(this.fitBounds(t,e),this._raiseConstraintsEvent(e)),this},ensureVisible:function(e){return this.applyConstraints(e)},_fitBounds:function(t,n){n=n||{};var o,i,l,d,h,m,f,p,u=n.immediately||!1,c=n.constraints||!1,r=this.getAspectRatio(),a=t.getCenter(),s=new e.Rect(t.x,t.y,t.width,t.height,t.degrees+this.getRotation()).getBoundingBox();return s.getAspectRatio()>=r?s.height=s.width/r:s.width=s.height*r,s.x=a.x-s.width/2,s.y=a.y-s.height/2,o=1/s.width,u?(this.panTo(a,!0),this.zoomTo(o,null,!0),c&&this.applyConstraints(!0),this):(l=this.getCenter(!0),d=this.getZoom(!0),this.panTo(l,!0),this.zoomTo(d,null,!0),h=this.getBounds(),i=this.getZoom(),i===0||Math.abs(o/i-1)<1e-8?(this.zoomTo(o,null,!0),this.panTo(a,u),c&&this.applyConstraints(!1),this):(c?(this.panTo(a,!1),o=this._applyZoomConstraints(o),this.zoomTo(o,null,!1),m=this.getConstrainedBounds(),this.panTo(l,!0),this.zoomTo(d,null,!0),this.fitBounds(m)):(f=s.rotate(-this.getRotation()),p=f.getTopLeft().times(o).minus(h.getTopLeft().times(i)).divide(o-i),this.zoomTo(o,p,u)),this))},fitBounds:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!1})},fitBoundsWithConstraints:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!0})},fitVertically:function(t){var n=new e.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(n,t)},fitHorizontally:function(t){var n=new e.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(n,t)},getConstrainedBounds:function(e){var t,n;return t=this.getBounds(e),n=this._applyBoundaryConstraints(t),n},panBy:function(t,n){var s=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(s.plus(t),n)},panTo:function(e,t){return t?(this.centerSpringX.resetTo(e.x),this.centerSpringY.resetTo(e.y)):(this.centerSpringX.springTo(e.x),this.centerSpringY.springTo(e.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:e,immediately:t}),this},zoomBy:function(e,t,n){return this.zoomTo(this.zoomSpring.target.value*e,t,n)},zoomTo:function(t,n,s){var o=this;return this.zoomPoint=n instanceof e.Point&&!isNaN(n.x)&&!isNaN(n.y)?n:null,s?this._adjustCenterSpringsForZoomPoint(function(){o.zoomSpring.resetTo(t)}):this.zoomSpring.springTo(t),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:t,refPoint:n,immediately:s}),this},setRotation:function(e,t){return this.rotateTo(e,null,t)},getRotation:function(e){return e?this.degreesSpring.current.value:this.degreesSpring.target.value},setRotationWithPivot:function(e,t,n){return this.rotateTo(e,t,n)},rotateTo:function(t,n,s){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(this.degreesSpring.target.value===t&&this.degreesSpring.isAtTargetValue())return this;if(this.rotationPivot=n instanceof e.Point&&!isNaN(n.x)&&!isNaN(n.y)?n:null,s)if(this.rotationPivot){if(i=t-this._oldDegrees,!i)return this.rotationPivot=null,this;this._rotateAboutPivot(t)}else this.degreesSpring.resetTo(t);else{var i,c,a=e.positiveModulo(this.degreesSpring.current.value,360),o=e.positiveModulo(t,360),r=o-a;r>180?o-=360:r<-180&&(o+=360),c=a-o,this.degreesSpring.resetTo(t+c),this.degreesSpring.springTo(t)}return this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:t,immediately:!!s,pivot:this.rotationPivot||this.getCenter()}),this},rotateBy:function(e,t,n){return this.rotateTo(this.degreesSpring.target.value+e,t,n)},resize:function(e,t){var o,i,s=this.getBoundsNoRotate(),n=s;return this.containerSize.x=e.x,this.containerSize.y=e.y,this._updateContainerInnerSize(),t&&(o=e.x/this.containerSize.x,n.width=s.width*o,n.height=n.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:e,maintain:t}),i=this.fitBounds(n,!0),this.viewer&&this.viewer.raiseEvent("after-resize",{newContainerSize:e,maintain:t}),i},_updateContainerInnerSize:function(){this._containerInnerSize=new e.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var e,t,n=this;return this._adjustCenterSpringsForZoomPoint(function(){n.zoomSpring.update()}),this.degreesSpring.isAtTargetValue()&&(this.rotationPivot=null),this.centerSpringX.update(),this.centerSpringY.update(),this.rotationPivot?this._rotateAboutPivot(!0):this.degreesSpring.update(),e=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom||this.degreesSpring.current.value!==this._oldDegrees,this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._oldDegrees=this.degreesSpring.current.value,t=e||!this.zoomSpring.isAtTargetValue()||!this.centerSpringX.isAtTargetValue()||!this.centerSpringY.isAtTargetValue()||!this.degreesSpring.isAtTargetValue(),t},_rotateAboutPivot:function(e){var n,s,o=e===!0,t=this.rotationPivot.minus(this.getCenter());this.centerSpringX.shiftBy(t.x),this.centerSpringY.shiftBy(t.y),o?this.degreesSpring.update():this.degreesSpring.resetTo(e),s=this.degreesSpring.current.value-this._oldDegrees,n=t.rotate(s*-1).times(-1),this.centerSpringX.shiftBy(n.x),this.centerSpringY.shiftBy(n.y)},_adjustCenterSpringsForZoomPoint:function(e){if(this.zoomPoint){t=this.pixelFromPoint(this.zoomPoint,!0),e();var t,s=this.pixelFromPoint(this.zoomPoint,!0),o=s.minus(t),n=this.deltaPointsFromPixels(o,!0);this.centerSpringX.shiftBy(n.x),this.centerSpringY.shiftBy(n.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else e()},deltaPixelsFromPointsNoRotate:function(e,t){return e.times(this._containerInnerSize.x*this.getZoom(t))},deltaPixelsFromPoints:function(e,t){return this.deltaPixelsFromPointsNoRotate(e.rotate(this.getRotation(t)),t)},deltaPointsFromPixelsNoRotate:function(e,t){return e.divide(this._containerInnerSize.x*this.getZoom(t))},deltaPointsFromPixels:function(e,t){return this.deltaPointsFromPixelsNoRotate(e,t).rotate(-this.getRotation(t))},pixelFromPointNoRotate:function(e,t){return this._pixelFromPointNoRotate(e,this.getBoundsNoRotate(t))},pixelFromPoint:function(e,t){return this._pixelFromPoint(e,this.getBoundsNoRotate(t))},_pixelFromPointNoRotate:function(t,n){return t.minus(n.getTopLeft()).times(this._containerInnerSize.x/n.width).plus(new e.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(e,t){return this._pixelFromPointNoRotate(e.rotate(this.getRotation(!0),this.getCenter(!0)),t)},pointFromPixelNoRotate:function(t,n){var s=this.getBoundsNoRotate(n);return t.minus(new e.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/s.width).plus(s.getTopLeft())},pointFromPixel:function(e,t){return this.pointFromPixelNoRotate(e,t).rotate(-this.getRotation(t),this.getCenter(t))},_viewportToImageDelta:function(t,n){var s=this._contentBoundsNoRotate.width;return new e.Point(t*this._contentSizeNoRotate.x/s,n*this._contentSizeNoRotate.x/s)},viewportToImageCoordinates:function(t,n){if(t instanceof e.Point)return this.viewportToImageCoordinates(t.x,t.y);if(this.viewer){var o,s=this.viewer.world.getItemCount();if(s>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(s===1)return o=this.viewer.world.getItemAt(0),o.viewportToImageCoordinates(t,n,!0)}return this._viewportToImageDelta(t-this._contentBoundsNoRotate.x,n-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(t,n){var s=this._contentBoundsNoRotate.width;return new e.Point(t/this._contentSizeNoRotate.x*s,n/this._contentSizeNoRotate.x*s)},imageToViewportCoordinates:function(t,n){if(t instanceof e.Point)return this.imageToViewportCoordinates(t.x,t.y);if(this.viewer){var s,i,o=this.viewer.world.getItemCount();if(o>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(o===1)return i=this.viewer.world.getItemAt(0),i.imageToViewportCoordinates(t,n,!0)}return s=this._imageToViewportDelta(t,n),s.x+=this._contentBoundsNoRotate.x,s.y+=this._contentBoundsNoRotate.y,s},imageToViewportRectangle:function(t,n,s,o){if(i=t,i instanceof e.Rect||(i=new e.Rect(t,n,s,o)),this.viewer)if(a=this.viewer.world.getItemCount(),a>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(a===1)return r=this.viewer.world.getItemAt(0),r.imageToViewportRectangle(t,n,s,o,!0);var i,a,r,c=this.imageToViewportCoordinates(i.x,i.y),l=this._imageToViewportDelta(i.width,i.height);return new e.Rect(c.x,c.y,l.x,l.y,i.degrees)},viewportToImageRectangle:function(t,n,s,o){if(i=t,i instanceof e.Rect||(i=new e.Rect(t,n,s,o)),this.viewer)if(a=this.viewer.world.getItemCount(),a>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(a===1)return r=this.viewer.world.getItemAt(0),r.viewportToImageRectangle(t,n,s,o,!0);var i,a,r,c=this.viewportToImageCoordinates(i.x,i.y),l=this._viewportToImageDelta(i.width,i.height);return new e.Rect(c.x,c.y,l.x,l.y,i.degrees)},viewerElementToImageCoordinates:function(e){var t=this.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.pixelFromPoint(t,!0)},windowToImageCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var n=t.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(n)},imageToWindowCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var n=this.imageToViewerElementCoordinates(t);return n.plus(e.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(e){return this.pointFromPixel(e,!0)},viewportToViewerElementCoordinates:function(e){return this.pixelFromPoint(e,!0)},viewerElementToViewportRectangle:function(t){return e.Rect.fromSummits(this.pointFromPixel(t.getTopLeft(),!0),this.pointFromPixel(t.getTopRight(),!0),this.pointFromPixel(t.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(t){return e.Rect.fromSummits(this.pixelFromPoint(t.getTopLeft(),!0),this.pixelFromPoint(t.getTopRight(),!0),this.pixelFromPoint(t.getBottomLeft(),!0))},windowToViewportCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var n=t.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(n)},viewportToWindowCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var n=this.viewportToViewerElementCoordinates(t);return n.plus(e.getElementPosition(this.viewer.element))},viewportToImageZoom:function(t){if(this.viewer)if(n=this.viewer.world.getItemCount(),n>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(n===1)return s=this.viewer.world.getItemAt(0),s.viewportToImageZoom(t);var n,s,o=this._contentSizeNoRotate.x,i=this._containerInnerSize.x,a=this._contentBoundsNoRotate.width,r=i/o*a;return t*r},imageToViewportZoom:function(t){if(this.viewer)if(n=this.viewer.world.getItemCount(),n>1)this.silenceMultiImageWarnings||e.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image. Instead, use [TiledImage.imageToViewportZoom] for the specific image of interest");else if(n===1)return s=this.viewer.world.getItemAt(0),s.imageToViewportZoom(t);var n,s,o=this._contentSizeNoRotate.x,i=this._containerInnerSize.x,a=this._contentBoundsNoRotate.width,r=o/i/a;return t*r},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(e){return this.flipped===e?this:(this.flipped=e,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:e}),this)},getMaxZoomPixelRatio:function(){return this.maxZoomPixelRatio},setMaxZoomPixelRatio:function(t,n=!0,s=!1){e.console.assert(!isNaN(t),"[Viewport.setMaxZoomPixelRatio] ratio must be a number"),!isNaN(t)&&(this.maxZoomPixelRatio=t,n&&this.getZoom()>this.getMaxZoom()&&this.applyConstraints(s))}}}(t),function(e){e.TiledImage=function(n){this._initialized=!1,e.console.assert(n.tileCache,"[TiledImage] options.tileCache is required"),e.console.assert(n.drawer,"[TiledImage] options.drawer is required"),e.console.assert(n.viewer,"[TiledImage] options.viewer is required"),e.console.assert(n.imageLoader,"[TiledImage] options.imageLoader is required"),e.console.assert(n.source,"[TiledImage] options.source is required"),e.console.assert(!n.clip||n.clip instanceof e.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),e.EventSource.call(this),this._tileCache=n.tileCache,delete n.tileCache,this._drawer=n.drawer,delete n.drawer,this._imageLoader=n.imageLoader,delete n.imageLoader,n.clip instanceof e.Rect&&(this._clip=n.clip.clone()),delete n.clip;var s,o,i,a,r,c,l=n.x||0;delete n.x,i=n.y||0,delete n.y,this.normHeight=n.source.dimensions.y/n.source.dimensions.x,this.contentAspectX=n.source.dimensions.x/n.source.dimensions.y,s=1,n.width?(s=n.width,delete n.width,n.height&&(e.console.error("specifying both width and height to a tiledImage is not supported"),delete n.height)):n.height&&(s=n.height/this.normHeight,delete n.height),o=n.fitBounds,delete n.fitBounds,a=n.fitBoundsPlacement||t.Placement.CENTER,delete n.fitBoundsPlacement,r=n.degrees||0,delete n.degrees,c=n.ajaxHeaders,delete n.ajaxHeaders,e.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_needsDraw:!0,_needsUpdate:!0,_hasOpaqueTile:!1,_tilesLoading:0,_tilesToDraw:[],_lastDrawn:[],_isBlending:!1,_wasBlending:!1,_isTainted:!1,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:e.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:e.DEFAULT_SETTINGS.iOSDevice,debugMode:e.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:e.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:e.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:e.DEFAULT_SETTINGS.placeholderFillStyle,opacity:e.DEFAULT_SETTINGS.opacity,preload:e.DEFAULT_SETTINGS.preload,compositeOperation:e.DEFAULT_SETTINGS.compositeOperation,subPixelRoundingForTransparency:e.DEFAULT_SETTINGS.subPixelRoundingForTransparency,maxTilesPerFrame:e.DEFAULT_SETTINGS.maxTilesPerFrame},n),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new e.Spring({initial:l,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new e.Spring({initial:i,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new e.Spring({initial:s,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new e.Spring({initial:r,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),o&&this.fitBounds(o,a,!0),this._ownAjaxHeaders={},this.setAjaxHeaders(c,!1),this._initialized=!0},e.extend(e.TiledImage.prototype,e.EventSource.prototype,{needsDraw:function(){return this._needsDraw},redraw:function(){this._needsDraw=!0},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(e){e!==this._fullyLoaded&&(this._fullyLoaded=e,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=e.now(),this._needsDraw=!0},update:function(e){let n=this._xSpring.update(),s=this._ySpring.update(),o=this._scaleSpring.update(),i=this._degreesSpring.update(),t=n||s||o||i||this._needsUpdate;if(t||e||!this._fullyLoaded){let e=this._updateLevelsForViewport();this._setFullyLoaded(e)}return this._needsUpdate=!1,!!t&&(this._updateForScale(),this._raiseBoundsChange(),this._needsDraw=!0,!0)},setDrawn:function(){return this._needsDraw=this._isBlending||this._wasBlending,this._needsDraw},setTainted(e){this._isTainted=e},isTainted(){return this._isTainted},destroy:function(){this.reset(),this.source.destroy&&this.source.destroy(this.viewer)},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(this.getRotation(e),this._getRotationPoint(e))},getBoundsNoRotate:function(t){return t?new e.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new e.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return e.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(t){if(n=this.getBoundsNoRotate(t),this._clip){var n,o=t?this._worldWidthCurrent:this._worldWidthTarget,i=o/this.source.dimensions.x,s=this._clip.times(i);n=new e.Rect(n.x+s.x,n.y+s.y,s.width,s.height)}return n.rotate(this.getRotation(t),this._getRotationPoint(t))},getTileBounds:function(e,t,n){var s=this.source.getNumTiles(e),i=(s.x+t%s.x)%s.x,a=(s.y+n%s.y)%s.y,o=this.source.getTileBounds(e,i,a);return this.getFlip()&&(o.x=Math.max(0,1-o.x-o.width)),o.x+=(t-i)/s.x,o.y+=this._worldHeightCurrent/this._worldWidthCurrent*((n-a)/s.y),o},getContentSize:function(){return new e.Point(this.source.dimensions.x,this.source.dimensions.y)},getSizeInWindowCoordinates:function(){var t=this.imageToWindowCoordinates(new e.Point(0,0)),n=this.imageToWindowCoordinates(this.getContentSize());return new e.Point(n.x-t.x,n.y-t.y)},_viewportToImageDelta:function(t,n,s){var o=s?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(t*(this.source.dimensions.x/o),n*(this.source.dimensions.y*this.contentAspectX/o))},viewportToImageCoordinates:function(t,n,s){var o;return t instanceof e.Point?(s=n,o=t):o=new e.Point(t,n),o=o.rotate(-this.getRotation(s),this._getRotationPoint(s)),s?this._viewportToImageDelta(o.x-this._xSpring.current.value,o.y-this._ySpring.current.value):this._viewportToImageDelta(o.x-this._xSpring.target.value,o.y-this._ySpring.target.value)},_imageToViewportDelta:function(t,n,s){var o=s?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(t/this.source.dimensions.x*o,n/this.source.dimensions.y/this.contentAspectX*o)},imageToViewportCoordinates:function(t,n,s){t instanceof e.Point&&(s=n,n=t.y,t=t.x);var o=this._imageToViewportDelta(t,n,s);return s?(o.x+=this._xSpring.current.value,o.y+=this._ySpring.current.value):(o.x+=this._xSpring.target.value,o.y+=this._ySpring.target.value),o.rotate(this.getRotation(s),this._getRotationPoint(s))},imageToViewportRectangle:function(t,n,s,o,i){a=t,a instanceof e.Rect?i=n:a=new e.Rect(t,n,s,o);var a,r=this.imageToViewportCoordinates(a.getTopLeft(),i),c=this._imageToViewportDelta(a.width,a.height,i);return new e.Rect(r.x,r.y,c.x,c.y,a.degrees+this.getRotation(i))},viewportToImageRectangle:function(t,n,s,o,i){a=t,t instanceof e.Rect?i=n:a=new e.Rect(t,n,s,o);var a,r=this.viewportToImageCoordinates(a.getTopLeft(),i),c=this._viewportToImageDelta(a.width,a.height,i);return new e.Rect(r.x,r.y,c.x,c.y,a.degrees-this.getRotation(i))},viewerElementToImageCoordinates:function(e){var t=this.viewport.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.viewport.pixelFromPoint(t,!0)},windowToImageCoordinates:function(e){var n=e.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(n)},imageToWindowCoordinates:function(e){var n=this.imageToViewerElementCoordinates(e);return n.plus(t.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(t){var n=this._scaleSpring.current.value;return t=t.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new e.Rect((t.x-this._xSpring.current.value)/n,(t.y-this._ySpring.current.value)/n,t.width/n,t.height/n,t.degrees)},viewportToImageZoom:function(e){var t=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return t*e},imageToViewportZoom:function(e){var t=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return e/t},setPosition:function(e,t){var n=this._xSpring.target.value===e.x&&this._ySpring.target.value===e.y;if(t){if(n&&this._xSpring.current.value===e.x&&this._ySpring.current.value===e.y)return;this._xSpring.resetTo(e.x),this._ySpring.resetTo(e.y),this._needsDraw=!0,this._needsUpdate=!0}else{if(n)return;this._xSpring.springTo(e.x),this._ySpring.springTo(e.y),this._needsDraw=!0,this._needsUpdate=!0}n||this._raiseBoundsChange()},setWidth:function(e,t){this._setScale(e,t)},setHeight:function(e,t){this._setScale(e/this.normHeight,t)},setCroppingPolygons:function(t){var n=function(t){return t instanceof e.Point||typeof t.x=="number"&&typeof t.y=="number"},s=function(e){return e.map(function(e){try{if(n(e))return{x:e.x,y:e.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!e.isArray(t))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=t.map(function(e){return s(e)}),this._needsDraw=!0}catch(t){e.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),e.console.error(t),this.resetCroppingPolygons()}},resetCroppingPolygons:function(){this._croppingPolygons=null,this._needsDraw=!0},fitBounds:function(t,n,s){n=n||e.Placement.CENTER;var c,l,h,m,i=e.Placement.properties[n],o=this.contentAspectX,a=0,r=0,d=1,u=1;this._clip&&(o=this._clip.getAspectRatio(),d=this._clip.width/this.source.dimensions.x,u=this._clip.height/this.source.dimensions.y,t.getAspectRatio()>o?(a=this._clip.x/this._clip.height*t.height,r=this._clip.y/this._clip.height*t.height):(a=this._clip.x/this._clip.width*t.width,r=this._clip.y/this._clip.width*t.width)),t.getAspectRatio()>o?(h=t.height/u,c=0,i.isHorizontallyCentered?c=(t.width-t.height*o)/2:i.isRight&&(c=t.width-t.height*o),this.setPosition(new e.Point(t.x-a+c,t.y-r),s),this.setHeight(h,s)):(m=t.width/d,l=0,i.isVerticallyCentered?l=(t.height-t.width/o)/2:i.isBottom&&(l=t.height-t.width/o),this.setPosition(new e.Point(t.x-a,t.y-r+l),s),this.setWidth(m,s))},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(t){e.console.assert(!t||t instanceof e.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),t instanceof e.Rect?this._clip=t.clone():this._clip=null,this._needsUpdate=!0,this._needsDraw=!0,this.raiseEvent("clip-change")},getFlip:function(){return this.flipped},setFlip:function(e){this.flipped=e},get flipped(){return this._flipped},set flipped(e){let t=this._flipped!==!!e;this._flipped=!!e,t&&(this.update(!0),this._needsDraw=!0,this._raiseBoundsChange())},get wrapHorizontal(){return this._wrapHorizontal},set wrapHorizontal(e){let t=this._wrapHorizontal!==!!e;this._wrapHorizontal=!!e,this._initialized&&t&&(this.update(!0),this._needsDraw=!0)},get wrapVertical(){return this._wrapVertical},set wrapVertical(e){let t=this._wrapVertical!==!!e;this._wrapVertical=!!e,this._initialized&&t&&(this.update(!0),this._needsDraw=!0)},get debugMode(){return this._debugMode},set debugMode(e){this._debugMode=!!e,this._needsDraw=!0},getOpacity:function(){return this.opacity},setOpacity:function(e){this.opacity=e},get opacity(){return this._opacity},set opacity(e){e!==this.opacity&&(this._opacity=e,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(e){this._preload=!!e,this._needsDraw=!0},getRotation:function(e){return e?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(e,t){this._degreesSpring.target.value===e&&this._degreesSpring.isAtTargetValue()||(t?this._degreesSpring.resetTo(e):this._degreesSpring.springTo(e),this._needsDraw=!0,this._needsUpdate=!0,this._raiseBoundsChange())},getDrawArea:function(){if(this._opacity===0&&!this._preload)return!1;var t,e=this._viewportToTiledImageRectangle(this.viewport.getBoundsWithMargins(!0));return!this.wrapHorizontal&&!this.wrapVertical&&(t=this._viewportToTiledImageRectangle(this.getClippedBounds(!0)),e=e.intersection(t)),e},getTilesToDraw:function(){let e=this._tilesToDraw.flat();return this._updateTilesInViewport(e),e=this._tilesToDraw.flat(),e.forEach(e=>{e.tile.beingDrawn=!0}),this._lastDrawn=e,e},_getRotationPoint:function(e){return this.getBoundsNoRotate(e).getCenter()},get compositeOperation(){return this._compositeOperation},set compositeOperation(e){e!==this._compositeOperation&&(this._compositeOperation=e,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this._compositeOperation}))},getCompositeOperation:function(){return this._compositeOperation},setCompositeOperation:function(e){this.compositeOperation=e},setAjaxHeaders:function(t,n){if(t===null&&(t={}),!e.isPlainObject(t)){console.error("[TiledImage.setAjaxHeaders] Ignoring invalid headers, must be a plain object");return}this._ownAjaxHeaders=t,this._updateAjaxHeaders(n)},_updateAjaxHeaders:function(t){if(t===0[0]&&(t=!0),e.isPlainObject(this.viewer.ajaxHeaders)?this.ajaxHeaders=e.extend({},this.viewer.ajaxHeaders,this._ownAjaxHeaders):this.ajaxHeaders=this._ownAjaxHeaders,t){for(i in this.tilesMatrix){n=this.source.getNumTiles(i);for(r in this.tilesMatrix[i]){c=(n.x+r%n.x)%n.x;for(d in this.tilesMatrix[i][r])if(l=(n.y+d%n.y)%n.y,o=this.tilesMatrix[i][r][d],o.loadWithAjax=this.loadTilesWithAjax,o.loadWithAjax){var n,s,o,i,a,r,c,l,d,u=this.source.getTileAjaxHeaders(i,c,l);o.ajaxHeaders=e.extend({},this.ajaxHeaders,u)}else o.ajaxHeaders=null}}for(a=0;a<this._imageLoader.jobQueue.length;a++)s=this._imageLoader.jobQueue[a],s.loadWithAjax=s.tile.loadWithAjax,s.ajaxHeaders=s.tile.loadWithAjax?s.tile.ajaxHeaders:null}},_setScale:function(e,t){var n=this._scaleSpring.target.value===e;if(t){if(n&&this._scaleSpring.current.value===e)return;this._scaleSpring.resetTo(e),this._updateForScale(),this._needsDraw=!0,this._needsUpdate=!0}else{if(n)return;this._scaleSpring.springTo(e),this._updateForScale(),this._needsDraw=!0,this._needsUpdate=!0}n||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var t=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),n=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,e=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(n/this.minPixelRatio)/Math.log(2))));return e=Math.max(e,this.source.minLevel||0),t=Math.min(t,e),{lowestLevel:t,highestLevel:e}},_updateLevelsForViewport:function(){var t,s,o,f,p,l=this._getLevelsInterval(),d=l.lowestLevel,i=l.highestLevel,n=[],c=this.getDrawArea(),a=e.now();if(this._lastDrawn.forEach(e=>{e.tile.beingDrawn=!1}),this._tilesToDraw=[],this._tilesLoading=0,this.loadingCoverage={},!c)return this._needsDraw=!1,this._fullyLoaded;t=new Array(i-d+1);for(let n=0,e=i;e>=d;e--,n++)t[n]=e;for(let e=i+1;e<=this.source.maxLevel;e++)if(s=this.tilesMatrix[e]&&this.tilesMatrix[e][0]&&this.tilesMatrix[e][0][0],s&&s.isBottomMost&&s.isRightMost&&s.loaded){t.push(e);break}let r=!1;for(let s=0;s<t.length;s++){let e=t[s];if(o=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(e),!0).x*this._scaleSpring.current.value,s===t.length-1||o>=this.minPixelRatio)r=!0;else if(!r)continue;var g=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(e),!1).x*this._scaleSpring.current.value,v=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,u=this.immediateRender?1:v,h=Math.min(1,(o-.5)/.5),b=u/Math.abs(u-g),m=this._updateLevel(e,h,b,c,a,n);if(n=m.bestTiles,f=m.updatedTiles.filter(e=>e.loaded),p=function(e,t,n){return function(s){return{tile:s,level:e,levelOpacity:t,currentTime:n}}}(e,h,a),this._tilesToDraw[e]=f.map(p),this._providesCoverage(this.coverage,e))break}return n&&n.length>0?(n.forEach(function(e){e&&!e.context2D&&this._loadTile(e,a)},this),this._needsDraw=!0,!1):this._tilesLoading===0},_updateTilesInViewport:function(t){let o=e.now(),n=this;this._tilesLoading=0,this._wasBlending=this._isBlending,this._isBlending=!1,this.loadingCoverage={};let i=t.length?t[0].level:0;if(!this.getDrawArea())return;function a(e){let t=e.tile;if(t&&t.loaded){let s=n._blendTile(t,t.x,t.y,e.level,e.levelOpacity,o,i);n._isBlending=n._isBlending||s,n._needsDraw=n._needsDraw||s||n._wasBlending}}let s=0;for(let e=0;e<t.length;e++){let n=t[e];a(n),this._providesCoverage(this.coverage,n.level)&&(s=Math.max(s,n.level))}if(s>0)for(let e in this._tilesToDraw)e<s&&delete this._tilesToDraw[e]},_blendTile:function(e,t,n,s,o,i,a){let c=1e3*this.blendTime,l,r;return e.blendStart||(e.blendStart=i),l=i-e.blendStart,r=c?Math.min(1,l/c):1,s===a&&(r=1,l=c),this.alwaysBlend&&(r*=o),e.opacity=r,r===1&&(this._setCoverage(this.coverage,s,t,n,!0),this._hasOpaqueTile=!0),l<c},_updateLevel:function(e,t,n,s,o,i){p=s.getBoundingBox().getTopLeft(),h=s.getBoundingBox().getBottomRight(),this.viewer&&this.viewer.raiseEvent("update-level",{tiledImage:this,havedrawn:!0,level:e,opacity:t,visibility:n,drawArea:s,topleft:p,bottomright:h,currenttime:o,best:i}),this._resetCoverage(this.coverage,e),this._resetCoverage(this.loadingCoverage,e);var l,u,h,m,f,p,b=this._getCornerTiles(e,p,h),d=b.topLeft,a=b.bottomRight,r=this.source.getNumTiles(e),y=this.viewport.pixelFromPoint(this.viewport.getCenter());this.getFlip()&&(a.x+=1,this.wrapHorizontal||(a.x=Math.min(a.x,r.x-1)));for(var j=Math.max(0,(a.x-d.x)*(a.y-d.y)),v=new Array(j),g=0,c=d.x;c<=a.x;c++)for(l=d.y;l<=a.y;l++)this.getFlip()?(f=(r.x+c%r.x)%r.x,u=c+r.x-f-f-1):u=c,s.intersection(this.getTileBounds(e,u,l))!==null&&(m=this._updateTile(u,l,e,n,y,r,o,i),i=m.bestTiles,v[g]=m.tile,g+=1);return{bestTiles:i,updatedTiles:v}},_positionTile:function(t,n,s,o,i){a=t.bounds.getTopLeft(),a.x*=this._scaleSpring.current.value,a.y*=this._scaleSpring.current.value,a.x+=this._xSpring.current.value,a.y+=this._ySpring.current.value,r=t.bounds.getSize(),r.x*=this._scaleSpring.current.value,r.y*=this._scaleSpring.current.value,t.positionedBounds.x=a.x,t.positionedBounds.y=a.y,t.positionedBounds.width=r.x,t.positionedBounds.height=r.y;var a,r,l=s.pixelFromPointNoRotate(a,!0),d=s.pixelFromPointNoRotate(a,!1),c=s.deltaPixelsFromPointsNoRotate(r,!0),u=s.deltaPixelsFromPointsNoRotate(r,!1),h=d.plus(u.divide(2)),m=o.squaredDistanceTo(h);this.viewer.drawer.minimumOverlapRequired(this)&&(n||(c=c.plus(new e.Point(1,1))),t.isRightMost&&this.wrapHorizontal&&(c.x+=.75),t.isBottomMost&&this.wrapVertical&&(c.y+=.75)),t.position=l,t.size=c,t.squaredDistance=m,t.visibility=i},_updateTile:function(e,t,n,s,o,i,a,r){var l,d,c=this._getTile(e,t,n,a,i);return this.viewer&&this.viewer.raiseEvent("update-tile",{tiledImage:this,tile:c}),this._setCoverage(this.coverage,n,e,t,!1),l=c.loaded||c.loading||this._isCovered(this.loadingCoverage,n,e,t),this._setCoverage(this.loadingCoverage,n,e,t,l),c.exists?((c.loaded&&c.opacity===1&&this._setCoverage(this.coverage,n,e,t,!0),this._positionTile(c,this.source.tileOverlap,this.viewport,o,s),!c.loaded)&&(c.context2D?this._setTileLoaded(c):(d=this._tileCache.getImageRecord(c.cacheKey),d&&this._setTileLoaded(c,d.getData()))),c.loading?this._tilesLoading++:l||(r=this._compareTiles(r,c,this.maxTilesPerFrame)),{bestTiles:r,tile:c}):{bestTiles:r,tile:c}},_getCornerTiles:function(t,n,s){this.wrapHorizontal?(a=e.positiveModulo(n.x,1),r=e.positiveModulo(s.x,1)):(a=Math.max(0,n.x),r=Math.min(1,s.x)),o=1/this.source.aspectRatio,this.wrapVertical?(c=e.positiveModulo(n.y,o),l=e.positiveModulo(s.y,o)):(c=Math.max(0,n.y),l=Math.min(o,s.y));var o,a,r,c,l,d=this.source.getTileAtPoint(t,new e.Point(a,c)),u=this.source.getTileAtPoint(t,new e.Point(r,l)),i=this.source.getNumTiles(t);return this.wrapHorizontal&&(d.x+=i.x*Math.floor(n.x),u.x+=i.x*Math.floor(s.x)),this.wrapVertical&&(d.y+=i.y*Math.floor(n.y/o),u.y+=i.y*Math.floor(s.y/o)),{topLeft:d,bottomRight:u}},_getTile:function(t,n,s,o,i){var a,r,c,u,h,m,f,p,g,v,l=this.tilesMatrix,d=this.source;return l[s]||(l[s]={}),l[s][t]||(l[s][t]={}),(!l[s][t][n]||!l[s][t][n].flipped!=!this.flipped)&&(a=(i.x+t%i.x)%i.x,r=(i.y+n%i.y)%i.y,f=this.getTileBounds(s,t,n),p=d.getTileBounds(s,a,r,!0),g=d.tileExists(s,a,r),h=d.getTileUrl(s,a,r),m=d.getTilePostData(s,a,r),this.loadTilesWithAjax?(u=d.getTileAjaxHeaders(s,a,r),e.isPlainObject(this.ajaxHeaders)&&(u=e.extend({},this.ajaxHeaders,u))):u=null,v=d.getContext2D?d.getContext2D(s,a,r):0[0],c=new e.Tile(s,t,n,f,g,h,v,this.loadTilesWithAjax,u,p,m,d.getTileHashKey(s,a,r,h,u,m)),this.getFlip()?a===0&&(c.isRightMost=!0):a===i.x-1&&(c.isRightMost=!0),r===i.y-1&&(c.isBottomMost=!0),c.flipped=this.flipped,l[s][t][n]=c),c=l[s][t][n],c.lastTouchTime=o,c},_loadTile:function(e,t){var n=this;e.loading=!0,this._imageLoader.addJob({src:e.getUrl(),tile:e,source:this.source,postData:e.postData,loadWithAjax:e.loadWithAjax,ajaxHeaders:e.ajaxHeaders,crossOriginPolicy:this.crossOriginPolicy,ajaxWithCredentials:this.ajaxWithCredentials,callback:function(s,o,i){n._onTileLoad(e,t,s,o,i)},abort:function(){e.loading=!1}})},_onTileLoad:function(t,n,s,o,i){if(s)t.exists=!0;else{e.console.error("Tile %s failed to load: %s - error: %s",t,t.getUrl(),o),this.viewer.raiseEvent("tile-load-failed",{tile:t,tiledImage:this,time:n,message:o,tileRequest:i}),t.loading=!1,t.exists=!1;return}if(n<this.lastResetTime){e.console.warn("Ignoring tile %s loaded before reset: %s",t,t.getUrl()),t.loading=!1;return}var a=this,r=function(){var e=a.source,n=e.getClosestLevel();a._setTileLoaded(t,s,n,i)};r()},_setTileLoaded:function(t,n,s,o){var l,a=0,r=!1,i=this;function c(){return r&&e.console.error("Event 'tile-loaded' argument getCompletionCallback must be called synchronously. Its return value should be called asynchronously."),a++,d}function d(){a--,a===0&&(t.loading=!1,t.loaded=!0,t.hasTransparency=i.source.hasTransparency(t.context2D,t.getUrl(),t.ajaxHeaders,t.postData),t.context2D||i._tileCache.cacheTile({data:n,tile:t,cutoff:s,tiledImage:i}),i.viewer.raiseEvent("tile-ready",{tile:t,tiledImage:i,tileRequest:o}),i._needsDraw=!0)}l=c(),this.viewer.raiseEvent("tile-loaded",{tile:t,tiledImage:this,tileRequest:o,get image(){return e.console.error("[tile-loaded] event 'image' has been deprecated. Use 'data' property instead."),n},data:n,getCompletionCallback:c}),r=!0,l()},_compareTiles:function(e,t,n){return e?(e.push(t),this._sortTiles(e),e.length>n&&e.pop(),e):[t]},_sortTiles:function(e){e.sort(function(e,t){return e===null?1:t===null?-1:e.visibility===t.visibility?e.squaredDistance-t.squaredDistance:t.visibility-e.visibility})},_providesCoverage:function(e,t,n,s){var o,i,a,r;if(!e[t])return!1;if(n===0[0]||s===0[0]){o=e[t];for(a in o)if(Object.prototype.hasOwnProperty.call(o,a)){i=o[a];for(r in i)if(Object.prototype.hasOwnProperty.call(i,r)&&!i[r])return!1}return!0}return e[t][n]===0[0]||e[t][n][s]===0[0]||e[t][n][s]===!0},_isCovered:function(e,t,n,s){return n===0[0]||s===0[0]?this._providesCoverage(e,t+1):this._providesCoverage(e,t+1,2*n,2*s)&&this._providesCoverage(e,t+1,2*n,2*s+1)&&this._providesCoverage(e,t+1,2*n+1,2*s)&&this._providesCoverage(e,t+1,2*n+1,2*s+1)},_setCoverage:function(t,n,s,o,i){if(!t[n]){e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",n);return}t[n][s]||(t[n][s]={}),t[n][s][o]=i},_resetCoverage:function(e,t){e[t]={}}})}(t),function(e){var n=function(t){e.console.assert(t,"[TileCache.cacheTile] options is required"),e.console.assert(t.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(t.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=t.tile,this.tiledImage=t.tiledImage},t=function(t){e.console.assert(t,"[ImageRecord] options is required"),e.console.assert(t.data,"[ImageRecord] options.data is required"),this._tiles=[],t.create.apply(null,[this,t.data,t.ownerTile]),this._destroyImplementation=t.destroy.bind(null,this),this.getImage=t.getImage.bind(null,this),this.getData=t.getData.bind(null,this),this.getRenderedContext=t.getRenderedContext.bind(null,this)};t.prototype={destroy:function(){this._destroyImplementation(),this._tiles=null},addTile:function(t){e.console.assert(t,"[ImageRecord.addTile] tile is required"),this._tiles.push(t)},removeTile:function(t){for(var n=0;n<this._tiles.length;n++)if(this._tiles[n]===t){this._tiles.splice(n,1);return}e.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",t)},getTileCount:function(){return this._tiles.length}},e.TileCache=function(t){t=t||{},this._maxImageCacheCount=t.maxImageCacheCount||e.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},e.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(s){e.console.assert(s,"[TileCache.cacheTile] options is required"),e.console.assert(s.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(s.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),e.console.assert(s.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var g=s.cutoff||0,m=this._tilesLoaded.length,r=this._imagesLoaded[s.tile.cacheKey];if(r||(s.data||(e.console.error("[TileCache.cacheTile] options.image was renamed to options.data. '.image' attribute has been deprecated and will be removed in the future."),s.data=s.image),e.console.assert(s.data,"[TileCache.cacheTile] options.data is required to create an ImageRecord"),r=this._imagesLoaded[s.tile.cacheKey]=new t({data:s.data,ownerTile:s.tile,create:s.tiledImage.source.createTileCache,destroy:s.tiledImage.source.destroyTileCache,getImage:s.tiledImage.source.getTileCacheDataAsImage,getData:s.tiledImage.source.getTileCacheData,getRenderedContext:s.tiledImage.source.getTileCacheDataAsContext2D}),this._imagesLoadedCount++),r.addTile(s.tile),s.tile.cacheImageRecord=r,this._imagesLoadedCount>this._maxImageCacheCount){for(var o,l,u,h,f,p,i=null,c=-1,d=null,a=this._tilesLoaded.length-1;a>=0;a--)if(l=this._tilesLoaded[a],o=l.tile,!(o.level<=g||o.beingDrawn)){if(!i){i=o,c=a,d=l;continue}h=o.lastTouchTime,u=i.lastTouchTime,p=o.level,f=i.level,(h<u||h===u&&p>f)&&(i=o,c=a,d=l)}i&&c>=0&&(this._unloadTile(d),m=c)}this._tilesLoaded[m]=new n({tile:s.tile,tiledImage:s.tiledImage})},clearTilesFor:function(t){e.console.assert(t,"[TileCache.clearTilesFor] tiledImage is required");for(var s,n=0;n<this._tilesLoaded.length;++n)s=this._tilesLoaded[n],s.tiledImage===t&&(this._unloadTile(s),this._tilesLoaded.splice(n,1),n--)},getImageRecord:function(t){return e.console.assert(t,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[t]},_unloadTile:function(t){e.console.assert(t,"[TileCache._unloadTile] tileRecord is required");var s,n=t.tile,i=t.tiledImage;let o=n.getCanvasContext&&n.getCanvasContext();n.unload(),n.cacheImageRecord=null,s=this._imagesLoaded[n.cacheKey],s&&(s.removeTile(n),s.getTileCount()||(s.destroy(),delete this._imagesLoaded[n.cacheKey],this._imagesLoadedCount--,o&&(o.canvas.width=0,o.canvas.height=0,i.viewer.raiseEvent("image-unloaded",{context2D:o,tile:n}))),i.viewer.raiseEvent("tile-unloaded",{tile:n,tiledImage:i}))}}}(t),function(e){e.World=function(t){var n=this;e.console.assert(t.viewer,"[World] options.viewer is required"),e.EventSource.call(this),this.viewer=t.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(){n._autoRefigureSizes?n._figureSizes():n._needsSizesFigured=!0},this._figureSizes()},e.extend(e.World.prototype,e.EventSource.prototype,{addItem:function(t,n){if(e.console.assert(t,"[World.addItem] item is required"),e.console.assert(t instanceof e.TiledImage,"[World.addItem] only TiledImages supported at this time"),n=n||{},n.index!==0[0]){var s=Math.max(0,Math.min(this._items.length,n.index));this._items.splice(s,0,t)}else this._items.push(t);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,t.addHandler("bounds-change",this._delegatedFigureSizes),t.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:t})},getItemAt:function(t){return e.console.assert(t!==0[0],"[World.getItemAt] index is required"),this._items[t]},getIndexOfItem:function(t){return e.console.assert(t,"[World.getIndexOfItem] item is required"),e.indexOf(this._items,t)},getItemCount:function(){return this._items.length},setItemIndex:function(t,n){e.console.assert(t,"[World.setItemIndex] item is required"),e.console.assert(n!==0[0],"[World.setItemIndex] index is required");var s=this.getIndexOfItem(t);if(n>=this._items.length)throw new Error("Index bigger than number of layers.");n===s||s===-1||(this._items.splice(s,1),this._items.splice(n,0,t),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:t,previousIndex:s,newIndex:n}))},removeItem:function(t){e.console.assert(t,"[World.removeItem] item is required");var n=e.indexOf(this._items,t);n!==-1&&(t.removeHandler("bounds-change",this._delegatedFigureSizes),t.removeHandler("clip-change",this._delegatedFigureSizes),t.destroy(),this._items.splice(n,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(t))},removeAll:function(){this.viewer._cancelPendingImages();for(e=0;e<this._items.length;e++)t=this._items[e],t.removeHandler("bounds-change",this._delegatedFigureSizes),t.removeHandler("clip-change",this._delegatedFigureSizes),t.destroy();var e,t,n=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,e=0;e<n.length;e++)t=n[e],this._raiseRemoveItem(t)},resetItems:function(){for(var e=0;e<this._items.length;e++)this._items[e].reset()},update:function(e){for(var t=!1,n=0;n<this._items.length;n++)t=this._items[n].update(e)||t;return t},draw:function(){this.viewer.drawer.draw(this._items),this._needsDraw=!1,this._items.forEach(e=>{this._needsDraw=e.setDrawn()||this._needsDraw})},needsDraw:function(){for(var e=0;e<this._items.length;e++)if(this._items[e].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(e){this._autoRefigureSizes=e,e&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(t){t=t||{};var n,s,o,i,r,l,d,m,f,u=t.immediately||!1,p=t.layout||e.DEFAULT_SETTINGS.collectionLayout,v=t.rows||e.DEFAULT_SETTINGS.collectionRows,h=t.columns||e.DEFAULT_SETTINGS.collectionColumns,a=t.tileSize||e.DEFAULT_SETTINGS.collectionTileSize,g=t.tileMargin||e.DEFAULT_SETTINGS.collectionTileMargin,c=a+g;!t.rows&&h?d=h:d=Math.ceil(this._items.length/v),o=0,r=0,this.setAutoRefigureSizes(!1);for(s=0;s<this._items.length;s++)s&&s%d===0&&(p==="horizontal"?(r+=c,o=0):(o+=c,r=0)),l=this._items[s],n=l.getBounds(),n.width>n.height?i=a:i=a*(n.width/n.height),m=i*(n.height/n.width),f=new e.Point(o+(a-i)/2,r+(a-m)/2),l.setPosition(f,u),l.setWidth(i,u),p==="horizontal"?o+=c:r+=c;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var l=this._homeBounds?this._homeBounds.clone():null,d=this._contentSize?this._contentSize.clone():null,u=this._contentFactor||0;if(this._items.length){n=this._items[0],s=n.getBounds(),this._contentFactor=n.getContentSize().x/s.width;for(var n,s,t=n.getClippedBounds().getBoundingBox(),o=t.x,i=t.y,a=t.x+t.width,r=t.y+t.height,c=1;c<this._items.length;c++)n=this._items[c],s=n.getBounds(),this._contentFactor=Math.max(this._contentFactor,n.getContentSize().x/s.width),t=n.getClippedBounds().getBoundingBox(),o=Math.min(o,t.x),i=Math.min(i,t.y),a=Math.max(a,t.x+t.width),r=Math.max(r,t.y+t.height);this._homeBounds=new e.Rect(o,i,a-o,r-i),this._contentSize=new e.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new e.Rect(0,0,1,1),this._contentSize=new e.Point(1,1),this._contentFactor=1;(this._contentFactor!==u||!this._homeBounds.equals(l)||!this._contentSize.equals(d))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(e){this.raiseEvent("remove-item",{item:e})}})}(t)}(Bt)),Bt.exports}W1=I0(),Vt=dr(W1);function K1(e){var t;return(t=e?.split("xywh=")[1])==null?0[0]:t.split(",").map(e=>parseFloat(e))}function ds(){let t,n;const e=new Promise((e,s)=>{t=e,n=s});return e.resolve=t,e.reject=n,e}Kt=.005,us=1.5,X1={data(){return{defaultCanvasCss:"",loadingTimeout:null,avResource:null,overlayElements:[],promise:ds(),tileSources:[],viewer:null,viewerState:{isReset:!0}}},computed:{filtersActive(){return Object.keys(this.$store.options.filters).length>0},paginationButtons(){var e;const t=((e=this.$store.manifest.viewingDirection)==null?0[0]:e.split("-to-"))||["left","right"],n=[{hidden:this.$store.isFirstPage,title:this.$translate("Previous page"),onClick:this.$store.goToPreviousPage,position:t[0]},{hidden:this.$store.isLastPage,title:this.$translate("Next page"),onClick:this.$store.goToNextPage,position:t[1]}];return this.$store.isReversed&&n.reverse(),n.filter(e=>!e.hidden)},multiLayerResources(){return this.$store.options.pages.filter(e=>e>0).map((e,t)=>{var n,s,o,i,a;return{pageIndex:t,items:(a=(i=(o=(s=(n=this.$store.manifest.items[e-1].items)==null?0[0]:n[0])==null?0[0]:s.items)==null?0[0]:o[0])==null?0[0]:i.body)==null?0[0]:a.items}}).filter(e=>{var t;return((t=e.items)==null?0[0]:t.length)>1})}},watch:{"$store.annotations":{handler(){this.updateOverlays()},deep:!0},"$store.options.annotationId":function(e){var s;if(!this.viewer||((s=this.overlayElements.find(e=>e.classList.contains("-current")))==null||s.classList.remove("-current"),!e))return;const o=this.viewer.viewport.getBounds(),n=this.overlayElements.find(t=>t.id===e);if(!n)return;n.classList.add("-current");const t=this.viewer.getOverlayById(n).getBounds(this.viewer.viewport);o.intersection(t)||(t.x-=.03,t.y-=.03,t.width+=.06,t.height+=.06,this.viewer.viewport.fitBoundsWithConstraints(t))},"$store.options.pages":function(e,t){const n=e.length!==t.length;this.loadInfo(n)},"$store.options.view":function(){this.updateOverlays()}},mounted(){this.loadInfo(),this.$store.readyPromises.push(this.promise),this.$store.rootElement.addEventListener("keydown",this.onKeydown),this.$store.rootElement.addEventListener("keypress",this.onKeypress)},beforeUnmount(){this.viewer&&this.viewer.destroy(),this.$store.rootElement.removeEventListener("keydown",this.onKeydown),this.$store.rootElement.removeEventListener("keypress",this.onKeypress)},methods:{initViewer(e){const t=[];let n=0,s=0;const o=this.$store.isReversed?this.$store.options.pages.toReversed():this.$store.options.pages;if(o.filter(e=>e>0).forEach((e,o)=>{this.tileSources.filter(t=>t.$meta.page===e&&t.$meta.layerIndex===(this.$store.options.layers[o]||0)).forEach((o,i)=>{var d;n=n||o[this.$store.isVertical?"height":"width"];const a=o[this.$store.isVertical?"height":"width"]/n;this.$store.options.pages[0]===0&&(!this.$store.isReversed&&e===1||this.$store.isReversed&&e===this.$store.pageCount)&&(t.push({opacity:0,tileSource:o,[this.$store.isVertical?"y":"x"]:0,[this.$store.isVertical?"height":"width"]:a}),s+=1+Kt);const r={tileSource:o,[this.$store.isVertical?"y":"x"]:s,[this.$store.isVertical?"height":"width"]:a},{target:c}=((d=this.$store.manifest.items[e-1].items[0])==null?0[0]:d.items[i])||{},l=K1(c?.id||c||"");l?.length===4?[r.x,r.y,r.width]=l.map(e=>e/n):s+=a+Kt,this.$store.options.pages[0]===0&&(!this.$store.isReversed&&e===this.$store.pageCount||this.$store.isReversed&&e===1)&&t.push({opacity:0,tileSource:o,[this.$store.isVertical?"y":"x"]:s,[this.$store.isVertical?"height":"width"]:a}),t.push(r)})}),this.viewer){this.viewer.addOnceHandler("open",()=>{if(this.viewerState.isReset||e)this.resetImage();else{if(this.viewer.viewport.applyConstraints(!0),!this.$store.options.optionsResetOnPageChange)return;this.$store.options.optionsResetOnPageChange.forEach(e=>{if(e==="filters")this.resetFilters();else if(e==="pan"){const e=this.viewer.viewport.getBounds();if(e.x<=0&&e.y<=0)return;const t=o[0]?0:1;this.viewer.viewport.panTo({x:e.x>0?e.width/2+t:this.$store.options.pan.x,y:e.y>0?e.height/2:this.$store.options.pan.y}),this.$store.updateOptions({pan:{}})}else e==="rotation"?(this.viewer.viewport.setRotation(0),this.$store.updateOptions({rotation:null})):e==="zoom"&&(this.viewer.viewport.goHome(),this.$store.updateOptions({zoom:null}))})}}),this.viewer.open(t);return}this.viewer=Vt({animationTime:.4,drawer:"canvas",element:this.$refs.image,immediateRender:this.$store.isContainerWidthAtLeast("small"),placeholderFillStyle:"grey",preserveImageSizeOnResize:!0,preserveViewport:!0,showNavigationControl:!1,showZoomControl:!1,tileSources:t,visibilityRatio:.2,...this.$store.options.viewer}),this.viewer.addHandler("canvas-key",e=>{var t;["f","F","r","R","S","W","+","=","-","_"].includes((t=e.originalEvent)==null?0[0]:t.key)&&(e.preventDefaultAction=!0)}),this.viewer.gestureSettingsMouse.clickToZoom=!1,this.viewer.addHandler("animation-finish",()=>{if(this.viewerState.isReset){this.removeImageOptions();return}const e=this.viewer.viewport.getCenter();this.$store.updateOptions({pan:{x:Math.round(e.x*1e3)/1e3,y:Math.round(e.y*1e3)/1e3},zoom:Math.round(this.viewer.viewport.getZoom()*1e3)/1e3})}),this.viewer.addHandler("open",()=>{this.startLoadingWatch(),this.$store.options.pan.x!==0[0]||this.$store.options.pan.y!==0[0]||this.$store.options.zoom?((this.$store.options.pan.x!==0[0]||this.$store.options.pan.y!==0[0])&&this.viewer.viewport.panTo({x:this.$store.options.pan.x,y:this.$store.options.pan.y},!0),this.$store.options.zoom&&this.viewer.viewport.zoomTo(this.$store.options.zoom,null,!0)):this.viewer.viewport.goHome(),this.$store.options.rotation!==null&&this.viewer.viewport.setRotation(this.$store.options.rotation),this.updateOverlays()}),this.viewer.addHandler("pan",this.updateViewerState),this.viewer.addHandler("resize",()=>{this.viewerState.isReset&&this.$nextTick(()=>this.viewer.viewport.goHome(!0)),this.updateViewerState()}),this.viewer.addHandler("rotate",this.updateViewerState),this.viewer.addHandler("zoom",this.updateViewerState),this.viewer.addHandler("tile-load-failed",e=>{this.$store.addError(`Error loading image: ${e.message}`)}),this.defaultCanvasCss=this.viewer.drawer.canvas.style.cssText,this.updateFilterStyle(),this.$api.expose(this.resetImage),this.$api.expose(this.viewer,"viewer"),this.promise.resolve()},loadInfo(e=!1){this.stopLoadingWatch(),this.avResource=null;let t,n;const s=[];this.$store.options.pages.filter(e=>e>0).forEach((e,o)=>{var r,c,l;const a=this.$store.manifest.items[e-1],i=this.$store.options.layers[o]||0;(l=(c=(r=a.items)==null?0[0]:r[0])==null?0[0]:c.items)==null||l.forEach((o,r)=>{var l,d,u,h,m,f,p,g;const c=((d=(l=o.body)==null?0[0]:l.items)==null?0[0]:d[i])||o.body;if(!c){this.$store.addError(`Resource missing for page ${e}`);return}if(["Sound","Video"].includes(c?.type)){if(this.$store.options.pages[1]>-1){this.$store.updateOptions({pages:[e]});return}this.avResource={},n={format:c.format,type:c.type,url:c.id},this.$nextTick(()=>{this.avResource=n});const o=a.accompanyingCanvas||a.placeholderCanvas,s=(f=(m=(h=(u=o?.items)==null?0[0]:u[0])==null?0[0]:h.items)==null?0[0]:m[0])==null?0[0]:f.body;t=((p=s?.items)==null?0[0]:p[i])||s}else t=c;if(t&&this.tileSources.find(t=>t.$meta.page===e&&t.$meta.itemIndex===r&&t.$meta.layerIndex===i))return;const v=((g=t?.source)==null?0[0]:g.service)||t?.service;if(v){const t=[].concat(v)[0],n=t.id||t["@id"],o=`${n}${n.at(-1)==="/"?"":"/"}info.json`;s.push(this.$store.fetchJson(o).then(t=>({...t,$meta:{page:e,itemIndex:r,layerIndex:i}}),t=>{let n;t.response&&t.response.statusText?n=t.response.statusText:t.message&&(n=t.message),this.$store.addError(`Error loading info file for page ${e}${n?`: ${n}`:""}`)}))}else t!=null&&t.id&&this.tileSources.push({$meta:{page:e,itemIndex:r,layerIndex:i},type:"image",url:t.id,width:t.width,height:t.height})}),!t&&!n&&this.$store.addError(`Image missing for page ${e}`)}),s.length?Promise.all(s).then(t=>{t.filter(Boolean).forEach(e=>{var t,n;if(this.$store.options.preferredImageFormat){const s=e.extraFormats||((n=(t=e.profile)==null?0[0]:t[1])==null?0[0]:n.formats);s!=null&&s.includes(this.$store.options.preferredImageFormat)&&(e.tileFormat=this.$store.options.preferredImageFormat)}this.tileSources.push(e)}),this.$store.options.pages.filter(e=>e>0).every((e,n)=>t[n].$meta.page===e)&&this.initViewer(e)}):t&&this.initViewer(e)},onKeydown(e){e.key==="Escape"&&this.$store.rootElement.focus(),[45,48,96].includes(e.keyCode)&&(e.shiftKey?this.resetImage(e):this.viewer.viewport.goHome())},onKeypress(e){if(!Jn(e))switch(e.key){case"I":this.resetFilters();break;case"r":case"R":this.rotateRight(e);break;case"+":case"=":case"W":this.zoomIn();break;case"-":case"_":case"S":this.zoomOut();break}},removeImageOptions(){this.$store.updateOptions({pan:{},zoom:null})},resetFilters(){this.viewer.drawer.canvas.style.cssText=this.defaultCanvasCss,this.$store.updateOptions({filters:{}})},resetImage(e){e&&(this.viewer.viewport.setRotation(0),this.$store.updateOptions({rotation:null}),this.filtersActive&&this.resetFilters()),this.viewer.viewport.goHome(),this.removeImageOptions()},rotateRight(e){const{viewport:t}=this.viewer,n=e&&e.shiftKey?0:(t.getRotation()+90)%360;t.setRotation(n),this.$store.updateOptions({rotation:n||null})},setFilter(e,t){const n=t.target.valueAsNumber;n===1?delete this.$store.options.filters[e]:this.$store.options.filters[e]=n,this.$store.updateOptions({filters:this.$store.options.filters}),this.updateFilterStyle()},startLoadingWatch(){this.$store.loading=0;for(let e=this.viewer.world.getItemCount()-1;e>=0;e-=1){const t=this.viewer.world.getItemAt(e);if(t&&t._tilesLoading){this.$store.loading=1;break}}this.loadingTimeout=setTimeout(this.startLoadingWatch,200)},stopLoadingWatch(){clearTimeout(this.loadingTimeout)},toggleOverlays(){this.$store.updateOptions({annotationsVisible:this.$store.options.annotationsVisible===!1&&null})},updateFilterStyle(){if(!this.filtersActive)return;const e=[];Object.keys(this.$store.options.filters).forEach(t=>{e.push(`${t}(${this.$store.options.filters[t]})`)});const t=e.join(" ");this.viewer.drawer.canvas.style.cssText=`${this.defaultCanvasCss} filter: ${t}`},updateOverlays(){if(!this.viewer||!this.$store.options.pages.filter(e=>e>0).every(e=>this.tileSources.some(t=>t.$meta.page===e))||(this.viewer.clearOverlays(),this.overlayElements=[],!this.$store.annotationsActive))return;let e,t=0;this.$store.options.pages.filter(e=>e>-1).forEach((n,s)=>{var o,i,a,r;const c=this.tileSources.find(e=>e.$meta.page===(n===0?1:n)&&e.$meta.layerIndex===(this.$store.options.layers[s]||0));if(s===0){if(e=c[this.$store.isVertical?"height":"width"],n===0)return}else{const n=this.$store.options.pages[s-1],i=((o=this.$store.manifest.items[n-1])==null?0[0]:o[this.$store.isVertical?"height":"width"])||e;t+=(Kt+i/e)*(this.$store.isReversed?-1:1)}(a=(i=this.$store.annotations[n])==null?0[0]:i[0])!=null&&a.coords&&((r=this.$store.annotations[n])==null||r.forEach((s,o)=>{const i=document.createElement("button");i.ariaLabel=`${n}/${o}`,i.className=`tify-media-overlay${this.$store.options.annotationId===s.id?" -current":""}`,i.id=s.id,i.type="button",new Vt.MouseTracker({element:i,clickHandler:e=>{e.quick&&setTimeout(()=>this.$store.toggleAnnotationId(s.id),5)},keyDownHandler:e=>e.keyCode===13&&this.$store.toggleAnnotationId(s.id)}),this.viewer.addOverlay({element:i,location:new Vt.Rect(s.coords[0]/e+(this.$store.isVertical?0:t),s.coords[1]/e+(this.$store.isVertical?t:0),s.coords[2]/e,s.coords[3]/e)}),this.overlayElements.push(i)}))})},updateViewerState(){const n=this.viewer.viewport.getZoom();this.viewerState.isMaxZoom=n>=this.viewer.viewport.getMaxZoom(),this.viewerState.isMinZoom=n<=this.viewer.viewport.getMinZoom();const e=this.viewer.viewport.getHomeBounds(),t=this.viewer.viewport.getBounds();this.viewerState.isReset=Math.abs(e.height-t.height)<1e-9&&Math.abs(e.width-t.width)<1e-9&&Math.abs(e.x-t.x)<1e-9&&Math.abs(e.y-t.y)<1e-9},zoomIn(){this.viewer.viewport.zoomBy(us),this.viewer.viewport.applyConstraints()},zoomOut(){this.viewer.viewport.zoomBy(1/us),this.viewer.viewport.applyConstraints()}}},Q1={class:"tify-media","aria-live":"polite"},Z1={class:"tify-sr-only"},J1={key:0,class:"tify-media-buttons -controls"},e4=["disabled","title","aria-label"],t4=["disabled","title","aria-label"],n4=["disabled","title","aria-label"],s4=["title","aria-label"],o4={class:"tify-sr-only"},i4=["disabled"],a4=["title","aria-label"],r4={class:"tify-sr-only"},c4={key:0},l4={class:"tify-button-list"},d4=["aria-pressed","onClick"],u4={class:"tify-media-buttons -pagination"},h4=["title","aria-label","onClick"];function P0(i,l,d,u,h,m){var f;const x=Ut,y=Wt,C=H1,v=N1,_=F1,w=k1,O=l1,p=Ft,b=i1,E=t1,k=Qu,A=je,S=is,M=ns,F=fn,T=gn,D=Hu;return e(),n("section",Q1,[t("h2",Z1,s(i.$translate("Media")),1),t("div",{ref:"image",class:j(["tify-media-image",{"-annotations-hidden":i.$store.options.annotationsVisible===!1}])},null,2),h.viewer?(e(),n("div",J1,[t("button",{type:"button",class:"tify-media-button",disabled:h.viewerState.isMaxZoom,title:i.$translate("Zoom in"),"aria-label":i.$translate("Zoom in"),onClick:l[0]||(l[0]=e=>m.zoomIn())},[a(x)],8,e4),t("button",{type:"button",class:"tify-media-button",disabled:h.viewerState.isMinZoom,title:i.$translate("Zoom out"),"aria-label":i.$translate("Zoom out"),onClick:l[1]||(l[1]=e=>m.zoomOut())},[a(y)],8,t4),t("button",{type:"button",class:"tify-media-button",disabled:h.viewerState.isReset,title:i.$translate("Reset"),"aria-label":i.$translate("Reset"),onClick:l[2]||(l[2]=e=>m.resetImage(!!e.shiftKey))},[a(C)],8,n4),t("button",{type:"button",class:j(["tify-media-button",{"-active":!!i.$store.options.rotation}]),title:i.$translate("Rotate"),"aria-label":i.$translate("Rotate"),onClick:l[3]||(l[3]=e=>m.rotateRight(e))},[a(v)],10,s4),a(p,{class:j(["tify-media-dropdown -filters",{"-active":m.filtersActive}]),alignment:"center",position:"right",label:i.$translate("Toggle image filters"),shortcut:"i"},{button:I(()=>[a(_)]),default:I(()=>[t("h3",o4,s(i.$translate("Image filters")),1),a(w,{onUpdate:l[4]||(l[4]=(e,t)=>m.setFilter(e,t))}),t("p",null,[t("button",{type:"button",class:"tify-media-reset",disabled:!m.filtersActive,onClick:l[5]||(l[5]=fe(e=>m.resetFilters(),["stop"]))},[a(O),z(" "+s(i.$translate("Reset")),1)],8,i4)])]),_:1},8,["class","label"]),i.$store.annotations.length&&(i.$store.options.view==="text"||!i.$store.isContainerWidthAtLeast("medium"))?(e(),n("button",{key:0,type:"button",class:"tify-media-button",title:i.$translate("Toggle annotations"),"aria-label":i.$translate("Toggle annotations"),onClick:l[6]||(l[6]=e=>m.toggleOverlays())},[i.$store.options.annotationsVisible!==!1?(e(),r(b,{key:0})):(e(),r(E,{key:1}))],8,a4)):o("",!0),m.multiLayerResources.length?(e(),r(p,{key:1,class:j(["tify-media-dropdown -layers",{"-active":i.$store.options.layers.some(Boolean)}]),alignment:"center",position:"right",label:i.$translate("Toggle image layer select"),shortcut:"c"},{button:I(()=>[a(k)]),default:I(()=>[t("h3",r4,s(i.$translate("Layer")),1),(e(!0),n(c,null,g(m.multiLayerResources,r=>(e(),n(c,{key:r.pageIndex},[i.$store.options.pages.filter(e=>e>0).length>1?(e(),n("h4",c4,[a(A,{number:i.$store.options.pages[r.pageIndex],wrap:!0},null,8,["number"])])):o("",!0),t("ol",l4,[(e(!0),n(c,null,g(r.items,(o,a)=>(e(),n("li",{key:o.id},[t("button",{type:"button","aria-pressed":a===(i.$store.options.layers[r.pageIndex]||0),onClick:e=>{i.$store.options.layers[r.pageIndex]=a,m.loadInfo()}},s(i.$store.localize(o.label)),9,d4)]))),128))])],64))),128))]),_:1},8,["class","label"])):o("",!0)])):o("",!0),t("div",u4,[(e(!0),n(c,null,g(m.paginationButtons,t=>(e(),n("button",{key:t.position,type:"button",class:j(["tify-media-button",`-${t.position}`]),title:t.title,"aria-label":t.title,onClick:t.onClick},[t.position==="left"?(e(),r(S,{key:0})):t.position==="right"?(e(),r(M,{key:1})):t.position==="top"?(e(),r(F,{key:2})):t.position==="bottom"?(e(),r(T,{key:3})):o("",!0)],10,h4))),128))]),(f=h.avResource)!=null&&f.url?(e(),r(D,{key:1,src:h.avResource.url,format:h.avResource.format,hasImage:!!h.viewer},null,8,["src","format","hasImage"])):o("",!0)])}f4=i(X1,[["render",P0]]),p4={},g4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function R0(s,o){return e(),n("svg",g4,o[0]||(o[0]=[t("path",{d:"M14,14H19V16H16V19H14V14M5,14H10V19H8V16H5V14M8,5H10V10H5V8H8V5M19,8V10H14V5H16V8H19Z"},null,-1)]))}b4=i(p4,[["render",R0]]),j4={},y4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function L0(s,o){return e(),n("svg",y4,o[0]||(o[0]=[t("path",{d:"M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z"},null,-1)]))}w4=i(j4,[["render",L0]]),O4={},x4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function N0(s,o){return e(),n("svg",x4,o[0]||(o[0]=[t("path",{d:"M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z"},null,-1)]))}E4=i(O4,[["render",N0]]),k4={},A4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function D0(s,o){return e(),n("svg",A4,o[0]||(o[0]=[t("path",{d:"M11 15H17V17H11V15M9 7H7V9H9V7M11 13H17V11H11V13M11 9H17V7H11V9M9 11H7V13H9V11M21 5V19C21 20.1 20.1 21 19 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5M19 5H5V19H19V5M9 15H7V17H9V15Z"},null,-1)]))}M4=i(k4,[["render",D0]]),F4={},T4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function z0(s,o){return e(),n("svg",T4,o[0]||(o[0]=[t("path",{d:"M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 15L17.55 9.54L16.13 8.13L13 11.25V2H11V11.25L7.88 8.13L6.46 9.55L12 15Z"},null,-1)]))}D4=i(F4,[["render",z0]]),N4={},L4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function F0(s,o){return e(),n("svg",L4,o[0]||(o[0]=[t("path",{d:"M13.5,4A1.5,1.5 0 0,0 12,5.5A1.5,1.5 0 0,0 13.5,7A1.5,1.5 0 0,0 15,5.5A1.5,1.5 0 0,0 13.5,4M13.14,8.77C11.95,8.87 8.7,11.46 8.7,11.46C8.5,11.61 8.56,11.6 8.72,11.88C8.88,12.15 8.86,12.17 9.05,12.04C9.25,11.91 9.58,11.7 10.13,11.36C12.25,10 10.47,13.14 9.56,18.43C9.2,21.05 11.56,19.7 12.17,19.3C12.77,18.91 14.38,17.8 14.54,17.69C14.76,17.54 14.6,17.42 14.43,17.17C14.31,17 14.19,17.12 14.19,17.12C13.54,17.55 12.35,18.45 12.19,17.88C12,17.31 13.22,13.4 13.89,10.71C14,10.07 14.3,8.67 13.14,8.77Z"},null,-1)]))}P4=i(N4,[["render",F0]]),H4={},I4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function M0(s,o){return e(),n("svg",I4,o[0]||(o[0]=[t("path",{d:"M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z"},null,-1)]))}V4=i(H4,[["render",M0]]),$4={},W4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function S0(s,o){return e(),n("svg",W4,o[0]||(o[0]=[t("path",{d:"M21,6V8H3V6H21M3,18H12V16H3V18M3,13H21V11H3V13Z"},null,-1)]))}K4=i($4,[["render",S0]]),q4={},Y4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function k0(s,o){return e(),n("svg",Y4,o[0]||(o[0]=[t("path",{d:"M20,5A2,2 0 0,1 22,7V17A2,2 0 0,1 20,19H4C2.89,19 2,18.1 2,17V7C2,5.89 2.89,5 4,5H20M5,16H19L14.5,10L11,14.5L8.5,11.5L5,16Z"},null,-1)]))}X4=i(q4,[["render",k0]]),Q4={},Z4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function E0(s,o){return e(),n("svg",Z4,o[0]||(o[0]=[t("path",{d:"M12 16C13.1 16 14 16.9 14 18S13.1 20 12 20 10 19.1 10 18 10.9 16 12 16M12 10C13.1 10 14 10.9 14 12S13.1 14 12 14 10 13.1 10 12 10.9 10 12 10M12 4C13.1 4 14 4.9 14 6S13.1 8 12 8 10 7.1 10 6 10.9 4 12 4M6 16C7.1 16 8 16.9 8 18S7.1 20 6 20 4 19.1 4 18 4.9 16 6 16M6 10C7.1 10 8 10.9 8 12S7.1 14 6 14 4 13.1 4 12 4.9 10 6 10M6 4C7.1 4 8 4.9 8 6S7.1 8 6 8 4 7.1 4 6 4.9 4 6 4M18 16C19.1 16 20 16.9 20 18S19.1 20 18 20 16 19.1 16 18 16.9 16 18 16M18 10C19.1 10 20 10.9 20 12S19.1 14 18 14 16 13.1 16 12 16.9 10 18 10M18 4C19.1 4 20 4.9 20 6S19.1 8 18 8 16 7.1 16 6 16.9 4 18 4Z"},null,-1)]))}e0=i(Q4,[["render",E0]]),t0={},n0={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function C0(s,o){return e(),n("svg",n0,o[0]||(o[0]=[t("path",{d:"M5.59,7.41L10.18,12L5.59,16.59L7,18L13,12L7,6L5.59,7.41M16,6H18V18H16V6Z"},null,-1)]))}o0=i(t0,[["render",C0]]),i0={},a0={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function t3(s,o){return e(),n("svg",a0,o[0]||(o[0]=[t("path",{d:"M16,18H18V6H16M6,18L14.5,12L6,6V18Z"},null,-1)]))}c0=i(i0,[["render",t3]]),l0={},d0={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function n3(s,o){return e(),n("svg",d0,o[0]||(o[0]=[t("path",{d:"M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z"},null,-1)]))}h0=i(l0,[["render",n3]]),m0={},f0={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function O0(s,o){return e(),n("svg",f0,o[0]||(o[0]=[t("path",{d:"M18.41,16.59L13.82,12L18.41,7.41L17,6L11,12L17,18L18.41,16.59M6,6H8V18H6V6Z"},null,-1)]))}g0=i(m0,[["render",O0]]),v0={},b0=["disabled","title","aria-label"],j0=["disabled","title","aria-label"],y0=["disabled","title","aria-label"],p0=["disabled","title","aria-label"],u0=["disabled","title","aria-label"],r0=["disabled","title","aria-label"];function x0(s,i){const r=g0,c=h0,l=is,d=ns,u=c0,h=o0;return e(),n("div",{class:j(["tify-header-button-group -pagination",{"-reversed":s.$store.isReversed,"-vertical":s.$store.isVertical}])},[t("button",{type:"button",class:"tify-header-button",disabled:s.$store.isFirstPage,title:s.$translate("First page"),"aria-label":s.$translate("First page"),onClick:i[0]||(i[0]=e=>s.$store.goToFirstPage())},[a(r)],8,b0),s.$store.sections.length>1?(e(),n("button",{key:0,type:"button",class:"tify-header-button",disabled:s.$store.isFirstPage,title:s.$translate("Previous section"),"aria-label":s.$translate("Previous section"),onClick:i[1]||(i[1]=e=>s.$store.goToPreviousSection())},[a(c)],8,j0)):o("",!0),t("button",{type:"button",class:"tify-header-button",disabled:s.$store.isFirstPage,title:s.$translate("Previous page"),"aria-label":s.$translate("Previous page"),onClick:i[2]||(i[2]=e=>s.$store.goToPreviousPage())},[a(l)],8,y0),t("button",{type:"button",class:"tify-header-button",disabled:s.$store.isLastPage,title:s.$translate("Next page"),"aria-label":s.$translate("Next page"),onClick:i[3]||(i[3]=e=>s.$store.goToNextPage())},[a(d)],8,p0),s.$store.sections.length>1?(e(),n("button",{key:1,type:"button",class:"tify-header-button",disabled:s.$store.isLastSection,title:s.$translate("Next section"),"aria-label":s.$translate("Next section"),onClick:i[4]||(i[4]=e=>s.$store.goToNextSection())},[a(u)],8,u0)):o("",!0),t("button",{type:"button",class:"tify-header-button",disabled:s.$store.isLastPage,title:s.$translate("Last page"),"aria-label":s.$translate("Last page"),onClick:i[5]||(i[5]=e=>s.$store.goToLastPage())},[a(h)],8,r0)],2)}s0=i(v0,[["render",x0]]),J4={},G4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function A0(s,o){return e(),n("svg",G4,o[0]||(o[0]=[t("path",{d:"M21,4H3A2,2 0 0,0 1,6V19A2,2 0 0,0 3,21H21A2,2 0 0,0 23,19V6A2,2 0 0,0 21,4M3,19V6H11V19H3M21,19H13V6H21V19Z"},null,-1)]))}U4=i(J4,[["render",A0]]),B4={},R4={class:"tify-icon","aria-hidden":"true",viewBox:"0 0 24 24"};function T0(s,o){return e(),n("svg",R4,o[0]||(o[0]=[t("path",{d:"M16,5V11H21V5M10,11H15V5H10M16,18H21V12H16M10,18H15V12H10M4,18H9V12H4M4,11H9V5H4V11Z"},null,-1)]))}z4=i(B4,[["render",T0]]),S4={data(){return{filter:"",filteredCanvases:[],highlightIndex:0}},watch:{filter(){this.updateFilteredCanvases(),this.$nextTick(()=>this.updateScroll())}},mounted(){this.updateFilteredCanvases()},methods:{onKeyDownArrow(){this.highlightIndex<this.filteredCanvases.length-1&&(this.highlightIndex+=1,this.updateScroll())},onKeyUpArrow(){this.highlightIndex>0&&(this.highlightIndex-=1,this.updateScroll())},onOpen(){this.filter="",this.highlightIndex=this.$store.options.pages.at(-1)-1,this.$nextTick(()=>{window.matchMedia("(pointer: coarse)").matches||this.$refs.search.focus(),this.updateScroll()})},resetFilter(e){this.filter&&(this.filter="",e.stopPropagation())},setPage(e){this.$store.setPage(e),this.$store.isContainerWidthAtLeast("medium")||this.$store.updateOptions({view:null})},updateFilteredCanvases(){const e=[],n=this.filter.toLowerCase();let t=-1;this.$store.manifest.items.forEach((s,o)=>{const i=this.$store.localize(s.label).toLowerCase().includes(n),a=(o+1).toFixed().includes(n);if(i||a){const n=s;n.page=o+1,n.page===this.$store.options.pages[0]&&(t=e.length),e.push(n)}}),this.highlightIndex=t<0?0:t,this.filteredCanvases=e},updateScroll(){const{list:e}=this.$refs,t=e.children[this.highlightIndex];e&&t&&(e.scrollTop=t.offsetTop-e.offsetHeight/2+t.offsetHeight/2)}}},C4={class:"tify-sr-only"},_4={class:"tify-sr-only"},v4={class:"tify-page-select-filter"},m4=["aria-label"],Y1={ref:"list",class:"tify-button-list tify-page-select-list"},$1=["onClick"];function B0(o,i,l,d,u,h){const m=je,f=Ft;return e(),r(f,{class:"tify-page-select",shortcut:"x",onOpen:h.onOpen},{button:I(()=>[t("span",C4,s(`${o.$translate("Current Page")} `),1),a(m,{number:o.$store.options.pages.find(e=>e>0)},null,8,["number"]),t("span",_4," / "+s(o.$translate("Toggle page select")),1)]),default:I(()=>[t("div",v4,[A(t("input",{ref:"search","onUpdate:modelValue":i[0]||(i[0]=e=>u.filter=e),"aria-label":o.$translate("Filter pages"),type:"text",class:"tify-page-select-input",onKeyup:i[1]||(i[1]=de(e=>o.$refs.list.querySelectorAll("a")[u.highlightIndex].click(),["enter"])),onKeydown:[i[2]||(i[2]=de(e=>h.resetFilter(),["esc"])),i[3]||(i[3]=de(fe(e=>h.onKeyUpArrow(),["prevent"]),["up"])),i[4]||(i[4]=de(fe(e=>h.onKeyDownArrow(),["prevent"]),["down"]))]},null,40,m4),[[tt,u.filter]])]),t("ol",Y1,[(e(!0),n(c,null,g(u.filteredCanvases,(s,i)=>(e(),n("li",{key:i},[t("a",{href:"javascript:;",class:j({"-current":o.$store.options.pages.includes(s.page),"-highlighted":u.highlightIndex===i}),onClick:e=>h.setPage(s.page)},[a(m,{number:s.page,wrap:!0},null,8,["number"])],10,$1)]))),128))],512)]),_:1},8,["onOpen"])}P1=i(S4,[["render",B0]]),D1={props:{textEnabled:Boolean,tocEnabled:Boolean},data(){return{controlsVisible:!1,fullscreen:d2(this.$store.rootElement.parentNode)}},computed:{doublePageEnabled(){var e;return!((e=this.$store.manifest.behavior)!=null&&e.some(e=>["continuous","individuals"].includes(e)))&&this.$store.manifest.items.some(e=>{var t,n,s,o,i;return((i=(o=(s=(n=(t=e.items)==null?0[0]:t[0])==null?0[0]:n.items)==null?0[0]:s[0])==null?0[0]:o.body)==null?0[0]:i.type)==="Image"})},title(){return this.$store.localize((this.$store.manifest||this.$store.collection||{}).label).replace(/(\S{1,10})\s+(\S{1,10})$/,"$1\xA0$2")}},created(){this.$api.expose(this.setView),this.$api.expose(this.toggleDoublePage),this.$api.expose(this.fullscreen.toggle)},mounted(){this.$store.rootElement.addEventListener("keydown",this.onKeyDown),Pd(this.$refs.controls,()=>{this.closeControlsPopup()})},beforeUnmount(){this.$store.rootElement.removeEventListener("keydown",this.onKeyDown)},methods:{closeControlsPopup(){this.controlsVisible=!1},onKeyDown(e){if(Jn(e))return;if(e.key==="Escape"){this.controlsVisible=!1;return}switch(e.key){case"Backspace":this.$refs.switchViewSmall.offsetParent&&this.toggleView(null);break;case"1":this.$store.manifest&&this.textEnabled&&this.toggleView("text");break;case"2":this.$store.manifest&&this.toggleView("thumbnails");break;case"3":this.$store.manifest&&this.tocEnabled&&this.toggleView("toc");break;case"4":this.toggleView("info");break;case"5":(this.$store.collection||this.$store.manifest)&&this.toggleView("export");break;case"6":this.$store.collection&&this.toggleView("collection");break;case"7":this.toggleView("help");break;case"b":this.$store.manifest&&this.toggleDoublePage();break;case"f":this.fullscreen.toggle();break}if(!this.$store.manifest)return;const{pages:t}=this.$store.options;switch(e.key){case"q":case",":t[0]>1&&this.$store.goToPreviousPage();break;case"e":case".":this.isLastPage||this.$store.goToNextPage();break;case"Q":t[0]>1&&this.$store.goToFirstPage();break;case"E":this.isLastPage||this.$store.goToLastPage();break}},setView(e){this.$store.updateOptions({view:e})},toggleControlsPopup(){this.controlsVisible=!this.controlsVisible},toggleDoublePage(e){const{pages:t}=this.$store.options;if(!this.doublePageEnabled)return t[0];let n;return t.length>1&&e!==!0||e===!1?n=[t[1]>0?t[1]:t[0]]:n=[t[0],this.$store.getFacingPage(t[0])].sort(),this.$store.updateOptions({pages:n}),n},toggleView(e){this.closeControlsPopup();const t=e===this.$store.options.view&&this.$store.manifest&&this.$store.isContainerWidthAtLeast("medium")?null:e;return this.$store.updateOptions({view:t}),t}}},M1={class:"tify-header"},E1={class:"tify-header-column -title"},y1=["title"],g1={key:0,class:"tify-header-column -pagination"},h1={class:"tify-sr-only"},c1={class:"tify-header-button-group -page-select"},o1=["title","aria-label","aria-pressed"],e1={ref:"controls",class:"tify-header-column -controls"},Xu={class:"tify-sr-only"},Ku={ref:"switchViewSmall",class:"tify-header-button-group -toggle"},$u=["aria-controls","aria-expanded","title","aria-label"],Vu=["id"],Pu={class:"tify-header-button-group -view"},pu=["aria-controls","aria-expanded"],uu=["aria-controls","aria-expanded"],ru=["aria-controls","aria-expanded"],su=["aria-controls","aria-expanded"],Jd=["aria-controls","aria-expanded"],qd=["aria-controls","aria-expanded"],Wd=["aria-controls","aria-expanded"],Vd={class:"tify-header-button-group -view"},Bd=["aria-controls","aria-expanded","title","aria-label"],Id=["title","aria-label"],Hd=["title","aria-label"];function f2(i,c,l,d,u,h){const y=P1,f=z4,g=U4,m=s0,v=e0,b=X4,p=K4,_=V4,w=P4,O=D4,x=M4,C=E4,E=w4,k=b4;return e(),n("header",M1,[t("div",E1,[t("h1",{class:"tify-header-title",title:h.title},s(h.title),9,y1)]),i.$store.pageCount>1?(e(),n("div",g1,[t("h2",h1,s(i.$translate("Page")),1),t("div",c1,[a(y),h.doublePageEnabled?(e(),n("button",{key:0,type:"button",class:j(["tify-header-button",{"-vertical":i.$store.isVertical}]),title:i.$translate("Toggle double-page"),"aria-label":i.$translate("Toggle double-page"),"aria-pressed":i.$store.options.pages.length>1,onClick:c[0]||(c[0]=(...e)=>h.toggleDoublePage&&h.toggleDoublePage(...e))},[i.$store.isCustomPageView?(e(),r(f,{key:0})):(e(),r(g,{key:1}))],10,o1)):o("",!0)]),i.$store.pageCount>1?(e(),r(m,{key:0})):o("",!0)])):o("",!0),t("div",e1,[t("h2",Xu,s(i.$translate("View [noun]")),1),t("div",Ku,[t("button",{type:"button","aria-controls":i.$getId("controls"),"aria-expanded":u.controlsVisible,class:"tify-header-button",title:i.$translate("View [noun]"),"aria-label":i.$translate("View [noun]"),onClick:c[1]||(c[1]=(...e)=>h.toggleControlsPopup&&h.toggleControlsPopup(...e))},[a(v)],8,$u)],512),t("div",{id:i.$getId("controls"),class:j(["tify-dropdown-content -bottom -mobile-only",{"-visible":u.controlsVisible}])},[t("div",Pu,[i.$store.manifest?(e(),n("button",{key:0,type:"button",class:"tify-header-button -media","aria-controls":i.$getId("media"),"aria-expanded":!i.$store.options.view,onClick:c[2]||(c[2]=e=>h.toggleView(null))},[a(b),t("span",null,s(i.$translate("Media")),1)],8,pu)):o("",!0),l.textEnabled?(e(),n("button",{key:1,type:"button",class:"tify-header-button","aria-controls":i.$getId("text"),"aria-expanded":i.$store.options.view==="text",onClick:c[3]||(c[3]=e=>h.toggleView("text"))},[a(p),t("span",null,s(i.$translate("Text")),1)],8,uu)):o("",!0),i.$store.manifest?(e(),n("button",{key:2,type:"button",class:"tify-header-button","aria-controls":i.$getId("thumbnails"),"aria-expanded":i.$store.options.view==="thumbnails",onClick:c[4]||(c[4]=e=>h.toggleView("thumbnails"))},[a(f),t("span",null,s(i.$translate("Pages")),1)],8,ru)):o("",!0),l.tocEnabled?(e(),n("button",{key:3,type:"button",class:"tify-header-button","aria-controls":i.$getId("toc"),"aria-expanded":i.$store.options.view==="toc",onClick:c[5]||(c[5]=e=>h.toggleView("toc"))},[a(_),t("span",null,s(i.$translate("Contents")),1)],8,su)):o("",!0),t("button",{type:"button",class:"tify-header-button","aria-controls":i.$getId("info"),"aria-expanded":i.$store.options.view==="info",onClick:c[6]||(c[6]=e=>h.toggleView("info"))},[a(w),t("span",null,s(i.$translate("Info")),1)],8,Jd),i.$store.collection||i.$store.manifest?(e(),n("button",{key:4,type:"button",class:"tify-header-button","aria-controls":i.$getId("export"),"aria-expanded":i.$store.options.view==="export",onClick:c[7]||(c[7]=e=>h.toggleView("export"))},[a(O),t("span",null,s(i.$translate("Export [noun]")),1)],8,qd)):o("",!0),i.$store.collection?(e(),n("button",{key:5,type:"button",class:"tify-header-button","aria-controls":i.$getId("collection"),"aria-expanded":i.$store.options.view==="collection",onClick:c[8]||(c[8]=e=>h.toggleView("collection"))},[a(x),t("span",null,s(i.$translate("Collection")),1)],8,Wd)):o("",!0)]),t("div",Vd,[t("button",{type:"button",class:"tify-header-button -icon-only","aria-controls":i.$getId("help"),"aria-expanded":i.$store.options.view==="help",title:i.$translate("Help"),"aria-label":i.$translate("Help"),onClick:c[9]||(c[9]=e=>h.toggleView("help"))},[a(C),t("span",null,s(i.$translate("Help")),1)],8,Bd),u.fullscreen.isFullscreen?(e(),n("button",{key:1,type:"button",class:"tify-header-button -icon-only",title:i.$translate("Exit fullscreen"),"aria-label":i.$translate("Exit fullscreen"),onClick:c[11]||(c[11]=e=>u.fullscreen.toggle())},[a(k),t("span",null,s(i.$translate("Exit fullscreen")),1)],8,Hd)):(e(),n("button",{key:0,type:"button",class:"tify-header-button -icon-only",title:i.$translate("Fullscreen"),"aria-label":i.$translate("Fullscreen"),onClick:c[10]||(c[10]=e=>u.fullscreen.toggle())},[a(E),t("span",null,s(i.$translate("Fullscreen")),1)],8,Id))]),i.$store.pageCount>1?(e(),r(m,{key:0})):o("",!0)],10,Vu)],512)])}Rd=i(D1,[["render",f2]]),Td={version:"0.34.5"},Md={props:{readyPromise:{type:Object,default:null,required:!0}},data(){return{readyToRender:!1}},computed:{hasText(){var e,t;return(t=(e=this.$store.manifest)==null?0[0]:e.items)==null?0[0]:t.some(e=>"annotations"in e)},hasToc(){return this.$store.structures.length>0}},watch:{"$store.options.pages":function(e,t){t&&(this.$store.options.layers=[]),this.$store.annotationsActive&&this.$store.loadAnnotations()},"$store.options.view":function(){this.$store.annotationsActive&&this.$store.loadAnnotations()}},created(){this.$api.expose(this.setLanguage),this.$api.expose(this.$store.setPage),this.$api.expose(this.$store.updateOptions)},mounted(){if(this.$store.rootElement=this.$el,!this.$store.options.manifestUrl){if(this.$store.options.contentStateEnabled){const e=new URLSearchParams(window.location.search);this.$store.options.manifestUrl=e.get("iiif-content")||""}if(!this.$store.options.manifestUrl){this.$store.addError("Missing IIIF manifest URL");return}}Promise.all([this.$store.loadManifest(this.$store.options.manifestUrl),this.setLanguage(this.$store.options.language)]).then(()=>{this.readyToRender=!0,this.$nextTick(()=>{Promise.all(this.$store.readyPromises).then(()=>{setTimeout(this.readyPromise.resolve)})})},e=>{this.readyPromise.reject(e)})},beforeUnmount(){clearTimeout(this.$store.urlUpdateTimeout),window.removeEventListener("popstate",this.$store.initOptions)},methods:{setLanguage(e){const t=ds();if(e==="en")return this.$store.options.language="en",this.$translate.setTranslation(null),t.resolve(e),t;if(this.$store.options.translationsDirUrl===null)return t.reject(new Error("Could not determine translationsDirUrl")),t;const n=`${this.$store.options.translationsDirUrl}/${e}.json?${Td.version}`;return this.$store.fetchJson(n).then(n=>{this.$store.options.language=e,this.$translate.setTranslation(n),t.resolve(e)},n=>{const s=n.response?n.response.statusText:n.message;this.$store.addError(`Error loading translation “${e}”: ${s}`),t.resolve(this.$store.options.language)}),t}}},Sd={key:1,class:"tify-main"},Ad={key:2,class:"tify-loading",role:"status"},Ed={class:"tify-sr-only"},Cd={key:3,class:"tify-error"},xd=["aria-label"],wd={class:"tify-error-messages"};function x2(i,l,d,u,h,m){const f=Rd,p=f4,v=Kl,b=Ll,y=wl,_=ml,w=to,O=lr,x=Ha,C=un;return e(),n("article",{class:j(["tify",i.$store.options.colorMode==="auto"?"":`-${i.$store.options.colorMode}`]),tabindex:"-1"},[h.readyToRender&&(i.$store.collection||i.$store.manifest)?(e(),r(f,{key:0,textEnabled:m.hasText,tocEnabled:m.hasToc},null,8,["textEnabled","tocEnabled"])):o("",!0),h.readyToRender?(e(),n("div",Sd,[i.$store.manifest?(e(),n(c,{key:0},[a(p,{id:i.$getId("media")},null,8,["id"]),m.hasText?A((e(),r(v,{key:0,id:i.$getId("text")},null,8,["id"])),[[L,i.$store.options.view==="text"]]):o("",!0),A(a(b,{id:i.$getId("thumbnails")},null,8,["id"]),[[L,i.$store.options.view==="thumbnails"]]),m.hasToc?A((e(),r(y,{key:1,id:i.$getId("toc")},null,8,["id"])),[[L,i.$store.options.view==="toc"]]):o("",!0)],64)):o("",!0),i.$store.collection||i.$store.manifest?A((e(),r(_,{key:1,id:i.$getId("export")},null,8,["id"])),[[L,i.$store.options.view==="export"]]):o("",!0),i.$store.collection||i.$store.manifest?A((e(),r(w,{key:2,id:i.$getId("info")},null,8,["id"])),[[L,i.$store.options.view==="info"]]):o("",!0),i.$store.collection?A((e(),r(O,{key:3,id:i.$getId("collection")},null,8,["id"])),[[L,i.$store.options.view==="collection"]]):o("",!0),A(a(x,{id:i.$getId("help")},null,8,["id"]),[[L,i.$store.options.view==="help"]])])):o("",!0),i.$store.loading?(e(),n("div",Ad,[t("span",Ed,s(i.$translate("Loading")),1)])):o("",!0),i.$store.errors.size?(e(),n("section",Cd,[t("button",{type:"button",class:"tify-error-close","aria-label":i.$translate("Dismiss"),onClick:l[0]||(l[0]=e=>i.$store.clearErrors())},[a(C)],8,xd),t("div",wd,[(e(!0),n(c,null,g(i.$store.errors,t=>(e(),n("p",{key:t},s(t),1))),128))])])):o("",!0)],2)}_d=i(Md,[["render",x2]]),jd={annotationId:null,annotationsVisible:null,childManifestAutoloaded:!0,childManifestUrl:null,colorMode:"auto",container:null,contentStateEnabled:!1,fallbackLanguage:"en",filters:{},language:"en",layers:[],manifestUrl:null,optionsResetOnPageChange:["pan"],pageLabelFormat:"P&nbsp;\xB7 L",pages:null,pan:{},preferredImageFormat:null,rotation:null,translationsDirUrl:null,urlQueryKey:null,urlQueryParams:["annotationId","annotationsVisible","childManifestUrl","layers","filters","pages","pan","rotation","view","zoom"],view:null,viewer:{},zoom:null};function k2(e){return{expose(t,n){e[n||t.name.replace("bound ","")]=t}}}pd={install:(e,t)=>{e.config.globalProperties.$api=new k2(t.instance)}},ud="TIFY is a slim and mobile-friendly IIIF document viewer, released under the <a href='https://www.gnu.org/licenses/agpl-3.0.html.en'>GNU Affero General Public License 3.0</a>.",rd="Copyright &copy; 2017&ndash;2025 <a href='https://www.uni-goettingen.de/en/'>G\xF6ttingen University</a>&nbsp;/ <a href='https://www.sub.uni-goettingen.de/en/'>G\xF6ttingen State and University Library</a>",sd={$info:ud,$copyright:rd,"$n/a":"‒"},Jl={install:e=>{const t=Je(null);e.config.globalProperties.$translate=n=>{var s,o,i;const{language:a}=e.config.globalProperties.$store.options,r=(o=(s=e.config.globalProperties.$store.options.translations)==null?0[0]:s[a])==null?0[0]:o[n];return r||((i=t.value)!=null&&i[n]?t.value[n]:sd[n]||n.replace(/\s*\[.+?\]/g,""))},e.config.globalProperties.$translate.setTranslation=e=>{t.value=e}}},Gl={install:e=>{const t=crypto!=null&&crypto.randomUUID?crypto.randomUUID():Math.random().toString().slice(2);e.config.globalProperties.$getId=e=>`${t}-${e}`}},Ul="http://library.stanford.edu/iiif/image-api/compliance.html#level0",Nl="http://library.stanford.edu/iiif/image-api/compliance.html#level1",hs="http://library.stanford.edu/iiif/image-api/compliance.html#level2",_l="http://library.stanford.edu/iiif/image-api/conformance.html#level0",hl="http://library.stanford.edu/iiif/image-api/conformance.html#level1",fs="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Nc="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",Fc="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",vs="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",_c="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",yc="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",js="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",Hr="http://iiif.io/api/image/1/level0.json",Fr="http://iiif.io/api/image/1/profiles/level0.json",kr="http://iiif.io/api/image/1/level1.json",xr="http://iiif.io/api/image/1/profiles/level1.json",ys="http://iiif.io/api/image/1/level2.json",_s="http://iiif.io/api/image/1/profiles/level2.json",jr="http://iiif.io/api/image/2/level0.json",fr="http://iiif.io/api/image/2/profiles/level0.json",ur="http://iiif.io/api/image/2/level1.json",cr="http://iiif.io/api/image/2/profiles/level1.json",xs="http://iiif.io/api/image/2/level2.json",Fs="http://iiif.io/api/image/2/profiles/level2.json",qa="level0",Ka="level1",Ts="level2",Va="http://iiif.io/api/image/2/level0",Pa="http://iiif.io/api/image/2/level1",Ds="http://iiif.io/api/image/2/level2",xa=[Ds,hs,fs,vs,js,ys,_s,xs,Fs,Ts],_a=[Va,Pa,Ds,Ul,Nl,hs,_l,hl,fs,Nc,Fc,vs,_c,yc,js,Hr,Fr,kr,xr,ys,_s,jr,fr,ur,cr,xs,Fs,qa,Ka,Ts],ya=_a;function Y(e){for(let t in e)(typeof e[t]>"u"||e[t]===null)&&delete e[t];return e}function f3(e){return Array.isArray(e)?e:e?[e]:[]}va=Object.defineProperty,ha=(e,t,n)=>t in e?va(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Rs=(e,t,n)=>(ha(e,typeof t!="symbol"?t+"":t,n),n),Ps=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function j3(e){if(typeof e>"u"||e===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if(typeof e!="object")throw new Error(`${typeof e} is not a valid entity`);if(typeof e["@type"]=="string"){let t=Ps.indexOf(e["@type"]);if(t!==-1)return Ps[t]}if(e.profile)return"Service";if(e.format||e["@type"])return"ContentResource";throw new Error("Resource type is not known")}ta=class Mo{constructor(e,t={}){Rs(this,"traversals"),Rs(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...e},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...t}}static all(e){return new Mo({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let n=[...(e.manifests||[]).map(e=>typeof e=="string"?{"@id":e,"@type":"sc:Manifest"}:e),...(e.collections||[]).map(e=>typeof e=="string"?{"@id":e,"@type":"sc:Collection"}:e),...e.members||[]],t=[],s=n.filter(e=>!t.includes(e["@id"])&&(t.push(e["@id"]),!0));delete e.collections,delete e.manifests,e.members=s}return e.manifests&&(e.manifests=e.manifests.map(e=>this.traverseManifest(typeof e=="string"?{"@id":e,"@type":"sc:Manifest"}:e))),e.collections&&(e.collections=e.collections.map(e=>this.traverseCollection(typeof e=="string"?{"@id":e,"@type":"sc:Collection"}:e))),e.members&&(e.members=e.members.map(e=>typeof e=="string"?e:e["@type"]==="sc:Collection"?this.traverseCollection(e):e["@type"]==="sc:Manifest"?this.traverseManifest(e):this.traverseUnknown(e))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(e=>this.traverseSequence(e))),e.structures&&(e.structures=e.structures.map(e=>this.traverseRange(e))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(e=>this.traverseCanvas(e))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(e=>this.traverseAnnotation(e))),e.otherContent&&(e.otherContent=e.otherContent.map(e=>this.traverseAnnotationList(e))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let t=[...(e.ranges||[]).map(e=>typeof e=="string"?{"@id":e,"@type":"sc:Range"}:e),...(e.canvases||[]).map(e=>typeof e=="string"?{"@id":e,"@type":"sc:Canvas"}:e),...e.members||[]];delete e.ranges,delete e.canvases,e.members=t.length?t.map(e=>this.traverseUnknown(e)):0[0]}return e}traverseAnnotationList(e){let t=typeof e=="string"?{"@id":e,"@type":"sc:AnnotationList"}:e;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(t)),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(e=>this.traverseAnnotation(e))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(Array.isArray(e.resource)?e.resource=e.resource.map(e=>this.traverseContentResource(e)):e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(e=>this.traverseAnnotationList(e))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(e=>this.traverseContentResource(e))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(j3(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"sc:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let n=Array.isArray(e),s=Array.isArray(e)?e:[e],t=[];for(let e of s)typeof e=="string"?t.push(this.traverseContentResource({"@id":e,"@type":"dctypes:Image"})):t.push(this.traverseContentResource(e));return!n&&!this.options.convertPropsToArray?t[0]:t}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let n=Array.isArray(e),s=Array.isArray(e)?e:[e],t=[];for(let e of s)t.push(this.traverseService(e));return!n&&!this.options.convertPropsToArray?t[0]:t}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,t){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,t);return e.map(e=>this.traverseType(e,t))}traverseType(e,t){return t.reduce((e,t)=>{let n=t(e);return typeof n>"u"&&!this.options.allowUndefinedReturn?e:n},e)}},ea="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Xi="http://library.stanford.edu/iiif/image-api/compliance.html#level2",Yi="http://library.stanford.edu/iiif/image-api/conformance.html#level1",qi="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Ki="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",Ui="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",Vi="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",Bi="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",Hi="http://iiif.io/api/image/1/level1.json",Li="http://iiif.io/api/image/1/profiles/level1.json",Si="http://iiif.io/api/image/1/level2.json",Ci="http://iiif.io/api/image/1/profiles/level2.json",_i="http://iiif.io/api/image/2/level1.json",bi="http://iiif.io/api/image/2/profiles/level1.json",gi="http://iiif.io/api/image/2/level2.json",pi="http://iiif.io/api/image/2/profiles/level2.json",mi="level1",li="level2",ci="http://iiif.io/api/image/2/level1",si="http://iiif.io/api/image/2/level2",ni=[ci,si,ea,Xi,Yi,qi,Ki,Ui,Vi,Bi,Hi,Li,Si,Ci,_i,bi,gi,pi,mi,li],qt={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:""};function $3(e){if(typeof e=="string")return[e];if(!e)return[];let n=Array.isArray(e)?e:[e],t=[];for(let e of n){if(typeof e=="string"){t.push(e);continue}t.push({"@language":e["@language"]||e.language,"@value":e["@value"]||e.value})}return t}function xe(e,t="none"){if(!e)return{none:[""]};let s=$3(e),n={};for(let e of s){if(typeof e=="string"){n[t]=n[t]?n[t]:[],n[t].push(e||"");continue}if(!e["@language"]){n[t]=n[t]?n[t]:[],n[t].push(e["@value"]||"");continue}let o=e["@language"];n[o]=n[o]?n[o]:[],n[o].push(e["@value"]||"")}return Object.keys(n).length===0?{none:[""]}:n}function Go(e){if(Array.isArray(e))return Go(e.find(e=>typeof e=="string"));if(xa.indexOf(e)!==-1)return"level2";if(ni.indexOf(e)!==-1)return"level1";if(ya.indexOf(e)!==-1)return"level0";if(typeof e=="string")return e}function K3(e){let t=Array.isArray(e)?e:[e];for(let e of t)switch(e){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function q3(e){switch(e){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function Ko(e){for(let t of["sc","oa","dcterms","dctypes","iiif"])if(e.startsWith(`${t}:`))return e.slice(t.length+1);return e}Wo=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function Hs(e){let n=e["@id"]||e.id,t=e["@type"]||e.type,s=e.profile||0[0],o=e["@context"]||0[0];if(s){let e=q3(s);if(e)return e}if(o){let e=K3(o);if(e)return e}if(t){if(Array.isArray(t)){if(t.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(t.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";t=t[0]}for(let e of["sc","oa","dcterms","dctypes","iiif"])if(t.startsWith(`${e}:`)){t=t.slice(e.length+1);break}switch(t){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(t&&Wo.indexOf(t)!==-1)return t;if(e.format){if(e.format.startsWith("image/"))return"Image";if(e.format.startsWith("text/")||e.format==="application/pdf")return"Text";if(e.format.startsWith("application/"))return"Dataset"}return n&&(n.endsWith(".jpg")||n.endsWith(".png")||n.endsWith(".jpeg"))?"Image":t||"unknown"}Bo=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function Z3(e){let t=e.match(Bo);return t?t[0]:e}function J3(e,t="Rights/License",n="none"){let s=null,o=[],i=Array.isArray(e)?e:[e];for(let a of i){let e=a?Z3(a):0[0];if(e&&(e.indexOf("creativecommons.org")!==-1||e.indexOf("rightsstatements.org")!==-1)){e.startsWith("https://")?s=`http://${e.slice(8)}`:s=e;continue}e&&o.push({label:{[n]:[t]},value:{[n]:[e]}})}return[s,o]}Ho=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function th(e){if(e){let n=Array.isArray(e)?e:[e],t=[];for(let e of n)e==="http://iiif.io/api/presentation/2/context.json"&&t.push("http://iiif.io/api/presentation/3/context.json"),Ho.indexOf(e)===-1&&t.push(e);if(n.length)return t.length===1?t[0]:t}}function nh(e){return e?e.map(e=>({label:xe(e.label),value:xe(e.value)})):[]}$s=0;function Ro(e,t){let n=encodeURI(e.id||e["@id"]||"").trim();return n&&t?`${n}/${t}`:n||($s++,`http://example.org/${e["@type"]}${t?`/${t}`:""}/${$s}`)}function se(e){let t=[...e.behavior||[]];e.viewingHint&&t.push(e.viewingHint);let n;return Array.isArray(e.motivation)?n=e.motivation.map(Ko):e.motivation&&(n=Ko(e.motivation)),{"@context":e["@context"]?th(e["@context"]):0[0],id:(e["@id"]||Ro(e)).trim(),type:Hs(e),behavior:t.length?t:0[0],height:e.height?e.height:0[0],width:e.width?e.width:0[0],motivation:n,viewingDirection:e.viewingDirection,profile:e.profile,format:e.format?e.format:0[0],duration:0[0],timeMode:0[0]}}function ae(e){let[n,s]=J3(e.license),t=[...e.metadata?nh(e.metadata):[],...s];return{rights:n,metadata:t.length?t:0[0],label:e.label?xe(e.label):0[0],requiredStatement:e.attribution?{label:xe(qt.attributionLabel),value:xe(e.attribution)}:0[0],navDate:e.navDate,summary:e.description?xe(e.description):0[0],thumbnail:rh(e.thumbnail)}}function rh(e){return e&&(Array.isArray(e)?e:[e]).map(e=>typeof e=="string"?{id:e,type:"Image"}:(e.type==="unknown"&&(e.type="Image"),e))}function ch(e){if(!e.within)return;let n=Array.isArray(e.within)?e.within:[e.within],t=[];for(let s of n)if(typeof s=="string"){if(s)switch(e["@type"]){case"sc:Manifest":t.push({id:s,type:"Collection"});break}}else s["@id"]&&t.push({id:s["@id"],type:Hs(s)});return t.length?t:0[0]}function he(e){let t=e.related?Array.isArray(e.related)?e.related:[e.related]:[],n=e.contentLayer;return{provider:e.logo||t.length?[{id:qt.providerId,type:"Agent",homepage:t.length?[t[0]]:0[0],logo:e.logo?Array.isArray(e.logo)?e.logo:[e.logo]:0[0],label:xe(qt.providerName)}]:0[0],partOf:ch(e),rendering:e.rendering,seeAlso:e.seeAlso,start:e.startCanvas,service:e.service?f3(e.service):0[0],supplementary:n?[n]:0[0]}}function dh(e){return{chars:e.chars,format:e.format?e.format:0[0],language:e.language}}function Us(e,t){return e?typeof e=="string"?{id:e,type:t}:typeof e?.["@id"]=="string"?{id:e["@id"],type:t}:typeof e.id=="string"?{id:e.id,type:t}:null:null}function hh(e){let t={};if(e.first){let n=Us(e.first,"Collection");n&&(t.first=n)}if((e.total||e.total===0)&&(t.total=e.total),e.prev){let n=Us(e.prev,"Collection");n&&(t.prev=n)}if(e.next){let n=Us(e.next,"Collection");n&&(t.next=n)}return t}function mh(e){let t=[];for(let s of e){let n={...s};n.items&&n.items.length===0&&delete n.items,t.push(n)}return t}function fh(e){return Y({...se(e),...ae(e),...he(e),...hh(e),items:mh(e.members)})}function ph(e){let s=[],t=[],o,i;for(let n of e.sequences||[])n.canvases.length&&s.push(...n.canvases),n.behavior&&t.push(...n.behavior),n.viewingDirection&&(i=n.viewingDirection),n.startCanvas&&(o=n.startCanvas);let n=se(e);return t.length&&(n.behavior?n.behavior.push(...t):n.behavior=t),Y({...n,...ae(e),...he(e),viewingDirection:i,start:o,items:s,structures:gh(e.structures)})}function gh(e){if(!e)return e;let t=new Map;for(let n of e)t.set(n.id,n);let n=[];for(let s of e)if(s.items){let e=s.items.map(e=>typeof e=="string"?(n.push(e),t.get(e)||e):e&&e.id?(n.push(e.id),t.get(e.id)||e):e);s.items=e}return e.filter(e=>n.indexOf(e.id)===-1)}function vh(e){return Y({...se(e),...ae(e),...he(e),annotations:e.otherContent&&e.otherContent.length?e.otherContent:0[0],items:e.images&&e.images.length?[{id:Ro(e,"annotation-page"),type:"AnnotationPage",items:e.images}]:0[0]})}function bh(e){return Y({...se(e),...ae(e),...he(e),items:e.resources&&e.resources.length?e.resources:0[0]})}function jh(e){return!e.canvases||e.canvases.length===0?{canvases:[],behavior:[]}:{canvases:e.canvases,behavior:e.viewingHint?[e.viewingHint]:[],viewingDirection:e.viewingDirection,startCanvas:e.startCanvas}}function yh(e){function t(e){if(Array.isArray(e)){if(e.length>1)return{type:"List",items:e.map(t)};e=e[0]}if(typeof e=="string")return encodeURI(e).trim();if("@type"in e){let t;if(typeof e.full=="string")t=e.full;else if(e.full["@type"]==="dctypes:Image")t={id:e.full["@id"],type:"Image"};else if(e.full["@type"]==="sc:Canvas")t={id:e.full["@id"],type:"Canvas"};else throw new Error(`Unsupported source type on annotation: ${e.full["@type"]}`);return{type:"SpecificResource",source:t,selector:Xs(e.selector)}}return encodeURI(e["@id"]).trim()}return Y({...se(e),...ae(e),...he(e),target:t(e.on),body:Array.isArray(e.resource)?e.resource.map(wo):wo(e.resource)})}function wo(e){return e.type==="Choice"?e:yo(e)}function yo(e){let t=e;return Y({...se(t),...ae(t),...he(t),...dh(t)})}function Oh(e){let t=[];return e.default&&e.default!=="rdf:nil"&&t.push(e.default),e.item&&e.item!=="rdf:nil"&&t.push(...e.item),Y({...se(e),...ae(e),items:t})}function xh(e){return Y({...se(e),...ae(e),...he(e),items:e.members})}function Ch(e){let{"@id":s,"@type":a,"@context":n,profile:o,...i}=e,t={};return s&&(t["@id"]=s),t["@type"]=Hs(e),t["@type"]==="unknown"&&(n&&n.length&&(t["@context"]=n),t["@type"]="Service"),o&&(t.profile=Go(o)),Y({...t,...i})}function Eh(e){return Y({...se(e),...ae(e),...he(e)})}jo=new ta({collection:[fh],manifest:[ph],canvas:[vh],annotationList:[bh],sequence:[jh],annotation:[yh],contentResource:[yo],choice:[Oh],range:[xh],service:[Ch],layer:[Eh]});function w0(e){return e&&e["@context"]&&(e["@context"]==="http://iiif.io/api/presentation/2/context.json"||e["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||e["@context"]==="http://www.shared-canvas.org/ns/context.json")||e["@context"]==="http://iiif.io/api/image/2/context.json"||e["@id"]&&e["@type"]==="sc:Collection"||e["@id"]&&e["@type"]==="sc:Manifest"?(e["@context"]||(e["@context"]="http://iiif.io/api/presentation/2/context.json"),jo.traverseUnknown(e)):e}function Xs(e){if((Array.isArray(e["@type"])&&e["@type"].includes("oa:SvgSelector")||e["@type"]=="oa:SvgSelector")&&("chars"in e||"value"in e))return{type:"SvgSelector",value:"chars"in e?e.chars:e.value};if(e["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:e.value};if(e["@type"]==="oa:Choice")return[Xs(e.default),...(Array.isArray(e.item)?e.item:[e.item]).map(Xs)];if(e["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in e?e.region:0[0],rotation:"rotation"in e?e.rotation:0[0]};throw new Error(`Unsupported selector type: ${e["@type"]}`)}go=w0;function Qs(e){var n,s,o,i,a;const{related:c}=e,{requiredStatement:r}=e,{viewingDirection:l}=e,t=go(e);return e["@context"]==="http://iiif.io/api/presentation/2/context.json"&&([].concat(c||[]).forEach(e=>{t.homepage=t.homepage||[],t.homepage.push(typeof e=="string"?e:{id:e["@id"],label:e.label,format:e.format})}),(n=t.provider)==null||n.forEach((e,n)=>{e.homepage&&(t.provider[n].homepage=e.homepage.filter(e=>e.id!=="http://example.org/undefined/1"&&!t.homepage.find(t=>t.id===e.id)))}),((a=(i=(o=(s=t.provider)==null?0[0]:s[0])==null?0[0]:o.label)==null?0[0]:i.none)==null?0[0]:a[0])==="Unknown"&&(delete t.provider[0].label,r&&!t.requiredStatement&&(t.requiredStatement=r)),t.viewingDirection=l),t}function Th(e={}){const t=vt({annotations:[],annotationsAvailable:null,collection:null,errors:new Set,loading:0,manifest:e.manifest?Qs(e.manifest):null,options:e.options||{},readyPromises:[],rootElement:e.rootElement||null,urlUpdateTimeout:null,annotationsActive:_(()=>t.options.view==="text"||!t.options.view&&!t.isContainerWidthAtLeast("medium")),currentStructure:_(()=>{if(!(t.manifest.structures instanceof Array))return!1;const s=[];t.options.pages.filter(e=>e>0).forEach(e=>{s.push(t.manifest.items[e-1].id)});const{length:o}=t.manifest.structures;let e,n;for(let i=o-1;i>=0;i-=1){const a=t.manifest.structures[i],{items:r}=a;if(r!=null&&r.some(e=>s.includes(e.id))){const t=a.items.length;if((t<n||!n)&&(e=i,n=t,n===0))break}}return typeof e=="number"&&e>=0&&t.manifest.structures[e]}),isCustomPageView:_(()=>{const{pages:e}=t.options;return e?.length!==1&&(e.length>2||!(e[0]<1||e[1]<1)&&(e[0]%2===1||e[1]%2===0))}),isFirstPage:_(()=>t.options.pages[0]===1||t.options.pages[1]===1),isLastPage:_(()=>t.options.pages.at(-1)===t.pageCount),isLastSection:_(()=>{var s;const{pages:e}=t.options,n=e.length-1;return(e[n]?e[n]:e[n-1])>=((s=t.sections[t.sections.length-1])==null?0[0]:s.firstPage)}),isReversed:_(()=>["right-to-left","bottom-to-top"].includes(t.manifest.viewingDirection)),isVertical:_(()=>["top-to-bottom","bottom-to-top"].includes(t.manifest.viewingDirection)),pageCount:_(()=>{var e,n;return(n=(e=t.manifest)==null?0[0]:e.items)==null?0[0]:n.length}),sections:_(()=>{if(!t.manifest.structures)return[];const e=[];return t.manifest.structures.forEach(n=>{if(!n.items){e.push({firstPage:1,lastPage:t.pageCount});return}const s=n.items[0].id,o=t.manifest.items.findIndex(e=>e.id===s)+1,i=n.items[n.items.length-1].id,a=t.manifest.items.findIndex(e=>e.id===i)+1;e.push({firstPage:o,lastPage:a})}),e}),structures:_(()=>{var o,i;if((o=t.manifest)==null||!o.structures)return[];if(t.manifest.structures.some(e=>e.type==="Range"))return t.manifest.structures.length===1&&(i=t.manifest.structures[0].behavior)!=null&&i.includes("top")?t.manifest.structures[0].items||[]:t.manifest.structures;const e=[],n=t.manifest.items,r=t.manifest.structures.length;for(let o=0;o<r;o+=1){const s={...t.manifest.structures[o]};if(s.items){{const e=s.items[0].id;s.firstPage=n.findIndex(t=>t.id===e)+1;const t=s.items.at(-1).id;if(s.lastPage=n.findIndex(e=>e.id===t)+1,!n[s.firstPage-1])continue}}else n!=null&&n[0]&&(s.firstPage=1,s.lastPage=t.pageCount);s.level=0,s.pageCount=s.lastPage-s.firstPage+1,e.push(s)}let s=0;for(let n=0;n<e.length;n+=1){const t=e[n];for(let i=n+1;i<e.length;i+=1){const o=e[i];o.firstPage>=t.firstPage&&o.lastPage<=t.lastPage&&(t.items=(t.items||[]).filter(e=>e.label),t.items.push(o),o.level+=1,s=Math.max(s,o.level))}}const a=(e,t=0)=>{for(let n=0;n<e.length;n+=1){const s=e[n];s.level>t?e.splice(n,1):s.items&&a(s.items,t+1)}};for(let t=0;t<s;t+=1)a(e);return e}),addError(e){t.errors.add(e),console.warn(e)},clearErrors(){t.errors.clear()},async fetchJson(e){t.loading+=1;const n=await fetch(e).catch(e=>(t.loading=0,Promise.reject(e)));if(!n.ok)return t.loading=0,Promise.reject(new Error(n.status));const s=await n.json().catch(e=>(t.loading=0,Promise.reject(e)));return t.loading>0&&(t.loading-=1),s},async fetchText(e){t.loading+=1;const n=await fetch(e).catch(e=>(t.loading=0,Promise.reject(e)));if(!n.ok)return console.warn("Error loading annotation"),"";const s=await n.text().catch(e=>(t.loading=0,Promise.reject(e)));return t.loading>0&&(t.loading-=1),s},getFacingPage(e){var n,s,o,i,a;return(n=t.manifest.items[e-1].behavior)!=null&&n.includes("non-paged")?-1:e===1?0:e%2===1?(o=(s=t.manifest.items[e-1-1])==null?0[0]:s.behavior)!=null&&o.includes("non-paged")?-1:e-1:(a=(i=t.manifest.items[e+1-1])==null?0[0]:i.behavior)!=null&&a.includes("non-paged")?-1:e<t.pageCount?e+1:0},getPageLabel(e,n){const s=t.localize(n,"");return s?t.options.pageLabelFormat.replace("P",e).replace("L",s):t.options.pageLabelFormat.includes("P")?`${e}`:"—"},getStartPages(){var n;let e=1;if(t.manifest.items&&t.manifest.start){const n=t.manifest.items.findIndex(e=>e.id===t.manifest.start.id);e=n>=0?n+1:1}return t.isContainerWidthAtLeast("medium")&&(n=t.manifest.behavior)!=null&&n.includes("paged")?[e,t.getFacingPage(e)].sort():[e]},getThumbnailUrl(e,n,s=0,o=0){var c,l,d,u,h,m,f;const p=t.manifest.items[e-1],i=(c=p.thumbnail)==null?0[0]:c[0];if(i!=null&&i.id&&i?.width>=n)return i.id;const r=(h=(u=(d=(l=p.items)==null?0[0]:l[0])==null?0[0]:d.items)==null?0[0]:u[s])==null?0[0]:h.body,a=r!=null&&r.items?r.items[o]:r,g=i?.service||((m=a?.source)==null?0[0]:m.service)||a?.service;if(g){const e=[].concat(g)[0],o=["ImageService2","ImageService3"].includes(e.type||e["@type"])?"default":"native",s=e.id||e["@id"];let t=n;i!=null&&i.service&&((f=e.sizes)==null||f.forEach(e=>{e.width>=t&&e.width<=t*2&&(t=e.width)}));const a="jpg",r=s.at(-1)==="/"?"":"/";return`${s}${r}full/${t},/0/${o}.${a}`}return a?.type==="Image"?i?.id||a?.id:""},goToFirstPage(){t.setPage(1)},goToNextPage(){const e=t.options.pages.at(-1);e<t.pageCount&&t.setPage(e+1)},goToNextSection(){const{pages:e}=t.options,s=e.length-1,o=e[s]?e[s]:e[s-1];let n=0;for(;o>=t.sections[n].firstPage||o&&o>=t.sections[n].firstPage;)n+=1;t.setPage(t.sections[n].firstPage)},goToLastPage(){t.setPage(t.pageCount)},goToPreviousPage(){const e=t.options.pages.find(e=>e>0);e>1&&t.setPage(e-1)},goToPreviousSection(){const{pages:n}=t.options,s=n[0]?n[0]:n[1];let e=t.sections.length-1;for(;s<=t.sections[e].firstPage||s&&s<=t.sections[e].firstPage;)e-=1;t.setPage(t.sections[e].firstPage)},isContainerWidthAtLeast(e){return t.rootElement&&window.getComputedStyle(t.rootElement,"::after").content.includes(e)},loadAnnotations(){var e;t.annotationsAvailable=null,(e=t.options.pages)==null||e.filter(e=>e>0).forEach(async e=>{if(t.annotations[e])return;const s=t.manifest.items[e-1];if(!("annotations"in s)){t.annotationsAvailable=!1;return}t.annotations[e]=[];let n=s.annotations[0].items;if(!n){const e=s.annotations[0].id;try{const s=await t.fetchJson(e);n=s.resources||s.items}catch(e){const n=e.response?e.response.statusText:e.message;console.warn(`Could not load annotations: ${n}`),t.annotationsAvailable=!1;return}}n instanceof Array&&n.forEach(async(n,s)=>{var a,r,c,l,d,u,h,m,f,p,g,j;let o;const v=n.id||n["@id"]||((c=n.resource)==null?0[0]:c.id)||((j=n.resource)==null?0[0]:j["@id"]);if((g=n.resource)!=null&&g.chars)o=n.resource.chars;else if((a=(m=n.resource)==null?0[0]:m[0])!=null&&a.chars)o=(d=(l=n.resource)==null?0[0]:l[0])==null?0[0]:d.chars;else if((u=n.resource)!=null&&u.label)o=`<i>${n.resource.label}</i>`;else{const e=[].concat(n.body);o=(await Promise.all(e.map(async e=>{var n,s,o,i;if(e?.type==="Image")return`<img src="${e.id}" alt="">`;if(e!=null&&e.value)return e.value;if((n=e?.body)!=null&&n.value)return e.body.value;const a=((s=e?.items)==null?0[0]:s[0].id)||((o=e?.body)==null?0[0]:o.id)||((i=e?.body)==null?0[0]:i["@id"])||e?.id||v;return vn(a)?t.fetchText(a):""}))).join("<br>")}if(!o)return;(n.format||((h=n.body)==null?0[0]:h.format))==="text/plain"&&(o=o.replace(/\n/g," <br>")),t.annotationsAvailable=!0;const b={id:v,html:Nt(o)},y=((f=(r=n.on)==null?0[0]:r.selector)==null?0[0]:f.value)||(typeof n.on=="string"?n.on:null)||((p=n.target)==null?0[0]:p.id)||n.target||"",i=K1(y);i?.length===4&&(b.coords=i),t.annotations[e][s]=b})})},initOptions(e){let n={};if(t.options.urlQueryKey)try{const e=new URLSearchParams(window.location.search);n=JSON.parse(e.get(t.options.urlQueryKey))||{}}catch{}n.view==="fulltext"?n.view="text":["scan",""].includes(n.view)&&(n.view=null),n.pages&&!Mr(n.pages,t.pageCount)&&(t.addError("Invalid pages, reset to start page"),n.pages=null),t.options.urlQueryParams.forEach(e=>{t.options[e]=n[e]??t.options[e]}),t.options.pages=e&&e.type==="popstate"?n.pages||t.getStartPages():n.pages||t.options.pages||t.getStartPages(),t.options.pan=n.panX||n.panY?{x:n.panX,y:n.panY}:n.pan||t.options.pan,t.options.rotation=parseInt(n.rotation,10)||t.options.rotation,t.options.view=n.view||n.view===""?n.view:t.options.view,t.options.zoom=parseFloat(n.zoom)||t.options.zoom},loadManifest(e,n={}){const s=ds();return t.fetchJson(e).then(async o=>{const i=Qs(o);if(n.expectedType&&i.type!==n.expectedType){const e=`Expected manifest of type ${n.expectedType}, but got ${i.type}`;return t.addError(e),s.reject(e),s}if(t.manifest=null,await ln(),i.type==="Manifest")return t.manifest=i,t.initOptions(),window.addEventListener("popstate",t.initOptions),n.reset&&t.updateOptions({childManifestUrl:e,pages:t.getStartPages(),pan:{},rotation:null,view:t.isContainerWidthAtLeast("medium")?"collection":null,zoom:null}),s.resolve(),s;if(i.type==="Collection"){t.collection=i;const o=new URLSearchParams(window.location.search);let n={};try{n=JSON.parse(o.get(t.options.urlQueryKey))||{}}catch{}let e="";if(t.options.urlQueryParams.includes("childManifestUrl")&&n.childManifestUrl?e=n.childManifestUrl:t.collection.manifests&&t.options.childManifestAutoloaded&&(e=t.collection.manifests[0].id),e)await t.loadManifest(e,{expectedType:"Manifest"}),t.updateOptions({childManifestUrl:e});else{const e=n.view||t.options.view;t.updateOptions({view:["collection","help","info"].includes(e)?e:"collection"})}return s.resolve(),s}const a="Please provide a valid IIIF Presentation API manifest";return t.addError(a),s.reject(a),s},e=>{const n=`Error loading IIIF manifest: ${e.response&&(e.response.statusText||e.response.data)||e.message}`;return t.addError(n),s.reject(n),s})},localize(e){if(!t.options.language)throw new Error("language not set");if(!e)return"";if(typeof e=="string")return e;const n=e[t.options.language]||e[t.options.fallbackLanguage]||Object.values(e)[0]||"";return([].concat(n).join("\xA0\xB7 ")||"").trim()},setPage(e){var s;let n=[].concat(e);if(!Mr(n,t.pageCount))throw new RangeError("Invalid pages");return n.length===1&&((s=t.options.pages)==null?0[0]:s.length)===2&&!this.isCustomPageView&&(n=[n[0],t.getFacingPage(n[0])].sort()),t.updateOptions({pages:n}),n},toggleAnnotationId(e){const n={annotationId:t.options.annotationId===e?null:e,annotationsVisible:t.options.annotationId?null:t.annotationsVisible};n.annotationId&&!t.isContainerWidthAtLeast("medium")&&(n.view=t.options.view?null:"text"),t.updateOptions(n)},updateOptions(e){clearTimeout(t.urlUpdateTimeout),Object.assign(t.options,e),e.pages&&t.clearErrors(),t.options.urlQueryKey&&(t.urlUpdateTimeout=setTimeout(()=>{const n={};t.options.urlQueryParams.forEach(e=>{const s=t.options[e];s===null||e==="layers"&&!s.some(Boolean)||e==="pages"&&s.toString()===t.getStartPages().toString()||typeof s=="object"&&!Object.keys(s).length?delete n[e]:n[e]=t.options[e]});const s=new URL(window.location);Object.keys(n).length?s.searchParams.set(t.options.urlQueryKey,JSON.stringify(n)):s.searchParams.delete(t.options.urlQueryKey),window.history&&(e.pages||e.view?window.history.pushState({},"",s):window.history.replaceState({},"",s))},100))}});return t}ao={convertManifest:Qs,install:(e,t={})=>{e.config.globalProperties.$store=new Th(t)}},window.Tify=function(e={}){if(this.options={...JSON.parse(JSON.stringify(jd)),...e},!this.options.translationsDirUrl)try{const{url:e}=$2;this.options.translationsDirUrl=`${e.slice(0,e.lastIndexOf("/"))}/translations`}catch{}let t=null;this.ready=new Promise((e,n)=>{t={resolve:e,reject:n}});const s=this;this.app=ba({render:()=>D3(_d,{readyPromise:t})}).use(pd,{instance:s}).use(Jl).use(Gl).use(ao,{options:this.options});let n=!1;this.mount=e=>{if(n)throw new Error("TIFY is already mounted");const t=typeof e=="string"?document.querySelector(e):e;if(!t)throw new Error("Container element not found");this.app.mount(t),n=!0},this.destroy=()=>{this.app.unmount()},this.options.container&&this.mount(this.options.container)},Dh=window.Tify;function Nh(e,t,n="en"){document.documentElement.lang!==0[0]&&(n=document.documentElement.lang),e.startsWith("#")||(e="#"+e);const s=new Tify({container:e,manifestUrl:t,language:n,translationsDirUrl:"/tify/translations/"});return s}window.iiifPresentationViewer=Nh})()